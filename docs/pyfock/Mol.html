<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>pyfock.Mol API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
        overflow-y: hidden;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../pyfock.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;pyfock</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Mol">Mol</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Mol.__init__">Mol</a>
                        </li>
                        <li>
                                <a class="variable" href="#Mol.coordfile">coordfile</a>
                        </li>
                        <li>
                                <a class="variable" href="#Mol.atoms">atoms</a>
                        </li>
                        <li>
                                <a class="variable" href="#Mol.charge">charge</a>
                        </li>
                        <li>
                                <a class="variable" href="#Mol.basis">basis</a>
                        </li>
                        <li>
                                <a class="variable" href="#Mol.nelectrons">nelectrons</a>
                        </li>
                        <li>
                                <a class="variable" href="#Mol.natoms">natoms</a>
                        </li>
                        <li>
                                <a class="variable" href="#Mol.coords">coords</a>
                        </li>
                        <li>
                                <a class="variable" href="#Mol.coordsBohrs">coordsBohrs</a>
                        </li>
                        <li>
                                <a class="variable" href="#Mol.atomicSpecies">atomicSpecies</a>
                        </li>
                        <li>
                                <a class="variable" href="#Mol.Zcharges">Zcharges</a>
                        </li>
                        <li>
                                <a class="variable" href="#Mol.success">success</a>
                        </li>
                        <li>
                                <a class="variable" href="#Mol.label">label</a>
                        </li>
                        <li>
                                <a class="function" href="#Mol.validateAtoms">validateAtoms</a>
                        </li>
                        <li>
                                <a class="function" href="#Mol.get_center_of_charge">get_center_of_charge</a>
                        </li>
                        <li>
                                <a class="function" href="#Mol.get_nuc_dip_moment">get_nuc_dip_moment</a>
                        </li>
                        <li>
                                <a class="function" href="#Mol.get_elec_dip_moment">get_elec_dip_moment</a>
                        </li>
                        <li>
                                <a class="function" href="#Mol.get_dipole_moment">get_dipole_moment</a>
                        </li>
                        <li>
                                <a class="function" href="#Mol.exportCoords">exportCoords</a>
                        </li>
                        <li>
                                <a class="function" href="#Mol.exportXYZ">exportXYZ</a>
                        </li>
                        <li>
                                <a class="function" href="#Mol.exportXYZs">exportXYZs</a>
                        </li>
                        <li>
                                <a class="function" href="#Mol.readCoordsFile">readCoordsFile</a>
                        </li>
                        <li>
                                <a class="function" href="#Mol.readXYZ">readXYZ</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../pyfock.html">pyfock</a><wbr>.Mol    </h1>

                
                        <input id="mod-Mol-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-Mol-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="c1"># Mol.py</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="c1"># Author: Manas Sharma (manassharma07@live.com)</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="c1"># This is a part of CrysX (https://bragitoff.com/crysx)</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="c1">#</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="c1">#</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="c1">#  .d8888b.                            Y88b   d88P       8888888b.           8888888888                888      </span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="c1"># d88P  Y88b                            Y88b d88P        888   Y88b          888                       888      </span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="c1"># 888    888                             Y88o88P         888    888          888                       888      </span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="c1"># 888        888d888 888  888 .d8888b     Y888P          888   d88P 888  888 8888888  .d88b.   .d8888b 888  888 </span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="c1"># 888        888P&quot;   888  888 88K         d888b          8888888P&quot;  888  888 888     d88&quot;&quot;88b d88P&quot;    888 .88P </span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="c1"># 888    888 888     888  888 &quot;Y8888b.   d88888b  888888 888        888  888 888     888  888 888      888888K  </span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="c1"># Y88b  d88P 888     Y88b 888      X88  d88P Y88b        888        Y88b 888 888     Y88..88P Y88b.    888 &quot;88b </span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="c1">#  &quot;Y8888P&quot;  888      &quot;Y88888  88888P&#39; d88P   Y88b       888         &quot;Y88888 888      &quot;Y88P&quot;   &quot;Y8888P 888  888 </span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="c1">#                         888                                            888                                    </span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="c1">#                    Y8b d88P                                       Y8b d88P                                    </span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="c1">#                     &quot;Y88P&quot;                                         &quot;Y88P&quot;                                       </span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">Data</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">Basis</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="c1">#Class to store molecular properties</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Mol</span><span class="p">:</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">    Class to store molecular properties and handle molecular structure operations.</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">    </span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">    This class provides functionality for creating, manipulating, and exporting molecular</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    structures. It supports reading from various coordinate file formats and automatically</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">    generates basis set information.</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">    </span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">    Attributes:</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">        coordfile (str): Path to coordinate file</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">        atoms (list): List of atoms with coordinates</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">        charge (int): Molecular charge</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">        basis (Basis): Basis set object for the molecule</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">        nelectrons (int): Number of electrons</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">        natoms (int): Number of atoms</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">        coords (numpy.ndarray): Atomic coordinates in Angstroms</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">        coordsBohrs (numpy.ndarray): Atomic coordinates in Bohr units</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">        atomicSpecies (list): List of atomic symbols</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">        Zcharges (list): List of atomic numbers</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">        success (bool): Whether molecule was initialized successfully</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">        label (str): Molecular label/description</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coordfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">        Initialize a Mol object with atomic coordinates and properties.</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">        </span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">        Args:</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">            atoms (list, optional): List of atoms in the format [[symbol, x, y, z], ...] </span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">                                   where symbol can be atomic symbol (str) or atomic number (int),</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">                                   and x, y, z are coordinates in Angstroms.</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">            coordfile (str, optional): Path to coordinate file (.xyz format supported).</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">            charge (int, optional): Molecular charge. Defaults to 0.</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">            basis (dict, optional): Basis set specification. If None, defaults to STO-3G </span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">                                   for all atoms.</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">        </span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">        Raises:</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">            ValueError: If neither atoms nor coordfile is provided.</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="sd">            TypeError: If coordfile is not a string.</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">        </span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">        Note:</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">            If both atoms and coordfile are provided, atoms takes precedence and </span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">            coordfile is ignored.</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        &quot;&quot;&quot;</span> 
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>        <span class="c1">#If no atoms or coordfile is specified.</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>        <span class="k">if</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">coordfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: No atoms and their coords specified.</span><span class="se">\n</span><span class="s1">Please either specify .xyz/.mol/coord file or enter atoms manually.&#39;</span><span class="p">)</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;See manual for supported file formats.&#39;</span><span class="p">)</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>        <span class="c1">#If both atoms and coordfile are specified then atoms are considered and the coord file is not considered.</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>        <span class="k">elif</span> <span class="ow">not</span> <span class="n">coordfile</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Remark: User provided both atoms as well as the coordfile.</span><span class="se">\n</span><span class="s1">Only atoms are being used.&#39;</span><span class="p">)</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="k">elif</span> <span class="n">coordfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordfile</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>                <span class="n">atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readCoordsFile</span><span class="p">(</span><span class="n">coordfile</span><span class="p">)</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: The coordfile argument should be a string with the name of the coord file.&#39;</span><span class="p">)</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>        
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        <span class="c1">#Coord file .xyz/.mol/TURBOMOLE coord file/QE input file/Orca input file</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coordfile</span> <span class="o">=</span> <span class="n">coordfile</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;str or None: Path to the coordinate file used to initialize the molecule.</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">        Contains the filename of the original coordinate file (.xyz, .mol, TURBOMOLE coord, etc.) </span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">        if the molecule was created from a file, or None if created directly from atoms list.&quot;&quot;&quot;</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>        <span class="c1">#Atoms and their coordinates</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;list: List of atoms with their coordinates in the format [[symbol, x, y, z], ...] where:</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        - symbol: Atomic symbol (str) or atomic number (int)</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        - x, y, z: Cartesian coordinates in Angstroms (float)</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">        This is the raw input data used to construct the molecule.&quot;&quot;&quot;</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>        <span class="c1">#Molecular charge</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">charge</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;int: Net charge of the molecule in elementary charge units.</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">        Positive values indicate cationic species, negative values indicate anionic species, </span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">        and 0 indicates a neutral molecule. Used to calculate the total number of electrons.&quot;&quot;&quot;</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>        <span class="c1">#The basis object for the Mol object</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Basis or None: Basis set object containing all basis function information for quantum </span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        chemical calculations. Initialized as None and populated with a Basis instance that </span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        handles basis set assignments for each atom in the molecule.&quot;&quot;&quot;</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;int: Total number of electrons in the molecule.</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">        Calculated as the sum of all atomic numbers (nuclear charges) adjusted by the molecular charge:</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">        nelectrons = Σ(Z_i) - charge, where Z_i is the atomic number of atom i.&quot;&quot;&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;int: Total number of atoms in the molecule.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">        Incremented during atom validation and used for array dimensioning and iteration </span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">        over atomic properties.&quot;&quot;&quot;</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;numpy.ndarray: Atomic coordinates in Angstroms with shape (natoms, 3).</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        Each row contains the [x, y, z] coordinates of one atom. Initialized as empty list </span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">        and populated during atom validation to become a numpy array.&quot;&quot;&quot;</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coordsBohrs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;numpy.ndarray: Atomic coordinates converted to Bohr units with shape (natoms, 3).</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        Calculated from self.coords using the conversion factor Data.Angs2BohrFactor. </span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">        Used for quantum chemical calculations requiring atomic units of length.&quot;&quot;&quot;</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atomicSpecies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;list of str: List of atomic symbols as strings (e.g., [&#39;H&#39;, &#39;C&#39;, &#39;N&#39;, &#39;O&#39;]).</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">        Ordered the same as atoms appear in the molecule. Length equals natoms. </span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">        Used for identifying atom types and output formatting.&quot;&quot;&quot;</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;list of int: List of atomic numbers (nuclear charges) for each atom in the molecule.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">        Corresponds to the number of protons in each atomic nucleus. Used for calculating </span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a><span class="sd">        electronic properties and nuclear contributions to various molecular properties.&quot;&quot;&quot;</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;bool: Flag indicating whether the molecule was successfully initialized and validated.</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">        Set to True if all atoms have valid symbols/atomic numbers and properly formatted </span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">        coordinates, False otherwise. Used to prevent operations on invalid molecular data.&quot;&quot;&quot;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Generic mol&#39;</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;str: Descriptive label or name for the molecule.</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">        Defaults to &#39;Generic mol&#39; but can be customized. Used in output files and for </span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">        identification purposes when exporting molecular data to various file formats.&quot;&quot;&quot;</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>        <span class="c1">#Validate if the atoms attribute are provided correctly</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validateAtoms</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span><span class="o">+</span><span class="n">charge</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">coordsBohrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">*</span><span class="n">Data</span><span class="o">.</span><span class="n">Angs2BohrFactor</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>            <span class="c1">#Basis set names for the atoms.</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>            <span class="c1">#Either just one basis function can be specified for all atoms</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>            <span class="c1">#Or one can specify a particular basis set for a particular atom.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>            <span class="c1">#&#39;basis&#39; is a dictionary specifying the basis set to be used for a particular atom</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>            <span class="k">if</span> <span class="n">basis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>                <span class="c1">#Default basis set is sto-3g for all atoms</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">Basis</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">mol</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">basis_name</span><span class="o">=</span><span class="s1">&#39;sto-3g&#39;</span><span class="p">)}</span><span class="c1">#{&#39;all&#39;,&#39;sto-3g&#39;}</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">Basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">)</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">Basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validateAtoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">        Validate atomic symbols and coordinates provided in the atoms list.</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">        </span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">        This method checks that atomic symbols are valid (either as strings matching</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">        known element symbols or as integers representing atomic numbers), and that</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">        coordinates are properly formatted as numerical values.</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">        </span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">        Args:</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">            atoms (list): List of atoms in format [[symbol, x, y, z], ...] where</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a><span class="sd">                         symbol can be str (element symbol) or int (atomic number),</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">                         and x, y, z are numerical coordinates.</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">        </span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">        Returns:</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">            bool: True if all atoms are valid, False otherwise.</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">        </span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="sd">        Side Effects:</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">            Updates the following instance attributes:</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">            - atomicSpecies: List of atomic symbols</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="sd">            - Zcharges: List of atomic numbers</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="sd">            - nelectrons: Total number of electrons</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="sd">            - natoms: Number of atoms</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="sd">            - coords: Numpy array of coordinates</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="sd">        </span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="sd">        Raises:</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">            Prints error messages for invalid atomic symbols, coordinates, or formatting.</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>        <span class="c1">#Validate atomic symbols</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)):</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>                <span class="n">elementSymbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Data</span><span class="o">.</span><span class="n">elementSymbols</span><span class="p">]</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>                <span class="k">if</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">elementSymbols</span><span class="p">:</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">atomicSpecies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>                    <span class="n">Z</span> <span class="o">=</span> <span class="n">elementSymbols</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">+</span> <span class="n">Z</span> 
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Unknown atomic symbols found&#39;</span><span class="p">)</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>                <span class="k">if</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">118</span> <span class="ow">and</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">atomicSpecies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Data</span><span class="o">.</span><span class="n">elementSymbols</span><span class="p">[</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>                    <span class="n">Z</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">+</span> <span class="n">Z</span> 
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Found atomic number out of the valid range&#39;</span><span class="p">)</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Found something other than string or integer for atomic symbols/numbers&#39;</span><span class="p">)</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>        <span class="c1">#Validate atomic coords</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)):</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>                <span class="c1">#TODO: the following condition doesn&#39;t work</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>                <span class="c1">#FIXME</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>                <span class="k">if</span> <span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordi</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">coordi</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordi</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">coordi</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]):</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Coordinates of atoms should be floats/integers.&#39;</span><span class="p">)</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Illegal definition of coords in atoms. There should be all three x,y,z coordinates.</span><span class="se">\n</span><span class="s1">Some seem to be missing.&#39;</span><span class="p">)</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Some definitions of atomic symbols/coords were illegal&#39;</span><span class="p">)</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>            
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_center_of_charge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">        Calculate the center of charge (weighted by atomic numbers) of the molecule.</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="sd">        </span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="sd">        The center of charge is computed as the weighted average of atomic positions,</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a><span class="sd">        where the weights are the atomic numbers (nuclear charges) of each atom.</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="sd">        </span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">        Returns:</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">            numpy.ndarray or None: 3D coordinates of the center of charge in Angstroms.</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">                                  Returns None if the molecule was not successfully initialized.</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">        </span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">        Formula:</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">            center_of_charge = Σ(Z_i * r_i) / Σ(Z_i)</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">            where Z_i is the atomic number and r_i is the position of atom i.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Mol object is not successfully initialized.&quot;</span><span class="p">)</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>        <span class="c1"># Use NumPy for efficient calculations</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>        <span class="n">total_charge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span><span class="p">)</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>        <span class="n">coc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_charge</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>        <span class="k">return</span> <span class="n">coc</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="c1"># # Use NumPy for efficient calculations</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>        <span class="c1"># total_mass = np.sum(self.Zcharges)</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>        <span class="c1"># com_x = np.sum(self.Zcharges * self.coords[:, 0]) / total_mass</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>        <span class="c1"># com_y = np.sum(self.Zcharges * self.coords[:, 1]) / total_mass</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>        <span class="c1"># com_z = np.sum(self.Zcharges * self.coords[:, 2]) / total_mass</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>        <span class="c1"># com = np.array([com_x, com_y, com_z])</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>        <span class="c1"># return com</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>    
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_nuc_dip_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">        Calculate the nuclear contribution to the molecular dipole moment.</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">        </span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">        The nuclear dipole moment is computed as the sum of nuclear charges</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">        multiplied by their positions in atomic units (Bohr).</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">        </span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">        Returns:</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">            numpy.ndarray: 3D vector representing the nuclear dipole moment</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">                          in atomic units (e⋅a₀), where each component corresponds</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">                          to x, y, z directions.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">        </span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">        Formula:</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">            μ_nuc = Σ(Z_i * r_i)</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">            where Z_i is the nuclear charge and r_i is the position in Bohr units.</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>        <span class="n">charges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>        <span class="n">coords</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordsBohrs</span> 
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>        <span class="n">nuc_dip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ix-&gt;x&#39;</span><span class="p">,</span> <span class="n">charges</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="k">return</span> <span class="n">nuc_dip</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_elec_dip_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dipole_moment_matrix</span><span class="p">,</span> <span class="n">dmat</span><span class="p">):</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="sd">        Calculate the electronic contribution to the molecular dipole moment.</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="sd">        </span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a><span class="sd">        The electronic dipole moment is computed using the dipole moment integrals</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">        and the density matrix from quantum chemical calculations.</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">        </span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a><span class="sd">        Args:</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">            dipole_moment_matrix (numpy.ndarray): 3D array of dipole moment integrals</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">                                                 with shape (3, nbasis, nbasis), where</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">                                                 the first dimension corresponds to x, y, z.</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">            dmat (numpy.ndarray): Density matrix with shape (nbasis, nbasis).</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">        </span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="sd">        Returns:</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">            numpy.ndarray: 3D vector representing the electronic dipole moment</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">                          in atomic units (e⋅a₀), where each component corresponds</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a><span class="sd">                          to x, y, z directions.</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a><span class="sd">        </span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="sd">        Formula:</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="sd">            μ_elec = Σ_μν P_μν ⟨μ|r|ν⟩</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="sd">            where P_μν is the density matrix and ⟨μ|r|ν⟩ are dipole integrals.</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>        <span class="n">elec_dip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xij,ji-&gt;x&#39;</span><span class="p">,</span> <span class="n">dipole_moment_matrix</span><span class="p">,</span> <span class="n">dmat</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>        <span class="k">return</span> <span class="n">elec_dip</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>    
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_dipole_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dipole_moment_matrix</span><span class="p">,</span> <span class="n">dmat</span><span class="p">):</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a><span class="sd">        Calculate the total molecular dipole moment.</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a><span class="sd">        </span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="sd">        The total dipole moment is computed as the difference between nuclear</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a><span class="sd">        and electronic contributions: μ_total = μ_nuclear - μ_electronic</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a><span class="sd">        </span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a><span class="sd">        Args:</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="sd">            dipole_moment_matrix (numpy.ndarray): 3D array of dipole moment integrals</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">                                                 with shape (3, nbasis, nbasis).</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">            dmat (numpy.ndarray): Density matrix from quantum chemical calculation</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">                                 with shape (nbasis, nbasis).</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">        </span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">        Returns:</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">            numpy.ndarray: 3D vector representing the total molecular dipole moment</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">                          in atomic units (e⋅a₀). Each component corresponds to</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="sd">                          x, y, z directions.</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a><span class="sd">        </span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">        Note:</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">            The sign convention follows: μ_total = μ_nuclear - μ_electronic</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a><span class="sd">            This gives the dipole moment vector pointing from negative to positive charge.</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a><span class="sd">            </span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a><span class="sd">        TODO: Allow user to specify output units (e.g., Debye).</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>        <span class="n">nuc_dip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nuc_dip_moment</span><span class="p">()</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>        <span class="n">elec_dip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_elec_dip_moment</span><span class="p">(</span><span class="n">dipole_moment_matrix</span><span class="p">,</span> <span class="n">dmat</span><span class="p">)</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>        <span class="n">mol_dip</span> <span class="o">=</span> <span class="n">nuc_dip</span> <span class="o">-</span> <span class="n">elec_dip</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>        <span class="c1"># TODO: allow the user to specify units (ex: DEBYE)</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>        <span class="k">return</span> <span class="n">mol_dip</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>    
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>    <span class="c1">#Export coord file in TURBOMOLE format</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exportCoords</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;coord&#39;</span><span class="p">):</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a><span class="sd">        Export molecular coordinates to TURBOMOLE format.</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a><span class="sd">        </span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a><span class="sd">        Creates a coordinate file in TURBOMOLE format with atomic positions</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a><span class="sd">        converted from Angstroms to Bohr units.</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a><span class="sd">        </span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a><span class="sd">        Args:</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a><span class="sd">            atomicSpecies (list): List of atomic symbols as strings.</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a><span class="sd">            coords (numpy.ndarray): Atomic coordinates in Angstroms with shape (natoms, 3).</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a><span class="sd">            filename (str, optional): Output filename. Defaults to &#39;coord&#39;.</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a><span class="sd">        </span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="sd">        File Format:</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a><span class="sd">            $coord</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a><span class="sd">            x_bohr y_bohr z_bohr element_symbol</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a><span class="sd">            ...</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a><span class="sd">            $end</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a><span class="sd">        </span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a><span class="sd">        Note:</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a><span class="sd">            This is a static method that should be called as a class method.</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a><span class="sd">            Coordinates are automatically converted from Angstroms to Bohr units.</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a><span class="sd">        </span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a><span class="sd">        Warning:</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a><span class="sd">            This method contains a bug - it references undefined variable &#39;coord&#39;</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a><span class="sd">            instead of &#39;coords&#39;. Should be fixed in implementation.</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$coord</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">)):</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Data</span><span class="o">.</span><span class="n">Angs2BohrFactor</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Data</span><span class="o">.</span><span class="n">Angs2BohrFactor</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Data</span><span class="o">.</span><span class="n">Angs2BohrFactor</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">atomicSpecies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$end</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>    <span class="c1">#Export the geometry in XYZ format</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exportXYZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;coord&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Generic Mol generated by CrysX (Python Library)&#39;</span><span class="p">):</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">        Export molecular geometry to XYZ format file.</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">        </span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a><span class="sd">        Creates a standard XYZ format file with atomic coordinates in Angstroms.</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="sd">        This method uses the molecule&#39;s current atomic species and coordinates.</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="sd">        </span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="sd">        Args:</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">            filename (str, optional): Base filename without extension. Defaults to &#39;coord&#39;.</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">                                     The &#39;.xyz&#39; extension will be automatically added.</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">            label (str, optional): Comment line for the XYZ file. Defaults to </span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">                                  &#39;Generic Mol generated by CrysX (Python Library)&#39;.</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">        </span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">        File Format:</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">            number_of_atoms</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="sd">            comment_line</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">            element_symbol x_coord y_coord z_coord</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">            ...</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">        </span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="sd">        Output:</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">            Creates a file named &#39;{filename}.xyz&#39; in the current directory.</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="sd">        </span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a><span class="sd">        Example:</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="sd">            mol.exportXYZ(&#39;water&#39;, &#39;H2O molecule&#39;)</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">            # Creates &#39;water.xyz&#39; with H2O coordinates</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xyz&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">label</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">):</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomicSpecies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>   
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>    <span class="c1">#Export the geometry in XYZ format</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exportXYZs</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;coord&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Generic Mol generated by CrysX (Python Library)&#39;</span><span class="p">):</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">        Export molecular geometry to XYZ format (static method version).</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">        </span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">        Static method to create XYZ files from provided atomic species and coordinates,</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="sd">        without requiring a Mol object instance.</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a><span class="sd">        </span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="sd">        Args:</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a><span class="sd">            atomicSpecies (list): List of atomic symbols as strings.</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="sd">            coords (numpy.ndarray): Atomic coordinates in Angstroms with shape (natoms, 3).</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a><span class="sd">            filename (str, optional): Base filename without extension. Defaults to &#39;coord&#39;.</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="sd">                                     The &#39;.xyz&#39; extension will be automatically added.</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a><span class="sd">            label (str, optional): Comment line for the XYZ file. Defaults to </span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="sd">                                  &#39;Generic Mol generated by CrysX (Python Library)&#39;.</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a><span class="sd">        </span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="sd">        File Format:</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a><span class="sd">            number_of_atoms</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a><span class="sd">            comment_line</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a><span class="sd">            element_symbol x_coord y_coord z_coord</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a><span class="sd">            ...</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a><span class="sd">        </span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a><span class="sd">        Warning:</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a><span class="sd">            This method contains a bug - it references undefined variable &#39;coord&#39;</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a><span class="sd">            instead of &#39;coords&#39;. Should be fixed in implementation.</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a><span class="sd">        </span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a><span class="sd">        Note:</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a><span class="sd">            This is a static method and should be called as a class method.</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xyz&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">label</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">)):</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>    
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>    <span class="c1"># Read geometry from TURBOOLE coords file</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">readCoordsFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="sd">        Read molecular coordinates from various file formats.</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a><span class="sd">        </span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="sd">        Currently supports XYZ format files. This method serves as a dispatcher</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">        to format-specific reading methods based on file extension.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">        </span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">        Args:</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">            filename (str): Path to the coordinate file. File format is determined</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">                           by the file extension.</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a><span class="sd">        </span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="sd">        Returns:</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a><span class="sd">            list: List of atoms in the format [[symbol, x, y, z], ...] where</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a><span class="sd">                  symbol is the atomic symbol and x, y, z are coordinates in Angstroms.</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a><span class="sd">        </span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a><span class="sd">        Supported Formats:</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a><span class="sd">            - .xyz: Standard XYZ coordinate format</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a><span class="sd">        </span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a><span class="sd">        Future Extensions:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a><span class="sd">            - .mol: MOL file format</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a><span class="sd">            - coord: TURBOMOLE coordinate format</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a><span class="sd">            - Other quantum chemistry input formats</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a><span class="sd">        </span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a><span class="sd">        Raises:</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a><span class="sd">            Prints error message if file format is not supported.</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.xyz&#39;</span><span class="p">):</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>            <span class="n">atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readXYZ</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Only xyz files for now&#39;</span><span class="p">)</span> 
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>        <span class="k">return</span> <span class="n">atoms</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>    <span class="c1">#Read geometry information from a .xyz file</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">readXYZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a><span class="sd">        Read molecular geometry from an XYZ format file.</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a><span class="sd">        </span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="sd">        Parses a standard XYZ file and extracts atomic symbols and coordinates.</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a><span class="sd">        The XYZ format consists of:</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a><span class="sd">        - Line 1: Number of atoms</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a><span class="sd">        - Line 2: Comment line (ignored)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a><span class="sd">        - Lines 3+: atomic_symbol x_coordinate y_coordinate z_coordinate</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a><span class="sd">        </span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a><span class="sd">        Args:</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a><span class="sd">            filename (str): Path to the XYZ file to read.</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a><span class="sd">        </span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a><span class="sd">        Returns:</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a><span class="sd">            list: List of atoms in format [[symbol, x, y, z], ...] where:</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a><span class="sd">                  - symbol (str): Atomic symbol (e.g., &#39;H&#39;, &#39;C&#39;, &#39;O&#39;)</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a><span class="sd">                  - x, y, z (float): Coordinates in Angstroms</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a><span class="sd">        </span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a><span class="sd">        File Format Expected:</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a><span class="sd">            number_of_atoms</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a><span class="sd">            comment_line</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a><span class="sd">            element_symbol x_coord y_coord z_coord</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a><span class="sd">            element_symbol x_coord y_coord z_coord</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">            ...</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a><span class="sd">        </span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">        Error Handling:</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a><span class="sd">            - Prints error if the number of atoms read doesn&#39;t match the declared count</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a><span class="sd">            - Assumes coordinates are separated by whitespace</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="sd">            - Strips whitespace from all input</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">        </span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">        Example:</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">            For a file &#39;water.xyz&#39;:</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a><span class="sd">            3</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">            Water molecule</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a><span class="sd">            O    0.000000    0.000000    0.000000</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a><span class="sd">            H    0.000000    0.000000    0.970000</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a><span class="sd">            H    0.944863    0.000000   -0.242498</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a><span class="sd">            </span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a><span class="sd">            Returns: [[&#39;O&#39;, 0.0, 0.0, 0.0], [&#39;H&#39;, 0.0, 0.0, 0.97], [&#39;H&#39;, 0.944863, 0.0, -0.242498]]</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>        <span class="n">natoms</span><span class="o">=</span><span class="mi">0</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>        <span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>        <span class="n">fileContentsInString</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">fileContentsInString</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>        <span class="n">currentLineNo</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>                <span class="k">if</span> <span class="n">currentLineNo</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>                    <span class="n">natoms</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>                <span class="k">if</span> <span class="n">currentLineNo</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>                    <span class="c1">#Do nothing: Comment line</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>                    <span class="n">currentLineNo</span> <span class="o">=</span> <span class="n">currentLineNo</span> 
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>                <span class="k">if</span> <span class="n">currentLineNo</span><span class="o">&gt;=</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">currentLineNo</span><span class="o">&lt;=</span><span class="n">natoms</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>                    <span class="n">splitLine</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>                    <span class="n">atomicSpecie</span> <span class="o">=</span> <span class="n">splitLine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>                    <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">splitLine</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>                    <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">splitLine</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>                    <span class="n">z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">splitLine</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>                    <span class="n">atoms</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">atomicSpecie</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>                
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>                <span class="n">currentLineNo</span> <span class="o">=</span> <span class="n">currentLineNo</span> <span class="o">+</span> <span class="mi">1</span>   
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">natoms</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)):</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Couldnt read all the atoms&#39;</span><span class="p">)</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>        <span class="k">return</span> <span class="n">atoms</span>
</span></pre></div>


            </section>
                <section id="Mol">
                            <input id="Mol-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Mol</span>:

                <label class="view-source-button" for="Mol-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Mol"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Mol-22"><a href="#Mol-22"><span class="linenos"> 22</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Mol</span><span class="p">:</span>
</span><span id="Mol-23"><a href="#Mol-23"><span class="linenos"> 23</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol-24"><a href="#Mol-24"><span class="linenos"> 24</span></a><span class="sd">    Class to store molecular properties and handle molecular structure operations.</span>
</span><span id="Mol-25"><a href="#Mol-25"><span class="linenos"> 25</span></a><span class="sd">    </span>
</span><span id="Mol-26"><a href="#Mol-26"><span class="linenos"> 26</span></a><span class="sd">    This class provides functionality for creating, manipulating, and exporting molecular</span>
</span><span id="Mol-27"><a href="#Mol-27"><span class="linenos"> 27</span></a><span class="sd">    structures. It supports reading from various coordinate file formats and automatically</span>
</span><span id="Mol-28"><a href="#Mol-28"><span class="linenos"> 28</span></a><span class="sd">    generates basis set information.</span>
</span><span id="Mol-29"><a href="#Mol-29"><span class="linenos"> 29</span></a><span class="sd">    </span>
</span><span id="Mol-30"><a href="#Mol-30"><span class="linenos"> 30</span></a><span class="sd">    Attributes:</span>
</span><span id="Mol-31"><a href="#Mol-31"><span class="linenos"> 31</span></a><span class="sd">        coordfile (str): Path to coordinate file</span>
</span><span id="Mol-32"><a href="#Mol-32"><span class="linenos"> 32</span></a><span class="sd">        atoms (list): List of atoms with coordinates</span>
</span><span id="Mol-33"><a href="#Mol-33"><span class="linenos"> 33</span></a><span class="sd">        charge (int): Molecular charge</span>
</span><span id="Mol-34"><a href="#Mol-34"><span class="linenos"> 34</span></a><span class="sd">        basis (Basis): Basis set object for the molecule</span>
</span><span id="Mol-35"><a href="#Mol-35"><span class="linenos"> 35</span></a><span class="sd">        nelectrons (int): Number of electrons</span>
</span><span id="Mol-36"><a href="#Mol-36"><span class="linenos"> 36</span></a><span class="sd">        natoms (int): Number of atoms</span>
</span><span id="Mol-37"><a href="#Mol-37"><span class="linenos"> 37</span></a><span class="sd">        coords (numpy.ndarray): Atomic coordinates in Angstroms</span>
</span><span id="Mol-38"><a href="#Mol-38"><span class="linenos"> 38</span></a><span class="sd">        coordsBohrs (numpy.ndarray): Atomic coordinates in Bohr units</span>
</span><span id="Mol-39"><a href="#Mol-39"><span class="linenos"> 39</span></a><span class="sd">        atomicSpecies (list): List of atomic symbols</span>
</span><span id="Mol-40"><a href="#Mol-40"><span class="linenos"> 40</span></a><span class="sd">        Zcharges (list): List of atomic numbers</span>
</span><span id="Mol-41"><a href="#Mol-41"><span class="linenos"> 41</span></a><span class="sd">        success (bool): Whether molecule was initialized successfully</span>
</span><span id="Mol-42"><a href="#Mol-42"><span class="linenos"> 42</span></a><span class="sd">        label (str): Molecular label/description</span>
</span><span id="Mol-43"><a href="#Mol-43"><span class="linenos"> 43</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Mol-44"><a href="#Mol-44"><span class="linenos"> 44</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coordfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Mol-45"><a href="#Mol-45"><span class="linenos"> 45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol-46"><a href="#Mol-46"><span class="linenos"> 46</span></a><span class="sd">        Initialize a Mol object with atomic coordinates and properties.</span>
</span><span id="Mol-47"><a href="#Mol-47"><span class="linenos"> 47</span></a><span class="sd">        </span>
</span><span id="Mol-48"><a href="#Mol-48"><span class="linenos"> 48</span></a><span class="sd">        Args:</span>
</span><span id="Mol-49"><a href="#Mol-49"><span class="linenos"> 49</span></a><span class="sd">            atoms (list, optional): List of atoms in the format [[symbol, x, y, z], ...] </span>
</span><span id="Mol-50"><a href="#Mol-50"><span class="linenos"> 50</span></a><span class="sd">                                   where symbol can be atomic symbol (str) or atomic number (int),</span>
</span><span id="Mol-51"><a href="#Mol-51"><span class="linenos"> 51</span></a><span class="sd">                                   and x, y, z are coordinates in Angstroms.</span>
</span><span id="Mol-52"><a href="#Mol-52"><span class="linenos"> 52</span></a><span class="sd">            coordfile (str, optional): Path to coordinate file (.xyz format supported).</span>
</span><span id="Mol-53"><a href="#Mol-53"><span class="linenos"> 53</span></a><span class="sd">            charge (int, optional): Molecular charge. Defaults to 0.</span>
</span><span id="Mol-54"><a href="#Mol-54"><span class="linenos"> 54</span></a><span class="sd">            basis (dict, optional): Basis set specification. If None, defaults to STO-3G </span>
</span><span id="Mol-55"><a href="#Mol-55"><span class="linenos"> 55</span></a><span class="sd">                                   for all atoms.</span>
</span><span id="Mol-56"><a href="#Mol-56"><span class="linenos"> 56</span></a><span class="sd">        </span>
</span><span id="Mol-57"><a href="#Mol-57"><span class="linenos"> 57</span></a><span class="sd">        Raises:</span>
</span><span id="Mol-58"><a href="#Mol-58"><span class="linenos"> 58</span></a><span class="sd">            ValueError: If neither atoms nor coordfile is provided.</span>
</span><span id="Mol-59"><a href="#Mol-59"><span class="linenos"> 59</span></a><span class="sd">            TypeError: If coordfile is not a string.</span>
</span><span id="Mol-60"><a href="#Mol-60"><span class="linenos"> 60</span></a><span class="sd">        </span>
</span><span id="Mol-61"><a href="#Mol-61"><span class="linenos"> 61</span></a><span class="sd">        Note:</span>
</span><span id="Mol-62"><a href="#Mol-62"><span class="linenos"> 62</span></a><span class="sd">            If both atoms and coordfile are provided, atoms takes precedence and </span>
</span><span id="Mol-63"><a href="#Mol-63"><span class="linenos"> 63</span></a><span class="sd">            coordfile is ignored.</span>
</span><span id="Mol-64"><a href="#Mol-64"><span class="linenos"> 64</span></a><span class="sd">        &quot;&quot;&quot;</span> 
</span><span id="Mol-65"><a href="#Mol-65"><span class="linenos"> 65</span></a>        <span class="c1">#If no atoms or coordfile is specified.</span>
</span><span id="Mol-66"><a href="#Mol-66"><span class="linenos"> 66</span></a>        <span class="k">if</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">coordfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Mol-67"><a href="#Mol-67"><span class="linenos"> 67</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: No atoms and their coords specified.</span><span class="se">\n</span><span class="s1">Please either specify .xyz/.mol/coord file or enter atoms manually.&#39;</span><span class="p">)</span>
</span><span id="Mol-68"><a href="#Mol-68"><span class="linenos"> 68</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;See manual for supported file formats.&#39;</span><span class="p">)</span>
</span><span id="Mol-69"><a href="#Mol-69"><span class="linenos"> 69</span></a>        <span class="c1">#If both atoms and coordfile are specified then atoms are considered and the coord file is not considered.</span>
</span><span id="Mol-70"><a href="#Mol-70"><span class="linenos"> 70</span></a>        <span class="k">elif</span> <span class="ow">not</span> <span class="n">coordfile</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Mol-71"><a href="#Mol-71"><span class="linenos"> 71</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Remark: User provided both atoms as well as the coordfile.</span><span class="se">\n</span><span class="s1">Only atoms are being used.&#39;</span><span class="p">)</span>
</span><span id="Mol-72"><a href="#Mol-72"><span class="linenos"> 72</span></a>        <span class="k">elif</span> <span class="n">coordfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Mol-73"><a href="#Mol-73"><span class="linenos"> 73</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordfile</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Mol-74"><a href="#Mol-74"><span class="linenos"> 74</span></a>                <span class="n">atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readCoordsFile</span><span class="p">(</span><span class="n">coordfile</span><span class="p">)</span>
</span><span id="Mol-75"><a href="#Mol-75"><span class="linenos"> 75</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Mol-76"><a href="#Mol-76"><span class="linenos"> 76</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: The coordfile argument should be a string with the name of the coord file.&#39;</span><span class="p">)</span>
</span><span id="Mol-77"><a href="#Mol-77"><span class="linenos"> 77</span></a>
</span><span id="Mol-78"><a href="#Mol-78"><span class="linenos"> 78</span></a>        
</span><span id="Mol-79"><a href="#Mol-79"><span class="linenos"> 79</span></a>        <span class="c1">#Coord file .xyz/.mol/TURBOMOLE coord file/QE input file/Orca input file</span>
</span><span id="Mol-80"><a href="#Mol-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coordfile</span> <span class="o">=</span> <span class="n">coordfile</span>
</span><span id="Mol-81"><a href="#Mol-81"><span class="linenos"> 81</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;str or None: Path to the coordinate file used to initialize the molecule.</span>
</span><span id="Mol-82"><a href="#Mol-82"><span class="linenos"> 82</span></a><span class="sd">        Contains the filename of the original coordinate file (.xyz, .mol, TURBOMOLE coord, etc.) </span>
</span><span id="Mol-83"><a href="#Mol-83"><span class="linenos"> 83</span></a><span class="sd">        if the molecule was created from a file, or None if created directly from atoms list.&quot;&quot;&quot;</span>
</span><span id="Mol-84"><a href="#Mol-84"><span class="linenos"> 84</span></a>        <span class="c1">#Atoms and their coordinates</span>
</span><span id="Mol-85"><a href="#Mol-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span>
</span><span id="Mol-86"><a href="#Mol-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;list: List of atoms with their coordinates in the format [[symbol, x, y, z], ...] where:</span>
</span><span id="Mol-87"><a href="#Mol-87"><span class="linenos"> 87</span></a><span class="sd">        - symbol: Atomic symbol (str) or atomic number (int)</span>
</span><span id="Mol-88"><a href="#Mol-88"><span class="linenos"> 88</span></a><span class="sd">        - x, y, z: Cartesian coordinates in Angstroms (float)</span>
</span><span id="Mol-89"><a href="#Mol-89"><span class="linenos"> 89</span></a><span class="sd">        This is the raw input data used to construct the molecule.&quot;&quot;&quot;</span>
</span><span id="Mol-90"><a href="#Mol-90"><span class="linenos"> 90</span></a>        <span class="c1">#Molecular charge</span>
</span><span id="Mol-91"><a href="#Mol-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">charge</span>
</span><span id="Mol-92"><a href="#Mol-92"><span class="linenos"> 92</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;int: Net charge of the molecule in elementary charge units.</span>
</span><span id="Mol-93"><a href="#Mol-93"><span class="linenos"> 93</span></a><span class="sd">        Positive values indicate cationic species, negative values indicate anionic species, </span>
</span><span id="Mol-94"><a href="#Mol-94"><span class="linenos"> 94</span></a><span class="sd">        and 0 indicates a neutral molecule. Used to calculate the total number of electrons.&quot;&quot;&quot;</span>
</span><span id="Mol-95"><a href="#Mol-95"><span class="linenos"> 95</span></a>        <span class="c1">#The basis object for the Mol object</span>
</span><span id="Mol-96"><a href="#Mol-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Mol-97"><a href="#Mol-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Basis or None: Basis set object containing all basis function information for quantum </span>
</span><span id="Mol-98"><a href="#Mol-98"><span class="linenos"> 98</span></a><span class="sd">        chemical calculations. Initialized as None and populated with a Basis instance that </span>
</span><span id="Mol-99"><a href="#Mol-99"><span class="linenos"> 99</span></a><span class="sd">        handles basis set assignments for each atom in the molecule.&quot;&quot;&quot;</span>
</span><span id="Mol-100"><a href="#Mol-100"><span class="linenos">100</span></a>
</span><span id="Mol-101"><a href="#Mol-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Mol-102"><a href="#Mol-102"><span class="linenos">102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;int: Total number of electrons in the molecule.</span>
</span><span id="Mol-103"><a href="#Mol-103"><span class="linenos">103</span></a><span class="sd">        Calculated as the sum of all atomic numbers (nuclear charges) adjusted by the molecular charge:</span>
</span><span id="Mol-104"><a href="#Mol-104"><span class="linenos">104</span></a><span class="sd">        nelectrons = Σ(Z_i) - charge, where Z_i is the atomic number of atom i.&quot;&quot;&quot;</span>
</span><span id="Mol-105"><a href="#Mol-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Mol-106"><a href="#Mol-106"><span class="linenos">106</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;int: Total number of atoms in the molecule.</span>
</span><span id="Mol-107"><a href="#Mol-107"><span class="linenos">107</span></a><span class="sd">        Incremented during atom validation and used for array dimensioning and iteration </span>
</span><span id="Mol-108"><a href="#Mol-108"><span class="linenos">108</span></a><span class="sd">        over atomic properties.&quot;&quot;&quot;</span>
</span><span id="Mol-109"><a href="#Mol-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Mol-110"><a href="#Mol-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;numpy.ndarray: Atomic coordinates in Angstroms with shape (natoms, 3).</span>
</span><span id="Mol-111"><a href="#Mol-111"><span class="linenos">111</span></a><span class="sd">        Each row contains the [x, y, z] coordinates of one atom. Initialized as empty list </span>
</span><span id="Mol-112"><a href="#Mol-112"><span class="linenos">112</span></a><span class="sd">        and populated during atom validation to become a numpy array.&quot;&quot;&quot;</span>
</span><span id="Mol-113"><a href="#Mol-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coordsBohrs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Mol-114"><a href="#Mol-114"><span class="linenos">114</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;numpy.ndarray: Atomic coordinates converted to Bohr units with shape (natoms, 3).</span>
</span><span id="Mol-115"><a href="#Mol-115"><span class="linenos">115</span></a><span class="sd">        Calculated from self.coords using the conversion factor Data.Angs2BohrFactor. </span>
</span><span id="Mol-116"><a href="#Mol-116"><span class="linenos">116</span></a><span class="sd">        Used for quantum chemical calculations requiring atomic units of length.&quot;&quot;&quot;</span>
</span><span id="Mol-117"><a href="#Mol-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atomicSpecies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Mol-118"><a href="#Mol-118"><span class="linenos">118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;list of str: List of atomic symbols as strings (e.g., [&#39;H&#39;, &#39;C&#39;, &#39;N&#39;, &#39;O&#39;]).</span>
</span><span id="Mol-119"><a href="#Mol-119"><span class="linenos">119</span></a><span class="sd">        Ordered the same as atoms appear in the molecule. Length equals natoms. </span>
</span><span id="Mol-120"><a href="#Mol-120"><span class="linenos">120</span></a><span class="sd">        Used for identifying atom types and output formatting.&quot;&quot;&quot;</span>
</span><span id="Mol-121"><a href="#Mol-121"><span class="linenos">121</span></a>
</span><span id="Mol-122"><a href="#Mol-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Mol-123"><a href="#Mol-123"><span class="linenos">123</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;list of int: List of atomic numbers (nuclear charges) for each atom in the molecule.</span>
</span><span id="Mol-124"><a href="#Mol-124"><span class="linenos">124</span></a><span class="sd">        Corresponds to the number of protons in each atomic nucleus. Used for calculating </span>
</span><span id="Mol-125"><a href="#Mol-125"><span class="linenos">125</span></a><span class="sd">        electronic properties and nuclear contributions to various molecular properties.&quot;&quot;&quot;</span>
</span><span id="Mol-126"><a href="#Mol-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Mol-127"><a href="#Mol-127"><span class="linenos">127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;bool: Flag indicating whether the molecule was successfully initialized and validated.</span>
</span><span id="Mol-128"><a href="#Mol-128"><span class="linenos">128</span></a><span class="sd">        Set to True if all atoms have valid symbols/atomic numbers and properly formatted </span>
</span><span id="Mol-129"><a href="#Mol-129"><span class="linenos">129</span></a><span class="sd">        coordinates, False otherwise. Used to prevent operations on invalid molecular data.&quot;&quot;&quot;</span>
</span><span id="Mol-130"><a href="#Mol-130"><span class="linenos">130</span></a>
</span><span id="Mol-131"><a href="#Mol-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Generic mol&#39;</span>
</span><span id="Mol-132"><a href="#Mol-132"><span class="linenos">132</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;str: Descriptive label or name for the molecule.</span>
</span><span id="Mol-133"><a href="#Mol-133"><span class="linenos">133</span></a><span class="sd">        Defaults to &#39;Generic mol&#39; but can be customized. Used in output files and for </span>
</span><span id="Mol-134"><a href="#Mol-134"><span class="linenos">134</span></a><span class="sd">        identification purposes when exporting molecular data to various file formats.&quot;&quot;&quot;</span>
</span><span id="Mol-135"><a href="#Mol-135"><span class="linenos">135</span></a>        <span class="c1">#Validate if the atoms attribute are provided correctly</span>
</span><span id="Mol-136"><a href="#Mol-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validateAtoms</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
</span><span id="Mol-137"><a href="#Mol-137"><span class="linenos">137</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
</span><span id="Mol-138"><a href="#Mol-138"><span class="linenos">138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span><span class="o">+</span><span class="n">charge</span>
</span><span id="Mol-139"><a href="#Mol-139"><span class="linenos">139</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">coordsBohrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">*</span><span class="n">Data</span><span class="o">.</span><span class="n">Angs2BohrFactor</span>
</span><span id="Mol-140"><a href="#Mol-140"><span class="linenos">140</span></a>            <span class="c1">#Basis set names for the atoms.</span>
</span><span id="Mol-141"><a href="#Mol-141"><span class="linenos">141</span></a>            <span class="c1">#Either just one basis function can be specified for all atoms</span>
</span><span id="Mol-142"><a href="#Mol-142"><span class="linenos">142</span></a>            <span class="c1">#Or one can specify a particular basis set for a particular atom.</span>
</span><span id="Mol-143"><a href="#Mol-143"><span class="linenos">143</span></a>            <span class="c1">#&#39;basis&#39; is a dictionary specifying the basis set to be used for a particular atom</span>
</span><span id="Mol-144"><a href="#Mol-144"><span class="linenos">144</span></a>            <span class="k">if</span> <span class="n">basis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Mol-145"><a href="#Mol-145"><span class="linenos">145</span></a>                <span class="c1">#Default basis set is sto-3g for all atoms</span>
</span><span id="Mol-146"><a href="#Mol-146"><span class="linenos">146</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">Basis</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">mol</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">basis_name</span><span class="o">=</span><span class="s1">&#39;sto-3g&#39;</span><span class="p">)}</span><span class="c1">#{&#39;all&#39;,&#39;sto-3g&#39;}</span>
</span><span id="Mol-147"><a href="#Mol-147"><span class="linenos">147</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">Basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">)</span>
</span><span id="Mol-148"><a href="#Mol-148"><span class="linenos">148</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Mol-149"><a href="#Mol-149"><span class="linenos">149</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">Basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</span><span id="Mol-150"><a href="#Mol-150"><span class="linenos">150</span></a>        
</span><span id="Mol-151"><a href="#Mol-151"><span class="linenos">151</span></a>
</span><span id="Mol-152"><a href="#Mol-152"><span class="linenos">152</span></a>        
</span><span id="Mol-153"><a href="#Mol-153"><span class="linenos">153</span></a>        
</span><span id="Mol-154"><a href="#Mol-154"><span class="linenos">154</span></a>
</span><span id="Mol-155"><a href="#Mol-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validateAtoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
</span><span id="Mol-156"><a href="#Mol-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol-157"><a href="#Mol-157"><span class="linenos">157</span></a><span class="sd">        Validate atomic symbols and coordinates provided in the atoms list.</span>
</span><span id="Mol-158"><a href="#Mol-158"><span class="linenos">158</span></a><span class="sd">        </span>
</span><span id="Mol-159"><a href="#Mol-159"><span class="linenos">159</span></a><span class="sd">        This method checks that atomic symbols are valid (either as strings matching</span>
</span><span id="Mol-160"><a href="#Mol-160"><span class="linenos">160</span></a><span class="sd">        known element symbols or as integers representing atomic numbers), and that</span>
</span><span id="Mol-161"><a href="#Mol-161"><span class="linenos">161</span></a><span class="sd">        coordinates are properly formatted as numerical values.</span>
</span><span id="Mol-162"><a href="#Mol-162"><span class="linenos">162</span></a><span class="sd">        </span>
</span><span id="Mol-163"><a href="#Mol-163"><span class="linenos">163</span></a><span class="sd">        Args:</span>
</span><span id="Mol-164"><a href="#Mol-164"><span class="linenos">164</span></a><span class="sd">            atoms (list): List of atoms in format [[symbol, x, y, z], ...] where</span>
</span><span id="Mol-165"><a href="#Mol-165"><span class="linenos">165</span></a><span class="sd">                         symbol can be str (element symbol) or int (atomic number),</span>
</span><span id="Mol-166"><a href="#Mol-166"><span class="linenos">166</span></a><span class="sd">                         and x, y, z are numerical coordinates.</span>
</span><span id="Mol-167"><a href="#Mol-167"><span class="linenos">167</span></a><span class="sd">        </span>
</span><span id="Mol-168"><a href="#Mol-168"><span class="linenos">168</span></a><span class="sd">        Returns:</span>
</span><span id="Mol-169"><a href="#Mol-169"><span class="linenos">169</span></a><span class="sd">            bool: True if all atoms are valid, False otherwise.</span>
</span><span id="Mol-170"><a href="#Mol-170"><span class="linenos">170</span></a><span class="sd">        </span>
</span><span id="Mol-171"><a href="#Mol-171"><span class="linenos">171</span></a><span class="sd">        Side Effects:</span>
</span><span id="Mol-172"><a href="#Mol-172"><span class="linenos">172</span></a><span class="sd">            Updates the following instance attributes:</span>
</span><span id="Mol-173"><a href="#Mol-173"><span class="linenos">173</span></a><span class="sd">            - atomicSpecies: List of atomic symbols</span>
</span><span id="Mol-174"><a href="#Mol-174"><span class="linenos">174</span></a><span class="sd">            - Zcharges: List of atomic numbers</span>
</span><span id="Mol-175"><a href="#Mol-175"><span class="linenos">175</span></a><span class="sd">            - nelectrons: Total number of electrons</span>
</span><span id="Mol-176"><a href="#Mol-176"><span class="linenos">176</span></a><span class="sd">            - natoms: Number of atoms</span>
</span><span id="Mol-177"><a href="#Mol-177"><span class="linenos">177</span></a><span class="sd">            - coords: Numpy array of coordinates</span>
</span><span id="Mol-178"><a href="#Mol-178"><span class="linenos">178</span></a><span class="sd">        </span>
</span><span id="Mol-179"><a href="#Mol-179"><span class="linenos">179</span></a><span class="sd">        Raises:</span>
</span><span id="Mol-180"><a href="#Mol-180"><span class="linenos">180</span></a><span class="sd">            Prints error messages for invalid atomic symbols, coordinates, or formatting.</span>
</span><span id="Mol-181"><a href="#Mol-181"><span class="linenos">181</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol-182"><a href="#Mol-182"><span class="linenos">182</span></a>        <span class="c1">#Validate atomic symbols</span>
</span><span id="Mol-183"><a href="#Mol-183"><span class="linenos">183</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)):</span>
</span><span id="Mol-184"><a href="#Mol-184"><span class="linenos">184</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Mol-185"><a href="#Mol-185"><span class="linenos">185</span></a>                <span class="n">elementSymbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Data</span><span class="o">.</span><span class="n">elementSymbols</span><span class="p">]</span>
</span><span id="Mol-186"><a href="#Mol-186"><span class="linenos">186</span></a>                <span class="k">if</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">elementSymbols</span><span class="p">:</span>
</span><span id="Mol-187"><a href="#Mol-187"><span class="linenos">187</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">atomicSpecies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Mol-188"><a href="#Mol-188"><span class="linenos">188</span></a>                    <span class="n">Z</span> <span class="o">=</span> <span class="n">elementSymbols</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="Mol-189"><a href="#Mol-189"><span class="linenos">189</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</span><span id="Mol-190"><a href="#Mol-190"><span class="linenos">190</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">+</span> <span class="n">Z</span> 
</span><span id="Mol-191"><a href="#Mol-191"><span class="linenos">191</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Mol-192"><a href="#Mol-192"><span class="linenos">192</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Mol-193"><a href="#Mol-193"><span class="linenos">193</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Unknown atomic symbols found&#39;</span><span class="p">)</span>
</span><span id="Mol-194"><a href="#Mol-194"><span class="linenos">194</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="Mol-195"><a href="#Mol-195"><span class="linenos">195</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Mol-196"><a href="#Mol-196"><span class="linenos">196</span></a>                <span class="k">if</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">118</span> <span class="ow">and</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
</span><span id="Mol-197"><a href="#Mol-197"><span class="linenos">197</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">atomicSpecies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Data</span><span class="o">.</span><span class="n">elementSymbols</span><span class="p">[</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
</span><span id="Mol-198"><a href="#Mol-198"><span class="linenos">198</span></a>                    <span class="n">Z</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Mol-199"><a href="#Mol-199"><span class="linenos">199</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</span><span id="Mol-200"><a href="#Mol-200"><span class="linenos">200</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">+</span> <span class="n">Z</span> 
</span><span id="Mol-201"><a href="#Mol-201"><span class="linenos">201</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Mol-202"><a href="#Mol-202"><span class="linenos">202</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Mol-203"><a href="#Mol-203"><span class="linenos">203</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Found atomic number out of the valid range&#39;</span><span class="p">)</span>
</span><span id="Mol-204"><a href="#Mol-204"><span class="linenos">204</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="Mol-205"><a href="#Mol-205"><span class="linenos">205</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Mol-206"><a href="#Mol-206"><span class="linenos">206</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Found something other than string or integer for atomic symbols/numbers&#39;</span><span class="p">)</span>
</span><span id="Mol-207"><a href="#Mol-207"><span class="linenos">207</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="Mol-208"><a href="#Mol-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</span><span id="Mol-209"><a href="#Mol-209"><span class="linenos">209</span></a>        <span class="c1">#Validate atomic coords</span>
</span><span id="Mol-210"><a href="#Mol-210"><span class="linenos">210</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)):</span>
</span><span id="Mol-211"><a href="#Mol-211"><span class="linenos">211</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
</span><span id="Mol-212"><a href="#Mol-212"><span class="linenos">212</span></a>                <span class="c1">#TODO: the following condition doesn&#39;t work</span>
</span><span id="Mol-213"><a href="#Mol-213"><span class="linenos">213</span></a>                <span class="c1">#FIXME</span>
</span><span id="Mol-214"><a href="#Mol-214"><span class="linenos">214</span></a>                <span class="k">if</span> <span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordi</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">coordi</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordi</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">coordi</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]):</span>
</span><span id="Mol-215"><a href="#Mol-215"><span class="linenos">215</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Mol-216"><a href="#Mol-216"><span class="linenos">216</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Mol-217"><a href="#Mol-217"><span class="linenos">217</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Coordinates of atoms should be floats/integers.&#39;</span><span class="p">)</span>
</span><span id="Mol-218"><a href="#Mol-218"><span class="linenos">218</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="Mol-219"><a href="#Mol-219"><span class="linenos">219</span></a>
</span><span id="Mol-220"><a href="#Mol-220"><span class="linenos">220</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Mol-221"><a href="#Mol-221"><span class="linenos">221</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Illegal definition of coords in atoms. There should be all three x,y,z coordinates.</span><span class="se">\n</span><span class="s1">Some seem to be missing.&#39;</span><span class="p">)</span>
</span><span id="Mol-222"><a href="#Mol-222"><span class="linenos">222</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="Mol-223"><a href="#Mol-223"><span class="linenos">223</span></a>        
</span><span id="Mol-224"><a href="#Mol-224"><span class="linenos">224</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="Mol-225"><a href="#Mol-225"><span class="linenos">225</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Mol-226"><a href="#Mol-226"><span class="linenos">226</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Mol-227"><a href="#Mol-227"><span class="linenos">227</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Some definitions of atomic symbols/coords were illegal&#39;</span><span class="p">)</span>
</span><span id="Mol-228"><a href="#Mol-228"><span class="linenos">228</span></a>            
</span><span id="Mol-229"><a href="#Mol-229"><span class="linenos">229</span></a>
</span><span id="Mol-230"><a href="#Mol-230"><span class="linenos">230</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_center_of_charge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Mol-231"><a href="#Mol-231"><span class="linenos">231</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol-232"><a href="#Mol-232"><span class="linenos">232</span></a><span class="sd">        Calculate the center of charge (weighted by atomic numbers) of the molecule.</span>
</span><span id="Mol-233"><a href="#Mol-233"><span class="linenos">233</span></a><span class="sd">        </span>
</span><span id="Mol-234"><a href="#Mol-234"><span class="linenos">234</span></a><span class="sd">        The center of charge is computed as the weighted average of atomic positions,</span>
</span><span id="Mol-235"><a href="#Mol-235"><span class="linenos">235</span></a><span class="sd">        where the weights are the atomic numbers (nuclear charges) of each atom.</span>
</span><span id="Mol-236"><a href="#Mol-236"><span class="linenos">236</span></a><span class="sd">        </span>
</span><span id="Mol-237"><a href="#Mol-237"><span class="linenos">237</span></a><span class="sd">        Returns:</span>
</span><span id="Mol-238"><a href="#Mol-238"><span class="linenos">238</span></a><span class="sd">            numpy.ndarray or None: 3D coordinates of the center of charge in Angstroms.</span>
</span><span id="Mol-239"><a href="#Mol-239"><span class="linenos">239</span></a><span class="sd">                                  Returns None if the molecule was not successfully initialized.</span>
</span><span id="Mol-240"><a href="#Mol-240"><span class="linenos">240</span></a><span class="sd">        </span>
</span><span id="Mol-241"><a href="#Mol-241"><span class="linenos">241</span></a><span class="sd">        Formula:</span>
</span><span id="Mol-242"><a href="#Mol-242"><span class="linenos">242</span></a><span class="sd">            center_of_charge = Σ(Z_i * r_i) / Σ(Z_i)</span>
</span><span id="Mol-243"><a href="#Mol-243"><span class="linenos">243</span></a><span class="sd">            where Z_i is the atomic number and r_i is the position of atom i.</span>
</span><span id="Mol-244"><a href="#Mol-244"><span class="linenos">244</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol-245"><a href="#Mol-245"><span class="linenos">245</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
</span><span id="Mol-246"><a href="#Mol-246"><span class="linenos">246</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Mol object is not successfully initialized.&quot;</span><span class="p">)</span>
</span><span id="Mol-247"><a href="#Mol-247"><span class="linenos">247</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Mol-248"><a href="#Mol-248"><span class="linenos">248</span></a>
</span><span id="Mol-249"><a href="#Mol-249"><span class="linenos">249</span></a>        <span class="c1"># Use NumPy for efficient calculations</span>
</span><span id="Mol-250"><a href="#Mol-250"><span class="linenos">250</span></a>        <span class="n">total_charge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span><span class="p">)</span>
</span><span id="Mol-251"><a href="#Mol-251"><span class="linenos">251</span></a>        <span class="n">coc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_charge</span>
</span><span id="Mol-252"><a href="#Mol-252"><span class="linenos">252</span></a>
</span><span id="Mol-253"><a href="#Mol-253"><span class="linenos">253</span></a>        <span class="k">return</span> <span class="n">coc</span>
</span><span id="Mol-254"><a href="#Mol-254"><span class="linenos">254</span></a>        <span class="c1"># # Use NumPy for efficient calculations</span>
</span><span id="Mol-255"><a href="#Mol-255"><span class="linenos">255</span></a>        <span class="c1"># total_mass = np.sum(self.Zcharges)</span>
</span><span id="Mol-256"><a href="#Mol-256"><span class="linenos">256</span></a>        <span class="c1"># com_x = np.sum(self.Zcharges * self.coords[:, 0]) / total_mass</span>
</span><span id="Mol-257"><a href="#Mol-257"><span class="linenos">257</span></a>        <span class="c1"># com_y = np.sum(self.Zcharges * self.coords[:, 1]) / total_mass</span>
</span><span id="Mol-258"><a href="#Mol-258"><span class="linenos">258</span></a>        <span class="c1"># com_z = np.sum(self.Zcharges * self.coords[:, 2]) / total_mass</span>
</span><span id="Mol-259"><a href="#Mol-259"><span class="linenos">259</span></a>
</span><span id="Mol-260"><a href="#Mol-260"><span class="linenos">260</span></a>        <span class="c1"># com = np.array([com_x, com_y, com_z])</span>
</span><span id="Mol-261"><a href="#Mol-261"><span class="linenos">261</span></a>        <span class="c1"># return com</span>
</span><span id="Mol-262"><a href="#Mol-262"><span class="linenos">262</span></a>    
</span><span id="Mol-263"><a href="#Mol-263"><span class="linenos">263</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_nuc_dip_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Mol-264"><a href="#Mol-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol-265"><a href="#Mol-265"><span class="linenos">265</span></a><span class="sd">        Calculate the nuclear contribution to the molecular dipole moment.</span>
</span><span id="Mol-266"><a href="#Mol-266"><span class="linenos">266</span></a><span class="sd">        </span>
</span><span id="Mol-267"><a href="#Mol-267"><span class="linenos">267</span></a><span class="sd">        The nuclear dipole moment is computed as the sum of nuclear charges</span>
</span><span id="Mol-268"><a href="#Mol-268"><span class="linenos">268</span></a><span class="sd">        multiplied by their positions in atomic units (Bohr).</span>
</span><span id="Mol-269"><a href="#Mol-269"><span class="linenos">269</span></a><span class="sd">        </span>
</span><span id="Mol-270"><a href="#Mol-270"><span class="linenos">270</span></a><span class="sd">        Returns:</span>
</span><span id="Mol-271"><a href="#Mol-271"><span class="linenos">271</span></a><span class="sd">            numpy.ndarray: 3D vector representing the nuclear dipole moment</span>
</span><span id="Mol-272"><a href="#Mol-272"><span class="linenos">272</span></a><span class="sd">                          in atomic units (e⋅a₀), where each component corresponds</span>
</span><span id="Mol-273"><a href="#Mol-273"><span class="linenos">273</span></a><span class="sd">                          to x, y, z directions.</span>
</span><span id="Mol-274"><a href="#Mol-274"><span class="linenos">274</span></a><span class="sd">        </span>
</span><span id="Mol-275"><a href="#Mol-275"><span class="linenos">275</span></a><span class="sd">        Formula:</span>
</span><span id="Mol-276"><a href="#Mol-276"><span class="linenos">276</span></a><span class="sd">            μ_nuc = Σ(Z_i * r_i)</span>
</span><span id="Mol-277"><a href="#Mol-277"><span class="linenos">277</span></a><span class="sd">            where Z_i is the nuclear charge and r_i is the position in Bohr units.</span>
</span><span id="Mol-278"><a href="#Mol-278"><span class="linenos">278</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol-279"><a href="#Mol-279"><span class="linenos">279</span></a>        <span class="n">charges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span>
</span><span id="Mol-280"><a href="#Mol-280"><span class="linenos">280</span></a>        <span class="n">coords</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordsBohrs</span> 
</span><span id="Mol-281"><a href="#Mol-281"><span class="linenos">281</span></a>        <span class="n">nuc_dip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ix-&gt;x&#39;</span><span class="p">,</span> <span class="n">charges</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
</span><span id="Mol-282"><a href="#Mol-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="n">nuc_dip</span>
</span><span id="Mol-283"><a href="#Mol-283"><span class="linenos">283</span></a>
</span><span id="Mol-284"><a href="#Mol-284"><span class="linenos">284</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_elec_dip_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dipole_moment_matrix</span><span class="p">,</span> <span class="n">dmat</span><span class="p">):</span>
</span><span id="Mol-285"><a href="#Mol-285"><span class="linenos">285</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol-286"><a href="#Mol-286"><span class="linenos">286</span></a><span class="sd">        Calculate the electronic contribution to the molecular dipole moment.</span>
</span><span id="Mol-287"><a href="#Mol-287"><span class="linenos">287</span></a><span class="sd">        </span>
</span><span id="Mol-288"><a href="#Mol-288"><span class="linenos">288</span></a><span class="sd">        The electronic dipole moment is computed using the dipole moment integrals</span>
</span><span id="Mol-289"><a href="#Mol-289"><span class="linenos">289</span></a><span class="sd">        and the density matrix from quantum chemical calculations.</span>
</span><span id="Mol-290"><a href="#Mol-290"><span class="linenos">290</span></a><span class="sd">        </span>
</span><span id="Mol-291"><a href="#Mol-291"><span class="linenos">291</span></a><span class="sd">        Args:</span>
</span><span id="Mol-292"><a href="#Mol-292"><span class="linenos">292</span></a><span class="sd">            dipole_moment_matrix (numpy.ndarray): 3D array of dipole moment integrals</span>
</span><span id="Mol-293"><a href="#Mol-293"><span class="linenos">293</span></a><span class="sd">                                                 with shape (3, nbasis, nbasis), where</span>
</span><span id="Mol-294"><a href="#Mol-294"><span class="linenos">294</span></a><span class="sd">                                                 the first dimension corresponds to x, y, z.</span>
</span><span id="Mol-295"><a href="#Mol-295"><span class="linenos">295</span></a><span class="sd">            dmat (numpy.ndarray): Density matrix with shape (nbasis, nbasis).</span>
</span><span id="Mol-296"><a href="#Mol-296"><span class="linenos">296</span></a><span class="sd">        </span>
</span><span id="Mol-297"><a href="#Mol-297"><span class="linenos">297</span></a><span class="sd">        Returns:</span>
</span><span id="Mol-298"><a href="#Mol-298"><span class="linenos">298</span></a><span class="sd">            numpy.ndarray: 3D vector representing the electronic dipole moment</span>
</span><span id="Mol-299"><a href="#Mol-299"><span class="linenos">299</span></a><span class="sd">                          in atomic units (e⋅a₀), where each component corresponds</span>
</span><span id="Mol-300"><a href="#Mol-300"><span class="linenos">300</span></a><span class="sd">                          to x, y, z directions.</span>
</span><span id="Mol-301"><a href="#Mol-301"><span class="linenos">301</span></a><span class="sd">        </span>
</span><span id="Mol-302"><a href="#Mol-302"><span class="linenos">302</span></a><span class="sd">        Formula:</span>
</span><span id="Mol-303"><a href="#Mol-303"><span class="linenos">303</span></a><span class="sd">            μ_elec = Σ_μν P_μν ⟨μ|r|ν⟩</span>
</span><span id="Mol-304"><a href="#Mol-304"><span class="linenos">304</span></a><span class="sd">            where P_μν is the density matrix and ⟨μ|r|ν⟩ are dipole integrals.</span>
</span><span id="Mol-305"><a href="#Mol-305"><span class="linenos">305</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol-306"><a href="#Mol-306"><span class="linenos">306</span></a>        <span class="n">elec_dip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xij,ji-&gt;x&#39;</span><span class="p">,</span> <span class="n">dipole_moment_matrix</span><span class="p">,</span> <span class="n">dmat</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
</span><span id="Mol-307"><a href="#Mol-307"><span class="linenos">307</span></a>        <span class="k">return</span> <span class="n">elec_dip</span>
</span><span id="Mol-308"><a href="#Mol-308"><span class="linenos">308</span></a>    
</span><span id="Mol-309"><a href="#Mol-309"><span class="linenos">309</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_dipole_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dipole_moment_matrix</span><span class="p">,</span> <span class="n">dmat</span><span class="p">):</span>
</span><span id="Mol-310"><a href="#Mol-310"><span class="linenos">310</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol-311"><a href="#Mol-311"><span class="linenos">311</span></a><span class="sd">        Calculate the total molecular dipole moment.</span>
</span><span id="Mol-312"><a href="#Mol-312"><span class="linenos">312</span></a><span class="sd">        </span>
</span><span id="Mol-313"><a href="#Mol-313"><span class="linenos">313</span></a><span class="sd">        The total dipole moment is computed as the difference between nuclear</span>
</span><span id="Mol-314"><a href="#Mol-314"><span class="linenos">314</span></a><span class="sd">        and electronic contributions: μ_total = μ_nuclear - μ_electronic</span>
</span><span id="Mol-315"><a href="#Mol-315"><span class="linenos">315</span></a><span class="sd">        </span>
</span><span id="Mol-316"><a href="#Mol-316"><span class="linenos">316</span></a><span class="sd">        Args:</span>
</span><span id="Mol-317"><a href="#Mol-317"><span class="linenos">317</span></a><span class="sd">            dipole_moment_matrix (numpy.ndarray): 3D array of dipole moment integrals</span>
</span><span id="Mol-318"><a href="#Mol-318"><span class="linenos">318</span></a><span class="sd">                                                 with shape (3, nbasis, nbasis).</span>
</span><span id="Mol-319"><a href="#Mol-319"><span class="linenos">319</span></a><span class="sd">            dmat (numpy.ndarray): Density matrix from quantum chemical calculation</span>
</span><span id="Mol-320"><a href="#Mol-320"><span class="linenos">320</span></a><span class="sd">                                 with shape (nbasis, nbasis).</span>
</span><span id="Mol-321"><a href="#Mol-321"><span class="linenos">321</span></a><span class="sd">        </span>
</span><span id="Mol-322"><a href="#Mol-322"><span class="linenos">322</span></a><span class="sd">        Returns:</span>
</span><span id="Mol-323"><a href="#Mol-323"><span class="linenos">323</span></a><span class="sd">            numpy.ndarray: 3D vector representing the total molecular dipole moment</span>
</span><span id="Mol-324"><a href="#Mol-324"><span class="linenos">324</span></a><span class="sd">                          in atomic units (e⋅a₀). Each component corresponds to</span>
</span><span id="Mol-325"><a href="#Mol-325"><span class="linenos">325</span></a><span class="sd">                          x, y, z directions.</span>
</span><span id="Mol-326"><a href="#Mol-326"><span class="linenos">326</span></a><span class="sd">        </span>
</span><span id="Mol-327"><a href="#Mol-327"><span class="linenos">327</span></a><span class="sd">        Note:</span>
</span><span id="Mol-328"><a href="#Mol-328"><span class="linenos">328</span></a><span class="sd">            The sign convention follows: μ_total = μ_nuclear - μ_electronic</span>
</span><span id="Mol-329"><a href="#Mol-329"><span class="linenos">329</span></a><span class="sd">            This gives the dipole moment vector pointing from negative to positive charge.</span>
</span><span id="Mol-330"><a href="#Mol-330"><span class="linenos">330</span></a><span class="sd">            </span>
</span><span id="Mol-331"><a href="#Mol-331"><span class="linenos">331</span></a><span class="sd">        TODO: Allow user to specify output units (e.g., Debye).</span>
</span><span id="Mol-332"><a href="#Mol-332"><span class="linenos">332</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol-333"><a href="#Mol-333"><span class="linenos">333</span></a>        <span class="n">nuc_dip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nuc_dip_moment</span><span class="p">()</span>
</span><span id="Mol-334"><a href="#Mol-334"><span class="linenos">334</span></a>        <span class="n">elec_dip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_elec_dip_moment</span><span class="p">(</span><span class="n">dipole_moment_matrix</span><span class="p">,</span> <span class="n">dmat</span><span class="p">)</span>
</span><span id="Mol-335"><a href="#Mol-335"><span class="linenos">335</span></a>        <span class="n">mol_dip</span> <span class="o">=</span> <span class="n">nuc_dip</span> <span class="o">-</span> <span class="n">elec_dip</span>
</span><span id="Mol-336"><a href="#Mol-336"><span class="linenos">336</span></a>        <span class="c1"># TODO: allow the user to specify units (ex: DEBYE)</span>
</span><span id="Mol-337"><a href="#Mol-337"><span class="linenos">337</span></a>        <span class="k">return</span> <span class="n">mol_dip</span>
</span><span id="Mol-338"><a href="#Mol-338"><span class="linenos">338</span></a>    
</span><span id="Mol-339"><a href="#Mol-339"><span class="linenos">339</span></a>    <span class="c1">#Export coord file in TURBOMOLE format</span>
</span><span id="Mol-340"><a href="#Mol-340"><span class="linenos">340</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exportCoords</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;coord&#39;</span><span class="p">):</span>
</span><span id="Mol-341"><a href="#Mol-341"><span class="linenos">341</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol-342"><a href="#Mol-342"><span class="linenos">342</span></a><span class="sd">        Export molecular coordinates to TURBOMOLE format.</span>
</span><span id="Mol-343"><a href="#Mol-343"><span class="linenos">343</span></a><span class="sd">        </span>
</span><span id="Mol-344"><a href="#Mol-344"><span class="linenos">344</span></a><span class="sd">        Creates a coordinate file in TURBOMOLE format with atomic positions</span>
</span><span id="Mol-345"><a href="#Mol-345"><span class="linenos">345</span></a><span class="sd">        converted from Angstroms to Bohr units.</span>
</span><span id="Mol-346"><a href="#Mol-346"><span class="linenos">346</span></a><span class="sd">        </span>
</span><span id="Mol-347"><a href="#Mol-347"><span class="linenos">347</span></a><span class="sd">        Args:</span>
</span><span id="Mol-348"><a href="#Mol-348"><span class="linenos">348</span></a><span class="sd">            atomicSpecies (list): List of atomic symbols as strings.</span>
</span><span id="Mol-349"><a href="#Mol-349"><span class="linenos">349</span></a><span class="sd">            coords (numpy.ndarray): Atomic coordinates in Angstroms with shape (natoms, 3).</span>
</span><span id="Mol-350"><a href="#Mol-350"><span class="linenos">350</span></a><span class="sd">            filename (str, optional): Output filename. Defaults to &#39;coord&#39;.</span>
</span><span id="Mol-351"><a href="#Mol-351"><span class="linenos">351</span></a><span class="sd">        </span>
</span><span id="Mol-352"><a href="#Mol-352"><span class="linenos">352</span></a><span class="sd">        File Format:</span>
</span><span id="Mol-353"><a href="#Mol-353"><span class="linenos">353</span></a><span class="sd">            $coord</span>
</span><span id="Mol-354"><a href="#Mol-354"><span class="linenos">354</span></a><span class="sd">            x_bohr y_bohr z_bohr element_symbol</span>
</span><span id="Mol-355"><a href="#Mol-355"><span class="linenos">355</span></a><span class="sd">            ...</span>
</span><span id="Mol-356"><a href="#Mol-356"><span class="linenos">356</span></a><span class="sd">            $end</span>
</span><span id="Mol-357"><a href="#Mol-357"><span class="linenos">357</span></a><span class="sd">        </span>
</span><span id="Mol-358"><a href="#Mol-358"><span class="linenos">358</span></a><span class="sd">        Note:</span>
</span><span id="Mol-359"><a href="#Mol-359"><span class="linenos">359</span></a><span class="sd">            This is a static method that should be called as a class method.</span>
</span><span id="Mol-360"><a href="#Mol-360"><span class="linenos">360</span></a><span class="sd">            Coordinates are automatically converted from Angstroms to Bohr units.</span>
</span><span id="Mol-361"><a href="#Mol-361"><span class="linenos">361</span></a><span class="sd">        </span>
</span><span id="Mol-362"><a href="#Mol-362"><span class="linenos">362</span></a><span class="sd">        Warning:</span>
</span><span id="Mol-363"><a href="#Mol-363"><span class="linenos">363</span></a><span class="sd">            This method contains a bug - it references undefined variable &#39;coord&#39;</span>
</span><span id="Mol-364"><a href="#Mol-364"><span class="linenos">364</span></a><span class="sd">            instead of &#39;coords&#39;. Should be fixed in implementation.</span>
</span><span id="Mol-365"><a href="#Mol-365"><span class="linenos">365</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol-366"><a href="#Mol-366"><span class="linenos">366</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="Mol-367"><a href="#Mol-367"><span class="linenos">367</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$coord</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol-368"><a href="#Mol-368"><span class="linenos">368</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">)):</span>
</span><span id="Mol-369"><a href="#Mol-369"><span class="linenos">369</span></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Data</span><span class="o">.</span><span class="n">Angs2BohrFactor</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Data</span><span class="o">.</span><span class="n">Angs2BohrFactor</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Data</span><span class="o">.</span><span class="n">Angs2BohrFactor</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">atomicSpecies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol-370"><a href="#Mol-370"><span class="linenos">370</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$end</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol-371"><a href="#Mol-371"><span class="linenos">371</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Mol-372"><a href="#Mol-372"><span class="linenos">372</span></a>
</span><span id="Mol-373"><a href="#Mol-373"><span class="linenos">373</span></a>    <span class="c1">#Export the geometry in XYZ format</span>
</span><span id="Mol-374"><a href="#Mol-374"><span class="linenos">374</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exportXYZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;coord&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Generic Mol generated by CrysX (Python Library)&#39;</span><span class="p">):</span>
</span><span id="Mol-375"><a href="#Mol-375"><span class="linenos">375</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol-376"><a href="#Mol-376"><span class="linenos">376</span></a><span class="sd">        Export molecular geometry to XYZ format file.</span>
</span><span id="Mol-377"><a href="#Mol-377"><span class="linenos">377</span></a><span class="sd">        </span>
</span><span id="Mol-378"><a href="#Mol-378"><span class="linenos">378</span></a><span class="sd">        Creates a standard XYZ format file with atomic coordinates in Angstroms.</span>
</span><span id="Mol-379"><a href="#Mol-379"><span class="linenos">379</span></a><span class="sd">        This method uses the molecule&#39;s current atomic species and coordinates.</span>
</span><span id="Mol-380"><a href="#Mol-380"><span class="linenos">380</span></a><span class="sd">        </span>
</span><span id="Mol-381"><a href="#Mol-381"><span class="linenos">381</span></a><span class="sd">        Args:</span>
</span><span id="Mol-382"><a href="#Mol-382"><span class="linenos">382</span></a><span class="sd">            filename (str, optional): Base filename without extension. Defaults to &#39;coord&#39;.</span>
</span><span id="Mol-383"><a href="#Mol-383"><span class="linenos">383</span></a><span class="sd">                                     The &#39;.xyz&#39; extension will be automatically added.</span>
</span><span id="Mol-384"><a href="#Mol-384"><span class="linenos">384</span></a><span class="sd">            label (str, optional): Comment line for the XYZ file. Defaults to </span>
</span><span id="Mol-385"><a href="#Mol-385"><span class="linenos">385</span></a><span class="sd">                                  &#39;Generic Mol generated by CrysX (Python Library)&#39;.</span>
</span><span id="Mol-386"><a href="#Mol-386"><span class="linenos">386</span></a><span class="sd">        </span>
</span><span id="Mol-387"><a href="#Mol-387"><span class="linenos">387</span></a><span class="sd">        File Format:</span>
</span><span id="Mol-388"><a href="#Mol-388"><span class="linenos">388</span></a><span class="sd">            number_of_atoms</span>
</span><span id="Mol-389"><a href="#Mol-389"><span class="linenos">389</span></a><span class="sd">            comment_line</span>
</span><span id="Mol-390"><a href="#Mol-390"><span class="linenos">390</span></a><span class="sd">            element_symbol x_coord y_coord z_coord</span>
</span><span id="Mol-391"><a href="#Mol-391"><span class="linenos">391</span></a><span class="sd">            ...</span>
</span><span id="Mol-392"><a href="#Mol-392"><span class="linenos">392</span></a><span class="sd">        </span>
</span><span id="Mol-393"><a href="#Mol-393"><span class="linenos">393</span></a><span class="sd">        Output:</span>
</span><span id="Mol-394"><a href="#Mol-394"><span class="linenos">394</span></a><span class="sd">            Creates a file named &#39;{filename}.xyz&#39; in the current directory.</span>
</span><span id="Mol-395"><a href="#Mol-395"><span class="linenos">395</span></a><span class="sd">        </span>
</span><span id="Mol-396"><a href="#Mol-396"><span class="linenos">396</span></a><span class="sd">        Example:</span>
</span><span id="Mol-397"><a href="#Mol-397"><span class="linenos">397</span></a><span class="sd">            mol.exportXYZ(&#39;water&#39;, &#39;H2O molecule&#39;)</span>
</span><span id="Mol-398"><a href="#Mol-398"><span class="linenos">398</span></a><span class="sd">            # Creates &#39;water.xyz&#39; with H2O coordinates</span>
</span><span id="Mol-399"><a href="#Mol-399"><span class="linenos">399</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol-400"><a href="#Mol-400"><span class="linenos">400</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xyz&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="Mol-401"><a href="#Mol-401"><span class="linenos">401</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol-402"><a href="#Mol-402"><span class="linenos">402</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">label</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol-403"><a href="#Mol-403"><span class="linenos">403</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">):</span>
</span><span id="Mol-404"><a href="#Mol-404"><span class="linenos">404</span></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomicSpecies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol-405"><a href="#Mol-405"><span class="linenos">405</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>   
</span><span id="Mol-406"><a href="#Mol-406"><span class="linenos">406</span></a>    <span class="c1">#Export the geometry in XYZ format</span>
</span><span id="Mol-407"><a href="#Mol-407"><span class="linenos">407</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exportXYZs</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;coord&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Generic Mol generated by CrysX (Python Library)&#39;</span><span class="p">):</span>
</span><span id="Mol-408"><a href="#Mol-408"><span class="linenos">408</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol-409"><a href="#Mol-409"><span class="linenos">409</span></a><span class="sd">        Export molecular geometry to XYZ format (static method version).</span>
</span><span id="Mol-410"><a href="#Mol-410"><span class="linenos">410</span></a><span class="sd">        </span>
</span><span id="Mol-411"><a href="#Mol-411"><span class="linenos">411</span></a><span class="sd">        Static method to create XYZ files from provided atomic species and coordinates,</span>
</span><span id="Mol-412"><a href="#Mol-412"><span class="linenos">412</span></a><span class="sd">        without requiring a Mol object instance.</span>
</span><span id="Mol-413"><a href="#Mol-413"><span class="linenos">413</span></a><span class="sd">        </span>
</span><span id="Mol-414"><a href="#Mol-414"><span class="linenos">414</span></a><span class="sd">        Args:</span>
</span><span id="Mol-415"><a href="#Mol-415"><span class="linenos">415</span></a><span class="sd">            atomicSpecies (list): List of atomic symbols as strings.</span>
</span><span id="Mol-416"><a href="#Mol-416"><span class="linenos">416</span></a><span class="sd">            coords (numpy.ndarray): Atomic coordinates in Angstroms with shape (natoms, 3).</span>
</span><span id="Mol-417"><a href="#Mol-417"><span class="linenos">417</span></a><span class="sd">            filename (str, optional): Base filename without extension. Defaults to &#39;coord&#39;.</span>
</span><span id="Mol-418"><a href="#Mol-418"><span class="linenos">418</span></a><span class="sd">                                     The &#39;.xyz&#39; extension will be automatically added.</span>
</span><span id="Mol-419"><a href="#Mol-419"><span class="linenos">419</span></a><span class="sd">            label (str, optional): Comment line for the XYZ file. Defaults to </span>
</span><span id="Mol-420"><a href="#Mol-420"><span class="linenos">420</span></a><span class="sd">                                  &#39;Generic Mol generated by CrysX (Python Library)&#39;.</span>
</span><span id="Mol-421"><a href="#Mol-421"><span class="linenos">421</span></a><span class="sd">        </span>
</span><span id="Mol-422"><a href="#Mol-422"><span class="linenos">422</span></a><span class="sd">        File Format:</span>
</span><span id="Mol-423"><a href="#Mol-423"><span class="linenos">423</span></a><span class="sd">            number_of_atoms</span>
</span><span id="Mol-424"><a href="#Mol-424"><span class="linenos">424</span></a><span class="sd">            comment_line</span>
</span><span id="Mol-425"><a href="#Mol-425"><span class="linenos">425</span></a><span class="sd">            element_symbol x_coord y_coord z_coord</span>
</span><span id="Mol-426"><a href="#Mol-426"><span class="linenos">426</span></a><span class="sd">            ...</span>
</span><span id="Mol-427"><a href="#Mol-427"><span class="linenos">427</span></a><span class="sd">        </span>
</span><span id="Mol-428"><a href="#Mol-428"><span class="linenos">428</span></a><span class="sd">        Warning:</span>
</span><span id="Mol-429"><a href="#Mol-429"><span class="linenos">429</span></a><span class="sd">            This method contains a bug - it references undefined variable &#39;coord&#39;</span>
</span><span id="Mol-430"><a href="#Mol-430"><span class="linenos">430</span></a><span class="sd">            instead of &#39;coords&#39;. Should be fixed in implementation.</span>
</span><span id="Mol-431"><a href="#Mol-431"><span class="linenos">431</span></a><span class="sd">        </span>
</span><span id="Mol-432"><a href="#Mol-432"><span class="linenos">432</span></a><span class="sd">        Note:</span>
</span><span id="Mol-433"><a href="#Mol-433"><span class="linenos">433</span></a><span class="sd">            This is a static method and should be called as a class method.</span>
</span><span id="Mol-434"><a href="#Mol-434"><span class="linenos">434</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol-435"><a href="#Mol-435"><span class="linenos">435</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xyz&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="Mol-436"><a href="#Mol-436"><span class="linenos">436</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol-437"><a href="#Mol-437"><span class="linenos">437</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">label</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol-438"><a href="#Mol-438"><span class="linenos">438</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">)):</span>
</span><span id="Mol-439"><a href="#Mol-439"><span class="linenos">439</span></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol-440"><a href="#Mol-440"><span class="linenos">440</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Mol-441"><a href="#Mol-441"><span class="linenos">441</span></a>    
</span><span id="Mol-442"><a href="#Mol-442"><span class="linenos">442</span></a>    <span class="c1"># Read geometry from TURBOOLE coords file</span>
</span><span id="Mol-443"><a href="#Mol-443"><span class="linenos">443</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">readCoordsFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="Mol-444"><a href="#Mol-444"><span class="linenos">444</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol-445"><a href="#Mol-445"><span class="linenos">445</span></a><span class="sd">        Read molecular coordinates from various file formats.</span>
</span><span id="Mol-446"><a href="#Mol-446"><span class="linenos">446</span></a><span class="sd">        </span>
</span><span id="Mol-447"><a href="#Mol-447"><span class="linenos">447</span></a><span class="sd">        Currently supports XYZ format files. This method serves as a dispatcher</span>
</span><span id="Mol-448"><a href="#Mol-448"><span class="linenos">448</span></a><span class="sd">        to format-specific reading methods based on file extension.</span>
</span><span id="Mol-449"><a href="#Mol-449"><span class="linenos">449</span></a><span class="sd">        </span>
</span><span id="Mol-450"><a href="#Mol-450"><span class="linenos">450</span></a><span class="sd">        Args:</span>
</span><span id="Mol-451"><a href="#Mol-451"><span class="linenos">451</span></a><span class="sd">            filename (str): Path to the coordinate file. File format is determined</span>
</span><span id="Mol-452"><a href="#Mol-452"><span class="linenos">452</span></a><span class="sd">                           by the file extension.</span>
</span><span id="Mol-453"><a href="#Mol-453"><span class="linenos">453</span></a><span class="sd">        </span>
</span><span id="Mol-454"><a href="#Mol-454"><span class="linenos">454</span></a><span class="sd">        Returns:</span>
</span><span id="Mol-455"><a href="#Mol-455"><span class="linenos">455</span></a><span class="sd">            list: List of atoms in the format [[symbol, x, y, z], ...] where</span>
</span><span id="Mol-456"><a href="#Mol-456"><span class="linenos">456</span></a><span class="sd">                  symbol is the atomic symbol and x, y, z are coordinates in Angstroms.</span>
</span><span id="Mol-457"><a href="#Mol-457"><span class="linenos">457</span></a><span class="sd">        </span>
</span><span id="Mol-458"><a href="#Mol-458"><span class="linenos">458</span></a><span class="sd">        Supported Formats:</span>
</span><span id="Mol-459"><a href="#Mol-459"><span class="linenos">459</span></a><span class="sd">            - .xyz: Standard XYZ coordinate format</span>
</span><span id="Mol-460"><a href="#Mol-460"><span class="linenos">460</span></a><span class="sd">        </span>
</span><span id="Mol-461"><a href="#Mol-461"><span class="linenos">461</span></a><span class="sd">        Future Extensions:</span>
</span><span id="Mol-462"><a href="#Mol-462"><span class="linenos">462</span></a><span class="sd">            - .mol: MOL file format</span>
</span><span id="Mol-463"><a href="#Mol-463"><span class="linenos">463</span></a><span class="sd">            - coord: TURBOMOLE coordinate format</span>
</span><span id="Mol-464"><a href="#Mol-464"><span class="linenos">464</span></a><span class="sd">            - Other quantum chemistry input formats</span>
</span><span id="Mol-465"><a href="#Mol-465"><span class="linenos">465</span></a><span class="sd">        </span>
</span><span id="Mol-466"><a href="#Mol-466"><span class="linenos">466</span></a><span class="sd">        Raises:</span>
</span><span id="Mol-467"><a href="#Mol-467"><span class="linenos">467</span></a><span class="sd">            Prints error message if file format is not supported.</span>
</span><span id="Mol-468"><a href="#Mol-468"><span class="linenos">468</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol-469"><a href="#Mol-469"><span class="linenos">469</span></a>        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.xyz&#39;</span><span class="p">):</span>
</span><span id="Mol-470"><a href="#Mol-470"><span class="linenos">470</span></a>            <span class="n">atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readXYZ</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="Mol-471"><a href="#Mol-471"><span class="linenos">471</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Mol-472"><a href="#Mol-472"><span class="linenos">472</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Only xyz files for now&#39;</span><span class="p">)</span> 
</span><span id="Mol-473"><a href="#Mol-473"><span class="linenos">473</span></a>        <span class="k">return</span> <span class="n">atoms</span>
</span><span id="Mol-474"><a href="#Mol-474"><span class="linenos">474</span></a>    <span class="c1">#Read geometry information from a .xyz file</span>
</span><span id="Mol-475"><a href="#Mol-475"><span class="linenos">475</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">readXYZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="Mol-476"><a href="#Mol-476"><span class="linenos">476</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol-477"><a href="#Mol-477"><span class="linenos">477</span></a><span class="sd">        Read molecular geometry from an XYZ format file.</span>
</span><span id="Mol-478"><a href="#Mol-478"><span class="linenos">478</span></a><span class="sd">        </span>
</span><span id="Mol-479"><a href="#Mol-479"><span class="linenos">479</span></a><span class="sd">        Parses a standard XYZ file and extracts atomic symbols and coordinates.</span>
</span><span id="Mol-480"><a href="#Mol-480"><span class="linenos">480</span></a><span class="sd">        The XYZ format consists of:</span>
</span><span id="Mol-481"><a href="#Mol-481"><span class="linenos">481</span></a><span class="sd">        - Line 1: Number of atoms</span>
</span><span id="Mol-482"><a href="#Mol-482"><span class="linenos">482</span></a><span class="sd">        - Line 2: Comment line (ignored)</span>
</span><span id="Mol-483"><a href="#Mol-483"><span class="linenos">483</span></a><span class="sd">        - Lines 3+: atomic_symbol x_coordinate y_coordinate z_coordinate</span>
</span><span id="Mol-484"><a href="#Mol-484"><span class="linenos">484</span></a><span class="sd">        </span>
</span><span id="Mol-485"><a href="#Mol-485"><span class="linenos">485</span></a><span class="sd">        Args:</span>
</span><span id="Mol-486"><a href="#Mol-486"><span class="linenos">486</span></a><span class="sd">            filename (str): Path to the XYZ file to read.</span>
</span><span id="Mol-487"><a href="#Mol-487"><span class="linenos">487</span></a><span class="sd">        </span>
</span><span id="Mol-488"><a href="#Mol-488"><span class="linenos">488</span></a><span class="sd">        Returns:</span>
</span><span id="Mol-489"><a href="#Mol-489"><span class="linenos">489</span></a><span class="sd">            list: List of atoms in format [[symbol, x, y, z], ...] where:</span>
</span><span id="Mol-490"><a href="#Mol-490"><span class="linenos">490</span></a><span class="sd">                  - symbol (str): Atomic symbol (e.g., &#39;H&#39;, &#39;C&#39;, &#39;O&#39;)</span>
</span><span id="Mol-491"><a href="#Mol-491"><span class="linenos">491</span></a><span class="sd">                  - x, y, z (float): Coordinates in Angstroms</span>
</span><span id="Mol-492"><a href="#Mol-492"><span class="linenos">492</span></a><span class="sd">        </span>
</span><span id="Mol-493"><a href="#Mol-493"><span class="linenos">493</span></a><span class="sd">        File Format Expected:</span>
</span><span id="Mol-494"><a href="#Mol-494"><span class="linenos">494</span></a><span class="sd">            number_of_atoms</span>
</span><span id="Mol-495"><a href="#Mol-495"><span class="linenos">495</span></a><span class="sd">            comment_line</span>
</span><span id="Mol-496"><a href="#Mol-496"><span class="linenos">496</span></a><span class="sd">            element_symbol x_coord y_coord z_coord</span>
</span><span id="Mol-497"><a href="#Mol-497"><span class="linenos">497</span></a><span class="sd">            element_symbol x_coord y_coord z_coord</span>
</span><span id="Mol-498"><a href="#Mol-498"><span class="linenos">498</span></a><span class="sd">            ...</span>
</span><span id="Mol-499"><a href="#Mol-499"><span class="linenos">499</span></a><span class="sd">        </span>
</span><span id="Mol-500"><a href="#Mol-500"><span class="linenos">500</span></a><span class="sd">        Error Handling:</span>
</span><span id="Mol-501"><a href="#Mol-501"><span class="linenos">501</span></a><span class="sd">            - Prints error if the number of atoms read doesn&#39;t match the declared count</span>
</span><span id="Mol-502"><a href="#Mol-502"><span class="linenos">502</span></a><span class="sd">            - Assumes coordinates are separated by whitespace</span>
</span><span id="Mol-503"><a href="#Mol-503"><span class="linenos">503</span></a><span class="sd">            - Strips whitespace from all input</span>
</span><span id="Mol-504"><a href="#Mol-504"><span class="linenos">504</span></a><span class="sd">        </span>
</span><span id="Mol-505"><a href="#Mol-505"><span class="linenos">505</span></a><span class="sd">        Example:</span>
</span><span id="Mol-506"><a href="#Mol-506"><span class="linenos">506</span></a><span class="sd">            For a file &#39;water.xyz&#39;:</span>
</span><span id="Mol-507"><a href="#Mol-507"><span class="linenos">507</span></a><span class="sd">            3</span>
</span><span id="Mol-508"><a href="#Mol-508"><span class="linenos">508</span></a><span class="sd">            Water molecule</span>
</span><span id="Mol-509"><a href="#Mol-509"><span class="linenos">509</span></a><span class="sd">            O    0.000000    0.000000    0.000000</span>
</span><span id="Mol-510"><a href="#Mol-510"><span class="linenos">510</span></a><span class="sd">            H    0.000000    0.000000    0.970000</span>
</span><span id="Mol-511"><a href="#Mol-511"><span class="linenos">511</span></a><span class="sd">            H    0.944863    0.000000   -0.242498</span>
</span><span id="Mol-512"><a href="#Mol-512"><span class="linenos">512</span></a><span class="sd">            </span>
</span><span id="Mol-513"><a href="#Mol-513"><span class="linenos">513</span></a><span class="sd">            Returns: [[&#39;O&#39;, 0.0, 0.0, 0.0], [&#39;H&#39;, 0.0, 0.0, 0.97], [&#39;H&#39;, 0.944863, 0.0, -0.242498]]</span>
</span><span id="Mol-514"><a href="#Mol-514"><span class="linenos">514</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol-515"><a href="#Mol-515"><span class="linenos">515</span></a>        <span class="n">natoms</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Mol-516"><a href="#Mol-516"><span class="linenos">516</span></a>        <span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Mol-517"><a href="#Mol-517"><span class="linenos">517</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="Mol-518"><a href="#Mol-518"><span class="linenos">518</span></a>        <span class="n">fileContentsInString</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="Mol-519"><a href="#Mol-519"><span class="linenos">519</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">fileContentsInString</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="Mol-520"><a href="#Mol-520"><span class="linenos">520</span></a>        <span class="n">currentLineNo</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Mol-521"><a href="#Mol-521"><span class="linenos">521</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="Mol-522"><a href="#Mol-522"><span class="linenos">522</span></a>            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="Mol-523"><a href="#Mol-523"><span class="linenos">523</span></a>            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
</span><span id="Mol-524"><a href="#Mol-524"><span class="linenos">524</span></a>                <span class="k">if</span> <span class="n">currentLineNo</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span><span id="Mol-525"><a href="#Mol-525"><span class="linenos">525</span></a>                    <span class="n">natoms</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="Mol-526"><a href="#Mol-526"><span class="linenos">526</span></a>                <span class="k">if</span> <span class="n">currentLineNo</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
</span><span id="Mol-527"><a href="#Mol-527"><span class="linenos">527</span></a>                    <span class="c1">#Do nothing: Comment line</span>
</span><span id="Mol-528"><a href="#Mol-528"><span class="linenos">528</span></a>                    <span class="n">currentLineNo</span> <span class="o">=</span> <span class="n">currentLineNo</span> 
</span><span id="Mol-529"><a href="#Mol-529"><span class="linenos">529</span></a>                <span class="k">if</span> <span class="n">currentLineNo</span><span class="o">&gt;=</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">currentLineNo</span><span class="o">&lt;=</span><span class="n">natoms</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span>
</span><span id="Mol-530"><a href="#Mol-530"><span class="linenos">530</span></a>                    <span class="n">splitLine</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="Mol-531"><a href="#Mol-531"><span class="linenos">531</span></a>                    <span class="n">atomicSpecie</span> <span class="o">=</span> <span class="n">splitLine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="Mol-532"><a href="#Mol-532"><span class="linenos">532</span></a>                    <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">splitLine</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="Mol-533"><a href="#Mol-533"><span class="linenos">533</span></a>                    <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">splitLine</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="Mol-534"><a href="#Mol-534"><span class="linenos">534</span></a>                    <span class="n">z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">splitLine</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="Mol-535"><a href="#Mol-535"><span class="linenos">535</span></a>                    <span class="n">atoms</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">atomicSpecie</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span>
</span><span id="Mol-536"><a href="#Mol-536"><span class="linenos">536</span></a>                
</span><span id="Mol-537"><a href="#Mol-537"><span class="linenos">537</span></a>                <span class="n">currentLineNo</span> <span class="o">=</span> <span class="n">currentLineNo</span> <span class="o">+</span> <span class="mi">1</span>   
</span><span id="Mol-538"><a href="#Mol-538"><span class="linenos">538</span></a>        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">natoms</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)):</span>
</span><span id="Mol-539"><a href="#Mol-539"><span class="linenos">539</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Couldnt read all the atoms&#39;</span><span class="p">)</span>
</span><span id="Mol-540"><a href="#Mol-540"><span class="linenos">540</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Mol-541"><a href="#Mol-541"><span class="linenos">541</span></a>
</span><span id="Mol-542"><a href="#Mol-542"><span class="linenos">542</span></a>        <span class="k">return</span> <span class="n">atoms</span>
</span></pre></div>


            <div class="docstring"><p>Class to store molecular properties and handle molecular structure operations.</p>

<p>This class provides functionality for creating, manipulating, and exporting molecular
structures. It supports reading from various coordinate file formats and automatically
generates basis set information.</p>

<p>Attributes:
    coordfile (str): Path to coordinate file
    atoms (list): List of atoms with coordinates
    charge (int): Molecular charge
    basis (Basis): Basis set object for the molecule
    nelectrons (int): Number of electrons
    natoms (int): Number of atoms
    coords (numpy.ndarray): Atomic coordinates in Angstroms
    coordsBohrs (numpy.ndarray): Atomic coordinates in Bohr units
    atomicSpecies (list): List of atomic symbols
    Zcharges (list): List of atomic numbers
    success (bool): Whether molecule was initialized successfully
    label (str): Molecular label/description</p>
</div>


                            <div id="Mol.__init__" class="classattr">
                                        <input id="Mol.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Mol</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">atoms</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">coordfile</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">charge</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="n">basis</span><span class="o">=</span><span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Mol.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Mol.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Mol.__init__-44"><a href="#Mol.__init__-44"><span class="linenos"> 44</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">coordfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Mol.__init__-45"><a href="#Mol.__init__-45"><span class="linenos"> 45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol.__init__-46"><a href="#Mol.__init__-46"><span class="linenos"> 46</span></a><span class="sd">        Initialize a Mol object with atomic coordinates and properties.</span>
</span><span id="Mol.__init__-47"><a href="#Mol.__init__-47"><span class="linenos"> 47</span></a><span class="sd">        </span>
</span><span id="Mol.__init__-48"><a href="#Mol.__init__-48"><span class="linenos"> 48</span></a><span class="sd">        Args:</span>
</span><span id="Mol.__init__-49"><a href="#Mol.__init__-49"><span class="linenos"> 49</span></a><span class="sd">            atoms (list, optional): List of atoms in the format [[symbol, x, y, z], ...] </span>
</span><span id="Mol.__init__-50"><a href="#Mol.__init__-50"><span class="linenos"> 50</span></a><span class="sd">                                   where symbol can be atomic symbol (str) or atomic number (int),</span>
</span><span id="Mol.__init__-51"><a href="#Mol.__init__-51"><span class="linenos"> 51</span></a><span class="sd">                                   and x, y, z are coordinates in Angstroms.</span>
</span><span id="Mol.__init__-52"><a href="#Mol.__init__-52"><span class="linenos"> 52</span></a><span class="sd">            coordfile (str, optional): Path to coordinate file (.xyz format supported).</span>
</span><span id="Mol.__init__-53"><a href="#Mol.__init__-53"><span class="linenos"> 53</span></a><span class="sd">            charge (int, optional): Molecular charge. Defaults to 0.</span>
</span><span id="Mol.__init__-54"><a href="#Mol.__init__-54"><span class="linenos"> 54</span></a><span class="sd">            basis (dict, optional): Basis set specification. If None, defaults to STO-3G </span>
</span><span id="Mol.__init__-55"><a href="#Mol.__init__-55"><span class="linenos"> 55</span></a><span class="sd">                                   for all atoms.</span>
</span><span id="Mol.__init__-56"><a href="#Mol.__init__-56"><span class="linenos"> 56</span></a><span class="sd">        </span>
</span><span id="Mol.__init__-57"><a href="#Mol.__init__-57"><span class="linenos"> 57</span></a><span class="sd">        Raises:</span>
</span><span id="Mol.__init__-58"><a href="#Mol.__init__-58"><span class="linenos"> 58</span></a><span class="sd">            ValueError: If neither atoms nor coordfile is provided.</span>
</span><span id="Mol.__init__-59"><a href="#Mol.__init__-59"><span class="linenos"> 59</span></a><span class="sd">            TypeError: If coordfile is not a string.</span>
</span><span id="Mol.__init__-60"><a href="#Mol.__init__-60"><span class="linenos"> 60</span></a><span class="sd">        </span>
</span><span id="Mol.__init__-61"><a href="#Mol.__init__-61"><span class="linenos"> 61</span></a><span class="sd">        Note:</span>
</span><span id="Mol.__init__-62"><a href="#Mol.__init__-62"><span class="linenos"> 62</span></a><span class="sd">            If both atoms and coordfile are provided, atoms takes precedence and </span>
</span><span id="Mol.__init__-63"><a href="#Mol.__init__-63"><span class="linenos"> 63</span></a><span class="sd">            coordfile is ignored.</span>
</span><span id="Mol.__init__-64"><a href="#Mol.__init__-64"><span class="linenos"> 64</span></a><span class="sd">        &quot;&quot;&quot;</span> 
</span><span id="Mol.__init__-65"><a href="#Mol.__init__-65"><span class="linenos"> 65</span></a>        <span class="c1">#If no atoms or coordfile is specified.</span>
</span><span id="Mol.__init__-66"><a href="#Mol.__init__-66"><span class="linenos"> 66</span></a>        <span class="k">if</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">coordfile</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Mol.__init__-67"><a href="#Mol.__init__-67"><span class="linenos"> 67</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: No atoms and their coords specified.</span><span class="se">\n</span><span class="s1">Please either specify .xyz/.mol/coord file or enter atoms manually.&#39;</span><span class="p">)</span>
</span><span id="Mol.__init__-68"><a href="#Mol.__init__-68"><span class="linenos"> 68</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;See manual for supported file formats.&#39;</span><span class="p">)</span>
</span><span id="Mol.__init__-69"><a href="#Mol.__init__-69"><span class="linenos"> 69</span></a>        <span class="c1">#If both atoms and coordfile are specified then atoms are considered and the coord file is not considered.</span>
</span><span id="Mol.__init__-70"><a href="#Mol.__init__-70"><span class="linenos"> 70</span></a>        <span class="k">elif</span> <span class="ow">not</span> <span class="n">coordfile</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Mol.__init__-71"><a href="#Mol.__init__-71"><span class="linenos"> 71</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Remark: User provided both atoms as well as the coordfile.</span><span class="se">\n</span><span class="s1">Only atoms are being used.&#39;</span><span class="p">)</span>
</span><span id="Mol.__init__-72"><a href="#Mol.__init__-72"><span class="linenos"> 72</span></a>        <span class="k">elif</span> <span class="n">coordfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Mol.__init__-73"><a href="#Mol.__init__-73"><span class="linenos"> 73</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordfile</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Mol.__init__-74"><a href="#Mol.__init__-74"><span class="linenos"> 74</span></a>                <span class="n">atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readCoordsFile</span><span class="p">(</span><span class="n">coordfile</span><span class="p">)</span>
</span><span id="Mol.__init__-75"><a href="#Mol.__init__-75"><span class="linenos"> 75</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Mol.__init__-76"><a href="#Mol.__init__-76"><span class="linenos"> 76</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: The coordfile argument should be a string with the name of the coord file.&#39;</span><span class="p">)</span>
</span><span id="Mol.__init__-77"><a href="#Mol.__init__-77"><span class="linenos"> 77</span></a>
</span><span id="Mol.__init__-78"><a href="#Mol.__init__-78"><span class="linenos"> 78</span></a>        
</span><span id="Mol.__init__-79"><a href="#Mol.__init__-79"><span class="linenos"> 79</span></a>        <span class="c1">#Coord file .xyz/.mol/TURBOMOLE coord file/QE input file/Orca input file</span>
</span><span id="Mol.__init__-80"><a href="#Mol.__init__-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coordfile</span> <span class="o">=</span> <span class="n">coordfile</span>
</span><span id="Mol.__init__-81"><a href="#Mol.__init__-81"><span class="linenos"> 81</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;str or None: Path to the coordinate file used to initialize the molecule.</span>
</span><span id="Mol.__init__-82"><a href="#Mol.__init__-82"><span class="linenos"> 82</span></a><span class="sd">        Contains the filename of the original coordinate file (.xyz, .mol, TURBOMOLE coord, etc.) </span>
</span><span id="Mol.__init__-83"><a href="#Mol.__init__-83"><span class="linenos"> 83</span></a><span class="sd">        if the molecule was created from a file, or None if created directly from atoms list.&quot;&quot;&quot;</span>
</span><span id="Mol.__init__-84"><a href="#Mol.__init__-84"><span class="linenos"> 84</span></a>        <span class="c1">#Atoms and their coordinates</span>
</span><span id="Mol.__init__-85"><a href="#Mol.__init__-85"><span class="linenos"> 85</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="o">=</span> <span class="n">atoms</span>
</span><span id="Mol.__init__-86"><a href="#Mol.__init__-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;list: List of atoms with their coordinates in the format [[symbol, x, y, z], ...] where:</span>
</span><span id="Mol.__init__-87"><a href="#Mol.__init__-87"><span class="linenos"> 87</span></a><span class="sd">        - symbol: Atomic symbol (str) or atomic number (int)</span>
</span><span id="Mol.__init__-88"><a href="#Mol.__init__-88"><span class="linenos"> 88</span></a><span class="sd">        - x, y, z: Cartesian coordinates in Angstroms (float)</span>
</span><span id="Mol.__init__-89"><a href="#Mol.__init__-89"><span class="linenos"> 89</span></a><span class="sd">        This is the raw input data used to construct the molecule.&quot;&quot;&quot;</span>
</span><span id="Mol.__init__-90"><a href="#Mol.__init__-90"><span class="linenos"> 90</span></a>        <span class="c1">#Molecular charge</span>
</span><span id="Mol.__init__-91"><a href="#Mol.__init__-91"><span class="linenos"> 91</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">charge</span>
</span><span id="Mol.__init__-92"><a href="#Mol.__init__-92"><span class="linenos"> 92</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;int: Net charge of the molecule in elementary charge units.</span>
</span><span id="Mol.__init__-93"><a href="#Mol.__init__-93"><span class="linenos"> 93</span></a><span class="sd">        Positive values indicate cationic species, negative values indicate anionic species, </span>
</span><span id="Mol.__init__-94"><a href="#Mol.__init__-94"><span class="linenos"> 94</span></a><span class="sd">        and 0 indicates a neutral molecule. Used to calculate the total number of electrons.&quot;&quot;&quot;</span>
</span><span id="Mol.__init__-95"><a href="#Mol.__init__-95"><span class="linenos"> 95</span></a>        <span class="c1">#The basis object for the Mol object</span>
</span><span id="Mol.__init__-96"><a href="#Mol.__init__-96"><span class="linenos"> 96</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Mol.__init__-97"><a href="#Mol.__init__-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Basis or None: Basis set object containing all basis function information for quantum </span>
</span><span id="Mol.__init__-98"><a href="#Mol.__init__-98"><span class="linenos"> 98</span></a><span class="sd">        chemical calculations. Initialized as None and populated with a Basis instance that </span>
</span><span id="Mol.__init__-99"><a href="#Mol.__init__-99"><span class="linenos"> 99</span></a><span class="sd">        handles basis set assignments for each atom in the molecule.&quot;&quot;&quot;</span>
</span><span id="Mol.__init__-100"><a href="#Mol.__init__-100"><span class="linenos">100</span></a>
</span><span id="Mol.__init__-101"><a href="#Mol.__init__-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Mol.__init__-102"><a href="#Mol.__init__-102"><span class="linenos">102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;int: Total number of electrons in the molecule.</span>
</span><span id="Mol.__init__-103"><a href="#Mol.__init__-103"><span class="linenos">103</span></a><span class="sd">        Calculated as the sum of all atomic numbers (nuclear charges) adjusted by the molecular charge:</span>
</span><span id="Mol.__init__-104"><a href="#Mol.__init__-104"><span class="linenos">104</span></a><span class="sd">        nelectrons = Σ(Z_i) - charge, where Z_i is the atomic number of atom i.&quot;&quot;&quot;</span>
</span><span id="Mol.__init__-105"><a href="#Mol.__init__-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Mol.__init__-106"><a href="#Mol.__init__-106"><span class="linenos">106</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;int: Total number of atoms in the molecule.</span>
</span><span id="Mol.__init__-107"><a href="#Mol.__init__-107"><span class="linenos">107</span></a><span class="sd">        Incremented during atom validation and used for array dimensioning and iteration </span>
</span><span id="Mol.__init__-108"><a href="#Mol.__init__-108"><span class="linenos">108</span></a><span class="sd">        over atomic properties.&quot;&quot;&quot;</span>
</span><span id="Mol.__init__-109"><a href="#Mol.__init__-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Mol.__init__-110"><a href="#Mol.__init__-110"><span class="linenos">110</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;numpy.ndarray: Atomic coordinates in Angstroms with shape (natoms, 3).</span>
</span><span id="Mol.__init__-111"><a href="#Mol.__init__-111"><span class="linenos">111</span></a><span class="sd">        Each row contains the [x, y, z] coordinates of one atom. Initialized as empty list </span>
</span><span id="Mol.__init__-112"><a href="#Mol.__init__-112"><span class="linenos">112</span></a><span class="sd">        and populated during atom validation to become a numpy array.&quot;&quot;&quot;</span>
</span><span id="Mol.__init__-113"><a href="#Mol.__init__-113"><span class="linenos">113</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coordsBohrs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Mol.__init__-114"><a href="#Mol.__init__-114"><span class="linenos">114</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;numpy.ndarray: Atomic coordinates converted to Bohr units with shape (natoms, 3).</span>
</span><span id="Mol.__init__-115"><a href="#Mol.__init__-115"><span class="linenos">115</span></a><span class="sd">        Calculated from self.coords using the conversion factor Data.Angs2BohrFactor. </span>
</span><span id="Mol.__init__-116"><a href="#Mol.__init__-116"><span class="linenos">116</span></a><span class="sd">        Used for quantum chemical calculations requiring atomic units of length.&quot;&quot;&quot;</span>
</span><span id="Mol.__init__-117"><a href="#Mol.__init__-117"><span class="linenos">117</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">atomicSpecies</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Mol.__init__-118"><a href="#Mol.__init__-118"><span class="linenos">118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;list of str: List of atomic symbols as strings (e.g., [&#39;H&#39;, &#39;C&#39;, &#39;N&#39;, &#39;O&#39;]).</span>
</span><span id="Mol.__init__-119"><a href="#Mol.__init__-119"><span class="linenos">119</span></a><span class="sd">        Ordered the same as atoms appear in the molecule. Length equals natoms. </span>
</span><span id="Mol.__init__-120"><a href="#Mol.__init__-120"><span class="linenos">120</span></a><span class="sd">        Used for identifying atom types and output formatting.&quot;&quot;&quot;</span>
</span><span id="Mol.__init__-121"><a href="#Mol.__init__-121"><span class="linenos">121</span></a>
</span><span id="Mol.__init__-122"><a href="#Mol.__init__-122"><span class="linenos">122</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Mol.__init__-123"><a href="#Mol.__init__-123"><span class="linenos">123</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;list of int: List of atomic numbers (nuclear charges) for each atom in the molecule.</span>
</span><span id="Mol.__init__-124"><a href="#Mol.__init__-124"><span class="linenos">124</span></a><span class="sd">        Corresponds to the number of protons in each atomic nucleus. Used for calculating </span>
</span><span id="Mol.__init__-125"><a href="#Mol.__init__-125"><span class="linenos">125</span></a><span class="sd">        electronic properties and nuclear contributions to various molecular properties.&quot;&quot;&quot;</span>
</span><span id="Mol.__init__-126"><a href="#Mol.__init__-126"><span class="linenos">126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Mol.__init__-127"><a href="#Mol.__init__-127"><span class="linenos">127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;bool: Flag indicating whether the molecule was successfully initialized and validated.</span>
</span><span id="Mol.__init__-128"><a href="#Mol.__init__-128"><span class="linenos">128</span></a><span class="sd">        Set to True if all atoms have valid symbols/atomic numbers and properly formatted </span>
</span><span id="Mol.__init__-129"><a href="#Mol.__init__-129"><span class="linenos">129</span></a><span class="sd">        coordinates, False otherwise. Used to prevent operations on invalid molecular data.&quot;&quot;&quot;</span>
</span><span id="Mol.__init__-130"><a href="#Mol.__init__-130"><span class="linenos">130</span></a>
</span><span id="Mol.__init__-131"><a href="#Mol.__init__-131"><span class="linenos">131</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Generic mol&#39;</span>
</span><span id="Mol.__init__-132"><a href="#Mol.__init__-132"><span class="linenos">132</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;str: Descriptive label or name for the molecule.</span>
</span><span id="Mol.__init__-133"><a href="#Mol.__init__-133"><span class="linenos">133</span></a><span class="sd">        Defaults to &#39;Generic mol&#39; but can be customized. Used in output files and for </span>
</span><span id="Mol.__init__-134"><a href="#Mol.__init__-134"><span class="linenos">134</span></a><span class="sd">        identification purposes when exporting molecular data to various file formats.&quot;&quot;&quot;</span>
</span><span id="Mol.__init__-135"><a href="#Mol.__init__-135"><span class="linenos">135</span></a>        <span class="c1">#Validate if the atoms attribute are provided correctly</span>
</span><span id="Mol.__init__-136"><a href="#Mol.__init__-136"><span class="linenos">136</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">validateAtoms</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
</span><span id="Mol.__init__-137"><a href="#Mol.__init__-137"><span class="linenos">137</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
</span><span id="Mol.__init__-138"><a href="#Mol.__init__-138"><span class="linenos">138</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span><span class="o">+</span><span class="n">charge</span>
</span><span id="Mol.__init__-139"><a href="#Mol.__init__-139"><span class="linenos">139</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">coordsBohrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">*</span><span class="n">Data</span><span class="o">.</span><span class="n">Angs2BohrFactor</span>
</span><span id="Mol.__init__-140"><a href="#Mol.__init__-140"><span class="linenos">140</span></a>            <span class="c1">#Basis set names for the atoms.</span>
</span><span id="Mol.__init__-141"><a href="#Mol.__init__-141"><span class="linenos">141</span></a>            <span class="c1">#Either just one basis function can be specified for all atoms</span>
</span><span id="Mol.__init__-142"><a href="#Mol.__init__-142"><span class="linenos">142</span></a>            <span class="c1">#Or one can specify a particular basis set for a particular atom.</span>
</span><span id="Mol.__init__-143"><a href="#Mol.__init__-143"><span class="linenos">143</span></a>            <span class="c1">#&#39;basis&#39; is a dictionary specifying the basis set to be used for a particular atom</span>
</span><span id="Mol.__init__-144"><a href="#Mol.__init__-144"><span class="linenos">144</span></a>            <span class="k">if</span> <span class="n">basis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Mol.__init__-145"><a href="#Mol.__init__-145"><span class="linenos">145</span></a>                <span class="c1">#Default basis set is sto-3g for all atoms</span>
</span><span id="Mol.__init__-146"><a href="#Mol.__init__-146"><span class="linenos">146</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;all&#39;</span><span class="p">:</span><span class="n">Basis</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">mol</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">basis_name</span><span class="o">=</span><span class="s1">&#39;sto-3g&#39;</span><span class="p">)}</span><span class="c1">#{&#39;all&#39;,&#39;sto-3g&#39;}</span>
</span><span id="Mol.__init__-147"><a href="#Mol.__init__-147"><span class="linenos">147</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">Basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">basis</span><span class="p">)</span>
</span><span id="Mol.__init__-148"><a href="#Mol.__init__-148"><span class="linenos">148</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Mol.__init__-149"><a href="#Mol.__init__-149"><span class="linenos">149</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">Basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a Mol object with atomic coordinates and properties.</p>

<p>Args:
    atoms (list, optional): List of atoms in the format [[symbol, x, y, z], ...] 
                           where symbol can be atomic symbol (str) or atomic number (int),
                           and x, y, z are coordinates in Angstroms.
    coordfile (str, optional): Path to coordinate file (.xyz format supported).
    charge (int, optional): Molecular charge. Defaults to 0.
    basis (dict, optional): Basis set specification. If None, defaults to STO-3G 
                           for all atoms.</p>

<p>Raises:
    ValueError: If neither atoms nor coordfile is provided.
    TypeError: If coordfile is not a string.</p>

<p>Note:
    If both atoms and coordfile are provided, atoms takes precedence and 
    coordfile is ignored.</p>
</div>


                            </div>
                            <div id="Mol.coordfile" class="classattr">
                                <div class="attr variable">
            <span class="name">coordfile</span>

        
    </div>
    <a class="headerlink" href="#Mol.coordfile"></a>
    
            <div class="docstring"><p>str or None: Path to the coordinate file used to initialize the molecule.
Contains the filename of the original coordinate file (.xyz, .mol, TURBOMOLE coord, etc.) 
if the molecule was created from a file, or None if created directly from atoms list.</p>
</div>


                            </div>
                            <div id="Mol.atoms" class="classattr">
                                <div class="attr variable">
            <span class="name">atoms</span>

        
    </div>
    <a class="headerlink" href="#Mol.atoms"></a>
    
            <div class="docstring"><p>list: List of atoms with their coordinates in the format [[symbol, x, y, z], ...] where:</p>

<ul>
<li>symbol: Atomic symbol (str) or atomic number (int)</li>
<li>x, y, z: Cartesian coordinates in Angstroms (float)
This is the raw input data used to construct the molecule.</li>
</ul>
</div>


                            </div>
                            <div id="Mol.charge" class="classattr">
                                <div class="attr variable">
            <span class="name">charge</span>

        
    </div>
    <a class="headerlink" href="#Mol.charge"></a>
    
            <div class="docstring"><p>int: Net charge of the molecule in elementary charge units.
Positive values indicate cationic species, negative values indicate anionic species, 
and 0 indicates a neutral molecule. Used to calculate the total number of electrons.</p>
</div>


                            </div>
                            <div id="Mol.basis" class="classattr">
                                <div class="attr variable">
            <span class="name">basis</span>

        
    </div>
    <a class="headerlink" href="#Mol.basis"></a>
    
            <div class="docstring"><p>Basis or None: Basis set object containing all basis function information for quantum 
chemical calculations. Initialized as None and populated with a Basis instance that 
handles basis set assignments for each atom in the molecule.</p>
</div>


                            </div>
                            <div id="Mol.nelectrons" class="classattr">
                                <div class="attr variable">
            <span class="name">nelectrons</span>

        
    </div>
    <a class="headerlink" href="#Mol.nelectrons"></a>
    
            <div class="docstring"><p>int: Total number of electrons in the molecule.
Calculated as the sum of all atomic numbers (nuclear charges) adjusted by the molecular charge:
nelectrons = Σ(Z_i) - charge, where Z_i is the atomic number of atom i.</p>
</div>


                            </div>
                            <div id="Mol.natoms" class="classattr">
                                <div class="attr variable">
            <span class="name">natoms</span>

        
    </div>
    <a class="headerlink" href="#Mol.natoms"></a>
    
            <div class="docstring"><p>int: Total number of atoms in the molecule.
Incremented during atom validation and used for array dimensioning and iteration 
over atomic properties.</p>
</div>


                            </div>
                            <div id="Mol.coords" class="classattr">
                                <div class="attr variable">
            <span class="name">coords</span>

        
    </div>
    <a class="headerlink" href="#Mol.coords"></a>
    
            <div class="docstring"><p>numpy.ndarray: Atomic coordinates in Angstroms with shape (natoms, 3).
Each row contains the [x, y, z] coordinates of one atom. Initialized as empty list 
and populated during atom validation to become a numpy array.</p>
</div>


                            </div>
                            <div id="Mol.coordsBohrs" class="classattr">
                                <div class="attr variable">
            <span class="name">coordsBohrs</span>

        
    </div>
    <a class="headerlink" href="#Mol.coordsBohrs"></a>
    
            <div class="docstring"><p>numpy.ndarray: Atomic coordinates converted to Bohr units with shape (natoms, 3).
Calculated from self.coords using the conversion factor Data.Angs2BohrFactor. 
Used for quantum chemical calculations requiring atomic units of length.</p>
</div>


                            </div>
                            <div id="Mol.atomicSpecies" class="classattr">
                                <div class="attr variable">
            <span class="name">atomicSpecies</span>

        
    </div>
    <a class="headerlink" href="#Mol.atomicSpecies"></a>
    
            <div class="docstring"><p>list of str: List of atomic symbols as strings (e.g., ['H', 'C', 'N', 'O']).
Ordered the same as atoms appear in the molecule. Length equals natoms. 
Used for identifying atom types and output formatting.</p>
</div>


                            </div>
                            <div id="Mol.Zcharges" class="classattr">
                                <div class="attr variable">
            <span class="name">Zcharges</span>

        
    </div>
    <a class="headerlink" href="#Mol.Zcharges"></a>
    
            <div class="docstring"><p>list of int: List of atomic numbers (nuclear charges) for each atom in the molecule.
Corresponds to the number of protons in each atomic nucleus. Used for calculating 
electronic properties and nuclear contributions to various molecular properties.</p>
</div>


                            </div>
                            <div id="Mol.success" class="classattr">
                                <div class="attr variable">
            <span class="name">success</span>

        
    </div>
    <a class="headerlink" href="#Mol.success"></a>
    
            <div class="docstring"><p>bool: Flag indicating whether the molecule was successfully initialized and validated.
Set to True if all atoms have valid symbols/atomic numbers and properly formatted 
coordinates, False otherwise. Used to prevent operations on invalid molecular data.</p>
</div>


                            </div>
                            <div id="Mol.label" class="classattr">
                                <div class="attr variable">
            <span class="name">label</span>

        
    </div>
    <a class="headerlink" href="#Mol.label"></a>
    
            <div class="docstring"><p>str: Descriptive label or name for the molecule.
Defaults to 'Generic mol' but can be customized. Used in output files and for 
identification purposes when exporting molecular data to various file formats.</p>
</div>


                            </div>
                            <div id="Mol.validateAtoms" class="classattr">
                                        <input id="Mol.validateAtoms-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">validateAtoms</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">atoms</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Mol.validateAtoms-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Mol.validateAtoms"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Mol.validateAtoms-155"><a href="#Mol.validateAtoms-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validateAtoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">):</span>
</span><span id="Mol.validateAtoms-156"><a href="#Mol.validateAtoms-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol.validateAtoms-157"><a href="#Mol.validateAtoms-157"><span class="linenos">157</span></a><span class="sd">        Validate atomic symbols and coordinates provided in the atoms list.</span>
</span><span id="Mol.validateAtoms-158"><a href="#Mol.validateAtoms-158"><span class="linenos">158</span></a><span class="sd">        </span>
</span><span id="Mol.validateAtoms-159"><a href="#Mol.validateAtoms-159"><span class="linenos">159</span></a><span class="sd">        This method checks that atomic symbols are valid (either as strings matching</span>
</span><span id="Mol.validateAtoms-160"><a href="#Mol.validateAtoms-160"><span class="linenos">160</span></a><span class="sd">        known element symbols or as integers representing atomic numbers), and that</span>
</span><span id="Mol.validateAtoms-161"><a href="#Mol.validateAtoms-161"><span class="linenos">161</span></a><span class="sd">        coordinates are properly formatted as numerical values.</span>
</span><span id="Mol.validateAtoms-162"><a href="#Mol.validateAtoms-162"><span class="linenos">162</span></a><span class="sd">        </span>
</span><span id="Mol.validateAtoms-163"><a href="#Mol.validateAtoms-163"><span class="linenos">163</span></a><span class="sd">        Args:</span>
</span><span id="Mol.validateAtoms-164"><a href="#Mol.validateAtoms-164"><span class="linenos">164</span></a><span class="sd">            atoms (list): List of atoms in format [[symbol, x, y, z], ...] where</span>
</span><span id="Mol.validateAtoms-165"><a href="#Mol.validateAtoms-165"><span class="linenos">165</span></a><span class="sd">                         symbol can be str (element symbol) or int (atomic number),</span>
</span><span id="Mol.validateAtoms-166"><a href="#Mol.validateAtoms-166"><span class="linenos">166</span></a><span class="sd">                         and x, y, z are numerical coordinates.</span>
</span><span id="Mol.validateAtoms-167"><a href="#Mol.validateAtoms-167"><span class="linenos">167</span></a><span class="sd">        </span>
</span><span id="Mol.validateAtoms-168"><a href="#Mol.validateAtoms-168"><span class="linenos">168</span></a><span class="sd">        Returns:</span>
</span><span id="Mol.validateAtoms-169"><a href="#Mol.validateAtoms-169"><span class="linenos">169</span></a><span class="sd">            bool: True if all atoms are valid, False otherwise.</span>
</span><span id="Mol.validateAtoms-170"><a href="#Mol.validateAtoms-170"><span class="linenos">170</span></a><span class="sd">        </span>
</span><span id="Mol.validateAtoms-171"><a href="#Mol.validateAtoms-171"><span class="linenos">171</span></a><span class="sd">        Side Effects:</span>
</span><span id="Mol.validateAtoms-172"><a href="#Mol.validateAtoms-172"><span class="linenos">172</span></a><span class="sd">            Updates the following instance attributes:</span>
</span><span id="Mol.validateAtoms-173"><a href="#Mol.validateAtoms-173"><span class="linenos">173</span></a><span class="sd">            - atomicSpecies: List of atomic symbols</span>
</span><span id="Mol.validateAtoms-174"><a href="#Mol.validateAtoms-174"><span class="linenos">174</span></a><span class="sd">            - Zcharges: List of atomic numbers</span>
</span><span id="Mol.validateAtoms-175"><a href="#Mol.validateAtoms-175"><span class="linenos">175</span></a><span class="sd">            - nelectrons: Total number of electrons</span>
</span><span id="Mol.validateAtoms-176"><a href="#Mol.validateAtoms-176"><span class="linenos">176</span></a><span class="sd">            - natoms: Number of atoms</span>
</span><span id="Mol.validateAtoms-177"><a href="#Mol.validateAtoms-177"><span class="linenos">177</span></a><span class="sd">            - coords: Numpy array of coordinates</span>
</span><span id="Mol.validateAtoms-178"><a href="#Mol.validateAtoms-178"><span class="linenos">178</span></a><span class="sd">        </span>
</span><span id="Mol.validateAtoms-179"><a href="#Mol.validateAtoms-179"><span class="linenos">179</span></a><span class="sd">        Raises:</span>
</span><span id="Mol.validateAtoms-180"><a href="#Mol.validateAtoms-180"><span class="linenos">180</span></a><span class="sd">            Prints error messages for invalid atomic symbols, coordinates, or formatting.</span>
</span><span id="Mol.validateAtoms-181"><a href="#Mol.validateAtoms-181"><span class="linenos">181</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol.validateAtoms-182"><a href="#Mol.validateAtoms-182"><span class="linenos">182</span></a>        <span class="c1">#Validate atomic symbols</span>
</span><span id="Mol.validateAtoms-183"><a href="#Mol.validateAtoms-183"><span class="linenos">183</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)):</span>
</span><span id="Mol.validateAtoms-184"><a href="#Mol.validateAtoms-184"><span class="linenos">184</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Mol.validateAtoms-185"><a href="#Mol.validateAtoms-185"><span class="linenos">185</span></a>                <span class="n">elementSymbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Data</span><span class="o">.</span><span class="n">elementSymbols</span><span class="p">]</span>
</span><span id="Mol.validateAtoms-186"><a href="#Mol.validateAtoms-186"><span class="linenos">186</span></a>                <span class="k">if</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">elementSymbols</span><span class="p">:</span>
</span><span id="Mol.validateAtoms-187"><a href="#Mol.validateAtoms-187"><span class="linenos">187</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">atomicSpecies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Mol.validateAtoms-188"><a href="#Mol.validateAtoms-188"><span class="linenos">188</span></a>                    <span class="n">Z</span> <span class="o">=</span> <span class="n">elementSymbols</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="Mol.validateAtoms-189"><a href="#Mol.validateAtoms-189"><span class="linenos">189</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</span><span id="Mol.validateAtoms-190"><a href="#Mol.validateAtoms-190"><span class="linenos">190</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">+</span> <span class="n">Z</span> 
</span><span id="Mol.validateAtoms-191"><a href="#Mol.validateAtoms-191"><span class="linenos">191</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Mol.validateAtoms-192"><a href="#Mol.validateAtoms-192"><span class="linenos">192</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Mol.validateAtoms-193"><a href="#Mol.validateAtoms-193"><span class="linenos">193</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Unknown atomic symbols found&#39;</span><span class="p">)</span>
</span><span id="Mol.validateAtoms-194"><a href="#Mol.validateAtoms-194"><span class="linenos">194</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="Mol.validateAtoms-195"><a href="#Mol.validateAtoms-195"><span class="linenos">195</span></a>            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
</span><span id="Mol.validateAtoms-196"><a href="#Mol.validateAtoms-196"><span class="linenos">196</span></a>                <span class="k">if</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">118</span> <span class="ow">and</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
</span><span id="Mol.validateAtoms-197"><a href="#Mol.validateAtoms-197"><span class="linenos">197</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">atomicSpecies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Data</span><span class="o">.</span><span class="n">elementSymbols</span><span class="p">[</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]])</span>
</span><span id="Mol.validateAtoms-198"><a href="#Mol.validateAtoms-198"><span class="linenos">198</span></a>                    <span class="n">Z</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Mol.validateAtoms-199"><a href="#Mol.validateAtoms-199"><span class="linenos">199</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
</span><span id="Mol.validateAtoms-200"><a href="#Mol.validateAtoms-200"><span class="linenos">200</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nelectrons</span> <span class="o">+</span> <span class="n">Z</span> 
</span><span id="Mol.validateAtoms-201"><a href="#Mol.validateAtoms-201"><span class="linenos">201</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="Mol.validateAtoms-202"><a href="#Mol.validateAtoms-202"><span class="linenos">202</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Mol.validateAtoms-203"><a href="#Mol.validateAtoms-203"><span class="linenos">203</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Found atomic number out of the valid range&#39;</span><span class="p">)</span>
</span><span id="Mol.validateAtoms-204"><a href="#Mol.validateAtoms-204"><span class="linenos">204</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="Mol.validateAtoms-205"><a href="#Mol.validateAtoms-205"><span class="linenos">205</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Mol.validateAtoms-206"><a href="#Mol.validateAtoms-206"><span class="linenos">206</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Found something other than string or integer for atomic symbols/numbers&#39;</span><span class="p">)</span>
</span><span id="Mol.validateAtoms-207"><a href="#Mol.validateAtoms-207"><span class="linenos">207</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="Mol.validateAtoms-208"><a href="#Mol.validateAtoms-208"><span class="linenos">208</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</span><span id="Mol.validateAtoms-209"><a href="#Mol.validateAtoms-209"><span class="linenos">209</span></a>        <span class="c1">#Validate atomic coords</span>
</span><span id="Mol.validateAtoms-210"><a href="#Mol.validateAtoms-210"><span class="linenos">210</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)):</span>
</span><span id="Mol.validateAtoms-211"><a href="#Mol.validateAtoms-211"><span class="linenos">211</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
</span><span id="Mol.validateAtoms-212"><a href="#Mol.validateAtoms-212"><span class="linenos">212</span></a>                <span class="c1">#TODO: the following condition doesn&#39;t work</span>
</span><span id="Mol.validateAtoms-213"><a href="#Mol.validateAtoms-213"><span class="linenos">213</span></a>                <span class="c1">#FIXME</span>
</span><span id="Mol.validateAtoms-214"><a href="#Mol.validateAtoms-214"><span class="linenos">214</span></a>                <span class="k">if</span> <span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordi</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="k">for</span> <span class="n">coordi</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coordi</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="k">for</span> <span class="n">coordi</span> <span class="ow">in</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]):</span>
</span><span id="Mol.validateAtoms-215"><a href="#Mol.validateAtoms-215"><span class="linenos">215</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
</span><span id="Mol.validateAtoms-216"><a href="#Mol.validateAtoms-216"><span class="linenos">216</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="Mol.validateAtoms-217"><a href="#Mol.validateAtoms-217"><span class="linenos">217</span></a>                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Coordinates of atoms should be floats/integers.&#39;</span><span class="p">)</span>
</span><span id="Mol.validateAtoms-218"><a href="#Mol.validateAtoms-218"><span class="linenos">218</span></a>                    <span class="k">return</span> <span class="kc">False</span>
</span><span id="Mol.validateAtoms-219"><a href="#Mol.validateAtoms-219"><span class="linenos">219</span></a>
</span><span id="Mol.validateAtoms-220"><a href="#Mol.validateAtoms-220"><span class="linenos">220</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Mol.validateAtoms-221"><a href="#Mol.validateAtoms-221"><span class="linenos">221</span></a>                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Illegal definition of coords in atoms. There should be all three x,y,z coordinates.</span><span class="se">\n</span><span class="s1">Some seem to be missing.&#39;</span><span class="p">)</span>
</span><span id="Mol.validateAtoms-222"><a href="#Mol.validateAtoms-222"><span class="linenos">222</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="Mol.validateAtoms-223"><a href="#Mol.validateAtoms-223"><span class="linenos">223</span></a>        
</span><span id="Mol.validateAtoms-224"><a href="#Mol.validateAtoms-224"><span class="linenos">224</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
</span><span id="Mol.validateAtoms-225"><a href="#Mol.validateAtoms-225"><span class="linenos">225</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Mol.validateAtoms-226"><a href="#Mol.validateAtoms-226"><span class="linenos">226</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Mol.validateAtoms-227"><a href="#Mol.validateAtoms-227"><span class="linenos">227</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Some definitions of atomic symbols/coords were illegal&#39;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Validate atomic symbols and coordinates provided in the atoms list.</p>

<p>This method checks that atomic symbols are valid (either as strings matching
known element symbols or as integers representing atomic numbers), and that
coordinates are properly formatted as numerical values.</p>

<p>Args:
    atoms (list): List of atoms in format [[symbol, x, y, z], ...] where
                 symbol can be str (element symbol) or int (atomic number),
                 and x, y, z are numerical coordinates.</p>

<p>Returns:
    bool: True if all atoms are valid, False otherwise.</p>

<p>Side Effects:
    Updates the following instance attributes:
    - atomicSpecies: List of atomic symbols
    - Zcharges: List of atomic numbers
    - nelectrons: Total number of electrons
    - natoms: Number of atoms
    - coords: Numpy array of coordinates</p>

<p>Raises:
    Prints error messages for invalid atomic symbols, coordinates, or formatting.</p>
</div>


                            </div>
                            <div id="Mol.get_center_of_charge" class="classattr">
                                        <input id="Mol.get_center_of_charge-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_center_of_charge</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Mol.get_center_of_charge-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Mol.get_center_of_charge"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Mol.get_center_of_charge-230"><a href="#Mol.get_center_of_charge-230"><span class="linenos">230</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_center_of_charge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Mol.get_center_of_charge-231"><a href="#Mol.get_center_of_charge-231"><span class="linenos">231</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol.get_center_of_charge-232"><a href="#Mol.get_center_of_charge-232"><span class="linenos">232</span></a><span class="sd">        Calculate the center of charge (weighted by atomic numbers) of the molecule.</span>
</span><span id="Mol.get_center_of_charge-233"><a href="#Mol.get_center_of_charge-233"><span class="linenos">233</span></a><span class="sd">        </span>
</span><span id="Mol.get_center_of_charge-234"><a href="#Mol.get_center_of_charge-234"><span class="linenos">234</span></a><span class="sd">        The center of charge is computed as the weighted average of atomic positions,</span>
</span><span id="Mol.get_center_of_charge-235"><a href="#Mol.get_center_of_charge-235"><span class="linenos">235</span></a><span class="sd">        where the weights are the atomic numbers (nuclear charges) of each atom.</span>
</span><span id="Mol.get_center_of_charge-236"><a href="#Mol.get_center_of_charge-236"><span class="linenos">236</span></a><span class="sd">        </span>
</span><span id="Mol.get_center_of_charge-237"><a href="#Mol.get_center_of_charge-237"><span class="linenos">237</span></a><span class="sd">        Returns:</span>
</span><span id="Mol.get_center_of_charge-238"><a href="#Mol.get_center_of_charge-238"><span class="linenos">238</span></a><span class="sd">            numpy.ndarray or None: 3D coordinates of the center of charge in Angstroms.</span>
</span><span id="Mol.get_center_of_charge-239"><a href="#Mol.get_center_of_charge-239"><span class="linenos">239</span></a><span class="sd">                                  Returns None if the molecule was not successfully initialized.</span>
</span><span id="Mol.get_center_of_charge-240"><a href="#Mol.get_center_of_charge-240"><span class="linenos">240</span></a><span class="sd">        </span>
</span><span id="Mol.get_center_of_charge-241"><a href="#Mol.get_center_of_charge-241"><span class="linenos">241</span></a><span class="sd">        Formula:</span>
</span><span id="Mol.get_center_of_charge-242"><a href="#Mol.get_center_of_charge-242"><span class="linenos">242</span></a><span class="sd">            center_of_charge = Σ(Z_i * r_i) / Σ(Z_i)</span>
</span><span id="Mol.get_center_of_charge-243"><a href="#Mol.get_center_of_charge-243"><span class="linenos">243</span></a><span class="sd">            where Z_i is the atomic number and r_i is the position of atom i.</span>
</span><span id="Mol.get_center_of_charge-244"><a href="#Mol.get_center_of_charge-244"><span class="linenos">244</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol.get_center_of_charge-245"><a href="#Mol.get_center_of_charge-245"><span class="linenos">245</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
</span><span id="Mol.get_center_of_charge-246"><a href="#Mol.get_center_of_charge-246"><span class="linenos">246</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Mol object is not successfully initialized.&quot;</span><span class="p">)</span>
</span><span id="Mol.get_center_of_charge-247"><a href="#Mol.get_center_of_charge-247"><span class="linenos">247</span></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="Mol.get_center_of_charge-248"><a href="#Mol.get_center_of_charge-248"><span class="linenos">248</span></a>
</span><span id="Mol.get_center_of_charge-249"><a href="#Mol.get_center_of_charge-249"><span class="linenos">249</span></a>        <span class="c1"># Use NumPy for efficient calculations</span>
</span><span id="Mol.get_center_of_charge-250"><a href="#Mol.get_center_of_charge-250"><span class="linenos">250</span></a>        <span class="n">total_charge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span><span class="p">)</span>
</span><span id="Mol.get_center_of_charge-251"><a href="#Mol.get_center_of_charge-251"><span class="linenos">251</span></a>        <span class="n">coc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_charge</span>
</span><span id="Mol.get_center_of_charge-252"><a href="#Mol.get_center_of_charge-252"><span class="linenos">252</span></a>
</span><span id="Mol.get_center_of_charge-253"><a href="#Mol.get_center_of_charge-253"><span class="linenos">253</span></a>        <span class="k">return</span> <span class="n">coc</span>
</span><span id="Mol.get_center_of_charge-254"><a href="#Mol.get_center_of_charge-254"><span class="linenos">254</span></a>        <span class="c1"># # Use NumPy for efficient calculations</span>
</span><span id="Mol.get_center_of_charge-255"><a href="#Mol.get_center_of_charge-255"><span class="linenos">255</span></a>        <span class="c1"># total_mass = np.sum(self.Zcharges)</span>
</span><span id="Mol.get_center_of_charge-256"><a href="#Mol.get_center_of_charge-256"><span class="linenos">256</span></a>        <span class="c1"># com_x = np.sum(self.Zcharges * self.coords[:, 0]) / total_mass</span>
</span><span id="Mol.get_center_of_charge-257"><a href="#Mol.get_center_of_charge-257"><span class="linenos">257</span></a>        <span class="c1"># com_y = np.sum(self.Zcharges * self.coords[:, 1]) / total_mass</span>
</span><span id="Mol.get_center_of_charge-258"><a href="#Mol.get_center_of_charge-258"><span class="linenos">258</span></a>        <span class="c1"># com_z = np.sum(self.Zcharges * self.coords[:, 2]) / total_mass</span>
</span><span id="Mol.get_center_of_charge-259"><a href="#Mol.get_center_of_charge-259"><span class="linenos">259</span></a>
</span><span id="Mol.get_center_of_charge-260"><a href="#Mol.get_center_of_charge-260"><span class="linenos">260</span></a>        <span class="c1"># com = np.array([com_x, com_y, com_z])</span>
</span><span id="Mol.get_center_of_charge-261"><a href="#Mol.get_center_of_charge-261"><span class="linenos">261</span></a>        <span class="c1"># return com</span>
</span></pre></div>


            <div class="docstring"><p>Calculate the center of charge (weighted by atomic numbers) of the molecule.</p>

<p>The center of charge is computed as the weighted average of atomic positions,
where the weights are the atomic numbers (nuclear charges) of each atom.</p>

<p>Returns:
    numpy.ndarray or None: 3D coordinates of the center of charge in Angstroms.
                          Returns None if the molecule was not successfully initialized.</p>

<p>Formula:
    center_of_charge = Σ(Z_i * r_i) / Σ(Z_i)
    where Z_i is the atomic number and r_i is the position of atom i.</p>
</div>


                            </div>
                            <div id="Mol.get_nuc_dip_moment" class="classattr">
                                        <input id="Mol.get_nuc_dip_moment-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_nuc_dip_moment</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Mol.get_nuc_dip_moment-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Mol.get_nuc_dip_moment"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Mol.get_nuc_dip_moment-263"><a href="#Mol.get_nuc_dip_moment-263"><span class="linenos">263</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_nuc_dip_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Mol.get_nuc_dip_moment-264"><a href="#Mol.get_nuc_dip_moment-264"><span class="linenos">264</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol.get_nuc_dip_moment-265"><a href="#Mol.get_nuc_dip_moment-265"><span class="linenos">265</span></a><span class="sd">        Calculate the nuclear contribution to the molecular dipole moment.</span>
</span><span id="Mol.get_nuc_dip_moment-266"><a href="#Mol.get_nuc_dip_moment-266"><span class="linenos">266</span></a><span class="sd">        </span>
</span><span id="Mol.get_nuc_dip_moment-267"><a href="#Mol.get_nuc_dip_moment-267"><span class="linenos">267</span></a><span class="sd">        The nuclear dipole moment is computed as the sum of nuclear charges</span>
</span><span id="Mol.get_nuc_dip_moment-268"><a href="#Mol.get_nuc_dip_moment-268"><span class="linenos">268</span></a><span class="sd">        multiplied by their positions in atomic units (Bohr).</span>
</span><span id="Mol.get_nuc_dip_moment-269"><a href="#Mol.get_nuc_dip_moment-269"><span class="linenos">269</span></a><span class="sd">        </span>
</span><span id="Mol.get_nuc_dip_moment-270"><a href="#Mol.get_nuc_dip_moment-270"><span class="linenos">270</span></a><span class="sd">        Returns:</span>
</span><span id="Mol.get_nuc_dip_moment-271"><a href="#Mol.get_nuc_dip_moment-271"><span class="linenos">271</span></a><span class="sd">            numpy.ndarray: 3D vector representing the nuclear dipole moment</span>
</span><span id="Mol.get_nuc_dip_moment-272"><a href="#Mol.get_nuc_dip_moment-272"><span class="linenos">272</span></a><span class="sd">                          in atomic units (e⋅a₀), where each component corresponds</span>
</span><span id="Mol.get_nuc_dip_moment-273"><a href="#Mol.get_nuc_dip_moment-273"><span class="linenos">273</span></a><span class="sd">                          to x, y, z directions.</span>
</span><span id="Mol.get_nuc_dip_moment-274"><a href="#Mol.get_nuc_dip_moment-274"><span class="linenos">274</span></a><span class="sd">        </span>
</span><span id="Mol.get_nuc_dip_moment-275"><a href="#Mol.get_nuc_dip_moment-275"><span class="linenos">275</span></a><span class="sd">        Formula:</span>
</span><span id="Mol.get_nuc_dip_moment-276"><a href="#Mol.get_nuc_dip_moment-276"><span class="linenos">276</span></a><span class="sd">            μ_nuc = Σ(Z_i * r_i)</span>
</span><span id="Mol.get_nuc_dip_moment-277"><a href="#Mol.get_nuc_dip_moment-277"><span class="linenos">277</span></a><span class="sd">            where Z_i is the nuclear charge and r_i is the position in Bohr units.</span>
</span><span id="Mol.get_nuc_dip_moment-278"><a href="#Mol.get_nuc_dip_moment-278"><span class="linenos">278</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol.get_nuc_dip_moment-279"><a href="#Mol.get_nuc_dip_moment-279"><span class="linenos">279</span></a>        <span class="n">charges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Zcharges</span>
</span><span id="Mol.get_nuc_dip_moment-280"><a href="#Mol.get_nuc_dip_moment-280"><span class="linenos">280</span></a>        <span class="n">coords</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coordsBohrs</span> 
</span><span id="Mol.get_nuc_dip_moment-281"><a href="#Mol.get_nuc_dip_moment-281"><span class="linenos">281</span></a>        <span class="n">nuc_dip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ix-&gt;x&#39;</span><span class="p">,</span> <span class="n">charges</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
</span><span id="Mol.get_nuc_dip_moment-282"><a href="#Mol.get_nuc_dip_moment-282"><span class="linenos">282</span></a>        <span class="k">return</span> <span class="n">nuc_dip</span>
</span></pre></div>


            <div class="docstring"><p>Calculate the nuclear contribution to the molecular dipole moment.</p>

<p>The nuclear dipole moment is computed as the sum of nuclear charges
multiplied by their positions in atomic units (Bohr).</p>

<p>Returns:
    numpy.ndarray: 3D vector representing the nuclear dipole moment
                  in atomic units (e⋅a₀), where each component corresponds
                  to x, y, z directions.</p>

<p>Formula:
    μ_nuc = Σ(Z_i * r_i)
    where Z_i is the nuclear charge and r_i is the position in Bohr units.</p>
</div>


                            </div>
                            <div id="Mol.get_elec_dip_moment" class="classattr">
                                        <input id="Mol.get_elec_dip_moment-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_elec_dip_moment</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">dipole_moment_matrix</span>, </span><span class="param"><span class="n">dmat</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Mol.get_elec_dip_moment-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Mol.get_elec_dip_moment"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Mol.get_elec_dip_moment-284"><a href="#Mol.get_elec_dip_moment-284"><span class="linenos">284</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_elec_dip_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dipole_moment_matrix</span><span class="p">,</span> <span class="n">dmat</span><span class="p">):</span>
</span><span id="Mol.get_elec_dip_moment-285"><a href="#Mol.get_elec_dip_moment-285"><span class="linenos">285</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol.get_elec_dip_moment-286"><a href="#Mol.get_elec_dip_moment-286"><span class="linenos">286</span></a><span class="sd">        Calculate the electronic contribution to the molecular dipole moment.</span>
</span><span id="Mol.get_elec_dip_moment-287"><a href="#Mol.get_elec_dip_moment-287"><span class="linenos">287</span></a><span class="sd">        </span>
</span><span id="Mol.get_elec_dip_moment-288"><a href="#Mol.get_elec_dip_moment-288"><span class="linenos">288</span></a><span class="sd">        The electronic dipole moment is computed using the dipole moment integrals</span>
</span><span id="Mol.get_elec_dip_moment-289"><a href="#Mol.get_elec_dip_moment-289"><span class="linenos">289</span></a><span class="sd">        and the density matrix from quantum chemical calculations.</span>
</span><span id="Mol.get_elec_dip_moment-290"><a href="#Mol.get_elec_dip_moment-290"><span class="linenos">290</span></a><span class="sd">        </span>
</span><span id="Mol.get_elec_dip_moment-291"><a href="#Mol.get_elec_dip_moment-291"><span class="linenos">291</span></a><span class="sd">        Args:</span>
</span><span id="Mol.get_elec_dip_moment-292"><a href="#Mol.get_elec_dip_moment-292"><span class="linenos">292</span></a><span class="sd">            dipole_moment_matrix (numpy.ndarray): 3D array of dipole moment integrals</span>
</span><span id="Mol.get_elec_dip_moment-293"><a href="#Mol.get_elec_dip_moment-293"><span class="linenos">293</span></a><span class="sd">                                                 with shape (3, nbasis, nbasis), where</span>
</span><span id="Mol.get_elec_dip_moment-294"><a href="#Mol.get_elec_dip_moment-294"><span class="linenos">294</span></a><span class="sd">                                                 the first dimension corresponds to x, y, z.</span>
</span><span id="Mol.get_elec_dip_moment-295"><a href="#Mol.get_elec_dip_moment-295"><span class="linenos">295</span></a><span class="sd">            dmat (numpy.ndarray): Density matrix with shape (nbasis, nbasis).</span>
</span><span id="Mol.get_elec_dip_moment-296"><a href="#Mol.get_elec_dip_moment-296"><span class="linenos">296</span></a><span class="sd">        </span>
</span><span id="Mol.get_elec_dip_moment-297"><a href="#Mol.get_elec_dip_moment-297"><span class="linenos">297</span></a><span class="sd">        Returns:</span>
</span><span id="Mol.get_elec_dip_moment-298"><a href="#Mol.get_elec_dip_moment-298"><span class="linenos">298</span></a><span class="sd">            numpy.ndarray: 3D vector representing the electronic dipole moment</span>
</span><span id="Mol.get_elec_dip_moment-299"><a href="#Mol.get_elec_dip_moment-299"><span class="linenos">299</span></a><span class="sd">                          in atomic units (e⋅a₀), where each component corresponds</span>
</span><span id="Mol.get_elec_dip_moment-300"><a href="#Mol.get_elec_dip_moment-300"><span class="linenos">300</span></a><span class="sd">                          to x, y, z directions.</span>
</span><span id="Mol.get_elec_dip_moment-301"><a href="#Mol.get_elec_dip_moment-301"><span class="linenos">301</span></a><span class="sd">        </span>
</span><span id="Mol.get_elec_dip_moment-302"><a href="#Mol.get_elec_dip_moment-302"><span class="linenos">302</span></a><span class="sd">        Formula:</span>
</span><span id="Mol.get_elec_dip_moment-303"><a href="#Mol.get_elec_dip_moment-303"><span class="linenos">303</span></a><span class="sd">            μ_elec = Σ_μν P_μν ⟨μ|r|ν⟩</span>
</span><span id="Mol.get_elec_dip_moment-304"><a href="#Mol.get_elec_dip_moment-304"><span class="linenos">304</span></a><span class="sd">            where P_μν is the density matrix and ⟨μ|r|ν⟩ are dipole integrals.</span>
</span><span id="Mol.get_elec_dip_moment-305"><a href="#Mol.get_elec_dip_moment-305"><span class="linenos">305</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol.get_elec_dip_moment-306"><a href="#Mol.get_elec_dip_moment-306"><span class="linenos">306</span></a>        <span class="n">elec_dip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;xij,ji-&gt;x&#39;</span><span class="p">,</span> <span class="n">dipole_moment_matrix</span><span class="p">,</span> <span class="n">dmat</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
</span><span id="Mol.get_elec_dip_moment-307"><a href="#Mol.get_elec_dip_moment-307"><span class="linenos">307</span></a>        <span class="k">return</span> <span class="n">elec_dip</span>
</span></pre></div>


            <div class="docstring"><p>Calculate the electronic contribution to the molecular dipole moment.</p>

<p>The electronic dipole moment is computed using the dipole moment integrals
and the density matrix from quantum chemical calculations.</p>

<p>Args:
    dipole_moment_matrix (numpy.ndarray): 3D array of dipole moment integrals
                                         with shape (3, nbasis, nbasis), where
                                         the first dimension corresponds to x, y, z.
    dmat (numpy.ndarray): Density matrix with shape (nbasis, nbasis).</p>

<p>Returns:
    numpy.ndarray: 3D vector representing the electronic dipole moment
                  in atomic units (e⋅a₀), where each component corresponds
                  to x, y, z directions.</p>

<p>Formula:
    μ_elec = Σ_μν P_μν ⟨μ|r|ν⟩
    where P_μν is the density matrix and ⟨μ|r|ν⟩ are dipole integrals.</p>
</div>


                            </div>
                            <div id="Mol.get_dipole_moment" class="classattr">
                                        <input id="Mol.get_dipole_moment-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_dipole_moment</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">dipole_moment_matrix</span>, </span><span class="param"><span class="n">dmat</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Mol.get_dipole_moment-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Mol.get_dipole_moment"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Mol.get_dipole_moment-309"><a href="#Mol.get_dipole_moment-309"><span class="linenos">309</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_dipole_moment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dipole_moment_matrix</span><span class="p">,</span> <span class="n">dmat</span><span class="p">):</span>
</span><span id="Mol.get_dipole_moment-310"><a href="#Mol.get_dipole_moment-310"><span class="linenos">310</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol.get_dipole_moment-311"><a href="#Mol.get_dipole_moment-311"><span class="linenos">311</span></a><span class="sd">        Calculate the total molecular dipole moment.</span>
</span><span id="Mol.get_dipole_moment-312"><a href="#Mol.get_dipole_moment-312"><span class="linenos">312</span></a><span class="sd">        </span>
</span><span id="Mol.get_dipole_moment-313"><a href="#Mol.get_dipole_moment-313"><span class="linenos">313</span></a><span class="sd">        The total dipole moment is computed as the difference between nuclear</span>
</span><span id="Mol.get_dipole_moment-314"><a href="#Mol.get_dipole_moment-314"><span class="linenos">314</span></a><span class="sd">        and electronic contributions: μ_total = μ_nuclear - μ_electronic</span>
</span><span id="Mol.get_dipole_moment-315"><a href="#Mol.get_dipole_moment-315"><span class="linenos">315</span></a><span class="sd">        </span>
</span><span id="Mol.get_dipole_moment-316"><a href="#Mol.get_dipole_moment-316"><span class="linenos">316</span></a><span class="sd">        Args:</span>
</span><span id="Mol.get_dipole_moment-317"><a href="#Mol.get_dipole_moment-317"><span class="linenos">317</span></a><span class="sd">            dipole_moment_matrix (numpy.ndarray): 3D array of dipole moment integrals</span>
</span><span id="Mol.get_dipole_moment-318"><a href="#Mol.get_dipole_moment-318"><span class="linenos">318</span></a><span class="sd">                                                 with shape (3, nbasis, nbasis).</span>
</span><span id="Mol.get_dipole_moment-319"><a href="#Mol.get_dipole_moment-319"><span class="linenos">319</span></a><span class="sd">            dmat (numpy.ndarray): Density matrix from quantum chemical calculation</span>
</span><span id="Mol.get_dipole_moment-320"><a href="#Mol.get_dipole_moment-320"><span class="linenos">320</span></a><span class="sd">                                 with shape (nbasis, nbasis).</span>
</span><span id="Mol.get_dipole_moment-321"><a href="#Mol.get_dipole_moment-321"><span class="linenos">321</span></a><span class="sd">        </span>
</span><span id="Mol.get_dipole_moment-322"><a href="#Mol.get_dipole_moment-322"><span class="linenos">322</span></a><span class="sd">        Returns:</span>
</span><span id="Mol.get_dipole_moment-323"><a href="#Mol.get_dipole_moment-323"><span class="linenos">323</span></a><span class="sd">            numpy.ndarray: 3D vector representing the total molecular dipole moment</span>
</span><span id="Mol.get_dipole_moment-324"><a href="#Mol.get_dipole_moment-324"><span class="linenos">324</span></a><span class="sd">                          in atomic units (e⋅a₀). Each component corresponds to</span>
</span><span id="Mol.get_dipole_moment-325"><a href="#Mol.get_dipole_moment-325"><span class="linenos">325</span></a><span class="sd">                          x, y, z directions.</span>
</span><span id="Mol.get_dipole_moment-326"><a href="#Mol.get_dipole_moment-326"><span class="linenos">326</span></a><span class="sd">        </span>
</span><span id="Mol.get_dipole_moment-327"><a href="#Mol.get_dipole_moment-327"><span class="linenos">327</span></a><span class="sd">        Note:</span>
</span><span id="Mol.get_dipole_moment-328"><a href="#Mol.get_dipole_moment-328"><span class="linenos">328</span></a><span class="sd">            The sign convention follows: μ_total = μ_nuclear - μ_electronic</span>
</span><span id="Mol.get_dipole_moment-329"><a href="#Mol.get_dipole_moment-329"><span class="linenos">329</span></a><span class="sd">            This gives the dipole moment vector pointing from negative to positive charge.</span>
</span><span id="Mol.get_dipole_moment-330"><a href="#Mol.get_dipole_moment-330"><span class="linenos">330</span></a><span class="sd">            </span>
</span><span id="Mol.get_dipole_moment-331"><a href="#Mol.get_dipole_moment-331"><span class="linenos">331</span></a><span class="sd">        TODO: Allow user to specify output units (e.g., Debye).</span>
</span><span id="Mol.get_dipole_moment-332"><a href="#Mol.get_dipole_moment-332"><span class="linenos">332</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol.get_dipole_moment-333"><a href="#Mol.get_dipole_moment-333"><span class="linenos">333</span></a>        <span class="n">nuc_dip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_nuc_dip_moment</span><span class="p">()</span>
</span><span id="Mol.get_dipole_moment-334"><a href="#Mol.get_dipole_moment-334"><span class="linenos">334</span></a>        <span class="n">elec_dip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_elec_dip_moment</span><span class="p">(</span><span class="n">dipole_moment_matrix</span><span class="p">,</span> <span class="n">dmat</span><span class="p">)</span>
</span><span id="Mol.get_dipole_moment-335"><a href="#Mol.get_dipole_moment-335"><span class="linenos">335</span></a>        <span class="n">mol_dip</span> <span class="o">=</span> <span class="n">nuc_dip</span> <span class="o">-</span> <span class="n">elec_dip</span>
</span><span id="Mol.get_dipole_moment-336"><a href="#Mol.get_dipole_moment-336"><span class="linenos">336</span></a>        <span class="c1"># TODO: allow the user to specify units (ex: DEBYE)</span>
</span><span id="Mol.get_dipole_moment-337"><a href="#Mol.get_dipole_moment-337"><span class="linenos">337</span></a>        <span class="k">return</span> <span class="n">mol_dip</span>
</span></pre></div>


            <div class="docstring"><p>Calculate the total molecular dipole moment.</p>

<p>The total dipole moment is computed as the difference between nuclear
and electronic contributions: μ_total = μ_nuclear - μ_electronic</p>

<p>Args:
    dipole_moment_matrix (numpy.ndarray): 3D array of dipole moment integrals
                                         with shape (3, nbasis, nbasis).
    dmat (numpy.ndarray): Density matrix from quantum chemical calculation
                         with shape (nbasis, nbasis).</p>

<p>Returns:
    numpy.ndarray: 3D vector representing the total molecular dipole moment
                  in atomic units (e⋅a₀). Each component corresponds to
                  x, y, z directions.</p>

<p>Note:
    The sign convention follows: μ_total = μ_nuclear - μ_electronic
    This gives the dipole moment vector pointing from negative to positive charge.</p>

<p>TODO: Allow user to specify output units (e.g., Debye).</p>
</div>


                            </div>
                            <div id="Mol.exportCoords" class="classattr">
                                        <input id="Mol.exportCoords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">exportCoords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">atomicSpecies</span>, </span><span class="param"><span class="n">coords</span>, </span><span class="param"><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;coord&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Mol.exportCoords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Mol.exportCoords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Mol.exportCoords-340"><a href="#Mol.exportCoords-340"><span class="linenos">340</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exportCoords</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;coord&#39;</span><span class="p">):</span>
</span><span id="Mol.exportCoords-341"><a href="#Mol.exportCoords-341"><span class="linenos">341</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol.exportCoords-342"><a href="#Mol.exportCoords-342"><span class="linenos">342</span></a><span class="sd">        Export molecular coordinates to TURBOMOLE format.</span>
</span><span id="Mol.exportCoords-343"><a href="#Mol.exportCoords-343"><span class="linenos">343</span></a><span class="sd">        </span>
</span><span id="Mol.exportCoords-344"><a href="#Mol.exportCoords-344"><span class="linenos">344</span></a><span class="sd">        Creates a coordinate file in TURBOMOLE format with atomic positions</span>
</span><span id="Mol.exportCoords-345"><a href="#Mol.exportCoords-345"><span class="linenos">345</span></a><span class="sd">        converted from Angstroms to Bohr units.</span>
</span><span id="Mol.exportCoords-346"><a href="#Mol.exportCoords-346"><span class="linenos">346</span></a><span class="sd">        </span>
</span><span id="Mol.exportCoords-347"><a href="#Mol.exportCoords-347"><span class="linenos">347</span></a><span class="sd">        Args:</span>
</span><span id="Mol.exportCoords-348"><a href="#Mol.exportCoords-348"><span class="linenos">348</span></a><span class="sd">            atomicSpecies (list): List of atomic symbols as strings.</span>
</span><span id="Mol.exportCoords-349"><a href="#Mol.exportCoords-349"><span class="linenos">349</span></a><span class="sd">            coords (numpy.ndarray): Atomic coordinates in Angstroms with shape (natoms, 3).</span>
</span><span id="Mol.exportCoords-350"><a href="#Mol.exportCoords-350"><span class="linenos">350</span></a><span class="sd">            filename (str, optional): Output filename. Defaults to &#39;coord&#39;.</span>
</span><span id="Mol.exportCoords-351"><a href="#Mol.exportCoords-351"><span class="linenos">351</span></a><span class="sd">        </span>
</span><span id="Mol.exportCoords-352"><a href="#Mol.exportCoords-352"><span class="linenos">352</span></a><span class="sd">        File Format:</span>
</span><span id="Mol.exportCoords-353"><a href="#Mol.exportCoords-353"><span class="linenos">353</span></a><span class="sd">            $coord</span>
</span><span id="Mol.exportCoords-354"><a href="#Mol.exportCoords-354"><span class="linenos">354</span></a><span class="sd">            x_bohr y_bohr z_bohr element_symbol</span>
</span><span id="Mol.exportCoords-355"><a href="#Mol.exportCoords-355"><span class="linenos">355</span></a><span class="sd">            ...</span>
</span><span id="Mol.exportCoords-356"><a href="#Mol.exportCoords-356"><span class="linenos">356</span></a><span class="sd">            $end</span>
</span><span id="Mol.exportCoords-357"><a href="#Mol.exportCoords-357"><span class="linenos">357</span></a><span class="sd">        </span>
</span><span id="Mol.exportCoords-358"><a href="#Mol.exportCoords-358"><span class="linenos">358</span></a><span class="sd">        Note:</span>
</span><span id="Mol.exportCoords-359"><a href="#Mol.exportCoords-359"><span class="linenos">359</span></a><span class="sd">            This is a static method that should be called as a class method.</span>
</span><span id="Mol.exportCoords-360"><a href="#Mol.exportCoords-360"><span class="linenos">360</span></a><span class="sd">            Coordinates are automatically converted from Angstroms to Bohr units.</span>
</span><span id="Mol.exportCoords-361"><a href="#Mol.exportCoords-361"><span class="linenos">361</span></a><span class="sd">        </span>
</span><span id="Mol.exportCoords-362"><a href="#Mol.exportCoords-362"><span class="linenos">362</span></a><span class="sd">        Warning:</span>
</span><span id="Mol.exportCoords-363"><a href="#Mol.exportCoords-363"><span class="linenos">363</span></a><span class="sd">            This method contains a bug - it references undefined variable &#39;coord&#39;</span>
</span><span id="Mol.exportCoords-364"><a href="#Mol.exportCoords-364"><span class="linenos">364</span></a><span class="sd">            instead of &#39;coords&#39;. Should be fixed in implementation.</span>
</span><span id="Mol.exportCoords-365"><a href="#Mol.exportCoords-365"><span class="linenos">365</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol.exportCoords-366"><a href="#Mol.exportCoords-366"><span class="linenos">366</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="Mol.exportCoords-367"><a href="#Mol.exportCoords-367"><span class="linenos">367</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$coord</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol.exportCoords-368"><a href="#Mol.exportCoords-368"><span class="linenos">368</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">)):</span>
</span><span id="Mol.exportCoords-369"><a href="#Mol.exportCoords-369"><span class="linenos">369</span></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">Data</span><span class="o">.</span><span class="n">Angs2BohrFactor</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Data</span><span class="o">.</span><span class="n">Angs2BohrFactor</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">Data</span><span class="o">.</span><span class="n">Angs2BohrFactor</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="n">atomicSpecies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol.exportCoords-370"><a href="#Mol.exportCoords-370"><span class="linenos">370</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$end</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol.exportCoords-371"><a href="#Mol.exportCoords-371"><span class="linenos">371</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Export molecular coordinates to TURBOMOLE format.</p>

<p>Creates a coordinate file in TURBOMOLE format with atomic positions
converted from Angstroms to Bohr units.</p>

<p>Args:
    atomicSpecies (list): List of atomic symbols as strings.
    coords (numpy.ndarray): Atomic coordinates in Angstroms with shape (natoms, 3).
    filename (str, optional): Output filename. Defaults to 'coord'.</p>

<p>File Format:
    $coord
    x_bohr y_bohr z_bohr element_symbol
    ...
    $end</p>

<p>Note:
    This is a static method that should be called as a class method.
    Coordinates are automatically converted from Angstroms to Bohr units.</p>

<p>Warning:
    This method contains a bug - it references undefined variable 'coord'
    instead of 'coords'. Should be fixed in implementation.</p>
</div>


                            </div>
                            <div id="Mol.exportXYZ" class="classattr">
                                        <input id="Mol.exportXYZ-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">exportXYZ</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">filename</span><span class="o">=</span><span class="s1">&#39;coord&#39;</span>,</span><span class="param">	<span class="n">label</span><span class="o">=</span><span class="s1">&#39;Generic Mol generated by CrysX (Python Library)&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Mol.exportXYZ-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Mol.exportXYZ"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Mol.exportXYZ-374"><a href="#Mol.exportXYZ-374"><span class="linenos">374</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exportXYZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;coord&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Generic Mol generated by CrysX (Python Library)&#39;</span><span class="p">):</span>
</span><span id="Mol.exportXYZ-375"><a href="#Mol.exportXYZ-375"><span class="linenos">375</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol.exportXYZ-376"><a href="#Mol.exportXYZ-376"><span class="linenos">376</span></a><span class="sd">        Export molecular geometry to XYZ format file.</span>
</span><span id="Mol.exportXYZ-377"><a href="#Mol.exportXYZ-377"><span class="linenos">377</span></a><span class="sd">        </span>
</span><span id="Mol.exportXYZ-378"><a href="#Mol.exportXYZ-378"><span class="linenos">378</span></a><span class="sd">        Creates a standard XYZ format file with atomic coordinates in Angstroms.</span>
</span><span id="Mol.exportXYZ-379"><a href="#Mol.exportXYZ-379"><span class="linenos">379</span></a><span class="sd">        This method uses the molecule&#39;s current atomic species and coordinates.</span>
</span><span id="Mol.exportXYZ-380"><a href="#Mol.exportXYZ-380"><span class="linenos">380</span></a><span class="sd">        </span>
</span><span id="Mol.exportXYZ-381"><a href="#Mol.exportXYZ-381"><span class="linenos">381</span></a><span class="sd">        Args:</span>
</span><span id="Mol.exportXYZ-382"><a href="#Mol.exportXYZ-382"><span class="linenos">382</span></a><span class="sd">            filename (str, optional): Base filename without extension. Defaults to &#39;coord&#39;.</span>
</span><span id="Mol.exportXYZ-383"><a href="#Mol.exportXYZ-383"><span class="linenos">383</span></a><span class="sd">                                     The &#39;.xyz&#39; extension will be automatically added.</span>
</span><span id="Mol.exportXYZ-384"><a href="#Mol.exportXYZ-384"><span class="linenos">384</span></a><span class="sd">            label (str, optional): Comment line for the XYZ file. Defaults to </span>
</span><span id="Mol.exportXYZ-385"><a href="#Mol.exportXYZ-385"><span class="linenos">385</span></a><span class="sd">                                  &#39;Generic Mol generated by CrysX (Python Library)&#39;.</span>
</span><span id="Mol.exportXYZ-386"><a href="#Mol.exportXYZ-386"><span class="linenos">386</span></a><span class="sd">        </span>
</span><span id="Mol.exportXYZ-387"><a href="#Mol.exportXYZ-387"><span class="linenos">387</span></a><span class="sd">        File Format:</span>
</span><span id="Mol.exportXYZ-388"><a href="#Mol.exportXYZ-388"><span class="linenos">388</span></a><span class="sd">            number_of_atoms</span>
</span><span id="Mol.exportXYZ-389"><a href="#Mol.exportXYZ-389"><span class="linenos">389</span></a><span class="sd">            comment_line</span>
</span><span id="Mol.exportXYZ-390"><a href="#Mol.exportXYZ-390"><span class="linenos">390</span></a><span class="sd">            element_symbol x_coord y_coord z_coord</span>
</span><span id="Mol.exportXYZ-391"><a href="#Mol.exportXYZ-391"><span class="linenos">391</span></a><span class="sd">            ...</span>
</span><span id="Mol.exportXYZ-392"><a href="#Mol.exportXYZ-392"><span class="linenos">392</span></a><span class="sd">        </span>
</span><span id="Mol.exportXYZ-393"><a href="#Mol.exportXYZ-393"><span class="linenos">393</span></a><span class="sd">        Output:</span>
</span><span id="Mol.exportXYZ-394"><a href="#Mol.exportXYZ-394"><span class="linenos">394</span></a><span class="sd">            Creates a file named &#39;{filename}.xyz&#39; in the current directory.</span>
</span><span id="Mol.exportXYZ-395"><a href="#Mol.exportXYZ-395"><span class="linenos">395</span></a><span class="sd">        </span>
</span><span id="Mol.exportXYZ-396"><a href="#Mol.exportXYZ-396"><span class="linenos">396</span></a><span class="sd">        Example:</span>
</span><span id="Mol.exportXYZ-397"><a href="#Mol.exportXYZ-397"><span class="linenos">397</span></a><span class="sd">            mol.exportXYZ(&#39;water&#39;, &#39;H2O molecule&#39;)</span>
</span><span id="Mol.exportXYZ-398"><a href="#Mol.exportXYZ-398"><span class="linenos">398</span></a><span class="sd">            # Creates &#39;water.xyz&#39; with H2O coordinates</span>
</span><span id="Mol.exportXYZ-399"><a href="#Mol.exportXYZ-399"><span class="linenos">399</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol.exportXYZ-400"><a href="#Mol.exportXYZ-400"><span class="linenos">400</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xyz&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="Mol.exportXYZ-401"><a href="#Mol.exportXYZ-401"><span class="linenos">401</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol.exportXYZ-402"><a href="#Mol.exportXYZ-402"><span class="linenos">402</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">label</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol.exportXYZ-403"><a href="#Mol.exportXYZ-403"><span class="linenos">403</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">natoms</span><span class="p">):</span>
</span><span id="Mol.exportXYZ-404"><a href="#Mol.exportXYZ-404"><span class="linenos">404</span></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atomicSpecies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol.exportXYZ-405"><a href="#Mol.exportXYZ-405"><span class="linenos">405</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>   
</span></pre></div>


            <div class="docstring"><p>Export molecular geometry to XYZ format file.</p>

<p>Creates a standard XYZ format file with atomic coordinates in Angstroms.
This method uses the molecule's current atomic species and coordinates.</p>

<p>Args:
    filename (str, optional): Base filename without extension. Defaults to 'coord'.
                             The '.xyz' extension will be automatically added.
    label (str, optional): Comment line for the XYZ file. Defaults to 
                          'Generic Mol generated by CrysX (Python Library)'.</p>

<p>File Format:
    number_of_atoms
    comment_line
    element_symbol x_coord y_coord z_coord
    ...</p>

<p>Output:
    Creates a file named '{filename}.xyz' in the current directory.</p>

<p>Example:
    mol.exportXYZ('water', 'H2O molecule')
    # Creates 'water.xyz' with H2O coordinates</p>
</div>


                            </div>
                            <div id="Mol.exportXYZs" class="classattr">
                                        <input id="Mol.exportXYZs-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">exportXYZs</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">atomicSpecies</span>,</span><span class="param">	<span class="n">coords</span>,</span><span class="param">	<span class="n">filename</span><span class="o">=</span><span class="s1">&#39;coord&#39;</span>,</span><span class="param">	<span class="n">label</span><span class="o">=</span><span class="s1">&#39;Generic Mol generated by CrysX (Python Library)&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Mol.exportXYZs-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Mol.exportXYZs"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Mol.exportXYZs-407"><a href="#Mol.exportXYZs-407"><span class="linenos">407</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exportXYZs</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;coord&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Generic Mol generated by CrysX (Python Library)&#39;</span><span class="p">):</span>
</span><span id="Mol.exportXYZs-408"><a href="#Mol.exportXYZs-408"><span class="linenos">408</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol.exportXYZs-409"><a href="#Mol.exportXYZs-409"><span class="linenos">409</span></a><span class="sd">        Export molecular geometry to XYZ format (static method version).</span>
</span><span id="Mol.exportXYZs-410"><a href="#Mol.exportXYZs-410"><span class="linenos">410</span></a><span class="sd">        </span>
</span><span id="Mol.exportXYZs-411"><a href="#Mol.exportXYZs-411"><span class="linenos">411</span></a><span class="sd">        Static method to create XYZ files from provided atomic species and coordinates,</span>
</span><span id="Mol.exportXYZs-412"><a href="#Mol.exportXYZs-412"><span class="linenos">412</span></a><span class="sd">        without requiring a Mol object instance.</span>
</span><span id="Mol.exportXYZs-413"><a href="#Mol.exportXYZs-413"><span class="linenos">413</span></a><span class="sd">        </span>
</span><span id="Mol.exportXYZs-414"><a href="#Mol.exportXYZs-414"><span class="linenos">414</span></a><span class="sd">        Args:</span>
</span><span id="Mol.exportXYZs-415"><a href="#Mol.exportXYZs-415"><span class="linenos">415</span></a><span class="sd">            atomicSpecies (list): List of atomic symbols as strings.</span>
</span><span id="Mol.exportXYZs-416"><a href="#Mol.exportXYZs-416"><span class="linenos">416</span></a><span class="sd">            coords (numpy.ndarray): Atomic coordinates in Angstroms with shape (natoms, 3).</span>
</span><span id="Mol.exportXYZs-417"><a href="#Mol.exportXYZs-417"><span class="linenos">417</span></a><span class="sd">            filename (str, optional): Base filename without extension. Defaults to &#39;coord&#39;.</span>
</span><span id="Mol.exportXYZs-418"><a href="#Mol.exportXYZs-418"><span class="linenos">418</span></a><span class="sd">                                     The &#39;.xyz&#39; extension will be automatically added.</span>
</span><span id="Mol.exportXYZs-419"><a href="#Mol.exportXYZs-419"><span class="linenos">419</span></a><span class="sd">            label (str, optional): Comment line for the XYZ file. Defaults to </span>
</span><span id="Mol.exportXYZs-420"><a href="#Mol.exportXYZs-420"><span class="linenos">420</span></a><span class="sd">                                  &#39;Generic Mol generated by CrysX (Python Library)&#39;.</span>
</span><span id="Mol.exportXYZs-421"><a href="#Mol.exportXYZs-421"><span class="linenos">421</span></a><span class="sd">        </span>
</span><span id="Mol.exportXYZs-422"><a href="#Mol.exportXYZs-422"><span class="linenos">422</span></a><span class="sd">        File Format:</span>
</span><span id="Mol.exportXYZs-423"><a href="#Mol.exportXYZs-423"><span class="linenos">423</span></a><span class="sd">            number_of_atoms</span>
</span><span id="Mol.exportXYZs-424"><a href="#Mol.exportXYZs-424"><span class="linenos">424</span></a><span class="sd">            comment_line</span>
</span><span id="Mol.exportXYZs-425"><a href="#Mol.exportXYZs-425"><span class="linenos">425</span></a><span class="sd">            element_symbol x_coord y_coord z_coord</span>
</span><span id="Mol.exportXYZs-426"><a href="#Mol.exportXYZs-426"><span class="linenos">426</span></a><span class="sd">            ...</span>
</span><span id="Mol.exportXYZs-427"><a href="#Mol.exportXYZs-427"><span class="linenos">427</span></a><span class="sd">        </span>
</span><span id="Mol.exportXYZs-428"><a href="#Mol.exportXYZs-428"><span class="linenos">428</span></a><span class="sd">        Warning:</span>
</span><span id="Mol.exportXYZs-429"><a href="#Mol.exportXYZs-429"><span class="linenos">429</span></a><span class="sd">            This method contains a bug - it references undefined variable &#39;coord&#39;</span>
</span><span id="Mol.exportXYZs-430"><a href="#Mol.exportXYZs-430"><span class="linenos">430</span></a><span class="sd">            instead of &#39;coords&#39;. Should be fixed in implementation.</span>
</span><span id="Mol.exportXYZs-431"><a href="#Mol.exportXYZs-431"><span class="linenos">431</span></a><span class="sd">        </span>
</span><span id="Mol.exportXYZs-432"><a href="#Mol.exportXYZs-432"><span class="linenos">432</span></a><span class="sd">        Note:</span>
</span><span id="Mol.exportXYZs-433"><a href="#Mol.exportXYZs-433"><span class="linenos">433</span></a><span class="sd">            This is a static method and should be called as a class method.</span>
</span><span id="Mol.exportXYZs-434"><a href="#Mol.exportXYZs-434"><span class="linenos">434</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol.exportXYZs-435"><a href="#Mol.exportXYZs-435"><span class="linenos">435</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="o">+</span><span class="s1">&#39;.xyz&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
</span><span id="Mol.exportXYZs-436"><a href="#Mol.exportXYZs-436"><span class="linenos">436</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol.exportXYZs-437"><a href="#Mol.exportXYZs-437"><span class="linenos">437</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">label</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol.exportXYZs-438"><a href="#Mol.exportXYZs-438"><span class="linenos">438</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">)):</span>
</span><span id="Mol.exportXYZs-439"><a href="#Mol.exportXYZs-439"><span class="linenos">439</span></a>            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">atomicSpecies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</span><span id="Mol.exportXYZs-440"><a href="#Mol.exportXYZs-440"><span class="linenos">440</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Export molecular geometry to XYZ format (static method version).</p>

<p>Static method to create XYZ files from provided atomic species and coordinates,
without requiring a Mol object instance.</p>

<p>Args:
    atomicSpecies (list): List of atomic symbols as strings.
    coords (numpy.ndarray): Atomic coordinates in Angstroms with shape (natoms, 3).
    filename (str, optional): Base filename without extension. Defaults to 'coord'.
                             The '.xyz' extension will be automatically added.
    label (str, optional): Comment line for the XYZ file. Defaults to 
                          'Generic Mol generated by CrysX (Python Library)'.</p>

<p>File Format:
    number_of_atoms
    comment_line
    element_symbol x_coord y_coord z_coord
    ...</p>

<p>Warning:
    This method contains a bug - it references undefined variable 'coord'
    instead of 'coords'. Should be fixed in implementation.</p>

<p>Note:
    This is a static method and should be called as a class method.</p>
</div>


                            </div>
                            <div id="Mol.readCoordsFile" class="classattr">
                                        <input id="Mol.readCoordsFile-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">readCoordsFile</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filename</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Mol.readCoordsFile-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Mol.readCoordsFile"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Mol.readCoordsFile-443"><a href="#Mol.readCoordsFile-443"><span class="linenos">443</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">readCoordsFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="Mol.readCoordsFile-444"><a href="#Mol.readCoordsFile-444"><span class="linenos">444</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol.readCoordsFile-445"><a href="#Mol.readCoordsFile-445"><span class="linenos">445</span></a><span class="sd">        Read molecular coordinates from various file formats.</span>
</span><span id="Mol.readCoordsFile-446"><a href="#Mol.readCoordsFile-446"><span class="linenos">446</span></a><span class="sd">        </span>
</span><span id="Mol.readCoordsFile-447"><a href="#Mol.readCoordsFile-447"><span class="linenos">447</span></a><span class="sd">        Currently supports XYZ format files. This method serves as a dispatcher</span>
</span><span id="Mol.readCoordsFile-448"><a href="#Mol.readCoordsFile-448"><span class="linenos">448</span></a><span class="sd">        to format-specific reading methods based on file extension.</span>
</span><span id="Mol.readCoordsFile-449"><a href="#Mol.readCoordsFile-449"><span class="linenos">449</span></a><span class="sd">        </span>
</span><span id="Mol.readCoordsFile-450"><a href="#Mol.readCoordsFile-450"><span class="linenos">450</span></a><span class="sd">        Args:</span>
</span><span id="Mol.readCoordsFile-451"><a href="#Mol.readCoordsFile-451"><span class="linenos">451</span></a><span class="sd">            filename (str): Path to the coordinate file. File format is determined</span>
</span><span id="Mol.readCoordsFile-452"><a href="#Mol.readCoordsFile-452"><span class="linenos">452</span></a><span class="sd">                           by the file extension.</span>
</span><span id="Mol.readCoordsFile-453"><a href="#Mol.readCoordsFile-453"><span class="linenos">453</span></a><span class="sd">        </span>
</span><span id="Mol.readCoordsFile-454"><a href="#Mol.readCoordsFile-454"><span class="linenos">454</span></a><span class="sd">        Returns:</span>
</span><span id="Mol.readCoordsFile-455"><a href="#Mol.readCoordsFile-455"><span class="linenos">455</span></a><span class="sd">            list: List of atoms in the format [[symbol, x, y, z], ...] where</span>
</span><span id="Mol.readCoordsFile-456"><a href="#Mol.readCoordsFile-456"><span class="linenos">456</span></a><span class="sd">                  symbol is the atomic symbol and x, y, z are coordinates in Angstroms.</span>
</span><span id="Mol.readCoordsFile-457"><a href="#Mol.readCoordsFile-457"><span class="linenos">457</span></a><span class="sd">        </span>
</span><span id="Mol.readCoordsFile-458"><a href="#Mol.readCoordsFile-458"><span class="linenos">458</span></a><span class="sd">        Supported Formats:</span>
</span><span id="Mol.readCoordsFile-459"><a href="#Mol.readCoordsFile-459"><span class="linenos">459</span></a><span class="sd">            - .xyz: Standard XYZ coordinate format</span>
</span><span id="Mol.readCoordsFile-460"><a href="#Mol.readCoordsFile-460"><span class="linenos">460</span></a><span class="sd">        </span>
</span><span id="Mol.readCoordsFile-461"><a href="#Mol.readCoordsFile-461"><span class="linenos">461</span></a><span class="sd">        Future Extensions:</span>
</span><span id="Mol.readCoordsFile-462"><a href="#Mol.readCoordsFile-462"><span class="linenos">462</span></a><span class="sd">            - .mol: MOL file format</span>
</span><span id="Mol.readCoordsFile-463"><a href="#Mol.readCoordsFile-463"><span class="linenos">463</span></a><span class="sd">            - coord: TURBOMOLE coordinate format</span>
</span><span id="Mol.readCoordsFile-464"><a href="#Mol.readCoordsFile-464"><span class="linenos">464</span></a><span class="sd">            - Other quantum chemistry input formats</span>
</span><span id="Mol.readCoordsFile-465"><a href="#Mol.readCoordsFile-465"><span class="linenos">465</span></a><span class="sd">        </span>
</span><span id="Mol.readCoordsFile-466"><a href="#Mol.readCoordsFile-466"><span class="linenos">466</span></a><span class="sd">        Raises:</span>
</span><span id="Mol.readCoordsFile-467"><a href="#Mol.readCoordsFile-467"><span class="linenos">467</span></a><span class="sd">            Prints error message if file format is not supported.</span>
</span><span id="Mol.readCoordsFile-468"><a href="#Mol.readCoordsFile-468"><span class="linenos">468</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol.readCoordsFile-469"><a href="#Mol.readCoordsFile-469"><span class="linenos">469</span></a>        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.xyz&#39;</span><span class="p">):</span>
</span><span id="Mol.readCoordsFile-470"><a href="#Mol.readCoordsFile-470"><span class="linenos">470</span></a>            <span class="n">atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readXYZ</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</span><span id="Mol.readCoordsFile-471"><a href="#Mol.readCoordsFile-471"><span class="linenos">471</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Mol.readCoordsFile-472"><a href="#Mol.readCoordsFile-472"><span class="linenos">472</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Only xyz files for now&#39;</span><span class="p">)</span> 
</span><span id="Mol.readCoordsFile-473"><a href="#Mol.readCoordsFile-473"><span class="linenos">473</span></a>        <span class="k">return</span> <span class="n">atoms</span>
</span></pre></div>


            <div class="docstring"><p>Read molecular coordinates from various file formats.</p>

<p>Currently supports XYZ format files. This method serves as a dispatcher
to format-specific reading methods based on file extension.</p>

<p>Args:
    filename (str): Path to the coordinate file. File format is determined
                   by the file extension.</p>

<p>Returns:
    list: List of atoms in the format [[symbol, x, y, z], ...] where
          symbol is the atomic symbol and x, y, z are coordinates in Angstroms.</p>

<p>Supported Formats:
    - .xyz: Standard XYZ coordinate format</p>

<p>Future Extensions:
    - .mol: MOL file format
    - coord: TURBOMOLE coordinate format
    - Other quantum chemistry input formats</p>

<p>Raises:
    Prints error message if file format is not supported.</p>
</div>


                            </div>
                            <div id="Mol.readXYZ" class="classattr">
                                        <input id="Mol.readXYZ-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">readXYZ</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">filename</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Mol.readXYZ-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Mol.readXYZ"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Mol.readXYZ-475"><a href="#Mol.readXYZ-475"><span class="linenos">475</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">readXYZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
</span><span id="Mol.readXYZ-476"><a href="#Mol.readXYZ-476"><span class="linenos">476</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Mol.readXYZ-477"><a href="#Mol.readXYZ-477"><span class="linenos">477</span></a><span class="sd">        Read molecular geometry from an XYZ format file.</span>
</span><span id="Mol.readXYZ-478"><a href="#Mol.readXYZ-478"><span class="linenos">478</span></a><span class="sd">        </span>
</span><span id="Mol.readXYZ-479"><a href="#Mol.readXYZ-479"><span class="linenos">479</span></a><span class="sd">        Parses a standard XYZ file and extracts atomic symbols and coordinates.</span>
</span><span id="Mol.readXYZ-480"><a href="#Mol.readXYZ-480"><span class="linenos">480</span></a><span class="sd">        The XYZ format consists of:</span>
</span><span id="Mol.readXYZ-481"><a href="#Mol.readXYZ-481"><span class="linenos">481</span></a><span class="sd">        - Line 1: Number of atoms</span>
</span><span id="Mol.readXYZ-482"><a href="#Mol.readXYZ-482"><span class="linenos">482</span></a><span class="sd">        - Line 2: Comment line (ignored)</span>
</span><span id="Mol.readXYZ-483"><a href="#Mol.readXYZ-483"><span class="linenos">483</span></a><span class="sd">        - Lines 3+: atomic_symbol x_coordinate y_coordinate z_coordinate</span>
</span><span id="Mol.readXYZ-484"><a href="#Mol.readXYZ-484"><span class="linenos">484</span></a><span class="sd">        </span>
</span><span id="Mol.readXYZ-485"><a href="#Mol.readXYZ-485"><span class="linenos">485</span></a><span class="sd">        Args:</span>
</span><span id="Mol.readXYZ-486"><a href="#Mol.readXYZ-486"><span class="linenos">486</span></a><span class="sd">            filename (str): Path to the XYZ file to read.</span>
</span><span id="Mol.readXYZ-487"><a href="#Mol.readXYZ-487"><span class="linenos">487</span></a><span class="sd">        </span>
</span><span id="Mol.readXYZ-488"><a href="#Mol.readXYZ-488"><span class="linenos">488</span></a><span class="sd">        Returns:</span>
</span><span id="Mol.readXYZ-489"><a href="#Mol.readXYZ-489"><span class="linenos">489</span></a><span class="sd">            list: List of atoms in format [[symbol, x, y, z], ...] where:</span>
</span><span id="Mol.readXYZ-490"><a href="#Mol.readXYZ-490"><span class="linenos">490</span></a><span class="sd">                  - symbol (str): Atomic symbol (e.g., &#39;H&#39;, &#39;C&#39;, &#39;O&#39;)</span>
</span><span id="Mol.readXYZ-491"><a href="#Mol.readXYZ-491"><span class="linenos">491</span></a><span class="sd">                  - x, y, z (float): Coordinates in Angstroms</span>
</span><span id="Mol.readXYZ-492"><a href="#Mol.readXYZ-492"><span class="linenos">492</span></a><span class="sd">        </span>
</span><span id="Mol.readXYZ-493"><a href="#Mol.readXYZ-493"><span class="linenos">493</span></a><span class="sd">        File Format Expected:</span>
</span><span id="Mol.readXYZ-494"><a href="#Mol.readXYZ-494"><span class="linenos">494</span></a><span class="sd">            number_of_atoms</span>
</span><span id="Mol.readXYZ-495"><a href="#Mol.readXYZ-495"><span class="linenos">495</span></a><span class="sd">            comment_line</span>
</span><span id="Mol.readXYZ-496"><a href="#Mol.readXYZ-496"><span class="linenos">496</span></a><span class="sd">            element_symbol x_coord y_coord z_coord</span>
</span><span id="Mol.readXYZ-497"><a href="#Mol.readXYZ-497"><span class="linenos">497</span></a><span class="sd">            element_symbol x_coord y_coord z_coord</span>
</span><span id="Mol.readXYZ-498"><a href="#Mol.readXYZ-498"><span class="linenos">498</span></a><span class="sd">            ...</span>
</span><span id="Mol.readXYZ-499"><a href="#Mol.readXYZ-499"><span class="linenos">499</span></a><span class="sd">        </span>
</span><span id="Mol.readXYZ-500"><a href="#Mol.readXYZ-500"><span class="linenos">500</span></a><span class="sd">        Error Handling:</span>
</span><span id="Mol.readXYZ-501"><a href="#Mol.readXYZ-501"><span class="linenos">501</span></a><span class="sd">            - Prints error if the number of atoms read doesn&#39;t match the declared count</span>
</span><span id="Mol.readXYZ-502"><a href="#Mol.readXYZ-502"><span class="linenos">502</span></a><span class="sd">            - Assumes coordinates are separated by whitespace</span>
</span><span id="Mol.readXYZ-503"><a href="#Mol.readXYZ-503"><span class="linenos">503</span></a><span class="sd">            - Strips whitespace from all input</span>
</span><span id="Mol.readXYZ-504"><a href="#Mol.readXYZ-504"><span class="linenos">504</span></a><span class="sd">        </span>
</span><span id="Mol.readXYZ-505"><a href="#Mol.readXYZ-505"><span class="linenos">505</span></a><span class="sd">        Example:</span>
</span><span id="Mol.readXYZ-506"><a href="#Mol.readXYZ-506"><span class="linenos">506</span></a><span class="sd">            For a file &#39;water.xyz&#39;:</span>
</span><span id="Mol.readXYZ-507"><a href="#Mol.readXYZ-507"><span class="linenos">507</span></a><span class="sd">            3</span>
</span><span id="Mol.readXYZ-508"><a href="#Mol.readXYZ-508"><span class="linenos">508</span></a><span class="sd">            Water molecule</span>
</span><span id="Mol.readXYZ-509"><a href="#Mol.readXYZ-509"><span class="linenos">509</span></a><span class="sd">            O    0.000000    0.000000    0.000000</span>
</span><span id="Mol.readXYZ-510"><a href="#Mol.readXYZ-510"><span class="linenos">510</span></a><span class="sd">            H    0.000000    0.000000    0.970000</span>
</span><span id="Mol.readXYZ-511"><a href="#Mol.readXYZ-511"><span class="linenos">511</span></a><span class="sd">            H    0.944863    0.000000   -0.242498</span>
</span><span id="Mol.readXYZ-512"><a href="#Mol.readXYZ-512"><span class="linenos">512</span></a><span class="sd">            </span>
</span><span id="Mol.readXYZ-513"><a href="#Mol.readXYZ-513"><span class="linenos">513</span></a><span class="sd">            Returns: [[&#39;O&#39;, 0.0, 0.0, 0.0], [&#39;H&#39;, 0.0, 0.0, 0.97], [&#39;H&#39;, 0.944863, 0.0, -0.242498]]</span>
</span><span id="Mol.readXYZ-514"><a href="#Mol.readXYZ-514"><span class="linenos">514</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Mol.readXYZ-515"><a href="#Mol.readXYZ-515"><span class="linenos">515</span></a>        <span class="n">natoms</span><span class="o">=</span><span class="mi">0</span>
</span><span id="Mol.readXYZ-516"><a href="#Mol.readXYZ-516"><span class="linenos">516</span></a>        <span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Mol.readXYZ-517"><a href="#Mol.readXYZ-517"><span class="linenos">517</span></a>        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</span><span id="Mol.readXYZ-518"><a href="#Mol.readXYZ-518"><span class="linenos">518</span></a>        <span class="n">fileContentsInString</span><span class="o">=</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="Mol.readXYZ-519"><a href="#Mol.readXYZ-519"><span class="linenos">519</span></a>        <span class="n">lines</span> <span class="o">=</span> <span class="n">fileContentsInString</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="Mol.readXYZ-520"><a href="#Mol.readXYZ-520"><span class="linenos">520</span></a>        <span class="n">currentLineNo</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Mol.readXYZ-521"><a href="#Mol.readXYZ-521"><span class="linenos">521</span></a>        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="Mol.readXYZ-522"><a href="#Mol.readXYZ-522"><span class="linenos">522</span></a>            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="Mol.readXYZ-523"><a href="#Mol.readXYZ-523"><span class="linenos">523</span></a>            <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
</span><span id="Mol.readXYZ-524"><a href="#Mol.readXYZ-524"><span class="linenos">524</span></a>                <span class="k">if</span> <span class="n">currentLineNo</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
</span><span id="Mol.readXYZ-525"><a href="#Mol.readXYZ-525"><span class="linenos">525</span></a>                    <span class="n">natoms</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="Mol.readXYZ-526"><a href="#Mol.readXYZ-526"><span class="linenos">526</span></a>                <span class="k">if</span> <span class="n">currentLineNo</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
</span><span id="Mol.readXYZ-527"><a href="#Mol.readXYZ-527"><span class="linenos">527</span></a>                    <span class="c1">#Do nothing: Comment line</span>
</span><span id="Mol.readXYZ-528"><a href="#Mol.readXYZ-528"><span class="linenos">528</span></a>                    <span class="n">currentLineNo</span> <span class="o">=</span> <span class="n">currentLineNo</span> 
</span><span id="Mol.readXYZ-529"><a href="#Mol.readXYZ-529"><span class="linenos">529</span></a>                <span class="k">if</span> <span class="n">currentLineNo</span><span class="o">&gt;=</span><span class="mi">3</span> <span class="ow">and</span> <span class="n">currentLineNo</span><span class="o">&lt;=</span><span class="n">natoms</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span>
</span><span id="Mol.readXYZ-530"><a href="#Mol.readXYZ-530"><span class="linenos">530</span></a>                    <span class="n">splitLine</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="Mol.readXYZ-531"><a href="#Mol.readXYZ-531"><span class="linenos">531</span></a>                    <span class="n">atomicSpecie</span> <span class="o">=</span> <span class="n">splitLine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="Mol.readXYZ-532"><a href="#Mol.readXYZ-532"><span class="linenos">532</span></a>                    <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">splitLine</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="Mol.readXYZ-533"><a href="#Mol.readXYZ-533"><span class="linenos">533</span></a>                    <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">splitLine</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="Mol.readXYZ-534"><a href="#Mol.readXYZ-534"><span class="linenos">534</span></a>                    <span class="n">z</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">splitLine</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
</span><span id="Mol.readXYZ-535"><a href="#Mol.readXYZ-535"><span class="linenos">535</span></a>                    <span class="n">atoms</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">atomicSpecie</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span>
</span><span id="Mol.readXYZ-536"><a href="#Mol.readXYZ-536"><span class="linenos">536</span></a>                
</span><span id="Mol.readXYZ-537"><a href="#Mol.readXYZ-537"><span class="linenos">537</span></a>                <span class="n">currentLineNo</span> <span class="o">=</span> <span class="n">currentLineNo</span> <span class="o">+</span> <span class="mi">1</span>   
</span><span id="Mol.readXYZ-538"><a href="#Mol.readXYZ-538"><span class="linenos">538</span></a>        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">natoms</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)):</span>
</span><span id="Mol.readXYZ-539"><a href="#Mol.readXYZ-539"><span class="linenos">539</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: Couldnt read all the atoms&#39;</span><span class="p">)</span>
</span><span id="Mol.readXYZ-540"><a href="#Mol.readXYZ-540"><span class="linenos">540</span></a>        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span id="Mol.readXYZ-541"><a href="#Mol.readXYZ-541"><span class="linenos">541</span></a>
</span><span id="Mol.readXYZ-542"><a href="#Mol.readXYZ-542"><span class="linenos">542</span></a>        <span class="k">return</span> <span class="n">atoms</span>
</span></pre></div>


            <div class="docstring"><p>Read molecular geometry from an XYZ format file.</p>

<p>Parses a standard XYZ file and extracts atomic symbols and coordinates.
The XYZ format consists of:</p>

<ul>
<li>Line 1: Number of atoms</li>
<li>Line 2: Comment line (ignored)</li>
<li>Lines 3+: atomic_symbol x_coordinate y_coordinate z_coordinate</li>
</ul>

<p>Args:
    filename (str): Path to the XYZ file to read.</p>

<p>Returns:
    list: List of atoms in format [[symbol, x, y, z], ...] where:
          - symbol (str): Atomic symbol (e.g., 'H', 'C', 'O')
          - x, y, z (float): Coordinates in Angstroms</p>

<p>File Format Expected:
    number_of_atoms
    comment_line
    element_symbol x_coord y_coord z_coord
    element_symbol x_coord y_coord z_coord
    ...</p>

<p>Error Handling:
    - Prints error if the number of atoms read doesn't match the declared count
    - Assumes coordinates are separated by whitespace
    - Strips whitespace from all input</p>

<p>Example:
    For a file 'water.xyz':
    3
    Water molecule
    O    0.000000    0.000000    0.000000
    H    0.000000    0.000000    0.970000
    H    0.944863    0.000000   -0.242498</p>

<pre><code>Returns: [['O', 0.0, 0.0, 0.0], ['H', 0.0, 0.0, 0.97], ['H', 0.944863, 0.0, -0.242498]]
</code></pre>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>