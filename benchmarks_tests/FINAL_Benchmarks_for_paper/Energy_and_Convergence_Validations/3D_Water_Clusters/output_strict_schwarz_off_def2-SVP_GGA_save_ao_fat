/home/lu29vow/.local/lib/python3.8/site-packages/cupy/_environment.py:447: UserWarning: 
--------------------------------------------------------------------------------

  CuPy may not function correctly because multiple CuPy packages are installed
  in your environment:

    cupy, cupy-cuda11x

  Follow these steps to resolve this issue:

    1. For all packages listed above, run the following command to remove all
       existing CuPy installations:

         $ pip uninstall <package_name>

      If you previously installed CuPy via conda, also run the following:

         $ conda uninstall cupy

    2. Install the appropriate CuPy package.
       Refer to the Installation Guide for detailed instructions.

         https://docs.cupy.dev/en/stable/install.html

--------------------------------------------------------------------------------

  warnings.warn(f'''
Cupy is not installed. GPU acceleration is not availble.
Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 9334 32-Core Processor
Number of Cores: 64
Number of Threads: 128
Memory (GB): 2267.59
Number of cores being actually used/requested for the benchmark: 48
Confirming that the environment variables are properly set...
OMP_NUM_THREADS = 48
OPENBLAS_NUM_THREADS = 48
MKL_NUM_THREADS = 48
VECLIB_MAXIMUM_THREADS = 48
NUMEXPR_NUM_THREADS = 48
PYSCF_MAX_MEMORY = 1500000

============================================================
Processing: ../../Structures/water_cluster_1.xyz
============================================================
#INFO: **** input file is /home/lu29vow/PyFock/benchmarks_tests/FINAL_Benchmarks_for_paper/Energy_and_Convergence_Validations/3D_Water_Clusters/benchmark_DFT_LDA_DF.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
#numba.config.THREADING_LAYER='tbb'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 48
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(1500000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)


basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'cc-pVDZ'


auxbasis_name = 'def2-universal-jfit'

# List of all molecules to calculate
xyz_files = [
    '../../Structures/water_cluster_1.xyz',
    '../../Structures/water_cluster_5.xyz',
    '../../Structures/water_cluster_10.xyz',
    '../../Structures/water_cluster_20.xyz',
    '../../Structures/water_cluster_32.xyz',
    '../../Structures/water_cluster_47.xyz',
    '../../Structures/water_cluster_76.xyz',
    '../../Structures/water_cluster_100.xyz',
    '../../Structures/water_cluster_139.xyz',
]


# Loop through all molecules
for xyzFilename in xyz_files:
    print(f"\n{'='*60}")
    print(f"Processing: {xyzFilename}")
    print(f"{'='*60}")

    # ---------PySCF---------------
    #Comparison with PySCF
    molPySCF = gto.Mole()
    molPySCF.atom = xyzFilename
    molPySCF.basis = basis_set_name
    molPySCF.cart = True
    molPySCF.verbose = 4
    molPySCF.max_memory=1500000
    molPySCF.build()

    print('\n\nPySCF Results\n\n')
    start=timer()
    mf = dft.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
    mf.xc = funcidpyscf
    mf.verbose = 4
    mf.direct_scf = False
    mf.init_guess = 'minao'
    dmat_init = mf.init_guess_by_minao(molPySCF)
    mf.max_cycle = 50
    mf.conv_tol = 1e-7
    mf.grids.level = 3
    energyPyscf = mf.kernel(dm0=dmat_init)
    print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
    print('One electron integrals energy',mf.scf_summary['e1'])
    print('Coulomb energy ',mf.scf_summary['coul'])
    print('EXC ',mf.scf_summary['exc'])
    duration = timer()-start
    print('PySCF time: ', duration)
    pyscfGrids = mf.grids
    print('PySCF Grid Size: ', pyscfGrids.weights.shape)
    print('\n\n PySCF Dipole moment')
    dmat = mf.make_rdm1()
    mol_dip_pyscf = mf.dip_moment(molPySCF, dmat, unit='AU')
    mf = 0

    #--------------------CrysX --------------------------

    #Initialize a Mol object with somewhat large geometry
    molCrysX = Mol(coordfile=xyzFilename)

    #Initialize a Basis object with a very large basis set
    basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})

    auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})

    dftObj = DFT(molCrysX, basis, auxbasis, xc=funcidcrysx, grids=pyscfGrids)
    dftObj.dmat = dmat_init
    dftObj.conv_crit = 1e-7
    dftObj.max_itr = 50
    dftObj.ncores = ncores
    dftObj.save_ao_values = True
    dftObj.rys = True
    dftObj.DF_algo = 10
    dftObj.blocksize = 5000
    dftObj.XC_algo = 2
    dftObj.debug = False
    dftObj.sortGrids = False
    dftObj.xc_bf_screen = True
    dftObj.threshold_schwarz = 1e-9
    dftObj.strict_schwarz = False
    dftObj.cholesky = True
    dftObj.orthogonalize = True
    # SAO or CAO basis
    dftObj.sao = False

    # GPU acceleration
    dftObj.use_gpu = False
    dftObj.keep_ao_in_gpu = False
    dftObj.use_libxc = False
    dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
    dftObj.n_gpus = 1 # Specify the number of GPUs
    dftObj.free_gpu_mem = True
    dftObj.threads_x = 32
    dftObj.threads_y = 32
    dftObj.dynamic_precision = False
    dftObj.keep_ints3c2e_in_gpu = True


    # Using PySCF grids to compare the energies
    energyCrysX, dmat = dftObj.scf()


    print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf))

    print('\n\nPyFock Dipole moment')
    M = Integrals.dipole_moment_mat_symm(basis)
    mol_dip = molCrysX.get_dipole_moment(M, dmat)
    print('Dipole moment(X, Y, Z, A.U.):', *mol_dip)
    print('Max Diff dipole moment (PySCF-CrysX)', abs(mol_dip_pyscf-mol_dip).max())

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
# import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
# print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='fat04.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64', processor='x86_64')  Threads 48
Python 3.8.6 (default, Oct 28 2021, 14:43:29) 
[GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]
numpy 1.22.4  scipy 1.7.1  h5py 3.5.0
Date: Mon Aug 11 09:16:54 2025
PySCF version 2.7.0
PySCF path  /home/lu29vow/.local/lib/python3.8/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 1500000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 3
[INPUT] num. electrons = 10
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Cartesian GTO integrals (6d 10f)
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 O     99.814000000000 100.835000000000 101.232000000000 AA  188.621123397337 190.550533770518 191.300755041970 Bohr   0.0
[INPUT]  2 H     99.329200000000  99.976800000000 101.063000000000 AA  187.704984172148 188.928770810416 190.981391326919 Bohr   0.0
[INPUT]  3 H     99.151600000000 101.561000000000 101.414000000000 AA  187.369368812425 191.922474936952 191.644685196641 Bohr   0.0

nuclear repulsion = 8.79298854522529
number of shells = 12
number of NR pGTOs = 39
number of NR cGTOs = 25
basis = def2-SVP
ecp = {}
CPU time:         8.21


PySCF Results


Initial guess from minao.


******** <class 'pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = False
chkfile to save SCF result = /tmp/tmplhsx2eck
max_memory 1500000 MB (current use 326 MB)
XC library pyscf.dft.libxc version 6.1.0
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1–5 (2018)
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14fef7d784c0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14fef7dcce50>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 33704
init E= -76.1883198798052
  HOMO = -0.392551484072277  LUMO = -0.0149628659679211
cycle= 1 E= -76.1648977838698  delta_E= 0.0234  |g|= 0.759  |ddm|= 1.39
  HOMO = -0.0358005137929344  LUMO = 0.0702304723712618
cycle= 2 E= -75.9055939025069  delta_E= 0.259  |g|= 1.37  |ddm|= 1.55
  HOMO = -0.233398656169745  LUMO = 0.0160874809751819
cycle= 3 E= -76.2714356355122  delta_E= -0.366  |g|= 0.0371  |ddm|= 1.13
  HOMO = -0.222644536079465  LUMO = 0.0198742637312956
cycle= 4 E= -76.2717432709137  delta_E= -0.000308  |g|= 0.00823  |ddm|= 0.0346
  HOMO = -0.223352720357989  LUMO = 0.0188700226940072
cycle= 5 E= -76.2717537770276  delta_E= -1.05e-05  |g|= 0.00143  |ddm|= 0.00373
  HOMO = -0.22361909577725  LUMO = 0.0187870144982907
cycle= 6 E= -76.2717541952536  delta_E= -4.18e-07  |g|= 4.39e-05  |ddm|= 0.00113
  HOMO = -0.223623700766797  LUMO = 0.01877720524404
cycle= 7 E= -76.2717541958835  delta_E= -6.3e-10  |g|= 4.71e-06  |ddm|= 6.14e-05
  HOMO = -0.223624558595402  LUMO = 0.0187778810890842
Extra cycle  E= -76.271754195881  delta_E= 2.49e-12  |g|= 6.54e-06  |ddm|= 8.26e-06
converged SCF energy = -76.271754195881
Nuc-Nuc PySCF=  8.792988545225288
One electron integrals energy -122.36074239363737
Coulomb energy  46.51210611726816
EXC  -9.216106464737129
PySCF time:  0.4085693819215521
PySCF Grid Size:  (30720,)


 PySCF Dipole moment
Dipole moment(X, Y, Z, A.U.): -0.73592, -0.08463,  0.00838

============================================================
PyFock Python Program for Quantum Chemistry Simulations
                                        by Manas Sharma
============================================================
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m[38;5;45m█[0m  [38;5;51m█[0m[38;5;51m█[0m    [38;5;87m█[0m[38;5;87m█[0m [38;5;123m█[0m[38;5;123m█[0m[38;5;123m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m  [38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m   [38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m   [38;5;213m█[0m[38;5;213m█[0m
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m█[0m[38;5;45m█[0m [38;5;45m░[0m[38;5;45m█[0m[38;5;51m█[0m  [38;5;51m█[0m[38;5;51m█[0m[38;5;87m░[0m [38;5;87m█[0m[38;5;87m█[0m[38;5;87m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m [38;5;159m█[0m[38;5;159m█[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;219m░[0m [38;5;219m█[0m[38;5;219m█[0m  [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m 
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m   [38;5;45m░[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m░[0m  [38;5;87m█[0m[38;5;87m█[0m[38;5;87m█[0m[38;5;123m█[0m[38;5;123m█[0m   [38;5;159m█[0m[38;5;159m█[0m    [38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m      [38;5;219m█[0m[38;5;219m█[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m  
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m░[0m[38;5;45m░[0m    [38;5;51m░[0m[38;5;51m█[0m[38;5;87m█[0m[38;5;87m░[0m   [38;5;123m█[0m[38;5;123m█[0m[38;5;123m░[0m[38;5;159m░[0m[38;5;159m░[0m   [38;5;195m█[0m[38;5;195m█[0m    [38;5;225m█[0m[38;5;219m█[0m [38;5;219m█[0m[38;5;219m█[0m      [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m 
[38;5;39m█[0m[38;5;39m█[0m         [38;5;51m█[0m[38;5;87m█[0m    [38;5;123m█[0m[38;5;123m█[0m      [38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;219m░[0m [38;5;219m░[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m  [38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m
[38;5;39m░[0m[38;5;39m░[0m         [38;5;51m░[0m[38;5;87m░[0m    [38;5;123m░[0m[38;5;123m░[0m       [38;5;195m░[0m[38;5;195m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m   [38;5;219m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m [38;5;213m░[0m[38;5;213m░[0m   [38;5;213m░[0m[38;5;213m░[0m

============================================================


Number of atoms: 3


Number of basis functions (atomic orbitals): 25


Number of auxiliary basis functions: 85


================================================================================


Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 9334 32-Core Processor
Number of Cores: 64
Number of Threads: 128
Memory (GB): 2267.59
Running DFT using 48 threads for Numba.



Calculating one electron integrals...


Core H size in GB  5e-06
done!
Time taken 0.28524816199205816 seconds.

Stricter version of Schwarz screening:  False

Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.023815752007067204 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.025832745945081115
Time taken to evaluate the square roots needed:  5.072704516351223e-05
Time for significant indices evaluation:  0.006114647025242448
Size of permanent array storing the significant indices of 3c2e ERI in GB  7.808e-06
No. of elements in the standard three-centered two electron ERI tensor:  53125
No. of elements in the triangular three-centered two electron ERI tensor:  27625
No. of significant triplets based on Schwarz inequality and triangularity: 27625 or 52.0% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.03334305202588439 seconds.

Two Center Two electron ERI size in GB  5.78e-05
Three Center Two electron ERI size in GB  0.000221
Three-centered two electron evaluation done!
Time taken for Cholesky factorization of two-centered two-electron integrals 0.001954911043867469 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  0.09825711196754128 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  30720
Size (in GB) for storing the coordinates of grid:       0.00073728
Size (in GB) for storing the weights of grid:           0.00024576
Size (in GB) for storing the density at gridpoints:     0.00024576

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  5000
No. of batches:  7

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 0.007804329041391611 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    25
Average no. of basis functions contributing to a batch of grid points:    23

You have asked to save the values of significant basis functions and their gradients on grid points so as to avoid recalculation for each SCF cycle.
Please note: This will require addtional memory that is approximately :0.0 GB
Calculating the value of significantly contributing basis functions (atomic orbitals)...
done!
Time taken 0.023704965016804636 seconds.



------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Number of electrons:  10.015624541132611



------Iteration 1--------


Energies

Electron-Nuclear Energy         -196.8725983637345
Nuclear repulsion Energy           8.7929885452488
Kinetic Energy                    75.7521863919201
Coulomb Energy                    45.1763830862684
Exchange-Correlation Energy       -9.0880198939453
--------------------------------------------------
Total Energy                     -76.2390602342424
--------------------------------------------------



Energy difference :  76.23906023424243


HOMO-LUMO gap: 0.3665206431285739 au
HOMO-LUMO gap: 9.974 eV


Time taken for the previous iteration: 0.12009072198998183


Number of electrons:  9.999999953351734



------Iteration 2--------


Energies

Electron-Nuclear Energy         -201.5649336578454
Nuclear repulsion Energy           8.7929885452488
Kinetic Energy                    77.1871792057042
Coulomb Energy                    48.8954320370357
Exchange-Correlation Energy       -9.4911393561590
--------------------------------------------------
Total Energy                     -76.1804732260157
--------------------------------------------------



Energy difference :  0.05858700822668084


HOMO-LUMO gap: 0.13265997333941115 au
HOMO-LUMO gap: 3.610 eV


Time taken for the previous iteration: 0.05397241096943617


Number of electrons:  9.999999982350875



------Iteration 3--------


Energies

Electron-Nuclear Energy         -191.1575675164897
Nuclear repulsion Energy           8.7929885452488
Kinetic Energy                    72.3092535392115
Coulomb Energy                    42.8044563872953
Exchange-Correlation Energy       -8.7916423838794
--------------------------------------------------
Total Energy                     -76.0425114286134
--------------------------------------------------



Energy difference :  0.13796179740231196


HOMO-LUMO gap: 0.24644574893259197 au
HOMO-LUMO gap: 6.706 eV


Time taken for the previous iteration: 0.05965587089303881


Number of electrons:  9.999999966581122



------Iteration 4--------


Energies

Electron-Nuclear Energy         -197.7951948109048
Nuclear repulsion Energy           8.7929885452488
Kinetic Energy                    75.3665695414206
Coulomb Energy                    46.5891024781568
Exchange-Correlation Energy       -9.2250664966491
--------------------------------------------------
Total Energy                     -76.2716007427277
--------------------------------------------------



Energy difference :  0.2290893141142618


HOMO-LUMO gap: 0.2439271980604376 au
HOMO-LUMO gap: 6.638 eV


Time taken for the previous iteration: 0.07380538294091821


Number of electrons:  9.999999965432998



------Iteration 5--------


Energies

Electron-Nuclear Energy         -197.7174694654969
Nuclear repulsion Energy           8.7929885452488
Kinetic Energy                    75.3344720216177
Coulomb Energy                    46.5371960906400
Exchange-Correlation Energy       -9.2189264557744
--------------------------------------------------
Total Energy                     -76.2717392637648
--------------------------------------------------



Energy difference :  0.00013852103707279184


HOMO-LUMO gap: 0.2425068947822302 au
HOMO-LUMO gap: 6.599 eV


Time taken for the previous iteration: 0.07463768497109413


Number of electrons:  9.999999965788522



------Iteration 6--------


Energies

Electron-Nuclear Energy         -197.6826593562012
Nuclear repulsion Energy           8.7929885452488
Kinetic Energy                    75.3190388654025
Coulomb Energy                    46.5153863427159
Exchange-Correlation Energy       -9.2165084235250
--------------------------------------------------
Total Energy                     -76.2717540263589
--------------------------------------------------



Energy difference :  1.4762594176431776e-05


HOMO-LUMO gap: 0.2424015951571894 au
HOMO-LUMO gap: 6.596 eV


Time taken for the previous iteration: 0.0748858789447695


Number of electrons:  9.99999996577705



------Iteration 7--------


Energies

Electron-Nuclear Energy         -197.6764684603689
Nuclear repulsion Energy           8.7929885452488
Kinetic Energy                    75.3157828833500
Coulomb Energy                    46.5120383635115
Exchange-Correlation Energy       -9.2160955274223
--------------------------------------------------
Total Energy                     -76.2717541956809
--------------------------------------------------



Energy difference :  1.6932195023855456e-07


HOMO-LUMO gap: 0.24240202443934944 au
HOMO-LUMO gap: 6.596 eV


Time taken for the previous iteration: 0.0743351390119642


Number of electrons:  9.999999965779567



------Iteration 8--------


Energies

Electron-Nuclear Energy         -197.6766287823649
Nuclear repulsion Energy           8.7929885452488
Kinetic Energy                    75.3158925430091
Coulomb Energy                    46.5120994006808
Exchange-Correlation Energy       -9.2161059024370
--------------------------------------------------
Total Energy                     -76.2717541958632
--------------------------------------------------



Energy difference :  1.822684225771809e-10

SCF Converged after 8 iterations!

-------------------------------------
Total Energy =  -76.27175419586317
-------------------------------------



Time taken : 1.056450531934388 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           0.03150929405819625
Density Fitting                         0.22346211597323418
    DF (gamma)                          0.1266714809462428
    DF (coeff)                          0.03190790326334536
    DF (Jtri)                           0.047283734078519046
    DF (Cholesky)                       0.001954911043867469
DIIS                                    0.015985163976438344
KS matrix diagonalization               0.020904781762510538
One electron Integrals (S, T, Vnuc)     0.28524816199205816
Coulomb Integrals (2c2e + 3c2e)         0.09630220092367381
Grids construction                      0
Exchange-Correlation Term               0.30982935428619385
Misc.                                   0.07320945896208286
Complete SCF                            1.056450531934388
Energy diff (PySCF-CrysX) 1.787725523172412e-11


PyFock Dipole moment
Dipole moment(X, Y, Z, A.U.): -0.7359185976631579 -0.08462801833093181 0.008377760785833743
Max Diff dipole moment (PySCF-CrysX) 4.568419853967498e-06

============================================================
Processing: ../../Structures/water_cluster_5.xyz
============================================================
#INFO: **** input file is /home/lu29vow/PyFock/benchmarks_tests/FINAL_Benchmarks_for_paper/Energy_and_Convergence_Validations/3D_Water_Clusters/benchmark_DFT_LDA_DF.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
#numba.config.THREADING_LAYER='tbb'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 48
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(1500000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)


basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'cc-pVDZ'


auxbasis_name = 'def2-universal-jfit'

# List of all molecules to calculate
xyz_files = [
    '../../Structures/water_cluster_1.xyz',
    '../../Structures/water_cluster_5.xyz',
    '../../Structures/water_cluster_10.xyz',
    '../../Structures/water_cluster_20.xyz',
    '../../Structures/water_cluster_32.xyz',
    '../../Structures/water_cluster_47.xyz',
    '../../Structures/water_cluster_76.xyz',
    '../../Structures/water_cluster_100.xyz',
    '../../Structures/water_cluster_139.xyz',
]


# Loop through all molecules
for xyzFilename in xyz_files:
    print(f"\n{'='*60}")
    print(f"Processing: {xyzFilename}")
    print(f"{'='*60}")

    # ---------PySCF---------------
    #Comparison with PySCF
    molPySCF = gto.Mole()
    molPySCF.atom = xyzFilename
    molPySCF.basis = basis_set_name
    molPySCF.cart = True
    molPySCF.verbose = 4
    molPySCF.max_memory=1500000
    molPySCF.build()

    print('\n\nPySCF Results\n\n')
    start=timer()
    mf = dft.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
    mf.xc = funcidpyscf
    mf.verbose = 4
    mf.direct_scf = False
    mf.init_guess = 'minao'
    dmat_init = mf.init_guess_by_minao(molPySCF)
    mf.max_cycle = 50
    mf.conv_tol = 1e-7
    mf.grids.level = 3
    energyPyscf = mf.kernel(dm0=dmat_init)
    print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
    print('One electron integrals energy',mf.scf_summary['e1'])
    print('Coulomb energy ',mf.scf_summary['coul'])
    print('EXC ',mf.scf_summary['exc'])
    duration = timer()-start
    print('PySCF time: ', duration)
    pyscfGrids = mf.grids
    print('PySCF Grid Size: ', pyscfGrids.weights.shape)
    print('\n\n PySCF Dipole moment')
    dmat = mf.make_rdm1()
    mol_dip_pyscf = mf.dip_moment(molPySCF, dmat, unit='AU')
    mf = 0

    #--------------------CrysX --------------------------

    #Initialize a Mol object with somewhat large geometry
    molCrysX = Mol(coordfile=xyzFilename)

    #Initialize a Basis object with a very large basis set
    basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})

    auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})

    dftObj = DFT(molCrysX, basis, auxbasis, xc=funcidcrysx, grids=pyscfGrids)
    dftObj.dmat = dmat_init
    dftObj.conv_crit = 1e-7
    dftObj.max_itr = 50
    dftObj.ncores = ncores
    dftObj.save_ao_values = True
    dftObj.rys = True
    dftObj.DF_algo = 10
    dftObj.blocksize = 5000
    dftObj.XC_algo = 2
    dftObj.debug = False
    dftObj.sortGrids = False
    dftObj.xc_bf_screen = True
    dftObj.threshold_schwarz = 1e-9
    dftObj.strict_schwarz = False
    dftObj.cholesky = True
    dftObj.orthogonalize = True
    # SAO or CAO basis
    dftObj.sao = False

    # GPU acceleration
    dftObj.use_gpu = False
    dftObj.keep_ao_in_gpu = False
    dftObj.use_libxc = False
    dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
    dftObj.n_gpus = 1 # Specify the number of GPUs
    dftObj.free_gpu_mem = True
    dftObj.threads_x = 32
    dftObj.threads_y = 32
    dftObj.dynamic_precision = False
    dftObj.keep_ints3c2e_in_gpu = True


    # Using PySCF grids to compare the energies
    energyCrysX, dmat = dftObj.scf()


    print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf))

    print('\n\nPyFock Dipole moment')
    M = Integrals.dipole_moment_mat_symm(basis)
    mol_dip = molCrysX.get_dipole_moment(M, dmat)
    print('Dipole moment(X, Y, Z, A.U.):', *mol_dip)
    print('Max Diff dipole moment (PySCF-CrysX)', abs(mol_dip_pyscf-mol_dip).max())

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
# import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
# print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='fat04.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64', processor='x86_64')  Threads 48
Python 3.8.6 (default, Oct 28 2021, 14:43:29) 
[GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]
numpy 1.22.4  scipy 1.7.1  h5py 3.5.0
Date: Mon Aug 11 09:17:02 2025
PySCF version 2.7.0
PySCF path  /home/lu29vow/.local/lib/python3.8/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 1500000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 15
[INPUT] num. electrons = 50
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Cartesian GTO integrals (6d 10f)
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 O     99.814000000000 100.835000000000 101.232000000000 AA  188.621123397337 190.550533770518 191.300755041970 Bohr   0.0
[INPUT]  2 H     99.329200000000  99.976800000000 101.063000000000 AA  187.704984172148 188.928770810416 190.981391326919 Bohr   0.0
[INPUT]  3 H     99.151600000000 101.561000000000 101.414000000000 AA  187.369368812425 191.922474936952 191.644685196641 Bohr   0.0
[INPUT]  4 O     98.804000000000  98.512200000000  97.758100000000 AA  186.712500011526 186.161077928378 184.736035457844 Bohr   0.0
[INPUT]  5 H     99.782100000000  98.646900000000  97.916700000000 AA  188.560841133963 186.415624037357 185.035746021200 Bohr   0.0
[INPUT]  6 H     98.421800000000  99.326500000000  97.321300000000 AA  185.990246686718 187.699881911612 183.910603086634 Bohr   0.0
[INPUT]  7 O     98.070300000000  98.516900000000 100.438000000000 AA  185.326007953933 186.169959641164 189.800312499066 Bohr   0.0
[INPUT]  8 H     97.172800000000  98.878600000000 100.690000000000 AA  183.629978757136 186.853473580419 190.276523482456 Bohr   0.0
[INPUT]  9 H     98.194000000000  98.592200000000  99.448100000000 AA  185.559767075542 186.312256018344 187.929672608359 Bohr   0.0
[INPUT] 10 O    102.360000000000 101.551000000000  99.964500000000 AA  193.432366110480 191.903577675707 188.905527179084 Bohr   0.0
[INPUT] 11 H    102.675000000000 102.370000000000 100.444000000000 AA  194.027629839718 193.451263371725 189.811650855813 Bohr   0.0
[INPUT] 12 H    101.556000000000 101.180000000000 100.430000000000 AA  191.913026306329 191.202489283493 189.785194690069 Bohr   0.0
[INPUT] 13 O    101.665000000000  98.316100000000  98.319400000000 AA  192.119006453907 185.790502635351 185.796738731562 Bohr   0.0
[INPUT] 14 H    101.904000000000  99.233800000000  98.002000000000 AA  192.570650997678 187.524704299864 185.196939659625 Bohr   0.0
[INPUT] 15 H    102.224000000000  97.640900000000  97.837700000000 AA  193.175363357539 184.514559556045 184.886457657359 Bohr   0.0

nuclear repulsion = 188.657977043618
number of shells = 60
number of NR pGTOs = 195
number of NR cGTOs = 125
basis = def2-SVP
ecp = {}
CPU time:        82.79


PySCF Results


Initial guess from minao.


******** <class 'pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = False
chkfile to save SCF result = /tmp/tmpxx7c8pwr
max_memory 1500000 MB (current use 643 MB)
XC library pyscf.dft.libxc version 6.1.0
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1–5 (2018)
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14fef7d784c0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14fef7dcce50>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 168496
init E= -381.053540645589
  HOMO = -0.393943391899515  LUMO = -0.0507200725480046
cycle= 1 E= -380.960844246896  delta_E= 0.0927  |g|= 1.59  |ddm|= 3.09
  HOMO = -0.000194740340365963  LUMO = 0.0436744857228761
cycle= 2 E= -379.891377390385  delta_E= 1.07  |g|= 2.83  |ddm|= 3.24
  HOMO = -0.194262013726692  LUMO = -0.015540289357804
cycle= 3 E= -381.424788756155  delta_E= -1.53  |g|= 0.109  |ddm|= 2.32
  HOMO = -0.196084375129539  LUMO = -0.00838903668396896
cycle= 4 E= -381.424758976449  delta_E= 2.98e-05  |g|= 0.118  |ddm|= 0.155
  HOMO = -0.189835887378797  LUMO = -0.00912293268648056
cycle= 5 E= -381.427195653435  delta_E= -0.00244  |g|= 0.0143  |ddm|= 0.0828
  HOMO = -0.189921787965773  LUMO = -0.00978746183931025
cycle= 6 E= -381.427225051689  delta_E= -2.94e-05  |g|= 0.00654  |ddm|= 0.0123
  HOMO = -0.190481485121845  LUMO = -0.00978613196359584
cycle= 7 E= -381.427232162829  delta_E= -7.11e-06  |g|= 0.00173  |ddm|= 0.00516
  HOMO = -0.19047104901504  LUMO = -0.00982225556425666
cycle= 8 E= -381.427232688849  delta_E= -5.26e-07  |g|= 0.000242  |ddm|= 0.00126
  HOMO = -0.190461249148429  LUMO = -0.00982671658145972
cycle= 9 E= -381.427232699016  delta_E= -1.02e-08  |g|= 9.83e-05  |ddm|= 0.000242
  HOMO = -0.190487879070736  LUMO = -0.00982719358730752
Extra cycle  E= -381.427232694881  delta_E= 4.13e-09  |g|= 0.000182  |ddm|= 0.000183
converged SCF energy = -381.427232694881
Nuc-Nuc PySCF=  188.65797704361805
One electron integrals energy -901.1637657065014
Coulomb energy  377.15522735418017
EXC  -46.076671386178305
PySCF time:  1.0677834880771115
PySCF Grid Size:  (150696,)


 PySCF Dipole moment
Dipole moment(X, Y, Z, A.U.): -0.63024,  0.81925, -0.87006

============================================================
PyFock Python Program for Quantum Chemistry Simulations
                                        by Manas Sharma
============================================================
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m[38;5;45m█[0m  [38;5;51m█[0m[38;5;51m█[0m    [38;5;87m█[0m[38;5;87m█[0m [38;5;123m█[0m[38;5;123m█[0m[38;5;123m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m  [38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m   [38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m   [38;5;213m█[0m[38;5;213m█[0m
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m█[0m[38;5;45m█[0m [38;5;45m░[0m[38;5;45m█[0m[38;5;51m█[0m  [38;5;51m█[0m[38;5;51m█[0m[38;5;87m░[0m [38;5;87m█[0m[38;5;87m█[0m[38;5;87m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m [38;5;159m█[0m[38;5;159m█[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;219m░[0m [38;5;219m█[0m[38;5;219m█[0m  [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m 
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m   [38;5;45m░[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m░[0m  [38;5;87m█[0m[38;5;87m█[0m[38;5;87m█[0m[38;5;123m█[0m[38;5;123m█[0m   [38;5;159m█[0m[38;5;159m█[0m    [38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m      [38;5;219m█[0m[38;5;219m█[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m  
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m░[0m[38;5;45m░[0m    [38;5;51m░[0m[38;5;51m█[0m[38;5;87m█[0m[38;5;87m░[0m   [38;5;123m█[0m[38;5;123m█[0m[38;5;123m░[0m[38;5;159m░[0m[38;5;159m░[0m   [38;5;195m█[0m[38;5;195m█[0m    [38;5;225m█[0m[38;5;219m█[0m [38;5;219m█[0m[38;5;219m█[0m      [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m 
[38;5;39m█[0m[38;5;39m█[0m         [38;5;51m█[0m[38;5;87m█[0m    [38;5;123m█[0m[38;5;123m█[0m      [38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;219m░[0m [38;5;219m░[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m  [38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m
[38;5;39m░[0m[38;5;39m░[0m         [38;5;51m░[0m[38;5;87m░[0m    [38;5;123m░[0m[38;5;123m░[0m       [38;5;195m░[0m[38;5;195m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m   [38;5;219m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m [38;5;213m░[0m[38;5;213m░[0m   [38;5;213m░[0m[38;5;213m░[0m

============================================================


Number of atoms: 15


Number of basis functions (atomic orbitals): 125


Number of auxiliary basis functions: 425


================================================================================


Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 9334 32-Core Processor
Number of Cores: 64
Number of Threads: 128
Memory (GB): 2267.59
Running DFT using 48 threads for Numba.



Calculating one electron integrals...


Core H size in GB  0.000125
done!
Time taken 0.007601683959364891 seconds.

Stricter version of Schwarz screening:  False

Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.014529054053127766 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.0023596490500494838
Time taken to evaluate the square roots needed:  0.00011364102829247713
Time for significant indices evaluation:  0.0005850099259987473
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.000189008
No. of elements in the standard three-centered two electron ERI tensor:  6640625
No. of elements in the triangular three-centered two electron ERI tensor:  3346875
No. of significant triplets based on Schwarz inequality and triangularity: 2476220 or 37.3% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.004604005021974444 seconds.

Two Center Two electron ERI size in GB  0.001445
Three Center Two electron ERI size in GB  0.01980976
Three-centered two electron evaluation done!
Time taken for Cholesky factorization of two-centered two-electron integrals 0.001475068973377347 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  0.16601969592738897 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  150696
Size (in GB) for storing the coordinates of grid:       0.003616704
Size (in GB) for storing the weights of grid:           0.001205568
Size (in GB) for storing the density at gridpoints:     0.001205568

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  5000
No. of batches:  31

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 0.019831640063785017 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    115
Average no. of basis functions contributing to a batch of grid points:    81

You have asked to save the values of significant basis functions and their gradients on grid points so as to avoid recalculation for each SCF cycle.
Please note: This will require addtional memory that is approximately :0.4 GB
Calculating the value of significantly contributing basis functions (atomic orbitals)...
done!
Time taken 0.05798293394036591 seconds.



------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Number of electrons:  50.08008473716244



------Iteration 1--------


Energies

Electron-Nuclear Energy        -1274.3790474517627
Nuclear repulsion Energy         188.6579770441236
Kinetic Energy                   378.9027100626675
Coulomb Energy                   371.0274322882910
Exchange-Correlation Energy      -45.4961212921582
--------------------------------------------------
Total Energy                    -381.2870493488390
--------------------------------------------------



Energy difference :  381.28704934883905


HOMO-LUMO gap: 0.3338903283737027 au
HOMO-LUMO gap: 9.086 eV


Time taken for the previous iteration: 0.28766639810055494


Number of electrons:  50.00000746845647



------Iteration 2--------


Energies

Electron-Nuclear Energy        -1296.3884556743672
Nuclear repulsion Energy         188.6579770441236
Kinetic Energy                   385.4799701256925
Coulomb Energy                   388.6085265605784
Exchange-Correlation Energy      -47.3844000772764
--------------------------------------------------
Total Energy                    -381.0263820212493
--------------------------------------------------



Energy difference :  0.26066732758977196


HOMO-LUMO gap: 0.0699177304193137 au
HOMO-LUMO gap: 1.903 eV


Time taken for the previous iteration: 0.26589759497437626


Number of electrons:  50.00002351553615



------Iteration 3--------


Energies

Electron-Nuclear Energy        -1246.2416439434460
Nuclear repulsion Energy         188.6579770441236
Kinetic Energy                   362.0715661167031
Coulomb Energy                   359.1527889448212
Exchange-Correlation Energy      -44.0566608551777
--------------------------------------------------
Total Energy                    -380.4159726929757
--------------------------------------------------



Energy difference :  0.6104093282735903


HOMO-LUMO gap: 0.17732505371334817 au
HOMO-LUMO gap: 4.825 eV


Time taken for the previous iteration: 0.20065951789729297


Number of electrons:  50.00001204916915



------Iteration 4--------


Energies

Electron-Nuclear Energy        -1278.1817313541478
Nuclear repulsion Energy         188.6579770441236
Kinetic Energy                   376.7122009233340
Coulomb Energy                   377.4981327254179
Exchange-Correlation Energy      -46.1123408706054
--------------------------------------------------
Total Energy                    -381.4257615318777
--------------------------------------------------



Energy difference :  1.0097888389020113


HOMO-LUMO gap: 0.18681530165985816 au
HOMO-LUMO gap: 5.083 eV


Time taken for the previous iteration: 0.3106875460362062


Number of electrons:  50.00001201301511



------Iteration 5--------


Energies

Electron-Nuclear Energy        -1277.8747149346789
Nuclear repulsion Energy         188.6579770441236
Kinetic Energy                   376.6102737335140
Coulomb Energy                   377.2711110842729
Exchange-Correlation Energy      -46.0907494959953
--------------------------------------------------
Total Energy                    -381.4261025687636
--------------------------------------------------



Energy difference :  0.0003410368859135815


HOMO-LUMO gap: 0.18117394976477552 au
HOMO-LUMO gap: 4.930 eV


Time taken for the previous iteration: 0.3843764230841771


Number of electrons:  50.00001215461246



------Iteration 6--------


Energies

Electron-Nuclear Energy        -1277.7654317833187
Nuclear repulsion Energy         188.6579770441236
Kinetic Energy                   376.5563514012737
Coulomb Energy                   377.2067170846362
Exchange-Correlation Energy      -46.0828123500040
--------------------------------------------------
Total Energy                    -381.4271986032891
--------------------------------------------------



Energy difference :  0.0010960345255170978


HOMO-LUMO gap: 0.18036163129433636 au
HOMO-LUMO gap: 4.908 eV


Time taken for the previous iteration: 0.3644950990565121


Number of electrons:  50.00001218151495



------Iteration 7--------


Energies

Electron-Nuclear Energy        -1277.6970277272083
Nuclear repulsion Energy         188.6579770441236
Kinetic Energy                   376.5231818524081
Coulomb Energy                   377.1665091201830
Exchange-Correlation Energy      -46.0778678735597
--------------------------------------------------
Total Energy                    -381.4272275840532
--------------------------------------------------



Energy difference :  2.898076411383954e-05


HOMO-LUMO gap: 0.18073291593629648 au
HOMO-LUMO gap: 4.918 eV


Time taken for the previous iteration: 0.2665829570032656


Number of electrons:  50.0000121731552



------Iteration 8--------


Energies

Electron-Nuclear Energy        -1277.6859840324103
Nuclear repulsion Energy         188.6579770441236
Kinetic Energy                   376.5181160637434
Coulomb Energy                   377.1598135736980
Exchange-Correlation Energy      -46.0771551594765
--------------------------------------------------
Total Energy                    -381.4272325103217
--------------------------------------------------



Energy difference :  4.926268445615278e-06


HOMO-LUMO gap: 0.18065555339192674 au
HOMO-LUMO gap: 4.916 eV


Time taken for the previous iteration: 0.2502723829820752


Number of electrons:  50.00001217603525



------Iteration 9--------


Energies

Electron-Nuclear Energy        -1277.6792538729246
Nuclear repulsion Energy         188.6579770441236
Kinetic Energy                   376.5150183566892
Coulomb Energy                   377.1557823459760
Exchange-Correlation Energy      -46.0767565906120
--------------------------------------------------
Total Energy                    -381.4272327167478
--------------------------------------------------



Energy difference :  2.0642613662857912e-07


HOMO-LUMO gap: 0.18063338935599837 au
HOMO-LUMO gap: 4.915 eV


Time taken for the previous iteration: 0.2018703599460423


Number of electrons:  50.00001217631631



------Iteration 10--------


Energies

Electron-Nuclear Energy        -1277.6778402189927
Nuclear repulsion Energy         188.6579770441236
Kinetic Energy                   376.5142152381767
Coulomb Energy                   377.1550621842966
Exchange-Correlation Energy      -46.0766469686056
--------------------------------------------------
Total Energy                    -381.4272327210013
--------------------------------------------------



Energy difference :  4.253479346516542e-09

SCF Converged after 10 iterations!

-------------------------------------
Total Energy =  -381.4272327210013
-------------------------------------



Time taken : 3.0122485919855535 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           0.07781457400415093
Density Fitting                         0.4908284110715613
    DF (gamma)                          0.2640174558619037
    DF (coeff)                          0.031551536871120334
    DF (Jtri)                           0.17111410002689809
    DF (Cholesky)                       0.001475068973377347
DIIS                                    0.09369083412457258
KS matrix diagonalization               0.1053036100929603
One electron Integrals (S, T, Vnuc)     0.007601683959364891
Coulomb Integrals (2c2e + 3c2e)         0.16454462695401162
Grids construction                      0
Exchange-Correlation Term               1.9993868018500507
Misc.                                   0.07307804992888123
Complete SCF                            3.0122485919855535
Energy diff (PySCF-CrysX) 2.6119835183635587e-08


PyFock Dipole moment
Dipole moment(X, Y, Z, A.U.): -0.6302729292765434 0.8193014272328583 -0.8701352307252819
Max Diff dipole moment (PySCF-CrysX) 7.281579382834025e-05

============================================================
Processing: ../../Structures/water_cluster_10.xyz
============================================================
#INFO: **** input file is /home/lu29vow/PyFock/benchmarks_tests/FINAL_Benchmarks_for_paper/Energy_and_Convergence_Validations/3D_Water_Clusters/benchmark_DFT_LDA_DF.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
#numba.config.THREADING_LAYER='tbb'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 48
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(1500000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)


basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'cc-pVDZ'


auxbasis_name = 'def2-universal-jfit'

# List of all molecules to calculate
xyz_files = [
    '../../Structures/water_cluster_1.xyz',
    '../../Structures/water_cluster_5.xyz',
    '../../Structures/water_cluster_10.xyz',
    '../../Structures/water_cluster_20.xyz',
    '../../Structures/water_cluster_32.xyz',
    '../../Structures/water_cluster_47.xyz',
    '../../Structures/water_cluster_76.xyz',
    '../../Structures/water_cluster_100.xyz',
    '../../Structures/water_cluster_139.xyz',
]


# Loop through all molecules
for xyzFilename in xyz_files:
    print(f"\n{'='*60}")
    print(f"Processing: {xyzFilename}")
    print(f"{'='*60}")

    # ---------PySCF---------------
    #Comparison with PySCF
    molPySCF = gto.Mole()
    molPySCF.atom = xyzFilename
    molPySCF.basis = basis_set_name
    molPySCF.cart = True
    molPySCF.verbose = 4
    molPySCF.max_memory=1500000
    molPySCF.build()

    print('\n\nPySCF Results\n\n')
    start=timer()
    mf = dft.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
    mf.xc = funcidpyscf
    mf.verbose = 4
    mf.direct_scf = False
    mf.init_guess = 'minao'
    dmat_init = mf.init_guess_by_minao(molPySCF)
    mf.max_cycle = 50
    mf.conv_tol = 1e-7
    mf.grids.level = 3
    energyPyscf = mf.kernel(dm0=dmat_init)
    print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
    print('One electron integrals energy',mf.scf_summary['e1'])
    print('Coulomb energy ',mf.scf_summary['coul'])
    print('EXC ',mf.scf_summary['exc'])
    duration = timer()-start
    print('PySCF time: ', duration)
    pyscfGrids = mf.grids
    print('PySCF Grid Size: ', pyscfGrids.weights.shape)
    print('\n\n PySCF Dipole moment')
    dmat = mf.make_rdm1()
    mol_dip_pyscf = mf.dip_moment(molPySCF, dmat, unit='AU')
    mf = 0

    #--------------------CrysX --------------------------

    #Initialize a Mol object with somewhat large geometry
    molCrysX = Mol(coordfile=xyzFilename)

    #Initialize a Basis object with a very large basis set
    basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})

    auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})

    dftObj = DFT(molCrysX, basis, auxbasis, xc=funcidcrysx, grids=pyscfGrids)
    dftObj.dmat = dmat_init
    dftObj.conv_crit = 1e-7
    dftObj.max_itr = 50
    dftObj.ncores = ncores
    dftObj.save_ao_values = True
    dftObj.rys = True
    dftObj.DF_algo = 10
    dftObj.blocksize = 5000
    dftObj.XC_algo = 2
    dftObj.debug = False
    dftObj.sortGrids = False
    dftObj.xc_bf_screen = True
    dftObj.threshold_schwarz = 1e-9
    dftObj.strict_schwarz = False
    dftObj.cholesky = True
    dftObj.orthogonalize = True
    # SAO or CAO basis
    dftObj.sao = False

    # GPU acceleration
    dftObj.use_gpu = False
    dftObj.keep_ao_in_gpu = False
    dftObj.use_libxc = False
    dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
    dftObj.n_gpus = 1 # Specify the number of GPUs
    dftObj.free_gpu_mem = True
    dftObj.threads_x = 32
    dftObj.threads_y = 32
    dftObj.dynamic_precision = False
    dftObj.keep_ints3c2e_in_gpu = True


    # Using PySCF grids to compare the energies
    energyCrysX, dmat = dftObj.scf()


    print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf))

    print('\n\nPyFock Dipole moment')
    M = Integrals.dipole_moment_mat_symm(basis)
    mol_dip = molCrysX.get_dipole_moment(M, dmat)
    print('Dipole moment(X, Y, Z, A.U.):', *mol_dip)
    print('Max Diff dipole moment (PySCF-CrysX)', abs(mol_dip_pyscf-mol_dip).max())

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
# import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
# print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='fat04.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64', processor='x86_64')  Threads 48
Python 3.8.6 (default, Oct 28 2021, 14:43:29) 
[GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]
numpy 1.22.4  scipy 1.7.1  h5py 3.5.0
Date: Mon Aug 11 09:17:06 2025
PySCF version 2.7.0
PySCF path  /home/lu29vow/.local/lib/python3.8/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 1500000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 30
[INPUT] num. electrons = 100
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Cartesian GTO integrals (6d 10f)
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 O     97.873900000000 103.017000000000 100.816000000000 AA  184.954865743068 194.673916174319 190.514628974151 Bohr   0.0
[INPUT]  2 H     98.128600000000 103.038000000000  99.848800000000 AA  185.436178986995 194.713600422935 188.686885866472 Bohr   0.0
[INPUT]  3 H     97.173800000000 102.317000000000 100.960000000000 AA  183.631868483260 193.351107887123 190.786749536089 Bohr   0.0
[INPUT]  4 O     99.814000000000 100.835000000000 101.232000000000 AA  188.621123397337 190.550533770518 191.300755041970 Bohr   0.0
[INPUT]  5 H     99.329200000000  99.976800000000 101.063000000000 AA  187.704984172148 188.928770810416 190.981391326919 Bohr   0.0
[INPUT]  6 H     99.151600000000 101.561000000000 101.414000000000 AA  187.369368812425 191.922474936952 191.644685196641 Bohr   0.0
[INPUT]  7 O     98.804000000000  98.512200000000  97.758100000000 AA  186.712500011526 186.161077928378 184.736035457844 Bohr   0.0
[INPUT]  8 H     99.782100000000  98.646900000000  97.916700000000 AA  188.560841133963 186.415624037357 185.035746021200 Bohr   0.0
[INPUT]  9 H     98.421800000000  99.326500000000  97.321300000000 AA  185.990246686718 187.699881911612 183.910603086634 Bohr   0.0
[INPUT] 10 O    100.747000000000 100.164000000000 103.736000000000 AA  190.384237871556 189.282527540935 196.032629257881 Bohr   0.0
[INPUT] 11 H    100.658000000000 100.628000000000 102.855000000000 AA  190.216052246470 190.159360462733 194.367780542139 Bohr   0.0
[INPUT] 12 H    100.105000000000  99.398600000000 103.776000000000 AA  189.171033699586 187.836131165193 196.108218302864 Bohr   0.0
[INPUT] 13 O     98.070300000000  98.516900000000 100.438000000000 AA  185.326007953933 186.169959641164 189.800312499066 Bohr   0.0
[INPUT] 14 H     97.172800000000  98.878600000000 100.690000000000 AA  183.629978757136 186.853473580419 190.276523482456 Bohr   0.0
[INPUT] 15 H     98.194000000000  98.592200000000  99.448100000000 AA  185.559767075542 186.312256018344 187.929672608359 Bohr   0.0
[INPUT] 16 O     98.548000000000 101.265000000000  97.248600000000 AA  186.228730123638 191.363116004081 183.773219997378 Bohr   0.0
[INPUT] 17 H     98.688900000000 102.140000000000  97.711000000000 AA  186.494992534589 193.016626363075 184.647029357377 Bohr   0.0
[INPUT] 18 H     97.919900000000 101.391000000000  96.480800000000 AA  185.041793144798 191.601221495776 182.322288278937 Bohr   0.0
[INPUT] 19 O    102.891000000000 100.842000000000  97.477600000000 AA  194.435810682624 190.563761853390 184.205967279903 Bohr   0.0
[INPUT] 20 H    103.837000000000 100.662000000000  97.209700000000 AA  196.223491596462 190.223611150968 183.699709651132 Bohr   0.0
[INPUT] 21 H    102.868000000000 101.166000000000  98.423400000000 AA  194.392346981759 191.176033117749 185.993270248517 Bohr   0.0
[INPUT] 22 O    102.360000000000 101.551000000000  99.964500000000 AA  193.432366110480 191.903577675707 188.905527179084 Bohr   0.0
[INPUT] 23 H    102.675000000000 102.370000000000 100.444000000000 AA  194.027629839718 193.451263371725 189.811650855813 Bohr   0.0
[INPUT] 24 H    101.556000000000 101.180000000000 100.430000000000 AA  191.913026306329 191.202489283493 189.785194690069 Bohr   0.0
[INPUT] 25 O    101.836000000000  97.446700000000 102.110000000000 AA  192.442149621208 184.147574742654 192.959934579338 Bohr   0.0
[INPUT] 26 H    100.860000000000  97.397400000000 101.898000000000 AA  190.597776923632 184.054411244713 192.559312640931 Bohr   0.0
[INPUT] 27 H    101.991000000000  97.133400000000 103.047000000000 AA  192.735057170515 183.555523547828 194.730607958056 Bohr   0.0
[INPUT] 28 O    101.665000000000  98.316100000000  98.319400000000 AA  192.119006453907 185.790502635351 185.796738731562 Bohr   0.0
[INPUT] 29 H    101.904000000000  99.233800000000  98.002000000000 AA  192.570650997678 187.524704299864 185.196939659625 Bohr   0.0
[INPUT] 30 H    102.224000000000  97.640900000000  97.837700000000 AA  193.175363357539 184.514559556045 184.886457657359 Bohr   0.0

nuclear repulsion = 647.706546115498
number of shells = 120
number of NR pGTOs = 390
number of NR cGTOs = 250
basis = def2-SVP
ecp = {}
CPU time:       268.55


PySCF Results


Initial guess from minao.


******** <class 'pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = False
chkfile to save SCF result = /tmp/tmpx7k82qtd
max_memory 1500000 MB (current use 1460 MB)
XC library pyscf.dft.libxc version 6.1.0
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1–5 (2018)
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14fef7d784c0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14fef7dcce50>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 336984
init E= -762.171722033874
  HOMO = -0.394591674873002  LUMO = -0.0757003032564759
cycle= 1 E= -761.941011762101  delta_E= 0.231  |g|= 2.23  |ddm|= 4.38
  HOMO = -0.00505787826329023  LUMO = 0.0168256457400403
cycle= 2 E= -758.207733890755  delta_E= 3.73  |g|= 4.28  |ddm|= 6.29
  HOMO = -0.158823285763391  LUMO = -0.0855643591973947
cycle= 3 E= -762.679583653588  delta_E= -4.47  |g|= 0.95  |ddm|= 5.43
  HOMO = -0.211342368189735  LUMO = -0.0391745781098225
cycle= 4 E= -762.849123952959  delta_E= -0.17  |g|=  0.2  |ddm|= 0.611
  HOMO = -0.188921332647122  LUMO = -0.0581592986492766
cycle= 5 E= -762.858075510701  delta_E= -0.00895  |g|= 0.117  |ddm|= 0.261
  HOMO = -0.183410754256351  LUMO = -0.0603734932983372
cycle= 6 E= -762.860036985954  delta_E= -0.00196  |g|= 0.0549  |ddm|= 0.108
  HOMO = -0.179080043027024  LUMO = -0.0603340917655767
cycle= 7 E= -762.860558180842  delta_E= -0.000521  |g|= 0.00937  |ddm|= 0.0408
  HOMO = -0.178967049009328  LUMO = -0.060630830999693
cycle= 8 E= -762.860569477494  delta_E= -1.13e-05  |g|= 0.00559  |ddm|= 0.00959
  HOMO = -0.179186745828119  LUMO = -0.0607379833528405
cycle= 9 E= -762.860574960774  delta_E= -5.48e-06  |g|= 0.000761  |ddm|= 0.00422
  HOMO = -0.179142847364016  LUMO = -0.0607310130644274
cycle= 10 E= -762.86057506427  delta_E= -1.03e-07  |g|= 0.000229  |ddm|= 0.000663
  HOMO = -0.179119370301444  LUMO = -0.0607406214246368
cycle= 11 E= -762.860575071824  delta_E= -7.55e-09  |g|= 0.000113  |ddm|= 0.000221
  HOMO = -0.179116222464554  LUMO = -0.0607427583271847
Extra cycle  E= -762.860575065841  delta_E= 5.98e-09  |g|= 0.000216  |ddm|= 0.000222
converged SCF energy = -762.860575065841
Nuc-Nuc PySCF=  647.7065461154975
One electron integrals energy -2342.9752049216204
Coulomb energy  1024.5691742910205
EXC  -92.16109055073822
PySCF time:  3.8320933469804004
PySCF Grid Size:  (295424,)


 PySCF Dipole moment
Dipole moment(X, Y, Z, A.U.): -1.83204,  1.61363, -1.41319

============================================================
PyFock Python Program for Quantum Chemistry Simulations
                                        by Manas Sharma
============================================================
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m[38;5;45m█[0m  [38;5;51m█[0m[38;5;51m█[0m    [38;5;87m█[0m[38;5;87m█[0m [38;5;123m█[0m[38;5;123m█[0m[38;5;123m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m  [38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m   [38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m   [38;5;213m█[0m[38;5;213m█[0m
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m█[0m[38;5;45m█[0m [38;5;45m░[0m[38;5;45m█[0m[38;5;51m█[0m  [38;5;51m█[0m[38;5;51m█[0m[38;5;87m░[0m [38;5;87m█[0m[38;5;87m█[0m[38;5;87m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m [38;5;159m█[0m[38;5;159m█[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;219m░[0m [38;5;219m█[0m[38;5;219m█[0m  [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m 
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m   [38;5;45m░[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m░[0m  [38;5;87m█[0m[38;5;87m█[0m[38;5;87m█[0m[38;5;123m█[0m[38;5;123m█[0m   [38;5;159m█[0m[38;5;159m█[0m    [38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m      [38;5;219m█[0m[38;5;219m█[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m  
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m░[0m[38;5;45m░[0m    [38;5;51m░[0m[38;5;51m█[0m[38;5;87m█[0m[38;5;87m░[0m   [38;5;123m█[0m[38;5;123m█[0m[38;5;123m░[0m[38;5;159m░[0m[38;5;159m░[0m   [38;5;195m█[0m[38;5;195m█[0m    [38;5;225m█[0m[38;5;219m█[0m [38;5;219m█[0m[38;5;219m█[0m      [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m 
[38;5;39m█[0m[38;5;39m█[0m         [38;5;51m█[0m[38;5;87m█[0m    [38;5;123m█[0m[38;5;123m█[0m      [38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;219m░[0m [38;5;219m░[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m  [38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m
[38;5;39m░[0m[38;5;39m░[0m         [38;5;51m░[0m[38;5;87m░[0m    [38;5;123m░[0m[38;5;123m░[0m       [38;5;195m░[0m[38;5;195m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m   [38;5;219m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m [38;5;213m░[0m[38;5;213m░[0m   [38;5;213m░[0m[38;5;213m░[0m

============================================================


Number of atoms: 30


Number of basis functions (atomic orbitals): 250


Number of auxiliary basis functions: 850


================================================================================


Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 9334 32-Core Processor
Number of Cores: 64
Number of Threads: 128
Memory (GB): 2267.59
Running DFT using 48 threads for Numba.



Calculating one electron integrals...


Core H size in GB  0.0005
done!
Time taken 0.01936313498299569 seconds.

Stricter version of Schwarz screening:  False

Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.02799207402858883 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.0046942910412326455
Time taken to evaluate the square roots needed:  0.0003483939217403531
Time for significant indices evaluation:  0.001199834980070591
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.0007530079999999999
No. of elements in the standard three-centered two electron ERI tensor:  53125000
No. of elements in the triangular three-centered two electron ERI tensor:  26668750
No. of significant triplets based on Schwarz inequality and triangularity: 15057630 or 28.3% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.007769595948047936 seconds.

Two Center Two electron ERI size in GB  0.00578
Three Center Two electron ERI size in GB  0.12046104
Three-centered two electron evaluation done!
Time taken for Cholesky factorization of two-centered two-electron integrals 0.010224788915365934 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  0.6845970050198957 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  295424
Size (in GB) for storing the coordinates of grid:       0.007090176
Size (in GB) for storing the weights of grid:           0.002363392
Size (in GB) for storing the density at gridpoints:     0.002363392

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  5000
No. of batches:  60

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 0.09093981503974646 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    209
Average no. of basis functions contributing to a batch of grid points:    142

You have asked to save the values of significant basis functions and their gradients on grid points so as to avoid recalculation for each SCF cycle.
Please note: This will require addtional memory that is approximately :1.3 GB
Calculating the value of significantly contributing basis functions (atomic orbitals)...
done!
Time taken 0.11820796004030854 seconds.



------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Number of electrons:  100.17352736615459



------Iteration 1--------


Energies

Electron-Nuclear Energy        -3090.7369993318134
Nuclear repulsion Energy         647.7065461172319
Kinetic Energy                   757.8678518437401
Coulomb Energy                  1013.5508322951841
Exchange-Correlation Energy      -91.0313360570867
--------------------------------------------------
Total Energy                    -762.6431051327440
--------------------------------------------------



Energy difference :  762.643105132744


HOMO-LUMO gap: 0.3082963735094872 au
HOMO-LUMO gap: 8.389 eV


Time taken for the previous iteration: 0.5283942149253562


Number of electrons:  100.0000017723235



------Iteration 2--------


Energies

Electron-Nuclear Energy        -3133.0313727401585
Nuclear repulsion Energy         647.7065461172319
Kinetic Energy                   770.8324532541998
Coulomb Energy                  1047.1752478261458
Exchange-Correlation Energy      -94.7537096553892
--------------------------------------------------
Total Energy                    -762.0708351979704
--------------------------------------------------



Energy difference :  0.572269934773658


HOMO-LUMO gap: 0.00522259108689388 au
HOMO-LUMO gap: 0.142 eV


Time taken for the previous iteration: 0.4209996190620586


Number of electrons:  100.00046450306182



------Iteration 3--------


Energies

Electron-Nuclear Energy        -3027.5741999537090
Nuclear repulsion Energy         647.7065461172319
Kinetic Energy                   722.7840251718306
Coulomb Energy                   985.4758092147372
Exchange-Correlation Energy      -87.6395342765568
--------------------------------------------------
Total Energy                    -759.2473537264659
--------------------------------------------------



Energy difference :  2.823481471504465


HOMO-LUMO gap: 0.059659285796307415 au
HOMO-LUMO gap: 1.623 eV


Time taken for the previous iteration: 0.5743608849588782


Number of electrons:  100.00001655538941



------Iteration 4--------


Energies

Electron-Nuclear Energy        -3094.0994475570701
Nuclear repulsion Energy         647.7065461172319
Kinetic Energy                   752.3235357522481
Coulomb Energy                  1023.4706381982585
Exchange-Correlation Energy      -92.0561551839736
--------------------------------------------------
Total Energy                    -762.6548826733053
--------------------------------------------------



Energy difference :  3.4075289468394203


HOMO-LUMO gap: 0.16789356250063392 au
HOMO-LUMO gap: 4.569 eV


Time taken for the previous iteration: 0.5293354609748349


Number of electrons:  100.0000128414974



------Iteration 5--------


Energies

Electron-Nuclear Energy        -3098.0168677044308
Nuclear repulsion Energy         647.7065461172319
Kinetic Energy                   753.9260260992371
Coulomb Energy                  1025.8319964623386
Exchange-Correlation Energy      -92.2973659780772
--------------------------------------------------
Total Energy                    -762.8496650037002
--------------------------------------------------



Energy difference :  0.19478233039490078


HOMO-LUMO gap: 0.15033988614899663 au
HOMO-LUMO gap: 4.091 eV


Time taken for the previous iteration: 0.8503178210230544


Number of electrons:  100.0000170076063



------Iteration 6--------


Energies

Electron-Nuclear Energy        -3096.8680344418358
Nuclear repulsion Energy         647.7065461172319
Kinetic Energy                   753.4825948761378
Coulomb Energy                  1025.0422180003015
Exchange-Correlation Energy      -92.2198240667056
--------------------------------------------------
Total Energy                    -762.8564995148704
--------------------------------------------------



Energy difference :  0.006834511170154656


HOMO-LUMO gap: 0.1298924207819141 au
HOMO-LUMO gap: 3.535 eV


Time taken for the previous iteration: 0.5479002050124109


Number of electrons:  100.00001670063925



------Iteration 7--------


Energies

Electron-Nuclear Energy        -3096.4080325204745
Nuclear repulsion Energy         647.7065461172319
Kinetic Energy                   753.2573871757455
Coulomb Energy                  1024.7697158906860
Exchange-Correlation Energy      -92.1853670905789
--------------------------------------------------
Total Energy                    -762.8597504273901
--------------------------------------------------



Energy difference :  0.003250912519661142


HOMO-LUMO gap: 0.12108156714446228 au
HOMO-LUMO gap: 3.295 eV


Time taken for the previous iteration: 0.4022154549602419


Number of electrons:  100.00001669784457



------Iteration 8--------


Energies

Electron-Nuclear Energy        -3096.1271461309279
Nuclear repulsion Energy         647.7065461172319
Kinetic Energy                   753.1181138273622
Coulomb Energy                  1024.6078286198206
Exchange-Correlation Energy      -92.1658941446642
--------------------------------------------------
Total Energy                    -762.8605517111771
--------------------------------------------------



Energy difference :  0.0008012837870410294


HOMO-LUMO gap: 0.12027539770342521 au
HOMO-LUMO gap: 3.273 eV


Time taken for the previous iteration: 0.4105780739337206


Number of electrons:  100.00001677129818



------Iteration 9--------


Energies

Electron-Nuclear Energy        -3096.0553265000754
Nuclear repulsion Energy         647.7065461172319
Kinetic Energy                   753.0787663863947
Coulomb Energy                  1024.5701981055859
Exchange-Correlation Energy      -92.1607437539353
--------------------------------------------------
Total Energy                    -762.8605596447978
--------------------------------------------------



Energy difference :  7.93362073636672e-06


HOMO-LUMO gap: 0.11850784261836722 au
HOMO-LUMO gap: 3.225 eV


Time taken for the previous iteration: 0.3924543739994988


Number of electrons:  100.00001677587295



------Iteration 10--------


Energies

Electron-Nuclear Energy        -3096.0396369198193
Nuclear repulsion Energy         647.7065461172319
Kinetic Energy                   753.0737744175461
Coulomb Energy                  1024.5586538873185
Exchange-Correlation Energy      -92.1599120205189
--------------------------------------------------
Total Energy                    -762.8605745182413
--------------------------------------------------



Energy difference :  1.4873443433316424e-05


HOMO-LUMO gap: 0.11826753754534725 au
HOMO-LUMO gap: 3.218 eV


Time taken for the previous iteration: 0.3927998129511252


Number of electrons:  100.00001675760791



------Iteration 11--------


Energies

Electron-Nuclear Energy        -3096.0828933337875
Nuclear repulsion Energy         647.7065461172319
Kinetic Energy                   753.0946892281094
Coulomb Energy                  1024.5838295359338
Exchange-Correlation Energy      -92.1627462300562
--------------------------------------------------
Total Energy                    -762.8605746825685
--------------------------------------------------



Energy difference :  1.6432727534265723e-07


HOMO-LUMO gap: 0.11834135603354046 au
HOMO-LUMO gap: 3.220 eV


Time taken for the previous iteration: 0.390429247985594


Number of electrons:  100.0000167790202



------Iteration 12--------


Energies

Electron-Nuclear Energy        -3096.0544672586207
Nuclear repulsion Energy         647.7065461172319
Kinetic Energy                   753.0810729737477
Coulomb Energy                  1024.5671340802207
Exchange-Correlation Energy      -92.1608610517796
--------------------------------------------------
Total Energy                    -762.8605751391999
--------------------------------------------------



Energy difference :  4.5663136916118674e-07


HOMO-LUMO gap: 0.1183663002816484 au
HOMO-LUMO gap: 3.221 eV


Time taken for the previous iteration: 0.39808781701140106


Number of electrons:  100.00001677352721



------Iteration 13--------


Energies

Electron-Nuclear Energy        -3096.0573818486710
Nuclear repulsion Energy         647.7065461172319
Kinetic Energy                   753.0824068613462
Coulomb Energy                  1024.5689050829362
Exchange-Correlation Energy      -92.1610513609703
--------------------------------------------------
Total Energy                    -762.8605751481271
--------------------------------------------------



Energy difference :  8.927145245252177e-09

SCF Converged after 13 iterations!

-------------------------------------
Total Energy =  -762.860575148127
-------------------------------------



Time taken : 7.211249956977554 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           0.209147775080055
Density Fitting                         0.6340223801089451
    DF (gamma)                          0.25786901195533574
    DF (coeff)                          0.051874194061383605
    DF (Jtri)                           0.2837014540564269
    DF (Cholesky)                       0.010224788915365934
DIIS                                    0.2945245138835162
KS matrix diagonalization               0.3176685868529603
One electron Integrals (S, T, Vnuc)     0.01936313498299569
Coulomb Integrals (2c2e + 3c2e)         0.6743722161045298
Grids construction                      0
Exchange-Correlation Term               4.946139300824143
Misc.                                   0.11601204914040864
Complete SCF                            7.211249956977554
Energy diff (PySCF-CrysX) 8.228653314290568e-08


PyFock Dipole moment
Dipole moment(X, Y, Z, A.U.): -1.8320234527018329 1.61355618716334 -1.4132566373009467
Max Diff dipole moment (PySCF-CrysX) 7.660336632397957e-05

============================================================
Processing: ../../Structures/water_cluster_20.xyz
============================================================
#INFO: **** input file is /home/lu29vow/PyFock/benchmarks_tests/FINAL_Benchmarks_for_paper/Energy_and_Convergence_Validations/3D_Water_Clusters/benchmark_DFT_LDA_DF.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
#numba.config.THREADING_LAYER='tbb'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 48
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(1500000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)


basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'cc-pVDZ'


auxbasis_name = 'def2-universal-jfit'

# List of all molecules to calculate
xyz_files = [
    '../../Structures/water_cluster_1.xyz',
    '../../Structures/water_cluster_5.xyz',
    '../../Structures/water_cluster_10.xyz',
    '../../Structures/water_cluster_20.xyz',
    '../../Structures/water_cluster_32.xyz',
    '../../Structures/water_cluster_47.xyz',
    '../../Structures/water_cluster_76.xyz',
    '../../Structures/water_cluster_100.xyz',
    '../../Structures/water_cluster_139.xyz',
]


# Loop through all molecules
for xyzFilename in xyz_files:
    print(f"\n{'='*60}")
    print(f"Processing: {xyzFilename}")
    print(f"{'='*60}")

    # ---------PySCF---------------
    #Comparison with PySCF
    molPySCF = gto.Mole()
    molPySCF.atom = xyzFilename
    molPySCF.basis = basis_set_name
    molPySCF.cart = True
    molPySCF.verbose = 4
    molPySCF.max_memory=1500000
    molPySCF.build()

    print('\n\nPySCF Results\n\n')
    start=timer()
    mf = dft.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
    mf.xc = funcidpyscf
    mf.verbose = 4
    mf.direct_scf = False
    mf.init_guess = 'minao'
    dmat_init = mf.init_guess_by_minao(molPySCF)
    mf.max_cycle = 50
    mf.conv_tol = 1e-7
    mf.grids.level = 3
    energyPyscf = mf.kernel(dm0=dmat_init)
    print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
    print('One electron integrals energy',mf.scf_summary['e1'])
    print('Coulomb energy ',mf.scf_summary['coul'])
    print('EXC ',mf.scf_summary['exc'])
    duration = timer()-start
    print('PySCF time: ', duration)
    pyscfGrids = mf.grids
    print('PySCF Grid Size: ', pyscfGrids.weights.shape)
    print('\n\n PySCF Dipole moment')
    dmat = mf.make_rdm1()
    mol_dip_pyscf = mf.dip_moment(molPySCF, dmat, unit='AU')
    mf = 0

    #--------------------CrysX --------------------------

    #Initialize a Mol object with somewhat large geometry
    molCrysX = Mol(coordfile=xyzFilename)

    #Initialize a Basis object with a very large basis set
    basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})

    auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})

    dftObj = DFT(molCrysX, basis, auxbasis, xc=funcidcrysx, grids=pyscfGrids)
    dftObj.dmat = dmat_init
    dftObj.conv_crit = 1e-7
    dftObj.max_itr = 50
    dftObj.ncores = ncores
    dftObj.save_ao_values = True
    dftObj.rys = True
    dftObj.DF_algo = 10
    dftObj.blocksize = 5000
    dftObj.XC_algo = 2
    dftObj.debug = False
    dftObj.sortGrids = False
    dftObj.xc_bf_screen = True
    dftObj.threshold_schwarz = 1e-9
    dftObj.strict_schwarz = False
    dftObj.cholesky = True
    dftObj.orthogonalize = True
    # SAO or CAO basis
    dftObj.sao = False

    # GPU acceleration
    dftObj.use_gpu = False
    dftObj.keep_ao_in_gpu = False
    dftObj.use_libxc = False
    dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
    dftObj.n_gpus = 1 # Specify the number of GPUs
    dftObj.free_gpu_mem = True
    dftObj.threads_x = 32
    dftObj.threads_y = 32
    dftObj.dynamic_precision = False
    dftObj.keep_ints3c2e_in_gpu = True


    # Using PySCF grids to compare the energies
    energyCrysX, dmat = dftObj.scf()


    print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf))

    print('\n\nPyFock Dipole moment')
    M = Integrals.dipole_moment_mat_symm(basis)
    mol_dip = molCrysX.get_dipole_moment(M, dmat)
    print('Dipole moment(X, Y, Z, A.U.):', *mol_dip)
    print('Max Diff dipole moment (PySCF-CrysX)', abs(mol_dip_pyscf-mol_dip).max())

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
# import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
# print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='fat04.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64', processor='x86_64')  Threads 48
Python 3.8.6 (default, Oct 28 2021, 14:43:29) 
[GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]
numpy 1.22.4  scipy 1.7.1  h5py 3.5.0
Date: Mon Aug 11 09:17:18 2025
PySCF version 2.7.0
PySCF path  /home/lu29vow/.local/lib/python3.8/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 1500000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 60
[INPUT] num. electrons = 200
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Cartesian GTO integrals (6d 10f)
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 O     97.873900000000 103.017000000000 100.816000000000 AA  184.954865743068 194.673916174319 190.514628974151 Bohr   0.0
[INPUT]  2 H     98.128600000000 103.038000000000  99.848800000000 AA  185.436178986995 194.713600422935 188.686885866472 Bohr   0.0
[INPUT]  3 H     97.173800000000 102.317000000000 100.960000000000 AA  183.631868483260 193.351107887123 190.786749536089 Bohr   0.0
[INPUT]  4 O    100.645000000000 100.169000000000  95.891500000000 AA  190.191485806851 189.291976171558 181.208672673731 Bohr   0.0
[INPUT]  5 H    101.491000000000 100.305000000000  96.406200000000 AA  191.790194108233 189.548978924499 182.181314710044 Bohr   0.0
[INPUT]  6 H     99.888700000000 100.618000000000  96.367800000000 AA  188.762285938842 190.140463201487 182.108749226861 Bohr   0.0
[INPUT]  7 O     99.814000000000 100.835000000000 101.232000000000 AA  188.621123397337 190.550533770518 191.300755041970 Bohr   0.0
[INPUT]  8 H     99.329200000000  99.976800000000 101.063000000000 AA  187.704984172148 188.928770810416 190.981391326919 Bohr   0.0
[INPUT]  9 H     99.151600000000 101.561000000000 101.414000000000 AA  187.369368812425 191.922474936952 191.644685196641 Bohr   0.0
[INPUT] 10 O     98.804000000000  98.512200000000  97.758100000000 AA  186.712500011526 186.161077928378 184.736035457844 Bohr   0.0
[INPUT] 11 H     99.782100000000  98.646900000000  97.916700000000 AA  188.560841133963 186.415624037357 185.035746021200 Bohr   0.0
[INPUT] 12 H     98.421800000000  99.326500000000  97.321300000000 AA  185.990246686718 187.699881911612 183.910603086634 Bohr   0.0
[INPUT] 13 O    100.747000000000 100.164000000000 103.736000000000 AA  190.384237871556 189.282527540935 196.032629257881 Bohr   0.0
[INPUT] 14 H    100.658000000000 100.628000000000 102.855000000000 AA  190.216052246470 190.159360462733 194.367780542139 Bohr   0.0
[INPUT] 15 H    100.105000000000  99.398600000000 103.776000000000 AA  189.171033699586 187.836131165193 196.108218302864 Bohr   0.0
[INPUT] 16 O     98.070300000000  98.516900000000 100.438000000000 AA  185.326007953933 186.169959641164 189.800312499066 Bohr   0.0
[INPUT] 17 H     97.172800000000  98.878600000000 100.690000000000 AA  183.629978757136 186.853473580419 190.276523482456 Bohr   0.0
[INPUT] 18 H     98.194000000000  98.592200000000  99.448100000000 AA  185.559767075542 186.312256018344 187.929672608359 Bohr   0.0
[INPUT] 19 O     98.548000000000 101.265000000000  97.248600000000 AA  186.228730123638 191.363116004081 183.773219997378 Bohr   0.0
[INPUT] 20 H     98.688900000000 102.140000000000  97.711000000000 AA  186.494992534589 193.016626363075 184.647029357377 Bohr   0.0
[INPUT] 21 H     97.919900000000 101.391000000000  96.480800000000 AA  185.041793144798 191.601221495776 182.322288278937 Bohr   0.0
[INPUT] 22 O    103.898000000000  98.427900000000  99.984500000000 AA  196.338764890061 186.001774016077 188.943321701575 Bohr   0.0
[INPUT] 23 H    103.015000000000  98.654900000000  99.573700000000 AA  194.670136722070 186.430741846354 188.167022209604 Bohr   0.0
[INPUT] 24 H    104.128000000000  97.477300000000  99.776100000000 AA  196.773401898711 184.205400362066 188.549502777216 Bohr   0.0
[INPUT] 25 O     99.166600000000  96.442100000000 101.723000000000 AA  187.397714704294 182.249155877916 192.228610569132 Bohr   0.0
[INPUT] 26 H     98.843200000000  97.206600000000 101.166000000000 AA  186.786577275609 183.693851500146 191.176033117749 Bohr   0.0
[INPUT] 27 H     99.643900000000  95.783700000000 101.141000000000 AA  188.299680983549 181.004960197502 191.128789964635 Bohr   0.0
[INPUT] 28 O    102.891000000000 100.842000000000  97.477600000000 AA  194.435810682624 190.563761853390 184.205967279903 Bohr   0.0
[INPUT] 29 H    103.837000000000 100.662000000000  97.209700000000 AA  196.223491596462 190.223611150968 183.699709651132 Bohr   0.0
[INPUT] 30 H    102.868000000000 101.166000000000  98.423400000000 AA  194.392346981759 191.176033117749 185.993270248517 Bohr   0.0
[INPUT] 31 O     96.227200000000 100.990000000000 101.698000000000 AA  181.843053733747 190.843441319826 192.181367416018 Bohr   0.0
[INPUT] 32 H     96.148800000000 100.422000000000 102.517000000000 AA  181.694899205581 189.770076881073 193.729053112036 Bohr   0.0
[INPUT] 33 H     95.313600000000 101.237000000000 101.375000000000 AA  180.116599946344 191.310203672593 191.570985877783 Bohr   0.0
[INPUT] 34 O     98.864800000000  98.222500000000 103.917000000000 AA  186.827395359900 185.613624270092 196.374669686428 Bohr   0.0
[INPUT] 35 H     98.949800000000  97.463000000000 103.272000000000 AA  186.988022080488 184.178377278485 195.155796336083 Bohr   0.0
[INPUT] 36 H     99.054800000000  97.896400000000 104.843000000000 AA  187.186443323567 184.997384580871 198.124556077775 Bohr   0.0
[INPUT] 37 O    104.578000000000 100.035000000000 101.952000000000 AA  197.623778654765 189.038752870866 192.661357851657 Bohr   0.0
[INPUT] 38 H    104.419000000000 101.011000000000 101.802000000000 AA  197.323312200959 190.883125568441 192.377898932972 Bohr   0.0
[INPUT] 39 H    104.206000000000  99.514900000000 101.184000000000 AA  196.920800536427 188.055906313480 191.210048187991 Bohr   0.0
[INPUT] 40 O    102.429000000000 104.060000000000 101.348000000000 AA  193.562757213075 196.644900522240 191.519963272420 Bohr   0.0
[INPUT] 41 H    101.757000000000 103.665000000000 101.974000000000 AA  192.292861257367 195.898458703037 192.702931826398 Bohr   0.0
[INPUT] 42 H    102.209000000000 105.021000000000 101.185000000000 AA  193.147017465670 198.460927327947 191.211937914116 Bohr   0.0
[INPUT] 43 O     98.708200000000 103.752000000000  98.244300000000 AA  186.531464248793 196.062864875874 185.654820299607 Bohr   0.0
[INPUT] 44 H     98.397100000000 104.234000000000  97.425400000000 AA  185.943570451441 196.973712867915 184.107323576201 Bohr   0.0
[INPUT] 45 H     99.598500000000 104.111000000000  98.524400000000 AA  188.213887417493 196.741276554593 186.184132587098 Bohr   0.0
[INPUT] 46 O     95.630300000000  99.996600000000  98.245400000000 AA  180.715076209994 188.966187387683 185.656898998344 Bohr   0.0
[INPUT] 47 H     96.540400000000 100.410000000000  98.268900000000 AA  182.434915955961 189.747400167578 185.701307562272 Bohr   0.0
[INPUT] 48 H     94.982900000000 100.638000000000  97.834500000000 AA  179.491667516951 190.178257723979 184.880410533761 Bohr   0.0
[INPUT] 49 O    102.360000000000 101.551000000000  99.964500000000 AA  193.432366110480 191.903577675707 188.905527179084 Bohr   0.0
[INPUT] 50 H    102.675000000000 102.370000000000 100.444000000000 AA  194.027629839718 193.451263371725 189.811650855813 Bohr   0.0
[INPUT] 51 H    101.556000000000 101.180000000000 100.430000000000 AA  191.913026306329 191.202489283493 189.785194690069 Bohr   0.0
[INPUT] 52 O    101.836000000000  97.446700000000 102.110000000000 AA  192.442149621208 184.147574742654 192.959934579338 Bohr   0.0
[INPUT] 53 H    100.860000000000  97.397400000000 101.898000000000 AA  190.597776923632 184.054411244713 192.559312640931 Bohr   0.0
[INPUT] 54 H    101.991000000000  97.133400000000 103.047000000000 AA  192.735057170515 183.555523547828 194.730607958056 Bohr   0.0
[INPUT] 55 O    101.665000000000  98.316100000000  98.319400000000 AA  192.119006453907 185.790502635351 185.796738731562 Bohr   0.0
[INPUT] 56 H    101.904000000000  99.233800000000  98.002000000000 AA  192.570650997678 187.524704299864 185.196939659625 Bohr   0.0
[INPUT] 57 H    102.224000000000  97.640900000000  97.837700000000 AA  193.175363357539 184.514559556045 184.886457657359 Bohr   0.0
[INPUT] 58 O     99.984700000000 103.272000000000 102.307000000000 AA  188.943699646800 195.155796336083 193.332210625878 Bohr   0.0
[INPUT] 59 H     99.640700000000 103.104000000000 103.231000000000 AA  188.293633859950 194.838322347156 195.078317564976 Bohr   0.0
[INPUT] 60 H     99.216500000000 103.453000000000 101.693000000000 AA  187.492012037909 195.497836764629 192.171918785395 Bohr   0.0

nuclear repulsion = 2286.80964382453
number of shells = 240
number of NR pGTOs = 780
number of NR cGTOs = 500
basis = def2-SVP
ecp = {}
CPU time:       707.08


PySCF Results


Initial guess from minao.


******** <class 'pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = False
chkfile to save SCF result = /tmp/tmp42eyjf8o
max_memory 1500000 MB (current use 3489 MB)
XC library pyscf.dft.libxc version 6.1.0
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1–5 (2018)
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14fef7d784c0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14fef7dcce50>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 673960
init E= -1524.7212432826
  HOMO = -0.394665197194878  LUMO = -0.0875951658668431
cycle= 1 E= -1524.09418171072  delta_E= 0.627  |g|= 3.05  |ddm|=  6.2
  HOMO = 0.0284439622603305  LUMO = 0.0331762967674954
cycle= 2 E= -1512.02404244398  delta_E= 12.1  |g|= 6.33  |ddm|= 10.8
  HOMO = -0.0920593582733365  LUMO = -0.0794280249524385
cycle= 3 E= -1514.48801136952  delta_E= -2.46  |g|= 4.25  |ddm|= 12.2
  HOMO = -0.180537665330322  LUMO = -0.0417910926311415
cycle= 4 E= -1525.48264235874  delta_E=  -11  |g|= 1.22  |ddm|= 7.74
  HOMO = -0.174407077417464  LUMO = -0.0355441281550824
cycle= 5 E= -1525.73813126917  delta_E= -0.255  |g|= 0.472  |ddm|= 0.97
  HOMO = -0.151560617235309  LUMO = -0.0340382143397168
cycle= 6 E= -1525.77756158011  delta_E= -0.0394  |g|= 0.196  |ddm|= 0.327
  HOMO = -0.157091049296602  LUMO = -0.0518175092980442
cycle= 7 E= -1525.78376259115  delta_E= -0.0062  |g|= 0.164  |ddm|= 0.223
  HOMO = -0.135157353083083  LUMO = -0.0645952336881924
cycle= 8 E= -1525.78843096852  delta_E= -0.00467  |g|= 0.0737  |ddm|= 0.15
  HOMO = -0.124646087399055  LUMO = -0.0700273381019286
cycle= 9 E= -1525.78950174422  delta_E= -0.00107  |g|= 0.0184  |ddm|= 0.0725
  HOMO = -0.121798986001015  LUMO = -0.0711376982058298
cycle= 10 E= -1525.78954644558  delta_E= -4.47e-05  |g|= 0.0118  |ddm|= 0.022
  HOMO = -0.121813698668352  LUMO = -0.0713075898121608
cycle= 11 E= -1525.78957073984  delta_E= -2.43e-05  |g|= 0.00153  |ddm|= 0.0087
  HOMO = -0.121935350068765  LUMO = -0.0712397857228397
cycle= 12 E= -1525.78957112595  delta_E= -3.86e-07  |g|= 0.000621  |ddm|= 0.00147
  HOMO = -0.121893514700857  LUMO = -0.0712400627505867
cycle= 13 E= -1525.78957117853  delta_E= -5.26e-08  |g|= 0.000311  |ddm|= 0.000591
  HOMO = -0.12196529850708  LUMO = -0.0712410418207475
Extra cycle  E= -1525.78957113262  delta_E= 4.59e-08  |g|= 0.000597  |ddm|= 0.000625
converged SCF energy = -1525.78957113262
Nuc-Nuc PySCF=  2286.8096438245325
One electron integrals energy -6668.631948089099
Coulomb energy  3040.4646961116955
EXC  -184.43196297975035
PySCF time:  23.50057079002727
PySCF Grid Size:  (573600,)


 PySCF Dipole moment
Dipole moment(X, Y, Z, A.U.): -5.19862,  2.89327, -2.37312

============================================================
PyFock Python Program for Quantum Chemistry Simulations
                                        by Manas Sharma
============================================================
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m[38;5;45m█[0m  [38;5;51m█[0m[38;5;51m█[0m    [38;5;87m█[0m[38;5;87m█[0m [38;5;123m█[0m[38;5;123m█[0m[38;5;123m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m  [38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m   [38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m   [38;5;213m█[0m[38;5;213m█[0m
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m█[0m[38;5;45m█[0m [38;5;45m░[0m[38;5;45m█[0m[38;5;51m█[0m  [38;5;51m█[0m[38;5;51m█[0m[38;5;87m░[0m [38;5;87m█[0m[38;5;87m█[0m[38;5;87m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m [38;5;159m█[0m[38;5;159m█[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;219m░[0m [38;5;219m█[0m[38;5;219m█[0m  [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m 
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m   [38;5;45m░[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m░[0m  [38;5;87m█[0m[38;5;87m█[0m[38;5;87m█[0m[38;5;123m█[0m[38;5;123m█[0m   [38;5;159m█[0m[38;5;159m█[0m    [38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m      [38;5;219m█[0m[38;5;219m█[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m  
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m░[0m[38;5;45m░[0m    [38;5;51m░[0m[38;5;51m█[0m[38;5;87m█[0m[38;5;87m░[0m   [38;5;123m█[0m[38;5;123m█[0m[38;5;123m░[0m[38;5;159m░[0m[38;5;159m░[0m   [38;5;195m█[0m[38;5;195m█[0m    [38;5;225m█[0m[38;5;219m█[0m [38;5;219m█[0m[38;5;219m█[0m      [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m 
[38;5;39m█[0m[38;5;39m█[0m         [38;5;51m█[0m[38;5;87m█[0m    [38;5;123m█[0m[38;5;123m█[0m      [38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;219m░[0m [38;5;219m░[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m  [38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m
[38;5;39m░[0m[38;5;39m░[0m         [38;5;51m░[0m[38;5;87m░[0m    [38;5;123m░[0m[38;5;123m░[0m       [38;5;195m░[0m[38;5;195m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m   [38;5;219m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m [38;5;213m░[0m[38;5;213m░[0m   [38;5;213m░[0m[38;5;213m░[0m

============================================================


Number of atoms: 60


Number of basis functions (atomic orbitals): 500


Number of auxiliary basis functions: 1700


================================================================================


Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 9334 32-Core Processor
Number of Cores: 64
Number of Threads: 128
Memory (GB): 2267.59
Running DFT using 48 threads for Numba.



Calculating one electron integrals...


Core H size in GB  0.002
done!
Time taken 0.06893870106432587 seconds.

Stricter version of Schwarz screening:  False

Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.05898211302701384 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.010222748038358986
Time taken to evaluate the square roots needed:  0.0019380459561944008
Time for significant indices evaluation:  0.003031439962796867
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.003006008
No. of elements in the standard three-centered two electron ERI tensor:  425000000
No. of elements in the triangular three-centered two electron ERI tensor:  212925000
No. of significant triplets based on Schwarz inequality and triangularity: 92784500 or 21.8% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.017402907949872315 seconds.

Two Center Two electron ERI size in GB  0.02312
Three Center Two electron ERI size in GB  0.742276
Three-centered two electron evaluation done!
Time taken for Cholesky factorization of two-centered two-electron integrals 0.09313762106467038 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  3.305919721024111 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  573600
Size (in GB) for storing the coordinates of grid:       0.0137664
Size (in GB) for storing the weights of grid:           0.0045888
Size (in GB) for storing the density at gridpoints:     0.0045888

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  5000
No. of batches:  115

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 0.4399703990202397 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    294
Average no. of basis functions contributing to a batch of grid points:    210

You have asked to save the values of significant basis functions and their gradients on grid points so as to avoid recalculation for each SCF cycle.
Please note: This will require addtional memory that is approximately :3.6 GB
Calculating the value of significantly contributing basis functions (atomic orbitals)...
done!
Time taken 0.42017395002767444 seconds.



------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Number of electrons:  200.3630909980803



------Iteration 1--------


Energies

Electron-Nuclear Energy        -8168.5337711179236
Nuclear repulsion Energy        2286.8096438306616
Kinetic Energy                  1516.0358974723465
Coulomb Energy                  3022.3152760504931
Exchange-Correlation Energy     -182.2557391396336
--------------------------------------------------
Total Energy                   -1525.6286929040557
--------------------------------------------------



Energy difference :  1525.6286929040557


HOMO-LUMO gap: 0.29309480799921417 au
HOMO-LUMO gap: 7.975 eV


Time taken for the previous iteration: 0.9789972020080313


Number of electrons:  200.00003484932014



------Iteration 2--------


Energies

Electron-Nuclear Energy        -8246.4043678750077
Nuclear repulsion Energy        2286.8096438306616
Kinetic Energy                  1540.9885978012474
Coulomb Energy                  3083.7030053356857
Exchange-Correlation Energy     -189.4258336228135
--------------------------------------------------
Total Energy                   -1524.3289545302277
--------------------------------------------------



Energy difference :  1.2997383738279495


HOMO-LUMO gap: 0.01649704286198207 au
HOMO-LUMO gap: 0.449 eV


Time taken for the previous iteration: 0.8829445459414274


Number of electrons:  200.00020209008946



------Iteration 3--------


Energies

Electron-Nuclear Energy        -8037.9292005455027
Nuclear repulsion Energy        2286.8096438306616
Kinetic Energy                  1448.7775057170325
Coulomb Energy                  2960.3763894207596
Exchange-Correlation Energy     -175.8926467942397
--------------------------------------------------
Total Energy                   -1517.8583083712883
--------------------------------------------------



Energy difference :  6.470646158939417


HOMO-LUMO gap: 0.018009710593387462 au
HOMO-LUMO gap: 0.490 eV


Time taken for the previous iteration: 0.8314559949794784


Number of electrons:  200.00006358497012



------Iteration 4--------


Energies

Electron-Nuclear Energy        -8165.9297628202121
Nuclear repulsion Energy        2286.8096438306616
Kinetic Energy                  1502.2930488524364
Coulomb Energy                  3035.4741988368155
Exchange-Correlation Energy     -183.8302845399213
--------------------------------------------------
Total Energy                   -1525.1831558402205
--------------------------------------------------



Energy difference :  7.324847468932148


HOMO-LUMO gap: 0.1301118864420543 au
HOMO-LUMO gap: 3.541 eV


Time taken for the previous iteration: 0.8102331410627812


Number of electrons:  200.0000538836117



------Iteration 5--------


Energies

Electron-Nuclear Energy        -8178.1248472473962
Nuclear repulsion Energy        2286.8096438306616
Kinetic Energy                  1507.4330834352465
Coulomb Energy                  3042.7350532123478
Exchange-Correlation Energy     -184.6069727105808
--------------------------------------------------
Total Energy                   -1525.7540394797211
--------------------------------------------------



Energy difference :  0.5708836395006074


HOMO-LUMO gap: 0.10888910555947509 au
HOMO-LUMO gap: 2.963 eV


Time taken for the previous iteration: 1.5134580270387232


Number of electrons:  200.00006017254378



------Iteration 6--------


Energies

Electron-Nuclear Energy        -8176.3739624306099
Nuclear repulsion Energy        2286.8096438306616
Kinetic Energy                  1507.1974940557072
Coulomb Energy                  3041.1370044841119
Exchange-Correlation Energy     -184.5464600065164
--------------------------------------------------
Total Energy                   -1525.7762800666455
--------------------------------------------------



Energy difference :  0.022240586924453964


HOMO-LUMO gap: 0.07427052763922157 au
HOMO-LUMO gap: 2.021 eV


Time taken for the previous iteration: 1.0322746339952573


Number of electrons:  200.0000579007707



------Iteration 7--------


Energies

Electron-Nuclear Energy        -8175.8632340888380
Nuclear repulsion Energy        2286.8096438306616
Kinetic Energy                  1506.8197881627098
Coulomb Energy                  3040.9346454581159
Exchange-Correlation Energy     -184.4878049847440
--------------------------------------------------
Total Energy                   -1525.7869616220955
--------------------------------------------------



Energy difference :  0.01068155544999172


HOMO-LUMO gap: 0.05843615338925712 au
HOMO-LUMO gap: 1.590 eV


Time taken for the previous iteration: 0.9408703800290823


Number of electrons:  200.00005818713817



------Iteration 8--------


Energies

Electron-Nuclear Energy        -8175.3126362051398
Nuclear repulsion Energy        2286.8096438306616
Kinetic Energy                  1506.5322703533197
Coulomb Energy                  3040.6289798791154
Exchange-Correlation Energy     -184.4476791114748
--------------------------------------------------
Total Energy                   -1525.7894212535170
--------------------------------------------------



Energy difference :  0.002459631421515951


HOMO-LUMO gap: 0.054773604147676735 au
HOMO-LUMO gap: 1.490 eV


Time taken for the previous iteration: 0.8740179579472169


Number of electrons:  200.00005830845691



------Iteration 9--------


Energies

Electron-Nuclear Energy        -8175.0171542133821
Nuclear repulsion Energy        2286.8096438306616
Kinetic Energy                  1506.4031964573098
Coulomb Energy                  3040.4452212583769
Exchange-Correlation Energy     -184.4304395092617
--------------------------------------------------
Total Energy                   -1525.7895321762949
--------------------------------------------------



Energy difference :  0.0001109227778215427


HOMO-LUMO gap: 0.050814456195071855 au
HOMO-LUMO gap: 1.383 eV


Time taken for the previous iteration: 0.8024448449723423


Number of electrons:  200.0000582986976



------Iteration 10--------


Energies

Electron-Nuclear Energy        -8175.0074575713024
Nuclear repulsion Energy        2286.8096438306616
Kinetic Energy                  1506.3994471455419
Coulomb Energy                  3040.4380696737076
Exchange-Correlation Energy     -184.4292695665667
--------------------------------------------------
Total Energy                   -1525.7895664879584
--------------------------------------------------



Energy difference :  3.431166351219872e-05


HOMO-LUMO gap: 0.05060453904316642 au
HOMO-LUMO gap: 1.377 eV


Time taken for the previous iteration: 0.8205807859776542


Number of electrons:  200.00005825751015



------Iteration 11--------


Energies

Electron-Nuclear Energy        -8175.1119756334729
Nuclear repulsion Energy        2286.8096438306616
Kinetic Energy                  1506.4482393422020
Coulomb Energy                  3040.5004528682421
Exchange-Correlation Energy     -184.4359307951516
--------------------------------------------------
Total Energy                   -1525.7895703875183
--------------------------------------------------



Energy difference :  3.8995599425106775e-06


HOMO-LUMO gap: 0.05058566334497261 au
HOMO-LUMO gap: 1.377 eV


Time taken for the previous iteration: 0.821117834886536


Number of electrons:  200.00005830388739



------Iteration 12--------


Energies

Electron-Nuclear Energy        -8175.0357854466938
Nuclear repulsion Energy        2286.8096438306616
Kinetic Energy                  1506.4119082398013
Coulomb Energy                  3040.4555719772206
Exchange-Correlation Energy     -184.4309101560479
--------------------------------------------------
Total Energy                   -1525.7895715550576
--------------------------------------------------



Energy difference :  1.1675392670440488e-06


HOMO-LUMO gap: 0.05067874633765079 au
HOMO-LUMO gap: 1.379 eV


Time taken for the previous iteration: 0.8129209339385852


Number of electrons:  200.00005828939018



------Iteration 13--------


Energies

Electron-Nuclear Energy        -8175.0497645498808
Nuclear repulsion Energy        2286.8096438306616
Kinetic Energy                  1506.4185030725796
Coulomb Energy                  3040.4638772474973
Exchange-Correlation Energy     -184.4318312417053
--------------------------------------------------
Total Energy                   -1525.7895716408475
--------------------------------------------------



Energy difference :  8.5789906734135e-08

SCF Converged after 13 iterations!

-------------------------------------
Total Energy =  -1525.7895716408475
-------------------------------------



Time taken : 16.19109950005077 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           0.8601443490479141
Density Fitting                         1.4042077771155164
    DF (gamma)                          0.7172543209744617
    DF (coeff)                          0.08295299927704036
    DF (Jtri)                           0.4615314931143075
    DF (Cholesky)                       0.09313762106467038
DIIS                                    0.5351393767632544
KS matrix diagonalization               0.8066116159316152
One electron Integrals (S, T, Vnuc)     0.06893870106432587
Coulomb Integrals (2c2e + 3c2e)         3.2127820999594405
Grids construction                      0
Exchange-Correlation Term               8.487327426089905
Misc.                                   0.8159481540787965
Complete SCF                            16.19109950005077
Energy diff (PySCF-CrysX) 5.082260940980632e-07


PyFock Dipole moment
Dipole moment(X, Y, Z, A.U.): -5.198556850547902 2.8931349644553848 -2.373283165790781
Max Diff dipole moment (PySCF-CrysX) 0.00016114838217617944

============================================================
Processing: ../../Structures/water_cluster_32.xyz
============================================================
#INFO: **** input file is /home/lu29vow/PyFock/benchmarks_tests/FINAL_Benchmarks_for_paper/Energy_and_Convergence_Validations/3D_Water_Clusters/benchmark_DFT_LDA_DF.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
#numba.config.THREADING_LAYER='tbb'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 48
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(1500000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)


basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'cc-pVDZ'


auxbasis_name = 'def2-universal-jfit'

# List of all molecules to calculate
xyz_files = [
    '../../Structures/water_cluster_1.xyz',
    '../../Structures/water_cluster_5.xyz',
    '../../Structures/water_cluster_10.xyz',
    '../../Structures/water_cluster_20.xyz',
    '../../Structures/water_cluster_32.xyz',
    '../../Structures/water_cluster_47.xyz',
    '../../Structures/water_cluster_76.xyz',
    '../../Structures/water_cluster_100.xyz',
    '../../Structures/water_cluster_139.xyz',
]


# Loop through all molecules
for xyzFilename in xyz_files:
    print(f"\n{'='*60}")
    print(f"Processing: {xyzFilename}")
    print(f"{'='*60}")

    # ---------PySCF---------------
    #Comparison with PySCF
    molPySCF = gto.Mole()
    molPySCF.atom = xyzFilename
    molPySCF.basis = basis_set_name
    molPySCF.cart = True
    molPySCF.verbose = 4
    molPySCF.max_memory=1500000
    molPySCF.build()

    print('\n\nPySCF Results\n\n')
    start=timer()
    mf = dft.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
    mf.xc = funcidpyscf
    mf.verbose = 4
    mf.direct_scf = False
    mf.init_guess = 'minao'
    dmat_init = mf.init_guess_by_minao(molPySCF)
    mf.max_cycle = 50
    mf.conv_tol = 1e-7
    mf.grids.level = 3
    energyPyscf = mf.kernel(dm0=dmat_init)
    print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
    print('One electron integrals energy',mf.scf_summary['e1'])
    print('Coulomb energy ',mf.scf_summary['coul'])
    print('EXC ',mf.scf_summary['exc'])
    duration = timer()-start
    print('PySCF time: ', duration)
    pyscfGrids = mf.grids
    print('PySCF Grid Size: ', pyscfGrids.weights.shape)
    print('\n\n PySCF Dipole moment')
    dmat = mf.make_rdm1()
    mol_dip_pyscf = mf.dip_moment(molPySCF, dmat, unit='AU')
    mf = 0

    #--------------------CrysX --------------------------

    #Initialize a Mol object with somewhat large geometry
    molCrysX = Mol(coordfile=xyzFilename)

    #Initialize a Basis object with a very large basis set
    basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})

    auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})

    dftObj = DFT(molCrysX, basis, auxbasis, xc=funcidcrysx, grids=pyscfGrids)
    dftObj.dmat = dmat_init
    dftObj.conv_crit = 1e-7
    dftObj.max_itr = 50
    dftObj.ncores = ncores
    dftObj.save_ao_values = True
    dftObj.rys = True
    dftObj.DF_algo = 10
    dftObj.blocksize = 5000
    dftObj.XC_algo = 2
    dftObj.debug = False
    dftObj.sortGrids = False
    dftObj.xc_bf_screen = True
    dftObj.threshold_schwarz = 1e-9
    dftObj.strict_schwarz = False
    dftObj.cholesky = True
    dftObj.orthogonalize = True
    # SAO or CAO basis
    dftObj.sao = False

    # GPU acceleration
    dftObj.use_gpu = False
    dftObj.keep_ao_in_gpu = False
    dftObj.use_libxc = False
    dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
    dftObj.n_gpus = 1 # Specify the number of GPUs
    dftObj.free_gpu_mem = True
    dftObj.threads_x = 32
    dftObj.threads_y = 32
    dftObj.dynamic_precision = False
    dftObj.keep_ints3c2e_in_gpu = True


    # Using PySCF grids to compare the energies
    energyCrysX, dmat = dftObj.scf()


    print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf))

    print('\n\nPyFock Dipole moment')
    M = Integrals.dipole_moment_mat_symm(basis)
    mol_dip = molCrysX.get_dipole_moment(M, dmat)
    print('Dipole moment(X, Y, Z, A.U.):', *mol_dip)
    print('Max Diff dipole moment (PySCF-CrysX)', abs(mol_dip_pyscf-mol_dip).max())

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
# import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
# print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='fat04.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64', processor='x86_64')  Threads 48
Python 3.8.6 (default, Oct 28 2021, 14:43:29) 
[GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]
numpy 1.22.4  scipy 1.7.1  h5py 3.5.0
Date: Mon Aug 11 09:17:58 2025
PySCF version 2.7.0
PySCF path  /home/lu29vow/.local/lib/python3.8/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 1500000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 96
[INPUT] num. electrons = 320
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Cartesian GTO integrals (6d 10f)
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 O     97.873900000000 103.017000000000 100.816000000000 AA  184.954865743068 194.673916174319 190.514628974151 Bohr   0.0
[INPUT]  2 H     98.128600000000 103.038000000000  99.848800000000 AA  185.436178986995 194.713600422935 188.686885866472 Bohr   0.0
[INPUT]  3 H     97.173800000000 102.317000000000 100.960000000000 AA  183.631868483260 193.351107887123 190.786749536089 Bohr   0.0
[INPUT]  4 O    101.099000000000 104.850000000000  99.030700000000 AA  191.049421467403 198.137784160647 187.140900923965 Bohr   0.0
[INPUT]  5 H    101.483000000000 104.260000000000  99.740500000000 AA  191.775076299236 197.022845747153 188.482228527182 Bohr   0.0
[INPUT]  6 H    101.829000000000 105.396000000000  98.619700000000 AA  192.428921538336 199.169574624659 186.364223486769 Bohr   0.0
[INPUT]  7 O    100.645000000000 100.169000000000  95.891500000000 AA  190.191485806851 189.291976171558 181.208672673731 Bohr   0.0
[INPUT]  8 H    101.491000000000 100.305000000000  96.406200000000 AA  191.790194108233 189.548978924499 182.181314710044 Bohr   0.0
[INPUT]  9 H     99.888700000000 100.618000000000  96.367800000000 AA  188.762285938842 190.140463201487 182.108749226861 Bohr   0.0
[INPUT] 10 O     99.814000000000 100.835000000000 101.232000000000 AA  188.621123397337 190.550533770518 191.300755041970 Bohr   0.0
[INPUT] 11 H     99.329200000000  99.976800000000 101.063000000000 AA  187.704984172148 188.928770810416 190.981391326919 Bohr   0.0
[INPUT] 12 H     99.151600000000 101.561000000000 101.414000000000 AA  187.369368812425 191.922474936952 191.644685196641 Bohr   0.0
[INPUT] 13 O     98.804000000000  98.512200000000  97.758100000000 AA  186.712500011526 186.161077928378 184.736035457844 Bohr   0.0
[INPUT] 14 H     99.782100000000  98.646900000000  97.916700000000 AA  188.560841133963 186.415624037357 185.035746021200 Bohr   0.0
[INPUT] 15 H     98.421800000000  99.326500000000  97.321300000000 AA  185.990246686718 187.699881911612 183.910603086634 Bohr   0.0
[INPUT] 16 O    100.747000000000 100.164000000000 103.736000000000 AA  190.384237871556 189.282527540935 196.032629257881 Bohr   0.0
[INPUT] 17 H    100.658000000000 100.628000000000 102.855000000000 AA  190.216052246470 190.159360462733 194.367780542139 Bohr   0.0
[INPUT] 18 H    100.105000000000  99.398600000000 103.776000000000 AA  189.171033699586 187.836131165193 196.108218302864 Bohr   0.0
[INPUT] 19 O     98.070300000000  98.516900000000 100.438000000000 AA  185.326007953933 186.169959641164 189.800312499066 Bohr   0.0
[INPUT] 20 H     97.172800000000  98.878600000000 100.690000000000 AA  183.629978757136 186.853473580419 190.276523482456 Bohr   0.0
[INPUT] 21 H     98.194000000000  98.592200000000  99.448100000000 AA  185.559767075542 186.312256018344 187.929672608359 Bohr   0.0
[INPUT] 22 O     96.373500000000  99.168100000000 103.663000000000 AA  182.119520665771 187.400549293481 195.894679250788 Bohr   0.0
[INPUT] 23 H     96.032600000000  99.385200000000 104.578000000000 AA  181.475313029907 187.810808835124 197.623778654765 Bohr   0.0
[INPUT] 24 H     97.337900000000  98.909800000000 103.720000000000 AA  183.941972540302 186.912433035505 196.002393639888 Bohr   0.0
[INPUT] 25 O     96.740700000000 101.641000000000  95.246600000000 AA  182.813428098711 192.073653026917 179.989988295999 Bohr   0.0
[INPUT] 26 H     95.765200000000 101.625000000000  95.027600000000 AA  180.970000264198 192.043417408924 179.576138274719 Bohr   0.0
[INPUT] 27 H     97.256100000000 101.957000000000  94.450300000000 AA  183.787392943312 192.670806482280 178.485199383007 Bohr   0.0
[INPUT] 28 O    103.969000000000  95.809900000000 100.611000000000 AA  196.472935444905 181.054471021966 190.127235118615 Bohr   0.0
[INPUT] 29 H    104.656000000000  95.771500000000 101.336000000000 AA  197.771177292481 180.981905538783 191.497286558925 Bohr   0.0
[INPUT] 30 H    103.152000000000  96.276300000000 100.950000000000 AA  194.929029201135 181.935839286463 190.767852274843 Bohr   0.0
[INPUT] 31 O     98.548000000000 101.265000000000  97.248600000000 AA  186.228730123638 191.363116004081 183.773219997378 Bohr   0.0
[INPUT] 32 H     98.688900000000 102.140000000000  97.711000000000 AA  186.494992534589 193.016626363075 184.647029357377 Bohr   0.0
[INPUT] 33 H     97.919900000000 101.391000000000  96.480800000000 AA  185.041793144798 191.601221495776 182.322288278937 Bohr   0.0
[INPUT] 34 O    104.764000000000 102.907000000000 101.929000000000 AA  197.975267713934 194.466046300617 192.617894150792 Bohr   0.0
[INPUT] 35 H    104.157000000000 103.650000000000 101.648000000000 AA  196.828203956323 195.870112811169 192.086881109789 Bohr   0.0
[INPUT] 36 H    105.597000000000 103.289000000000 102.328000000000 AA  199.549409575697 195.187921680201 193.371894874494 Bohr   0.0
[INPUT] 37 O    103.898000000000  98.427900000000  99.984500000000 AA  196.338764890061 186.001774016077 188.943321701575 Bohr   0.0
[INPUT] 38 H    103.015000000000  98.654900000000  99.573700000000 AA  194.670136722070 186.430741846354 188.167022209604 Bohr   0.0
[INPUT] 39 H    104.128000000000  97.477300000000  99.776100000000 AA  196.773401898711 184.205400362066 188.549502777216 Bohr   0.0
[INPUT] 40 O     99.166600000000  96.442100000000 101.723000000000 AA  187.397714704294 182.249155877916 192.228610569132 Bohr   0.0
[INPUT] 41 H     98.843200000000  97.206600000000 101.166000000000 AA  186.786577275609 183.693851500146 191.176033117749 Bohr   0.0
[INPUT] 42 H     99.643900000000  95.783700000000 101.141000000000 AA  188.299680983549 181.004960197502 191.128789964635 Bohr   0.0
[INPUT] 43 O    102.891000000000 100.842000000000  97.477600000000 AA  194.435810682624 190.563761853390 184.205967279903 Bohr   0.0
[INPUT] 44 H    103.837000000000 100.662000000000  97.209700000000 AA  196.223491596462 190.223611150968 183.699709651132 Bohr   0.0
[INPUT] 45 H    102.868000000000 101.166000000000  98.423400000000 AA  194.392346981759 191.176033117749 185.993270248517 Bohr   0.0
[INPUT] 46 O     96.227200000000 100.990000000000 101.698000000000 AA  181.843053733747 190.843441319826 192.181367416018 Bohr   0.0
[INPUT] 47 H     96.148800000000 100.422000000000 102.517000000000 AA  181.694899205581 189.770076881073 193.729053112036 Bohr   0.0
[INPUT] 48 H     95.313600000000 101.237000000000 101.375000000000 AA  180.116599946344 191.310203672593 191.570985877783 Bohr   0.0
[INPUT] 49 O     95.278100000000  97.169000000000  98.965800000000 AA  180.049514668922 183.622797797862 187.018257698481 Bohr   0.0
[INPUT] 50 H     95.144800000000  97.377000000000  99.934800000000 AA  179.797614176518 184.015860831772 188.849402313185 Bohr   0.0
[INPUT] 51 H     95.587900000000  97.991100000000  98.488100000000 AA  180.634951822313 185.176341644867 186.115535528776 Bohr   0.0
[INPUT] 52 O     98.864800000000  98.222500000000 103.917000000000 AA  186.827395359900 185.613624270092 196.374669686428 Bohr   0.0
[INPUT] 53 H     98.949800000000  97.463000000000 103.272000000000 AA  186.988022080488 184.178377278485 195.155796336083 Bohr   0.0
[INPUT] 54 H     99.054800000000  97.896400000000 104.843000000000 AA  187.186443323567 184.997384580871 198.124556077775 Bohr   0.0
[INPUT] 55 O    104.578000000000 100.035000000000 101.952000000000 AA  197.623778654765 189.038752870866 192.661357851657 Bohr   0.0
[INPUT] 56 H    104.419000000000 101.011000000000 101.802000000000 AA  197.323312200959 190.883125568441 192.377898932972 Bohr   0.0
[INPUT] 57 H    104.206000000000  99.514900000000 101.184000000000 AA  196.920800536427 188.055906313480 191.210048187991 Bohr   0.0
[INPUT] 58 O    102.429000000000 104.060000000000 101.348000000000 AA  193.562757213075 196.644900522240 191.519963272420 Bohr   0.0
[INPUT] 59 H    101.757000000000 103.665000000000 101.974000000000 AA  192.292861257367 195.898458703037 192.702931826398 Bohr   0.0
[INPUT] 60 H    102.209000000000 105.021000000000 101.185000000000 AA  193.147017465670 198.460927327947 191.211937914116 Bohr   0.0
[INPUT] 61 O     95.118700000000  97.700600000000 101.797000000000 AA  179.748292324667 184.627376205681 192.368450302350 Bohr   0.0
[INPUT] 62 H     94.171300000000  97.423600000000 101.957000000000 AA  177.957965794254 184.103922069177 192.670806482280 Bohr   0.0
[INPUT] 63 H     95.377300000000  98.403200000000 102.460000000000 AA  180.236975500479 185.955097780801 193.621338722936 Bohr   0.0
[INPUT] 64 O     98.708200000000 103.752000000000  98.244300000000 AA  186.531464248793 196.062864875874 185.654820299607 Bohr   0.0
[INPUT] 65 H     98.397100000000 104.234000000000  97.425400000000 AA  185.943570451441 196.973712867915 184.107323576201 Bohr   0.0
[INPUT] 66 H     99.598500000000 104.111000000000  98.524400000000 AA  188.213887417493 196.741276554593 186.184132587098 Bohr   0.0
[INPUT] 67 O    103.454000000000  97.589900000000  96.421800000000 AA  195.499726490754 184.418183523692 182.210794437587 Bohr   0.0
[INPUT] 68 H    103.885000000000  98.135100000000  95.702500000000 AA  196.314198450441 185.448462206805 180.851514436188 Bohr   0.0
[INPUT] 69 H    104.142000000000  97.009800000000  96.857500000000 AA  196.799858064455 183.321953398832 183.034148110060 Bohr   0.0
[INPUT] 70 O     95.630300000000  99.996600000000  98.245400000000 AA  180.715076209994 188.966187387683 185.656898998344 Bohr   0.0
[INPUT] 71 H     96.540400000000 100.410000000000  98.268900000000 AA  182.434915955961 189.747400167578 185.701307562272 Bohr   0.0
[INPUT] 72 H     94.982900000000 100.638000000000  97.834500000000 AA  179.491667516951 190.178257723979 184.880410533761 Bohr   0.0
[INPUT] 73 O     99.505700000000  94.600000000000  99.762000000000 AA  188.038520833134 178.768091383855 188.522857638860 Bohr   0.0
[INPUT] 74 H     98.915000000000  94.230400000000  99.044800000000 AA  186.922259611353 178.069648608216 187.167546062322 Bohr   0.0
[INPUT] 75 H    100.455000000000  94.596700000000  99.446700000000 AA  189.832437843183 178.761855287644 187.927026991784 Bohr   0.0
[INPUT] 76 O    102.360000000000 101.551000000000  99.964500000000 AA  193.432366110480 191.903577675707 188.905527179084 Bohr   0.0
[INPUT] 77 H    102.675000000000 102.370000000000 100.444000000000 AA  194.027629839718 193.451263371725 189.811650855813 Bohr   0.0
[INPUT] 78 H    101.556000000000 101.180000000000 100.430000000000 AA  191.913026306329 191.202489283493 189.785194690069 Bohr   0.0
[INPUT] 79 O     99.128800000000  95.980100000000  96.602100000000 AA  187.326283056785 181.376102408367 182.551512057847 Bohr   0.0
[INPUT] 80 H     99.037300000000  96.941600000000  96.861200000000 AA  187.153373116387 183.193074077136 183.041140096721 Bohr   0.0
[INPUT] 81 H    100.097000000000  95.729200000000  96.588100000000 AA  189.155915890589 180.901970123714 182.525055892103 Bohr   0.0
[INPUT] 82 O    103.544000000000  99.038500000000 104.412000000000 AA  195.669801841965 187.155640787737 197.310084118087 Bohr   0.0
[INPUT] 83 H    104.182000000000  99.184200000000 103.655000000000 AA  196.875447109437 187.430973884086 195.879561441791 Bohr   0.0
[INPUT] 84 H    102.605000000000  99.102500000000 104.073000000000 AA  193.895349010998 187.276583259709 196.669466961860 Bohr   0.0
[INPUT] 85 O    103.133000000000 101.981000000000 104.535000000000 AA  194.893124404769 192.716159909270 197.542520431409 Bohr   0.0
[INPUT] 86 H    103.581000000000 102.216000000000 103.673000000000 AA  195.739721708574 193.160245548542 195.913576512034 Bohr   0.0
[INPUT] 87 H    102.678000000000 101.095000000000 104.444000000000 AA  194.033299018091 191.041862562905 197.370555354073 Bohr   0.0
[INPUT] 88 O    101.836000000000  97.446700000000 102.110000000000 AA  192.442149621208 184.147574742654 192.959934579338 Bohr   0.0
[INPUT] 89 H    100.860000000000  97.397400000000 101.898000000000 AA  190.597776923632 184.054411244713 192.559312640931 Bohr   0.0
[INPUT] 90 H    101.991000000000  97.133400000000 103.047000000000 AA  192.735057170515 183.555523547828 194.730607958056 Bohr   0.0
[INPUT] 91 O    101.665000000000  98.316100000000  98.319400000000 AA  192.119006453907 185.790502635351 185.796738731562 Bohr   0.0
[INPUT] 92 H    101.904000000000  99.233800000000  98.002000000000 AA  192.570650997678 187.524704299864 185.196939659625 Bohr   0.0
[INPUT] 93 H    102.224000000000  97.640900000000  97.837700000000 AA  193.175363357539 184.514559556045 184.886457657359 Bohr   0.0
[INPUT] 94 O     99.984700000000 103.272000000000 102.307000000000 AA  188.943699646800 195.155796336083 193.332210625878 Bohr   0.0
[INPUT] 95 H     99.640700000000 103.104000000000 103.231000000000 AA  188.293633859950 194.838322347156 195.078317564976 Bohr   0.0
[INPUT] 96 H     99.216500000000 103.453000000000 101.693000000000 AA  187.492012037909 195.497836764629 192.171918785395 Bohr   0.0

nuclear repulsion = 5098.44012114699
number of shells = 384
number of NR pGTOs = 1248
number of NR cGTOs = 800
basis = def2-SVP
ecp = {}
CPU time:      1859.25


PySCF Results


Initial guess from minao.


******** <class 'pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = False
chkfile to save SCF result = /tmp/tmpohuqper1
max_memory 1500000 MB (current use 6437 MB)
XC library pyscf.dft.libxc version 6.1.0
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1–5 (2018)
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14fef7d784c0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14fef7dcce50>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 1078336
init E= -2439.6678799785
  HOMO = -0.398297878755849  LUMO = -0.0982104492596267
cycle= 1 E= -2438.70677745028  delta_E= 0.961  |g|= 3.81  |ddm|= 7.84
  HOMO = 0.0361449577446759  LUMO = 0.0386220654951667
cycle= 2 E= -2426.84802093419  delta_E= 11.9  |g|= 7.35  |ddm|= 11.8
  HOMO = -0.122242171793545  LUMO = -0.102386880702824
cycle= 3 E= -2437.78186197988  delta_E= -10.9  |g|= 2.69  |ddm|=   11
  HOMO = -0.178194832748442  LUMO = -0.0734018811061613
cycle= 4 E= -2441.1242139646  delta_E= -3.34  |g|= 1.04  |ddm|= 3.79
  HOMO = -0.178046626747966  LUMO = -0.0368492207545807
cycle= 5 E= -2441.32306642556  delta_E= -0.199  |g|= 0.339  |ddm|= 0.836
  HOMO = -0.147250916037513  LUMO = -0.0430907001768058
cycle= 6 E= -2441.34486206928  delta_E= -0.0218  |g|= 0.134  |ddm|= 0.349
  HOMO = -0.146466386615956  LUMO = -0.0424074906395858
cycle= 7 E= -2441.34677194992  delta_E= -0.00191  |g|= 0.103  |ddm|= 0.118
  HOMO = -0.141190526113915  LUMO = -0.0442747921800759
cycle= 8 E= -2441.34846735453  delta_E= -0.0017  |g|= 0.0454  |ddm|= 0.0736
  HOMO = -0.136730015483071  LUMO = -0.0473740908794242
cycle= 9 E= -2441.34885704746  delta_E= -0.00039  |g|= 0.0139  |ddm|= 0.0375
  HOMO = -0.134933572323432  LUMO = -0.0483103773522061
cycle= 10 E= -2441.34888370993  delta_E= -2.67e-05  |g|= 0.0081  |ddm|= 0.0148
  HOMO = -0.13495269506143  LUMO = -0.0485281783327573
cycle= 11 E= -2441.3488955486  delta_E= -1.18e-05  |g|= 0.00128  |ddm|= 0.00622
  HOMO = -0.134876792586383  LUMO = -0.0486062351010421
cycle= 12 E= -2441.34889582464  delta_E= -2.76e-07  |g|= 0.000513  |ddm|= 0.00127
  HOMO = -0.134880539608148  LUMO = -0.0486035279886467
cycle= 13 E= -2441.34889584838  delta_E= -2.37e-08  |g|= 0.000357  |ddm|= 0.000527
  HOMO = -0.134864920803236  LUMO = -0.0486039922440803
cycle= 14 E= -2441.34889586965  delta_E= -2.13e-08  |g|= 9.61e-05  |ddm|= 0.000285
  HOMO = -0.134877952268902  LUMO = -0.0486060805492659
Extra cycle  E= -2441.34889586601  delta_E= 3.64e-09  |g|= 0.000173  |ddm|= 0.000183
converged SCF energy = -2441.34889586601
Nuc-Nuc PySCF=  5098.440121146994
One electron integrals energy -13549.878655053215
Coulomb energy  6305.174290929294
EXC  -295.08465288908786
PySCF time:  41.531205912004225
PySCF Grid Size:  (909024,)


 PySCF Dipole moment
Dipole moment(X, Y, Z, A.U.): -3.09253,  5.01428, -2.70772

============================================================
PyFock Python Program for Quantum Chemistry Simulations
                                        by Manas Sharma
============================================================
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m[38;5;45m█[0m  [38;5;51m█[0m[38;5;51m█[0m    [38;5;87m█[0m[38;5;87m█[0m [38;5;123m█[0m[38;5;123m█[0m[38;5;123m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m  [38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m   [38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m   [38;5;213m█[0m[38;5;213m█[0m
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m█[0m[38;5;45m█[0m [38;5;45m░[0m[38;5;45m█[0m[38;5;51m█[0m  [38;5;51m█[0m[38;5;51m█[0m[38;5;87m░[0m [38;5;87m█[0m[38;5;87m█[0m[38;5;87m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m [38;5;159m█[0m[38;5;159m█[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;219m░[0m [38;5;219m█[0m[38;5;219m█[0m  [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m 
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m   [38;5;45m░[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m░[0m  [38;5;87m█[0m[38;5;87m█[0m[38;5;87m█[0m[38;5;123m█[0m[38;5;123m█[0m   [38;5;159m█[0m[38;5;159m█[0m    [38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m      [38;5;219m█[0m[38;5;219m█[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m  
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m░[0m[38;5;45m░[0m    [38;5;51m░[0m[38;5;51m█[0m[38;5;87m█[0m[38;5;87m░[0m   [38;5;123m█[0m[38;5;123m█[0m[38;5;123m░[0m[38;5;159m░[0m[38;5;159m░[0m   [38;5;195m█[0m[38;5;195m█[0m    [38;5;225m█[0m[38;5;219m█[0m [38;5;219m█[0m[38;5;219m█[0m      [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m 
[38;5;39m█[0m[38;5;39m█[0m         [38;5;51m█[0m[38;5;87m█[0m    [38;5;123m█[0m[38;5;123m█[0m      [38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;219m░[0m [38;5;219m░[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m  [38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m
[38;5;39m░[0m[38;5;39m░[0m         [38;5;51m░[0m[38;5;87m░[0m    [38;5;123m░[0m[38;5;123m░[0m       [38;5;195m░[0m[38;5;195m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m   [38;5;219m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m [38;5;213m░[0m[38;5;213m░[0m   [38;5;213m░[0m[38;5;213m░[0m

============================================================


Number of atoms: 96


Number of basis functions (atomic orbitals): 800


Number of auxiliary basis functions: 2720


================================================================================


Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 9334 32-Core Processor
Number of Cores: 64
Number of Threads: 128
Memory (GB): 2267.59
Running DFT using 48 threads for Numba.



Calculating one electron integrals...


Core H size in GB  0.00512
done!
Time taken 0.1620648339157924 seconds.

Stricter version of Schwarz screening:  False

Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.14234401599969715 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.030772843048907816
Time taken to evaluate the square roots needed:  0.002508749021217227
Time for significant indices evaluation:  0.007163579924963415
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.007689608
No. of elements in the standard three-centered two electron ERI tensor:  1740800000
No. of elements in the triangular three-centered two electron ERI tensor:  871488000
No. of significant triplets based on Schwarz inequality and triangularity: 280998144 or 16.1% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.04278602998238057 seconds.

Two Center Two electron ERI size in GB  0.0591872
Three Center Two electron ERI size in GB  2.247985152
Three-centered two electron evaluation done!
Time taken for Cholesky factorization of two-centered two-electron integrals 0.2930035589961335 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  10.104209400014952 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  909024
Size (in GB) for storing the coordinates of grid:       0.021816576
Size (in GB) for storing the weights of grid:           0.007272192
Size (in GB) for storing the density at gridpoints:     0.007272192

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  5000
No. of batches:  182

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 1.2743557670619339 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    389
Average no. of basis functions contributing to a batch of grid points:    258

You have asked to save the values of significant basis functions and their gradients on grid points so as to avoid recalculation for each SCF cycle.
Please note: This will require addtional memory that is approximately :7.0 GB
Calculating the value of significantly contributing basis functions (atomic orbitals)...
done!
Time taken 0.7267695280024782 seconds.



------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Number of electrons:  320.5949327993114



------Iteration 1--------


Energies

Electron-Nuclear Energy       -15954.7541847494685
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2425.7817582857056
Coulomb Energy                  6281.0932454885588
Exchange-Correlation Energy     -291.6736204652615
--------------------------------------------------
Total Energy                   -2441.1126802798499
--------------------------------------------------



Energy difference :  2441.11268027985


HOMO-LUMO gap: 0.2851597355163535 au
HOMO-LUMO gap: 7.760 eV


Time taken for the previous iteration: 1.557767707039602


Number of electrons:  320.00008427106695



------Iteration 2--------


Energies

Electron-Nuclear Energy       -16073.3276271902541
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2465.1454399738436
Coulomb Energy                  6373.6780616896249
Exchange-Correlation Energy     -303.0140120607481
--------------------------------------------------
Total Energy                   -2439.0780164269199
--------------------------------------------------



Energy difference :  2.0346638529299526


HOMO-LUMO gap: 0.011545919761270406 au
HOMO-LUMO gap: 0.314 eV


Time taken for the previous iteration: 1.3246104390127584


Number of electrons:  320.0003728045969



------Iteration 3--------


Energies

Electron-Nuclear Energy       -15738.6825545194697
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2318.5548399341360
Coulomb Energy                  6172.9676988640367
Exchange-Correlation Energy     -281.4978621108430
--------------------------------------------------
Total Energy                   -2430.2177566715254
--------------------------------------------------



Energy difference :  8.860259755394509


HOMO-LUMO gap: 0.007853379873189681 au
HOMO-LUMO gap: 0.214 eV


Time taken for the previous iteration: 1.320951194036752


Number of electrons:  320.0002498415562



------Iteration 4--------


Energies

Electron-Nuclear Energy       -15954.2209779058794
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2404.8427248806624
Coulomb Energy                  6307.1581756191235
Exchange-Correlation Energy     -294.0483457553195
--------------------------------------------------
Total Energy                   -2437.8283020007993
--------------------------------------------------



Energy difference :  7.6105453292739185


HOMO-LUMO gap: 0.09822105208347498 au
HOMO-LUMO gap: 2.673 eV


Time taken for the previous iteration: 1.318024451029487


Number of electrons:  320.0001405048664



------Iteration 5--------


Energies

Electron-Nuclear Energy       -15962.9013496546522
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2411.3050765973044
Coulomb Energy                  6307.3216384349525
Exchange-Correlation Energy     -295.2940576368514
--------------------------------------------------
Total Energy                   -2441.1285710986322
--------------------------------------------------



Energy difference :  3.3002690978328246


HOMO-LUMO gap: 0.1342857541470428 au
HOMO-LUMO gap: 3.654 eV


Time taken for the previous iteration: 1.3432188929291442


Number of electrons:  320.00013885737116



------Iteration 6--------


Energies

Electron-Nuclear Energy       -15965.5820577096183
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2412.4124837607474
Coulomb Energy                  6308.8404094841317
Exchange-Correlation Energy     -295.4434682632267
--------------------------------------------------
Total Energy                   -2441.3325115673524
--------------------------------------------------



Energy difference :  0.20394046872024774


HOMO-LUMO gap: 0.11680134186398256 au
HOMO-LUMO gap: 3.178 eV


Time taken for the previous iteration: 1.4186832299456


Number of electrons:  320.0001436264747



------Iteration 7--------


Energies

Electron-Nuclear Energy       -15961.3699624356104
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2410.9009487188027
Coulomb Energy                  6305.8736119335945
Exchange-Correlation Energy     -295.1895382375845
--------------------------------------------------
Total Energy                   -2441.3448188601824
--------------------------------------------------



Energy difference :  0.012307292829973449


HOMO-LUMO gap: 0.10766960437976714 au
HOMO-LUMO gap: 2.930 eV


Time taken for the previous iteration: 1.430150792002678


Number of electrons:  320.00014607441346



------Iteration 8--------


Energies

Electron-Nuclear Energy       -15960.7730340360959
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2410.4442777016852
Coulomb Energy                  6305.6664972983417
Exchange-Correlation Energy     -295.1253264388606
--------------------------------------------------
Total Energy                   -2441.3474643143145
--------------------------------------------------



Energy difference :  0.002645454132107261


HOMO-LUMO gap: 0.10209808258454967 au
HOMO-LUMO gap: 2.778 eV


Time taken for the previous iteration: 1.4356773459585384


Number of electrons:  320.00014569209435



------Iteration 9--------


Energies

Electron-Nuclear Energy       -15960.2214897525464
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2410.2103219635628
Coulomb Energy                  6305.3163214621018
Exchange-Correlation Energy     -295.0936753250572
--------------------------------------------------
Total Energy                   -2441.3484004913244
--------------------------------------------------



Energy difference :  0.0009361770098621491


HOMO-LUMO gap: 0.09187941102538755 au
HOMO-LUMO gap: 2.500 eV


Time taken for the previous iteration: 1.37277901195921


Number of electrons:  320.00014684351834



------Iteration 10--------


Energies

Electron-Nuclear Energy       -15960.0288457687329
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2410.1539421311677
Coulomb Energy                  6305.1698122767903
Exchange-Correlation Energy     -295.0838085981942
--------------------------------------------------
Total Energy                   -2441.3487787983540
--------------------------------------------------



Energy difference :  0.0003783070296776714


HOMO-LUMO gap: 0.08532884567690413 au
HOMO-LUMO gap: 2.322 eV


Time taken for the previous iteration: 1.4039944719988853


Number of electrons:  320.00014702418605



------Iteration 11--------


Energies

Electron-Nuclear Energy       -15960.3751032411674
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2410.3239580014456
Coulomb Energy                  6305.3690008167523
Exchange-Correlation Energy     -295.1067780905639
--------------------------------------------------
Total Energy                   -2441.3488013529186
--------------------------------------------------



Energy difference :  2.2554564566235058e-05


HOMO-LUMO gap: 0.08625844820312878 au
HOMO-LUMO gap: 2.347 eV


Time taken for the previous iteration: 1.4838548040715978


Number of electrons:  320.00014733843756



------Iteration 12--------


Energies

Electron-Nuclear Energy       -15959.8012435399633
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2410.0398273151009
Coulomb Energy                  6305.0406253117762
Exchange-Correlation Energy     -295.0681880478645
--------------------------------------------------
Total Energy                   -2441.3488578003362
--------------------------------------------------



Energy difference :  5.644741759169847e-05


HOMO-LUMO gap: 0.0862239416034658 au
HOMO-LUMO gap: 2.346 eV


Time taken for the previous iteration: 1.3263407920021564


Number of electrons:  320.0001471482532



------Iteration 13--------


Energies

Electron-Nuclear Energy       -15960.0700687506160
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2410.1756645471096
Coulomb Energy                  6305.1920373774446
Exchange-Correlation Energy     -295.0866506930820
--------------------------------------------------
Total Energy                   -2441.3488963585278
--------------------------------------------------



Energy difference :  3.855819159070961e-05


HOMO-LUMO gap: 0.08621471792067048 au
HOMO-LUMO gap: 2.346 eV


Time taken for the previous iteration: 1.4425271799555048


Number of electrons:  320.00014717647133



------Iteration 14--------


Energies

Electron-Nuclear Energy       -15960.0282530212498
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2410.1552603761002
Coulomb Energy                  6305.1678179025303
Exchange-Correlation Energy     -295.0838431132053
--------------------------------------------------
Total Energy                   -2441.3488966952109
--------------------------------------------------



Energy difference :  3.36683115165215e-07


HOMO-LUMO gap: 0.08627113749062065 au
HOMO-LUMO gap: 2.348 eV


Time taken for the previous iteration: 1.3971037969458848


Number of electrons:  320.00014716680414



------Iteration 15--------


Energies

Electron-Nuclear Energy       -15960.0356407417094
Nuclear repulsion Energy        5098.4401211606146
Kinetic Energy                  2410.1593227649050
Coulomb Energy                  6305.1716937312940
Exchange-Correlation Energy     -295.0843936348730
--------------------------------------------------
Total Energy                   -2441.3488967197700
--------------------------------------------------



Energy difference :  2.455908543197438e-08

SCF Converged after 15 iterations!

-------------------------------------
Total Energy =  -2441.34889671977
-------------------------------------



Time taken : 33.37411336298101 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           2.001125295064412
Density Fitting                         2.9651708791498095
    DF (gamma)                          1.6091065790969878
    DF (coeff)                          0.15608687279745936
    DF (Jtri)                           0.8150405988562852
    DF (Cholesky)                       0.2930035589961335
DIIS                                    1.1714786801021546
KS matrix diagonalization               2.3651892461348325
One electron Integrals (S, T, Vnuc)     0.1620648339157924
Coulomb Integrals (2c2e + 3c2e)         9.811205841018818
Grids construction                      0
Exchange-Correlation Term               14.676924025872722
Misc.                                   0.22095456172246486
Complete SCF                            33.37411336298101
Energy diff (PySCF-CrysX) 8.537554094800726e-07


PyFock Dipole moment
Dipole moment(X, Y, Z, A.U.): -3.0926006564332056 5.013864611093595 -2.707893146056449
Max Diff dipole moment (PySCF-CrysX) 0.0004167587685515173

============================================================
Processing: ../../Structures/water_cluster_47.xyz
============================================================
#INFO: **** input file is /home/lu29vow/PyFock/benchmarks_tests/FINAL_Benchmarks_for_paper/Energy_and_Convergence_Validations/3D_Water_Clusters/benchmark_DFT_LDA_DF.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
#numba.config.THREADING_LAYER='tbb'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 48
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(1500000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)


basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'cc-pVDZ'


auxbasis_name = 'def2-universal-jfit'

# List of all molecules to calculate
xyz_files = [
    '../../Structures/water_cluster_1.xyz',
    '../../Structures/water_cluster_5.xyz',
    '../../Structures/water_cluster_10.xyz',
    '../../Structures/water_cluster_20.xyz',
    '../../Structures/water_cluster_32.xyz',
    '../../Structures/water_cluster_47.xyz',
    '../../Structures/water_cluster_76.xyz',
    '../../Structures/water_cluster_100.xyz',
    '../../Structures/water_cluster_139.xyz',
]


# Loop through all molecules
for xyzFilename in xyz_files:
    print(f"\n{'='*60}")
    print(f"Processing: {xyzFilename}")
    print(f"{'='*60}")

    # ---------PySCF---------------
    #Comparison with PySCF
    molPySCF = gto.Mole()
    molPySCF.atom = xyzFilename
    molPySCF.basis = basis_set_name
    molPySCF.cart = True
    molPySCF.verbose = 4
    molPySCF.max_memory=1500000
    molPySCF.build()

    print('\n\nPySCF Results\n\n')
    start=timer()
    mf = dft.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
    mf.xc = funcidpyscf
    mf.verbose = 4
    mf.direct_scf = False
    mf.init_guess = 'minao'
    dmat_init = mf.init_guess_by_minao(molPySCF)
    mf.max_cycle = 50
    mf.conv_tol = 1e-7
    mf.grids.level = 3
    energyPyscf = mf.kernel(dm0=dmat_init)
    print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
    print('One electron integrals energy',mf.scf_summary['e1'])
    print('Coulomb energy ',mf.scf_summary['coul'])
    print('EXC ',mf.scf_summary['exc'])
    duration = timer()-start
    print('PySCF time: ', duration)
    pyscfGrids = mf.grids
    print('PySCF Grid Size: ', pyscfGrids.weights.shape)
    print('\n\n PySCF Dipole moment')
    dmat = mf.make_rdm1()
    mol_dip_pyscf = mf.dip_moment(molPySCF, dmat, unit='AU')
    mf = 0

    #--------------------CrysX --------------------------

    #Initialize a Mol object with somewhat large geometry
    molCrysX = Mol(coordfile=xyzFilename)

    #Initialize a Basis object with a very large basis set
    basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})

    auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})

    dftObj = DFT(molCrysX, basis, auxbasis, xc=funcidcrysx, grids=pyscfGrids)
    dftObj.dmat = dmat_init
    dftObj.conv_crit = 1e-7
    dftObj.max_itr = 50
    dftObj.ncores = ncores
    dftObj.save_ao_values = True
    dftObj.rys = True
    dftObj.DF_algo = 10
    dftObj.blocksize = 5000
    dftObj.XC_algo = 2
    dftObj.debug = False
    dftObj.sortGrids = False
    dftObj.xc_bf_screen = True
    dftObj.threshold_schwarz = 1e-9
    dftObj.strict_schwarz = False
    dftObj.cholesky = True
    dftObj.orthogonalize = True
    # SAO or CAO basis
    dftObj.sao = False

    # GPU acceleration
    dftObj.use_gpu = False
    dftObj.keep_ao_in_gpu = False
    dftObj.use_libxc = False
    dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
    dftObj.n_gpus = 1 # Specify the number of GPUs
    dftObj.free_gpu_mem = True
    dftObj.threads_x = 32
    dftObj.threads_y = 32
    dftObj.dynamic_precision = False
    dftObj.keep_ints3c2e_in_gpu = True


    # Using PySCF grids to compare the energies
    energyCrysX, dmat = dftObj.scf()


    print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf))

    print('\n\nPyFock Dipole moment')
    M = Integrals.dipole_moment_mat_symm(basis)
    mol_dip = molCrysX.get_dipole_moment(M, dmat)
    print('Dipole moment(X, Y, Z, A.U.):', *mol_dip)
    print('Max Diff dipole moment (PySCF-CrysX)', abs(mol_dip_pyscf-mol_dip).max())

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
# import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
# print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='fat04.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64', processor='x86_64')  Threads 48
Python 3.8.6 (default, Oct 28 2021, 14:43:29) 
[GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]
numpy 1.22.4  scipy 1.7.1  h5py 3.5.0
Date: Mon Aug 11 09:19:14 2025
PySCF version 2.7.0
PySCF path  /home/lu29vow/.local/lib/python3.8/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 1500000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 141
[INPUT] num. electrons = 470
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Cartesian GTO integrals (6d 10f)
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 O    101.140000000000 103.233000000000 105.698000000000 AA  191.126900238510 195.082097017225 199.740271914278 Bohr   0.0
[INPUT]  2 H    101.800000000000 103.577000000000 106.365000000000 AA  192.374119480723 195.732162804075 201.000719239363 Bohr   0.0
[INPUT]  3 H    101.619000000000 102.707000000000 104.996000000000 AA  192.032079052177 194.088101075704 198.413684174833 Bohr   0.0
[INPUT]  4 O    103.662000000000 102.962000000000  95.665500000000 AA  195.892789524663 194.569981237468 180.781594569579 Bohr   0.0
[INPUT]  5 H    104.569000000000 102.981000000000  96.087800000000 AA  197.606771119644 194.605886033835 181.579625911983 Bohr   0.0
[INPUT]  6 H    103.118000000000 102.230000000000  96.076400000000 AA  194.864778512900 193.186701714286 181.558083034163 Bohr   0.0
[INPUT]  7 O     97.873900000000 103.017000000000 100.816000000000 AA  184.954865743068 194.673916174319 190.514628974151 Bohr   0.0
[INPUT]  8 H     98.128600000000 103.038000000000  99.848800000000 AA  185.436178986995 194.713600422935 188.686885866472 Bohr   0.0
[INPUT]  9 H     97.173800000000 102.317000000000 100.960000000000 AA  183.631868483260 193.351107887123 190.786749536089 Bohr   0.0
[INPUT] 10 O    101.099000000000 104.850000000000  99.030700000000 AA  191.049421467403 198.137784160647 187.140900923965 Bohr   0.0
[INPUT] 11 H    101.483000000000 104.260000000000  99.740500000000 AA  191.775076299236 197.022845747153 188.482228527182 Bohr   0.0
[INPUT] 12 H    101.829000000000 105.396000000000  98.619700000000 AA  192.428921538336 199.169574624659 186.364223486769 Bohr   0.0
[INPUT] 13 O    100.645000000000 100.169000000000  95.891500000000 AA  190.191485806851 189.291976171558 181.208672673731 Bohr   0.0
[INPUT] 14 H    101.491000000000 100.305000000000  96.406200000000 AA  191.790194108233 189.548978924499 182.181314710044 Bohr   0.0
[INPUT] 15 H     99.888700000000 100.618000000000  96.367800000000 AA  188.762285938842 190.140463201487 182.108749226861 Bohr   0.0
[INPUT] 16 O     99.814000000000 100.835000000000 101.232000000000 AA  188.621123397337 190.550533770518 191.300755041970 Bohr   0.0
[INPUT] 17 H     99.329200000000  99.976800000000 101.063000000000 AA  187.704984172148 188.928770810416 190.981391326919 Bohr   0.0
[INPUT] 18 H     99.151600000000 101.561000000000 101.414000000000 AA  187.369368812425 191.922474936952 191.644685196641 Bohr   0.0
[INPUT] 19 O     98.804000000000  98.512200000000  97.758100000000 AA  186.712500011526 186.161077928378 184.736035457844 Bohr   0.0
[INPUT] 20 H     99.782100000000  98.646900000000  97.916700000000 AA  188.560841133963 186.415624037357 185.035746021200 Bohr   0.0
[INPUT] 21 H     98.421800000000  99.326500000000  97.321300000000 AA  185.990246686718 187.699881911612 183.910603086634 Bohr   0.0
[INPUT] 22 O    100.747000000000 100.164000000000 103.736000000000 AA  190.384237871556 189.282527540935 196.032629257881 Bohr   0.0
[INPUT] 23 H    100.658000000000 100.628000000000 102.855000000000 AA  190.216052246470 190.159360462733 194.367780542139 Bohr   0.0
[INPUT] 24 H    100.105000000000  99.398600000000 103.776000000000 AA  189.171033699586 187.836131165193 196.108218302864 Bohr   0.0
[INPUT] 25 O     98.070300000000  98.516900000000 100.438000000000 AA  185.326007953933 186.169959641164 189.800312499066 Bohr   0.0
[INPUT] 26 H     97.172800000000  98.878600000000 100.690000000000 AA  183.629978757136 186.853473580419 190.276523482456 Bohr   0.0
[INPUT] 27 H     98.194000000000  98.592200000000  99.448100000000 AA  185.559767075542 186.312256018344 187.929672608359 Bohr   0.0
[INPUT] 28 O     96.373500000000  99.168100000000 103.663000000000 AA  182.119520665771 187.400549293481 195.894679250788 Bohr   0.0
[INPUT] 29 H     96.032600000000  99.385200000000 104.578000000000 AA  181.475313029907 187.810808835124 197.623778654765 Bohr   0.0
[INPUT] 30 H     97.337900000000  98.909800000000 103.720000000000 AA  183.941972540302 186.912433035505 196.002393639888 Bohr   0.0
[INPUT] 31 O     96.740700000000 101.641000000000  95.246600000000 AA  182.813428098711 192.073653026917 179.989988295999 Bohr   0.0
[INPUT] 32 H     95.765200000000 101.625000000000  95.027600000000 AA  180.970000264198 192.043417408924 179.576138274719 Bohr   0.0
[INPUT] 33 H     97.256100000000 101.957000000000  94.450300000000 AA  183.787392943312 192.670806482280 178.485199383007 Bohr   0.0
[INPUT] 34 O     96.855700000000  95.639100000000 102.759000000000 AA  183.030746603036 180.731705799890 194.186366834181 Bohr   0.0
[INPUT] 35 H     96.157300000000  96.250200000000 102.386000000000 AA  181.710961877640 181.886517434612 193.481498989718 Bohr   0.0
[INPUT] 36 H     97.741700000000  95.856700000000 102.349000000000 AA  184.705043949401 181.142910204596 193.411579123110 Bohr   0.0
[INPUT] 37 O    103.969000000000  95.809900000000 100.611000000000 AA  196.472935444905 181.054471021966 190.127235118615 Bohr   0.0
[INPUT] 38 H    104.656000000000  95.771500000000 101.336000000000 AA  197.771177292481 180.981905538783 191.497286558925 Bohr   0.0
[INPUT] 39 H    103.152000000000  96.276300000000 100.950000000000 AA  194.929029201135 181.935839286463 190.767852274843 Bohr   0.0
[INPUT] 40 O     98.463200000000 103.644000000000 104.855000000000 AA  186.068481348275 195.858774454421 198.147232791270 Bohr   0.0
[INPUT] 41 H     99.448900000000 103.710000000000 105.009000000000 AA  187.931184389258 195.983496378643 198.438250614453 Bohr   0.0
[INPUT] 42 H     98.023000000000 103.265000000000 105.669000000000 AA  185.236623908241 195.142568253211 199.685469856666 Bohr   0.0
[INPUT] 43 O     98.548000000000 101.265000000000  97.248600000000 AA  186.228730123638 191.363116004081 183.773219997378 Bohr   0.0
[INPUT] 44 H     98.688900000000 102.140000000000  97.711000000000 AA  186.494992534589 193.016626363075 184.647029357377 Bohr   0.0
[INPUT] 45 H     97.919900000000 101.391000000000  96.480800000000 AA  185.041793144798 191.601221495776 182.322288278937 Bohr   0.0
[INPUT] 46 O    104.764000000000 102.907000000000 101.929000000000 AA  197.975267713934 194.466046300617 192.617894150792 Bohr   0.0
[INPUT] 47 H    104.157000000000 103.650000000000 101.648000000000 AA  196.828203956323 195.870112811169 192.086881109789 Bohr   0.0
[INPUT] 48 H    105.597000000000 103.289000000000 102.328000000000 AA  199.549409575697 195.187921680201 193.371894874494 Bohr   0.0
[INPUT] 49 O    104.727000000000  95.435700000000  98.038700000000 AA  197.905347847325 180.347335506154 185.266292608397 Bohr   0.0
[INPUT] 50 H    103.947000000000  95.065800000000  97.535100000000 AA  196.431361470164 179.648325812677 184.314626532066 Bohr   0.0
[INPUT] 51 H    104.496000000000  95.504800000000  99.009000000000 AA  197.468821112551 180.477915581361 187.099893867062 Bohr   0.0
[INPUT] 52 O    103.898000000000  98.427900000000  99.984500000000 AA  196.338764890061 186.001774016077 188.943321701575 Bohr   0.0
[INPUT] 53 H    103.015000000000  98.654900000000  99.573700000000 AA  194.670136722070 186.430741846354 188.167022209604 Bohr   0.0
[INPUT] 54 H    104.128000000000  97.477300000000  99.776100000000 AA  196.773401898711 184.205400362066 188.549502777216 Bohr   0.0
[INPUT] 55 O     99.166600000000  96.442100000000 101.723000000000 AA  187.397714704294 182.249155877916 192.228610569132 Bohr   0.0
[INPUT] 56 H     98.843200000000  97.206600000000 101.166000000000 AA  186.786577275609 183.693851500146 191.176033117749 Bohr   0.0
[INPUT] 57 H     99.643900000000  95.783700000000 101.141000000000 AA  188.299680983549 181.004960197502 191.128789964635 Bohr   0.0
[INPUT] 58 O    102.891000000000 100.842000000000  97.477600000000 AA  194.435810682624 190.563761853390 184.205967279903 Bohr   0.0
[INPUT] 59 H    103.837000000000 100.662000000000  97.209700000000 AA  196.223491596462 190.223611150968 183.699709651132 Bohr   0.0
[INPUT] 60 H    102.868000000000 101.166000000000  98.423400000000 AA  194.392346981759 191.176033117749 185.993270248517 Bohr   0.0
[INPUT] 61 O     96.227200000000 100.990000000000 101.698000000000 AA  181.843053733747 190.843441319826 192.181367416018 Bohr   0.0
[INPUT] 62 H     96.148800000000 100.422000000000 102.517000000000 AA  181.694899205581 189.770076881073 193.729053112036 Bohr   0.0
[INPUT] 63 H     95.313600000000 101.237000000000 101.375000000000 AA  180.116599946344 191.310203672593 191.570985877783 Bohr   0.0
[INPUT] 64 O     95.278100000000  97.169000000000  98.965800000000 AA  180.049514668922 183.622797797862 187.018257698481 Bohr   0.0
[INPUT] 65 H     95.144800000000  97.377000000000  99.934800000000 AA  179.797614176518 184.015860831772 188.849402313185 Bohr   0.0
[INPUT] 66 H     95.587900000000  97.991100000000  98.488100000000 AA  180.634951822313 185.176341644867 186.115535528776 Bohr   0.0
[INPUT] 67 O     98.864800000000  98.222500000000 103.917000000000 AA  186.827395359900 185.613624270092 196.374669686428 Bohr   0.0
[INPUT] 68 H     98.949800000000  97.463000000000 103.272000000000 AA  186.988022080488 184.178377278485 195.155796336083 Bohr   0.0
[INPUT] 69 H     99.054800000000  97.896400000000 104.843000000000 AA  187.186443323567 184.997384580871 198.124556077775 Bohr   0.0
[INPUT] 70 O    104.578000000000 100.035000000000 101.952000000000 AA  197.623778654765 189.038752870866 192.661357851657 Bohr   0.0
[INPUT] 71 H    104.419000000000 101.011000000000 101.802000000000 AA  197.323312200959 190.883125568441 192.377898932972 Bohr   0.0
[INPUT] 72 H    104.206000000000  99.514900000000 101.184000000000 AA  196.920800536427 188.055906313480 191.210048187991 Bohr   0.0
[INPUT] 73 O    102.429000000000 104.060000000000 101.348000000000 AA  193.562757213075 196.644900522240 191.519963272420 Bohr   0.0
[INPUT] 74 H    101.757000000000 103.665000000000 101.974000000000 AA  192.292861257367 195.898458703037 192.702931826398 Bohr   0.0
[INPUT] 75 H    102.209000000000 105.021000000000 101.185000000000 AA  193.147017465670 198.460927327947 191.211937914116 Bohr   0.0
[INPUT] 76 O     96.798000000000  93.944200000000 100.568000000000 AA  182.921709405649 177.528808991365 190.045976895259 Bohr   0.0
[INPUT] 77 H     97.508200000000  94.486700000000 100.119000000000 AA  184.263792899315 178.553985413942 189.197489865329 Bohr   0.0
[INPUT] 78 H     96.982400000000  93.900400000000 101.550000000000 AA  183.270174903019 177.446038987109 191.901687949582 Bohr   0.0
[INPUT] 79 O     95.118700000000  97.700600000000 101.797000000000 AA  179.748292324667 184.627376205681 192.368450302350 Bohr   0.0
[INPUT] 80 H     94.171300000000  97.423600000000 101.957000000000 AA  177.957965794254 184.103922069177 192.670806482280 Bohr   0.0
[INPUT] 81 H     95.377300000000  98.403200000000 102.460000000000 AA  180.236975500479 185.955097780801 193.621338722936 Bohr   0.0
[INPUT] 82 O    105.654000000000 100.606000000000  97.050900000000 AA  199.657123964797 190.117786487993 183.399621142551 Bohr   0.0
[INPUT] 83 H    105.817000000000  99.917100000000  96.344600000000 AA  199.965149323101 188.815954160780 182.064907580771 Bohr   0.0
[INPUT] 84 H    105.599000000000 100.160000000000  97.944500000000 AA  199.553189027946 189.274968636437 185.088280407463 Bohr   0.0
[INPUT] 85 O     98.708200000000 103.752000000000  98.244300000000 AA  186.531464248793 196.062864875874 185.654820299607 Bohr   0.0
[INPUT] 86 H     98.397100000000 104.234000000000  97.425400000000 AA  185.943570451441 196.973712867915 184.107323576201 Bohr   0.0
[INPUT] 87 H     99.598500000000 104.111000000000  98.524400000000 AA  188.213887417493 196.741276554593 186.184132587098 Bohr   0.0
[INPUT] 88 O     99.468000000000 105.283000000000  95.690500000000 AA  187.967278158238 198.956035572583 180.828837722693 Bohr   0.0
[INPUT] 89 H    100.395000000000 104.911000000000  95.651600000000 AA  189.719054275709 198.253057454245 180.755327376447 Bohr   0.0
[INPUT] 90 H     99.511900000000 106.279000000000  95.772300000000 AA  188.050237135106 200.838202792650 180.983417319682 Bohr   0.0
[INPUT] 91 O    102.160000000000  94.349500000000  98.747200000000 AA  193.054420885567 178.294714989651 186.605163567651 Bohr   0.0
[INPUT] 92 H    102.527000000000  93.534300000000  98.299300000000 AA  193.747950373282 176.754210252906 185.758755236458 Bohr   0.0
[INPUT] 93 H    102.436000000000  94.354600000000  99.708300000000 AA  193.575985295947 178.304352592887 188.421379345971 Bohr   0.0
[INPUT] 94 O     98.771600000000 100.739000000000 106.197000000000 AA  186.651272885090 190.369120062560 200.683245250436 Bohr   0.0
[INPUT] 95 H     99.398100000000 101.178000000000 106.840000000000 AA  187.835186302130 191.198709831244 201.898339148531 Bohr   0.0
[INPUT] 96 H     99.297200000000 100.231000000000 105.514000000000 AA  187.644512936162 189.409139191281 199.392562307358 Bohr   0.0
[INPUT] 97 O    103.454000000000  97.589900000000  96.421800000000 AA  195.499726490754 184.418183523692 182.210794437587 Bohr   0.0
[INPUT] 98 H    103.885000000000  98.135100000000  95.702500000000 AA  196.314198450441 185.448462206805 180.851514436188 Bohr   0.0
[INPUT] 99 H    104.142000000000  97.009800000000  96.857500000000 AA  196.799858064455 183.321953398832 183.034148110060 Bohr   0.0
[INPUT]100 O     95.630300000000  99.996600000000  98.245400000000 AA  180.715076209994 188.966187387683 185.656898998344 Bohr   0.0
[INPUT]101 H     96.540400000000 100.410000000000  98.268900000000 AA  182.434915955961 189.747400167578 185.701307562272 Bohr   0.0
[INPUT]102 H     94.982900000000 100.638000000000  97.834500000000 AA  179.491667516951 190.178257723979 184.880410533761 Bohr   0.0
[INPUT]103 O     99.505700000000  94.600000000000  99.762000000000 AA  188.038520833134 178.768091383855 188.522857638860 Bohr   0.0
[INPUT]104 H     98.915000000000  94.230400000000  99.044800000000 AA  186.922259611353 178.069648608216 187.167546062322 Bohr   0.0
[INPUT]105 H    100.455000000000  94.596700000000  99.446700000000 AA  189.832437843183 178.761855287644 187.927026991784 Bohr   0.0
[INPUT]106 O     93.723900000000 101.482000000000 100.592000000000 AA  177.112502326123 191.773186573112 190.091330322249 Bohr   0.0
[INPUT]107 H     93.285300000000 102.174000000000 100.019000000000 AA  176.283668447889 193.080877051311 189.008517252873 Bohr   0.0
[INPUT]108 H     93.374700000000 100.577000000000 100.347000000000 AA  176.452609963425 190.062984430380 189.628347421730 Bohr   0.0
[INPUT]109 O    102.360000000000 101.551000000000  99.964500000000 AA  193.432366110480 191.903577675707 188.905527179084 Bohr   0.0
[INPUT]110 H    102.675000000000 102.370000000000 100.444000000000 AA  194.027629839718 193.451263371725 189.811650855813 Bohr   0.0
[INPUT]111 H    101.556000000000 101.180000000000 100.430000000000 AA  191.913026306329 191.202489283493 189.785194690069 Bohr   0.0
[INPUT]112 O     99.128800000000  95.980100000000  96.602100000000 AA  187.326283056785 181.376102408367 182.551512057847 Bohr   0.0
[INPUT]113 H     99.037300000000  96.941600000000  96.861200000000 AA  187.153373116387 183.193074077136 183.041140096721 Bohr   0.0
[INPUT]114 H    100.097000000000  95.729200000000  96.588100000000 AA  189.155915890589 180.901970123714 182.525055892103 Bohr   0.0
[INPUT]115 O    103.544000000000  99.038500000000 104.412000000000 AA  195.669801841965 187.155640787737 197.310084118087 Bohr   0.0
[INPUT]116 H    104.182000000000  99.184200000000 103.655000000000 AA  196.875447109437 187.430973884086 195.879561441791 Bohr   0.0
[INPUT]117 H    102.605000000000  99.102500000000 104.073000000000 AA  193.895349010998 187.276583259709 196.669466961860 Bohr   0.0
[INPUT]118 O     99.482600000000  98.237100000000  94.256600000000 AA  187.994868159656 185.641214271510 178.119159432679 Bohr   0.0
[INPUT]119 H     98.968300000000  98.764500000000  93.580400000000 AA  187.022982013792 186.637855829606 176.841326627248 Bohr   0.0
[INPUT]120 H    100.018000000000  98.859300000000  94.827300000000 AA  189.006627526748 186.817001866215 179.197626131968 Bohr   0.0
[INPUT]121 O     97.111700000000 105.889000000000 101.284000000000 AA  183.514516490925 200.101209604070 191.399020800448 Bohr   0.0
[INPUT]122 H     97.802500000000 106.403000000000 101.792000000000 AA  184.819939297774 201.072528832096 192.359001671727 Bohr   0.0
[INPUT]123 H     97.487600000000 105.002000000000 101.014000000000 AA  184.224864541149 198.425022531581 190.888794746815 Bohr   0.0
[INPUT]124 O    103.133000000000 101.981000000000 104.535000000000 AA  194.893124404769 192.716159909270 197.542520431409 Bohr   0.0
[INPUT]125 H    103.581000000000 102.216000000000 103.673000000000 AA  195.739721708574 193.160245548542 195.913576512034 Bohr   0.0
[INPUT]126 H    102.678000000000 101.095000000000 104.444000000000 AA  194.033299018091 191.041862562905 197.370555354073 Bohr   0.0
[INPUT]127 O    101.858000000000  95.959800000000 104.565000000000 AA  192.483723595948 181.337740968038 197.599212215146 Bohr   0.0
[INPUT]128 H    102.487000000000  95.187200000000 104.478000000000 AA  193.672361328299 179.877738564199 197.434806042309 Bohr   0.0
[INPUT]129 H    100.951000000000  95.624200000000 104.818000000000 AA  190.769742000968 180.703548880634 198.077312924661 Bohr   0.0
[INPUT]130 O    106.341000000000  99.341900000000  99.395500000000 AA  200.955365812373 187.728983693930 187.830273014207 Bohr   0.0
[INPUT]131 H    105.471000000000  98.930500000000  99.666400000000 AA  199.311304084002 186.951550366284 188.342199821351 Bohr   0.0
[INPUT]132 H    107.040000000000  99.120000000000 100.075000000000 AA  202.276284373444 187.309653466889 189.114341915849 Bohr   0.0
[INPUT]133 O    101.836000000000  97.446700000000 102.110000000000 AA  192.442149621208 184.147574742654 192.959934579338 Bohr   0.0
[INPUT]134 H    100.860000000000  97.397400000000 101.898000000000 AA  190.597776923632 184.054411244713 192.559312640931 Bohr   0.0
[INPUT]135 H    101.991000000000  97.133400000000 103.047000000000 AA  192.735057170515 183.555523547828 194.730607958056 Bohr   0.0
[INPUT]136 O    101.665000000000  98.316100000000  98.319400000000 AA  192.119006453907 185.790502635351 185.796738731562 Bohr   0.0
[INPUT]137 H    101.904000000000  99.233800000000  98.002000000000 AA  192.570650997678 187.524704299864 185.196939659625 Bohr   0.0
[INPUT]138 H    102.224000000000  97.640900000000  97.837700000000 AA  193.175363357539 184.514559556045 184.886457657359 Bohr   0.0
[INPUT]139 O     99.984700000000 103.272000000000 102.307000000000 AA  188.943699646800 195.155796336083 193.332210625878 Bohr   0.0
[INPUT]140 H     99.640700000000 103.104000000000 103.231000000000 AA  188.293633859950 194.838322347156 195.078317564976 Bohr   0.0
[INPUT]141 H     99.216500000000 103.453000000000 101.693000000000 AA  187.492012037909 195.497836764629 192.171918785395 Bohr   0.0

nuclear repulsion = 9770.45725240077
number of shells = 564
number of NR pGTOs = 1833
number of NR cGTOs = 1175
basis = def2-SVP
ecp = {}
CPU time:      4225.95


PySCF Results


Initial guess from minao.


******** <class 'pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = False
chkfile to save SCF result = /tmp/tmpdczthtbv
max_memory 1500000 MB (current use 8918 MB)
XC library pyscf.dft.libxc version 6.1.0
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1–5 (2018)
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14fef7d784c0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14fef7dcce50>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 1583808
init E= -3583.24866369299
  HOMO = -0.400846058954152  LUMO = -0.110135649860537
cycle= 1 E= -3581.85525168824  delta_E= 1.39  |g|= 4.62  |ddm|= 9.51
  HOMO = 0.0214029374124725  LUMO = 0.026042119824567
cycle= 2 E= -3565.15042662227  delta_E= 16.7  |g|= 8.79  |ddm|= 13.4
  HOMO = -0.144271934581989  LUMO = -0.141486873517467
cycle= 3 E= -3579.00387761495  delta_E= -13.9  |g|= 3.55  |ddm|= 12.8
  HOMO = -0.160841842642457  LUMO = -0.0691548551490885
cycle= 4 E= -3585.33105317123  delta_E= -6.33  |g|= 1.41  |ddm|= 5.82
  HOMO = -0.171720597704971  LUMO = -0.0554917789235494
cycle= 5 E= -3585.69008895253  delta_E= -0.359  |g|= 0.428  |ddm|= 1.05
  HOMO = -0.118516432350691  LUMO = -0.0619200620965315
cycle= 6 E= -3585.72387703577  delta_E= -0.0338  |g|= 0.208  |ddm|= 0.47
  HOMO = -0.156019392081282  LUMO = -0.0537941664049826
cycle= 7 E= -3585.72899496031  delta_E= -0.00512  |g|= 0.164  |ddm|= 0.203
  HOMO = -0.161736906021013  LUMO = -0.050339206164968
cycle= 8 E= -3585.73367313469  delta_E= -0.00468  |g|= 0.0674  |ddm|= 0.126
  HOMO = -0.155357661589057  LUMO = -0.0497109566198552
cycle= 9 E= -3585.73456275158  delta_E= -0.00089  |g|= 0.0204  |ddm|= 0.063
  HOMO = -0.15268443292261  LUMO = -0.0498093218973131
cycle= 10 E= -3585.7346236438  delta_E= -6.09e-05  |g|= 0.0122  |ddm|= 0.0246
  HOMO = -0.152992702004631  LUMO = -0.0497230320273945
cycle= 11 E= -3585.73465019396  delta_E= -2.66e-05  |g|= 0.00199  |ddm|= 0.00961
  HOMO = -0.152945682000614  LUMO = -0.0496981126049025
cycle= 12 E= -3585.73465082965  delta_E= -6.36e-07  |g|= 0.000742  |ddm|= 0.00186
  HOMO = -0.152955499405347  LUMO = -0.049697254827481
cycle= 13 E= -3585.73465087751  delta_E= -4.79e-08  |g|= 0.00053  |ddm|= 0.000794
  HOMO = -0.152941901932584  LUMO = -0.0497010796257958
cycle= 14 E= -3585.73465092674  delta_E= -4.92e-08  |g|= 8.43e-05  |ddm|= 0.000398
  HOMO = -0.152949032831691  LUMO = -0.0496997598325747
Extra cycle  E= -3585.73465092339  delta_E= 3.35e-09  |g|= 0.000161  |ddm|= 0.00017
converged SCF energy = -3585.73465092339
Nuc-Nuc PySCF=  9770.457252400773
One electron integrals energy -24462.137288745816
Coulomb energy  11539.315986992906
EXC  -433.370601571254
PySCF time:  73.11668310803361
PySCF Grid Size:  (1325848,)


 PySCF Dipole moment
Dipole moment(X, Y, Z, A.U.):  0.89342,  2.92364,  0.13811

============================================================
PyFock Python Program for Quantum Chemistry Simulations
                                        by Manas Sharma
============================================================
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m[38;5;45m█[0m  [38;5;51m█[0m[38;5;51m█[0m    [38;5;87m█[0m[38;5;87m█[0m [38;5;123m█[0m[38;5;123m█[0m[38;5;123m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m  [38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m   [38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m   [38;5;213m█[0m[38;5;213m█[0m
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m█[0m[38;5;45m█[0m [38;5;45m░[0m[38;5;45m█[0m[38;5;51m█[0m  [38;5;51m█[0m[38;5;51m█[0m[38;5;87m░[0m [38;5;87m█[0m[38;5;87m█[0m[38;5;87m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m [38;5;159m█[0m[38;5;159m█[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;219m░[0m [38;5;219m█[0m[38;5;219m█[0m  [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m 
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m   [38;5;45m░[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m░[0m  [38;5;87m█[0m[38;5;87m█[0m[38;5;87m█[0m[38;5;123m█[0m[38;5;123m█[0m   [38;5;159m█[0m[38;5;159m█[0m    [38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m      [38;5;219m█[0m[38;5;219m█[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m  
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m░[0m[38;5;45m░[0m    [38;5;51m░[0m[38;5;51m█[0m[38;5;87m█[0m[38;5;87m░[0m   [38;5;123m█[0m[38;5;123m█[0m[38;5;123m░[0m[38;5;159m░[0m[38;5;159m░[0m   [38;5;195m█[0m[38;5;195m█[0m    [38;5;225m█[0m[38;5;219m█[0m [38;5;219m█[0m[38;5;219m█[0m      [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m 
[38;5;39m█[0m[38;5;39m█[0m         [38;5;51m█[0m[38;5;87m█[0m    [38;5;123m█[0m[38;5;123m█[0m      [38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;219m░[0m [38;5;219m░[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m  [38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m
[38;5;39m░[0m[38;5;39m░[0m         [38;5;51m░[0m[38;5;87m░[0m    [38;5;123m░[0m[38;5;123m░[0m       [38;5;195m░[0m[38;5;195m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m   [38;5;219m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m [38;5;213m░[0m[38;5;213m░[0m   [38;5;213m░[0m[38;5;213m░[0m

============================================================


Number of atoms: 141


Number of basis functions (atomic orbitals): 1175


Number of auxiliary basis functions: 3995


================================================================================


Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 9334 32-Core Processor
Number of Cores: 64
Number of Threads: 128
Memory (GB): 2267.59
Running DFT using 48 threads for Numba.



Calculating one electron integrals...


Core H size in GB  0.011045
done!
Time taken 0.32408348796889186 seconds.

Stricter version of Schwarz screening:  False

Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.3103050879435614 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.054003357072360814
Time taken to evaluate the square roots needed:  0.006443343940190971
Time for significant indices evaluation:  0.01567959995009005
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.016581608
No. of elements in the standard three-centered two electron ERI tensor:  5515596875
No. of elements in the triangular three-centered two electron ERI tensor:  2760145500
No. of significant triplets based on Schwarz inequality and triangularity: 674641995 or 12.2% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.07798097096383572 seconds.

Two Center Two electron ERI size in GB  0.1276802
Three Center Two electron ERI size in GB  5.39713596
Three-centered two electron evaluation done!
Time taken for Cholesky factorization of two-centered two-electron integrals 0.9145843129372224 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  22.94503594993148 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  1325848
Size (in GB) for storing the coordinates of grid:       0.031820352
Size (in GB) for storing the weights of grid:           0.010606784
Size (in GB) for storing the density at gridpoints:     0.010606784

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  5000
No. of batches:  266

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 2.904553701984696 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    474
Average no. of basis functions contributing to a batch of grid points:    304

You have asked to save the values of significant basis functions and their gradients on grid points so as to avoid recalculation for each SCF cycle.
Please note: This will require addtional memory that is approximately :12.1 GB
Calculating the value of significantly contributing basis functions (atomic orbitals)...
done!
Time taken 1.63102723704651 seconds.



------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Number of electrons:  470.90468638666874



------Iteration 1--------


Energies

Electron-Nuclear Energy       -28007.8523458472155
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3562.8768022072459
Coulomb Energy                 11517.5360221015671
Exchange-Correlation Energy     -428.4055394493581
--------------------------------------------------
Total Energy                   -3585.3878085608376
--------------------------------------------------



Energy difference :  3585.3878085608376


HOMO-LUMO gap: 0.2739789079978145 au
HOMO-LUMO gap: 7.455 eV


Time taken for the previous iteration: 2.4977845289977267


Number of electrons:  470.0000422719048



------Iteration 2--------


Energies

Electron-Nuclear Energy       -28165.5223784017908
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3620.4846459001378
Coulomb Energy                 11637.1876169123152
Exchange-Correlation Energy     -445.0097830058028
--------------------------------------------------
Total Energy                   -3582.4026461682188
--------------------------------------------------



Energy difference :  2.985162392618804


HOMO-LUMO gap: 0.004711891856623871 au
HOMO-LUMO gap: 0.128 eV


Time taken for the previous iteration: 2.2967736230930313


Number of electrons:  470.00024118690203



------Iteration 3--------


Energies

Electron-Nuclear Energy       -27704.2270792278941
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3406.4442704047087
Coulomb Energy                 11371.2630435693827
Exchange-Correlation Energy     -413.8400120812007
--------------------------------------------------
Total Energy                   -3569.9025249080787
--------------------------------------------------



Energy difference :  12.500121260140077


HOMO-LUMO gap: 0.0016517808244954357 au
HOMO-LUMO gap: 0.045 eV


Time taken for the previous iteration: 2.3018652650061995


Number of electrons:  470.000215133084



------Iteration 4--------


Energies

Electron-Nuclear Energy       -27957.9695962422120
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3527.7053590401874
Coulomb Energy                 11511.3524088107297
Exchange-Correlation Energy     -431.0667921567747
--------------------------------------------------
Total Energy                   -3579.5213681211480
--------------------------------------------------



Energy difference :  9.61884321306934


HOMO-LUMO gap: 0.0951076117695484 au
HOMO-LUMO gap: 2.588 eV


Time taken for the previous iteration: 2.3010643889429048


Number of electrons:  470.0000501295565



------Iteration 5--------


Energies

Electron-Nuclear Energy       -27999.0554604271965
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3538.4751484443636
Coulomb Energy                 11538.0208040150919
Exchange-Correlation Energy     -433.2537455143589
--------------------------------------------------
Total Energy                   -3585.3560010551773
--------------------------------------------------



Energy difference :  5.834632934029287


HOMO-LUMO gap: 0.13525074698697015 au
HOMO-LUMO gap: 3.680 eV


Time taken for the previous iteration: 2.289547560038045


Number of electrons:  470.00006321871575



------Iteration 6--------


Energies

Electron-Nuclear Energy       -28008.4327553691583
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3542.1427532835969
Coulomb Energy                 11543.8813981033436
Exchange-Correlation Energy     -433.7637706083908
--------------------------------------------------
Total Energy                   -3585.7151221636850
--------------------------------------------------



Energy difference :  0.3591211085076793


HOMO-LUMO gap: 0.10338853150523675 au
HOMO-LUMO gap: 2.813 eV


Time taken for the previous iteration: 2.4341569329844788


Number of electrons:  470.00005882199497



------Iteration 7--------


Energies

Electron-Nuclear Energy       -28002.9416617398128
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3540.6887360289948
Coulomb Energy                 11539.5583238545114
Exchange-Correlation Energy     -433.4926358724405
--------------------------------------------------
Total Energy                   -3585.7299853018249
--------------------------------------------------



Energy difference :  0.014863138139844523


HOMO-LUMO gap: 0.11007823506838274 au
HOMO-LUMO gap: 2.995 eV


Time taken for the previous iteration: 2.2942074219463393


Number of electrons:  470.0000627866614



------Iteration 8--------


Energies

Electron-Nuclear Energy       -28002.6267984412843
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3540.1276314470829
Coulomb Energy                 11539.7221608856689
Exchange-Correlation Energy     -433.4133445628130
--------------------------------------------------
Total Energy                   -3585.7330982444255
--------------------------------------------------



Energy difference :  0.003112942600637325


HOMO-LUMO gap: 0.11030655975298759 au
HOMO-LUMO gap: 3.002 eV


Time taken for the previous iteration: 2.458684148034081


Number of electrons:  470.00006038075907



------Iteration 9--------


Energies

Electron-Nuclear Energy       -28002.1156665461313
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3539.8707273583759
Coulomb Energy                 11539.4334320551716
Exchange-Correlation Energy     -433.3799996805929
--------------------------------------------------
Total Energy                   -3585.7342543862560
--------------------------------------------------



Energy difference :  0.0011561418305063853


HOMO-LUMO gap: 0.10519950667598235 au
HOMO-LUMO gap: 2.863 eV


Time taken for the previous iteration: 2.3293720020446926


Number of electrons:  470.0000605316591



------Iteration 10--------


Energies

Electron-Nuclear Energy       -28001.7688057103442
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3539.7424305938753
Coulomb Energy                 11539.1951695943862
Exchange-Correlation Energy     -433.3606176592313
--------------------------------------------------
Total Energy                   -3585.7345707543918
--------------------------------------------------



Energy difference :  0.0003163681358273607


HOMO-LUMO gap: 0.1021048491758153 au
HOMO-LUMO gap: 2.778 eV


Time taken for the previous iteration: 2.43813082203269


Number of electrons:  470.0000599418948



------Iteration 11--------


Energies

Electron-Nuclear Energy       -28002.4164949417245
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3540.0297438031798
Coulomb Energy                 11539.5946794540632
Exchange-Correlation Energy     -433.3997486669280
--------------------------------------------------
Total Energy                   -3585.7345679244863
--------------------------------------------------



Energy difference :  2.829905497492291e-06


HOMO-LUMO gap: 0.10350607598078562 au
HOMO-LUMO gap: 2.817 eV


Time taken for the previous iteration: 2.344529096968472


Number of electrons:  470.0000600450299



------Iteration 12--------


Energies

Electron-Nuclear Energy       -28001.8324477382339
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3539.7580489558618
Coulomb Energy                 11539.2456108445804
Exchange-Correlation Energy     -433.3630891233319
--------------------------------------------------
Total Energy                   -3585.7346246342040
--------------------------------------------------



Energy difference :  5.6709717682679184e-05


HOMO-LUMO gap: 0.10317282014086658 au
HOMO-LUMO gap: 2.807 eV


Time taken for the previous iteration: 2.368414465105161


Number of electrons:  470.0000601181452



------Iteration 13--------


Energies

Electron-Nuclear Energy       -28001.9143021738892
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3539.7970156485094
Coulomb Energy                 11539.2935446432257
Exchange-Correlation Energy     -433.3681622830344
--------------------------------------------------
Total Energy                   -3585.7346517382648
--------------------------------------------------



Energy difference :  2.7104060791316442e-05


HOMO-LUMO gap: 0.10320758601868785 au
HOMO-LUMO gap: 2.808 eV


Time taken for the previous iteration: 2.347678566002287


Number of electrons:  470.0000601206232



------Iteration 14--------


Energies

Electron-Nuclear Energy       -28001.9618894345513
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3539.8178915573676
Coulomb Energy                 11539.3231336863901
Exchange-Correlation Energy     -433.3710402674527
--------------------------------------------------
Total Energy                   -3585.7346520313240
--------------------------------------------------



Energy difference :  2.930592017946765e-07


HOMO-LUMO gap: 0.10324317002516048 au
HOMO-LUMO gap: 2.809 eV


Time taken for the previous iteration: 2.2871774649247527


Number of electrons:  470.00006011107865



------Iteration 15--------


Energies

Electron-Nuclear Energy       -28001.9523702679289
Nuclear repulsion Energy        9770.4572524269224
Kinetic Energy                  3539.8149542404585
Coulomb Energy                 11539.3161505694115
Exchange-Correlation Energy     -433.3706390738610
--------------------------------------------------
Total Energy                   -3585.7346521050004
--------------------------------------------------



Energy difference :  7.367634680122137e-08

SCF Converged after 15 iterations!

-------------------------------------
Total Energy =  -3585.7346521050004
-------------------------------------



Time taken : 63.0638733060332 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           4.535580939031206
Density Fitting                         5.705269056954421
    DF (gamma)                          2.508760836091824
    DF (coeff)                          0.39688234799541533
    DF (Jtri)                           1.709623233997263
    DF (Cholesky)                       0.9145843129372224
DIIS                                    3.1420479191001505
KS matrix diagonalization               5.420702484087087
One electron Integrals (S, T, Vnuc)     0.32408348796889186
Coulomb Integrals (2c2e + 3c2e)         22.030451636994258
Grids construction                      0
Exchange-Correlation Term               21.574601504136808
Misc.                                   0.331136277760379
Complete SCF                            63.0638733060332
Energy diff (PySCF-CrysX) 1.1816082405857742e-06


PyFock Dipole moment
Dipole moment(X, Y, Z, A.U.): 0.8932753725530347 2.923321219612262 0.13797063517267816
Max Diff dipole moment (PySCF-CrysX) 0.0003156993770971894

============================================================
Processing: ../../Structures/water_cluster_76.xyz
============================================================
#INFO: **** input file is /home/lu29vow/PyFock/benchmarks_tests/FINAL_Benchmarks_for_paper/Energy_and_Convergence_Validations/3D_Water_Clusters/benchmark_DFT_LDA_DF.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
#numba.config.THREADING_LAYER='tbb'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 48
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(1500000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)


basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'cc-pVDZ'


auxbasis_name = 'def2-universal-jfit'

# List of all molecules to calculate
xyz_files = [
    '../../Structures/water_cluster_1.xyz',
    '../../Structures/water_cluster_5.xyz',
    '../../Structures/water_cluster_10.xyz',
    '../../Structures/water_cluster_20.xyz',
    '../../Structures/water_cluster_32.xyz',
    '../../Structures/water_cluster_47.xyz',
    '../../Structures/water_cluster_76.xyz',
    '../../Structures/water_cluster_100.xyz',
    '../../Structures/water_cluster_139.xyz',
]


# Loop through all molecules
for xyzFilename in xyz_files:
    print(f"\n{'='*60}")
    print(f"Processing: {xyzFilename}")
    print(f"{'='*60}")

    # ---------PySCF---------------
    #Comparison with PySCF
    molPySCF = gto.Mole()
    molPySCF.atom = xyzFilename
    molPySCF.basis = basis_set_name
    molPySCF.cart = True
    molPySCF.verbose = 4
    molPySCF.max_memory=1500000
    molPySCF.build()

    print('\n\nPySCF Results\n\n')
    start=timer()
    mf = dft.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
    mf.xc = funcidpyscf
    mf.verbose = 4
    mf.direct_scf = False
    mf.init_guess = 'minao'
    dmat_init = mf.init_guess_by_minao(molPySCF)
    mf.max_cycle = 50
    mf.conv_tol = 1e-7
    mf.grids.level = 3
    energyPyscf = mf.kernel(dm0=dmat_init)
    print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
    print('One electron integrals energy',mf.scf_summary['e1'])
    print('Coulomb energy ',mf.scf_summary['coul'])
    print('EXC ',mf.scf_summary['exc'])
    duration = timer()-start
    print('PySCF time: ', duration)
    pyscfGrids = mf.grids
    print('PySCF Grid Size: ', pyscfGrids.weights.shape)
    print('\n\n PySCF Dipole moment')
    dmat = mf.make_rdm1()
    mol_dip_pyscf = mf.dip_moment(molPySCF, dmat, unit='AU')
    mf = 0

    #--------------------CrysX --------------------------

    #Initialize a Mol object with somewhat large geometry
    molCrysX = Mol(coordfile=xyzFilename)

    #Initialize a Basis object with a very large basis set
    basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})

    auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})

    dftObj = DFT(molCrysX, basis, auxbasis, xc=funcidcrysx, grids=pyscfGrids)
    dftObj.dmat = dmat_init
    dftObj.conv_crit = 1e-7
    dftObj.max_itr = 50
    dftObj.ncores = ncores
    dftObj.save_ao_values = True
    dftObj.rys = True
    dftObj.DF_algo = 10
    dftObj.blocksize = 5000
    dftObj.XC_algo = 2
    dftObj.debug = False
    dftObj.sortGrids = False
    dftObj.xc_bf_screen = True
    dftObj.threshold_schwarz = 1e-9
    dftObj.strict_schwarz = False
    dftObj.cholesky = True
    dftObj.orthogonalize = True
    # SAO or CAO basis
    dftObj.sao = False

    # GPU acceleration
    dftObj.use_gpu = False
    dftObj.keep_ao_in_gpu = False
    dftObj.use_libxc = False
    dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
    dftObj.n_gpus = 1 # Specify the number of GPUs
    dftObj.free_gpu_mem = True
    dftObj.threads_x = 32
    dftObj.threads_y = 32
    dftObj.dynamic_precision = False
    dftObj.keep_ints3c2e_in_gpu = True


    # Using PySCF grids to compare the energies
    energyCrysX, dmat = dftObj.scf()


    print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf))

    print('\n\nPyFock Dipole moment')
    M = Integrals.dipole_moment_mat_symm(basis)
    mol_dip = molCrysX.get_dipole_moment(M, dmat)
    print('Dipole moment(X, Y, Z, A.U.):', *mol_dip)
    print('Max Diff dipole moment (PySCF-CrysX)', abs(mol_dip_pyscf-mol_dip).max())

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
# import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
# print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='fat04.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64', processor='x86_64')  Threads 48
Python 3.8.6 (default, Oct 28 2021, 14:43:29) 
[GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]
numpy 1.22.4  scipy 1.7.1  h5py 3.5.0
Date: Mon Aug 11 09:21:32 2025
PySCF version 2.7.0
PySCF path  /home/lu29vow/.local/lib/python3.8/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 1500000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 228
[INPUT] num. electrons = 760
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Cartesian GTO integrals (6d 10f)
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 O     96.287700000000 105.219000000000 103.893000000000 AA  181.957382164283 198.835093100611 196.329316259438 Bohr   0.0
[INPUT]  2 H     96.781000000000 104.419000000000 104.235000000000 AA  182.889584061531 197.323312200959 196.975602594039 Bohr   0.0
[INPUT]  3 H     96.485600000000 105.342000000000 102.921000000000 AA  182.331358964335 199.067529413933 194.492502466361 Bohr   0.0
[INPUT]  4 O    101.140000000000 103.233000000000 105.698000000000 AA  191.126900238510 195.082097017225 199.740271914278 Bohr   0.0
[INPUT]  5 H    101.800000000000 103.577000000000 106.365000000000 AA  192.374119480723 195.732162804075 201.000719239363 Bohr   0.0
[INPUT]  6 H    101.619000000000 102.707000000000 104.996000000000 AA  192.032079052177 194.088101075704 198.413684174833 Bohr   0.0
[INPUT]  7 O     93.054300000000 101.153000000000 103.187000000000 AA  175.847141713115 191.151466678130 194.995169615495 Bohr   0.0
[INPUT]  8 H     93.153500000000 102.024000000000 103.669000000000 AA  176.034602544671 192.797418132626 195.906017607535 Bohr   0.0
[INPUT]  9 H     93.282100000000 101.279000000000 102.221000000000 AA  176.277621324291 191.389572169825 193.169694179165 Bohr   0.0
[INPUT] 10 O    103.662000000000 102.962000000000  95.665500000000 AA  195.892789524663 194.569981237468 180.781594569579 Bohr   0.0
[INPUT] 11 H    104.569000000000 102.981000000000  96.087800000000 AA  197.606771119644 194.605886033835 181.579625911983 Bohr   0.0
[INPUT] 12 H    103.118000000000 102.230000000000  96.076400000000 AA  194.864778512900 193.186701714286 181.558083034163 Bohr   0.0
[INPUT] 13 O    101.495000000000  96.997200000000  93.049900000000 AA  191.797753012731 183.298142849662 175.838826918167 Bohr   0.0
[INPUT] 14 H    100.616000000000  97.208900000000  93.477800000000 AA  190.136683749238 183.698197870233 176.647440726868 Bohr   0.0
[INPUT] 15 H    101.533000000000  96.022200000000  92.831100000000 AA  191.869562605464 181.455659878211 175.425354842112 Bohr   0.0
[INPUT] 16 O     97.873900000000 103.017000000000 100.816000000000 AA  184.954865743068 194.673916174319 190.514628974151 Bohr   0.0
[INPUT] 17 H     98.128600000000 103.038000000000  99.848800000000 AA  185.436178986995 194.713600422935 188.686885866472 Bohr   0.0
[INPUT] 18 H     97.173800000000 102.317000000000 100.960000000000 AA  183.631868483260 193.351107887123 190.786749536089 Bohr   0.0
[INPUT] 19 O    103.316000000000 100.168000000000 106.766000000000 AA  195.238944285564 189.290086445433 201.758499415313 Bohr   0.0
[INPUT] 20 H    103.471000000000  99.766300000000 105.864000000000 AA  195.531851834872 188.530983461195 200.053966450956 Bohr   0.0
[INPUT] 21 H    103.282000000000 101.164000000000 106.687000000000 AA  195.174693597329 191.172253665500 201.609211051473 Bohr   0.0
[INPUT] 22 O    101.099000000000 104.850000000000  99.030700000000 AA  191.049421467403 198.137784160647 187.140900923965 Bohr   0.0
[INPUT] 23 H    101.483000000000 104.260000000000  99.740500000000 AA  191.775076299236 197.022845747153 188.482228527182 Bohr   0.0
[INPUT] 24 H    101.829000000000 105.396000000000  98.619700000000 AA  192.428921538336 199.169574624659 186.364223486769 Bohr   0.0
[INPUT] 25 O    100.645000000000 100.169000000000  95.891500000000 AA  190.191485806851 189.291976171558 181.208672673731 Bohr   0.0
[INPUT] 26 H    101.491000000000 100.305000000000  96.406200000000 AA  191.790194108233 189.548978924499 182.181314710044 Bohr   0.0
[INPUT] 27 H     99.888700000000 100.618000000000  96.367800000000 AA  188.762285938842 190.140463201487 182.108749226861 Bohr   0.0
[INPUT] 28 O     99.814000000000 100.835000000000 101.232000000000 AA  188.621123397337 190.550533770518 191.300755041970 Bohr   0.0
[INPUT] 29 H     99.329200000000  99.976800000000 101.063000000000 AA  187.704984172148 188.928770810416 190.981391326919 Bohr   0.0
[INPUT] 30 H     99.151600000000 101.561000000000 101.414000000000 AA  187.369368812425 191.922474936952 191.644685196641 Bohr   0.0
[INPUT] 31 O     98.804000000000  98.512200000000  97.758100000000 AA  186.712500011526 186.161077928378 184.736035457844 Bohr   0.0
[INPUT] 32 H     99.782100000000  98.646900000000  97.916700000000 AA  188.560841133963 186.415624037357 185.035746021200 Bohr   0.0
[INPUT] 33 H     98.421800000000  99.326500000000  97.321300000000 AA  185.990246686718 187.699881911612 183.910603086634 Bohr   0.0
[INPUT] 34 O    100.747000000000 100.164000000000 103.736000000000 AA  190.384237871556 189.282527540935 196.032629257881 Bohr   0.0
[INPUT] 35 H    100.658000000000 100.628000000000 102.855000000000 AA  190.216052246470 190.159360462733 194.367780542139 Bohr   0.0
[INPUT] 36 H    100.105000000000  99.398600000000 103.776000000000 AA  189.171033699586 187.836131165193 196.108218302864 Bohr   0.0
[INPUT] 37 O     98.070300000000  98.516900000000 100.438000000000 AA  185.326007953933 186.169959641164 189.800312499066 Bohr   0.0
[INPUT] 38 H     97.172800000000  98.878600000000 100.690000000000 AA  183.629978757136 186.853473580419 190.276523482456 Bohr   0.0
[INPUT] 39 H     98.194000000000  98.592200000000  99.448100000000 AA  185.559767075542 186.312256018344 187.929672608359 Bohr   0.0
[INPUT] 40 O     99.241500000000 107.096000000000 102.899000000000 AA  187.539255191024 202.382109036420 194.450928491620 Bohr   0.0
[INPUT] 41 H     99.533400000000 106.810000000000 103.812000000000 AA  188.090866246784 201.841647364794 196.176248443348 Bohr   0.0
[INPUT] 42 H     99.798300000000 107.871000000000 102.599000000000 AA  188.591454697181 203.846646782958 193.884010654251 Bohr   0.0
[INPUT] 43 O     96.373500000000  99.168100000000 103.663000000000 AA  182.119520665771 187.400549293481 195.894679250788 Bohr   0.0
[INPUT] 44 H     96.032600000000  99.385200000000 104.578000000000 AA  181.475313029907 187.810808835124 197.623778654765 Bohr   0.0
[INPUT] 45 H     97.337900000000  98.909800000000 103.720000000000 AA  183.941972540302 186.912433035505 196.002393639888 Bohr   0.0
[INPUT] 46 O     92.236600000000  98.969600000000  99.830200000000 AA  174.301912661058 187.025438657754 188.651736960555 Bohr   0.0
[INPUT] 47 H     92.257200000000  98.492300000000 100.709000000000 AA  174.340841019224 186.123472378499 190.312428278823 Bohr   0.0
[INPUT] 48 H     92.125400000000  98.304300000000  99.091900000000 AA  174.091775116006 185.768203867081 187.256552162789 Bohr   0.0
[INPUT] 49 O     96.740700000000 101.641000000000  95.246600000000 AA  182.813428098711 192.073653026917 179.989988295999 Bohr   0.0
[INPUT] 50 H     95.765200000000 101.625000000000  95.027600000000 AA  180.970000264198 192.043417408924 179.576138274719 Bohr   0.0
[INPUT] 51 H     97.256100000000 101.957000000000  94.450300000000 AA  183.787392943312 192.670806482280 178.485199383007 Bohr   0.0
[INPUT] 52 O     96.855700000000  95.639100000000 102.759000000000 AA  183.030746603036 180.731705799890 194.186366834181 Bohr   0.0
[INPUT] 53 H     96.157300000000  96.250200000000 102.386000000000 AA  181.710961877640 181.886517434612 193.481498989718 Bohr   0.0
[INPUT] 54 H     97.741700000000  95.856700000000 102.349000000000 AA  184.705043949401 181.142910204596 193.411579123110 Bohr   0.0
[INPUT] 55 O     97.209000000000  95.906800000000  94.278900000000 AA  183.698386842845 181.237585483436 178.161300325257 Bohr   0.0
[INPUT] 56 H     97.087400000000  95.813100000000  93.290800000000 AA  183.468596146098 181.060518145565 176.294061941574 Bohr   0.0
[INPUT] 57 H     98.015300000000  96.468800000000  94.463700000000 AA  185.222073017082 182.299611565442 178.510521713077 Bohr   0.0
[INPUT] 58 O    103.969000000000  95.809900000000 100.611000000000 AA  196.472935444905 181.054471021966 190.127235118615 Bohr   0.0
[INPUT] 59 H    104.656000000000  95.771500000000 101.336000000000 AA  197.771177292481 180.981905538783 191.497286558925 Bohr   0.0
[INPUT] 60 H    103.152000000000  96.276300000000 100.950000000000 AA  194.929029201135 181.935839286463 190.767852274843 Bohr   0.0
[INPUT] 61 O    106.587000000000 100.034000000000 103.851000000000 AA  201.420238439016 189.036863144741 196.249947762206 Bohr   0.0
[INPUT] 62 H    105.829000000000 100.104000000000 103.203000000000 AA  199.987826036596 189.169143973461 195.025405233488 Bohr   0.0
[INPUT] 63 H    107.394000000000 100.487000000000 103.470000000000 AA  202.945247421540 189.892909079169 195.529962108747 Bohr   0.0
[INPUT] 64 O     98.463200000000 103.644000000000 104.855000000000 AA  186.068481348275 195.858774454421 198.147232791270 Bohr   0.0
[INPUT] 65 H     99.448900000000 103.710000000000 105.009000000000 AA  187.931184389258 195.983496378643 198.438250614453 Bohr   0.0
[INPUT] 66 H     98.023000000000 103.265000000000 105.669000000000 AA  185.236623908241 195.142568253211 199.685469856666 Bohr   0.0
[INPUT] 67 O    101.993000000000 104.014000000000  93.998500000000 AA  192.738836622764 196.557973120510 177.631421119929 Bohr   0.0
[INPUT] 68 H    102.580000000000 103.877000000000  94.796800000000 AA  193.848105857884 196.299080641445 179.139989485169 Bohr   0.0
[INPUT] 69 H    102.066000000000 103.222000000000  93.391700000000 AA  192.876786629858 195.061310029855 176.484735307543 Bohr   0.0
[INPUT] 70 O     98.548000000000 101.265000000000  97.248600000000 AA  186.228730123638 191.363116004081 183.773219997378 Bohr   0.0
[INPUT] 71 H     98.688900000000 102.140000000000  97.711000000000 AA  186.494992534589 193.016626363075 184.647029357377 Bohr   0.0
[INPUT] 72 H     97.919900000000 101.391000000000  96.480800000000 AA  185.041793144798 191.601221495776 182.322288278937 Bohr   0.0
[INPUT] 73 O     99.706100000000  94.287900000000 105.534000000000 AA  188.417221948497 178.178307860378 199.430356829849 Bohr   0.0
[INPUT] 74 H     98.709100000000  94.214400000000 105.511000000000 AA  186.533165002305 178.039412990223 199.386893128984 Bohr   0.0
[INPUT] 75 H    100.042000000000  93.988200000000 106.427000000000 AA  189.051980953738 177.611956940846 201.117882259086 Bohr   0.0
[INPUT] 76 O    104.764000000000 102.907000000000 101.929000000000 AA  197.975267713934 194.466046300617 192.617894150792 Bohr   0.0
[INPUT] 77 H    104.157000000000 103.650000000000 101.648000000000 AA  196.828203956323 195.870112811169 192.086881109789 Bohr   0.0
[INPUT] 78 H    105.597000000000 103.289000000000 102.328000000000 AA  199.549409575697 195.187921680201 193.371894874494 Bohr   0.0
[INPUT] 79 O    104.727000000000  95.435700000000  98.038700000000 AA  197.905347847325 180.347335506154 185.266292608397 Bohr   0.0
[INPUT] 80 H    103.947000000000  95.065800000000  97.535100000000 AA  196.431361470164 179.648325812677 184.314626532066 Bohr   0.0
[INPUT] 81 H    104.496000000000  95.504800000000  99.009000000000 AA  197.468821112551 180.477915581361 187.099893867062 Bohr   0.0
[INPUT] 82 O    103.898000000000  98.427900000000  99.984500000000 AA  196.338764890061 186.001774016077 188.943321701575 Bohr   0.0
[INPUT] 83 H    103.015000000000  98.654900000000  99.573700000000 AA  194.670136722070 186.430741846354 188.167022209604 Bohr   0.0
[INPUT] 84 H    104.128000000000  97.477300000000  99.776100000000 AA  196.773401898711 184.205400362066 188.549502777216 Bohr   0.0
[INPUT] 85 O     99.166600000000  96.442100000000 101.723000000000 AA  187.397714704294 182.249155877916 192.228610569132 Bohr   0.0
[INPUT] 86 H     98.843200000000  97.206600000000 101.166000000000 AA  186.786577275609 183.693851500146 191.176033117749 Bohr   0.0
[INPUT] 87 H     99.643900000000  95.783700000000 101.141000000000 AA  188.299680983549 181.004960197502 191.128789964635 Bohr   0.0
[INPUT] 88 O     94.272300000000 104.861000000000  98.027200000000 AA  178.148828132835 198.158571148017 185.244560757964 Bohr   0.0
[INPUT] 89 H     93.274400000000 104.806000000000  97.992700000000 AA  176.263070433131 198.054636211166 185.179365206667 Bohr   0.0
[INPUT] 90 H     94.652300000000 104.579000000000  97.146100000000 AA  178.866924060170 197.625668380890 183.579523069610 Bohr   0.0
[INPUT] 91 O     94.408300000000 105.314000000000 100.701000000000 AA  178.405830885776 199.014617082445 190.297310469826 Bohr   0.0
[INPUT] 92 H     94.396800000000 105.021000000000  99.744600000000 AA  178.384099035343 198.460927327947 188.489976404292 Bohr   0.0
[INPUT] 93 H     95.353500000000 105.456000000000 100.995000000000 AA  180.192000018715 199.282958192133 190.852889950448 Bohr   0.0
[INPUT] 94 O    106.040000000000  95.593700000000 102.478000000000 AA  200.386558248879 180.645912233835 193.655353793178 Bohr   0.0
[INPUT] 95 H    105.762000000000  96.182200000000 103.237000000000 AA  199.861214386250 181.758016058142 195.089655921723 Bohr   0.0
[INPUT] 96 H    106.867000000000  95.091200000000 102.732000000000 AA  201.949361753894 179.696324856241 194.135344228818 Bohr   0.0
[INPUT] 97 O    102.891000000000 100.842000000000  97.477600000000 AA  194.435810682624 190.563761853390 184.205967279903 Bohr   0.0
[INPUT] 98 H    103.837000000000 100.662000000000  97.209700000000 AA  196.223491596462 190.223611150968 183.699709651132 Bohr   0.0
[INPUT] 99 H    102.868000000000 101.166000000000  98.423400000000 AA  194.392346981759 191.176033117749 185.993270248517 Bohr   0.0
[INPUT]100 O     96.227200000000 100.990000000000 101.698000000000 AA  181.843053733747 190.843441319826 192.181367416018 Bohr   0.0
[INPUT]101 H     96.148800000000 100.422000000000 102.517000000000 AA  181.694899205581 189.770076881073 193.729053112036 Bohr   0.0
[INPUT]102 H     95.313600000000 101.237000000000 101.375000000000 AA  180.116599946344 191.310203672593 191.570985877783 Bohr   0.0
[INPUT]103 O     95.278100000000  97.169000000000  98.965800000000 AA  180.049514668922 183.622797797862 187.018257698481 Bohr   0.0
[INPUT]104 H     95.144800000000  97.377000000000  99.934800000000 AA  179.797614176518 184.015860831772 188.849402313185 Bohr   0.0
[INPUT]105 H     95.587900000000  97.991100000000  98.488100000000 AA  180.634951822313 185.176341644867 186.115535528776 Bohr   0.0
[INPUT]106 O     98.864800000000  98.222500000000 103.917000000000 AA  186.827395359900 185.613624270092 196.374669686428 Bohr   0.0
[INPUT]107 H     98.949800000000  97.463000000000 103.272000000000 AA  186.988022080488 184.178377278485 195.155796336083 Bohr   0.0
[INPUT]108 H     99.054800000000  97.896400000000 104.843000000000 AA  187.186443323567 184.997384580871 198.124556077775 Bohr   0.0
[INPUT]109 O    104.578000000000 100.035000000000 101.952000000000 AA  197.623778654765 189.038752870866 192.661357851657 Bohr   0.0
[INPUT]110 H    104.419000000000 101.011000000000 101.802000000000 AA  197.323312200959 190.883125568441 192.377898932972 Bohr   0.0
[INPUT]111 H    104.206000000000  99.514900000000 101.184000000000 AA  196.920800536427 188.055906313480 191.210048187991 Bohr   0.0
[INPUT]112 O    102.027000000000 106.876000000000 101.138000000000 AA  192.803087311000 201.966369289016 191.123120786261 Bohr   0.0
[INPUT]113 H    102.200000000000 106.695000000000 100.170000000000 AA  193.130009930549 201.624328860469 189.293865897682 Bohr   0.0
[INPUT]114 H    101.515000000000 107.729000000000 101.232000000000 AA  191.835547535222 203.578305673270 191.300755041970 Bohr   0.0
[INPUT]115 O    102.429000000000 104.060000000000 101.348000000000 AA  193.562757213075 196.644900522240 191.519963272420 Bohr   0.0
[INPUT]116 H    101.757000000000 103.665000000000 101.974000000000 AA  192.292861257367 195.898458703037 192.702931826398 Bohr   0.0
[INPUT]117 H    102.209000000000 105.021000000000 101.185000000000 AA  193.147017465670 198.460927327947 191.211937914116 Bohr   0.0
[INPUT]118 O     96.798000000000  93.944200000000 100.568000000000 AA  182.921709405649 177.528808991365 190.045976895259 Bohr   0.0
[INPUT]119 H     97.508200000000  94.486700000000 100.119000000000 AA  184.263792899315 178.553985413942 189.197489865329 Bohr   0.0
[INPUT]120 H     96.982400000000  93.900400000000 101.550000000000 AA  183.270174903019 177.446038987109 191.901687949582 Bohr   0.0
[INPUT]121 O     95.118700000000  97.700600000000 101.797000000000 AA  179.748292324667 184.627376205681 192.368450302350 Bohr   0.0
[INPUT]122 H     94.171300000000  97.423600000000 101.957000000000 AA  177.957965794254 184.103922069177 192.670806482280 Bohr   0.0
[INPUT]123 H     95.377300000000  98.403200000000 102.460000000000 AA  180.236975500479 185.955097780801 193.621338722936 Bohr   0.0
[INPUT]124 O     99.231100000000  93.154200000000 102.821000000000 AA  187.519602039328 176.035925352959 194.303529853904 Bohr   0.0
[INPUT]125 H     99.331300000000  93.817000000000 103.563000000000 AA  187.708952597010 177.288435828320 195.705706638331 Bohr   0.0
[INPUT]126 H    100.104000000000  93.053400000000 102.344000000000 AA  189.169143973461 175.845440959603 193.402130492487 Bohr   0.0
[INPUT]127 O    103.867000000000  98.228800000000  93.492200000000 AA  196.280183380199 185.625529544677 176.674652783062 Bohr   0.0
[INPUT]128 H    103.007000000000  97.732700000000  93.371700000000 AA  194.655018913073 184.688036414280 176.446940785052 Bohr   0.0
[INPUT]129 H    103.971000000000  98.898600000000  92.757000000000 AA  196.476714897154 186.891268102910 175.285326136281 Bohr   0.0
[INPUT]130 O    105.654000000000 100.606000000000  97.050900000000 AA  199.657123964797 190.117786487993 183.399621142551 Bohr   0.0
[INPUT]131 H    105.817000000000  99.917100000000  96.344600000000 AA  199.965149323101 188.815954160780 182.064907580771 Bohr   0.0
[INPUT]132 H    105.599000000000 100.160000000000  97.944500000000 AA  199.553189027946 189.274968636437 185.088280407463 Bohr   0.0
[INPUT]133 O     98.708200000000 103.752000000000  98.244300000000 AA  186.531464248793 196.062864875874 185.654820299607 Bohr   0.0
[INPUT]134 H     98.397100000000 104.234000000000  97.425400000000 AA  185.943570451441 196.973712867915 184.107323576201 Bohr   0.0
[INPUT]135 H     99.598500000000 104.111000000000  98.524400000000 AA  188.213887417493 196.741276554593 186.184132587098 Bohr   0.0
[INPUT]136 O     95.933300000000 100.069000000000 106.486000000000 AA  181.287663225737 189.103003559101 201.229376100435 Bohr   0.0
[INPUT]137 H     95.896800000000  99.719700000000 107.422000000000 AA  181.218688222191 188.442922223791 202.998159753028 Bohr   0.0
[INPUT]138 H     96.887400000000 100.192000000000 106.213000000000 AA  183.090650921185 189.335439872423 200.713480868429 Bohr   0.0
[INPUT]139 O     97.164700000000  94.924300000000 105.416000000000 AA  183.614671975527 179.380929566051 199.207369147151 Bohr   0.0
[INPUT]140 H     96.958600000000  95.152200000000 104.464000000000 AA  183.225199421254 179.811598149840 197.408349876565 Bohr   0.0
[INPUT]141 H     96.312500000000  94.858500000000 105.935000000000 AA  182.004247372173 179.256585587055 200.188137005800 Bohr   0.0
[INPUT]142 O     97.960300000000  99.738400000000  92.323200000000 AA  185.118138080231 188.478260102320 174.465562943445 Bohr   0.0
[INPUT]143 H     98.025100000000  99.203100000000  91.481000000000 AA  185.240592333103 187.466689707840 172.874035601336 Bohr   0.0
[INPUT]144 H     97.432100000000 100.570000000000  92.149900000000 AA  184.119984741236 190.049756347508 174.138073406058 Bohr   0.0
[INPUT]145 O    106.052000000000  98.653800000000  95.236000000000 AA  200.409234962374 186.428663147617 179.969957199078 Bohr   0.0
[INPUT]146 H    106.528000000000  97.778800000000  95.148400000000 AA  201.308744597667 184.775152788622 179.804417190566 Bohr   0.0
[INPUT]147 H    105.747000000000  98.958900000000  94.333900000000 AA  199.832868494382 187.005218588222 178.265235262108 Bohr   0.0
[INPUT]148 O     99.468000000000 105.283000000000  95.690500000000 AA  187.967278158238 198.956035572583 180.828837722693 Bohr   0.0
[INPUT]149 H    100.395000000000 104.911000000000  95.651600000000 AA  189.719054275709 198.253057454245 180.755327376447 Bohr   0.0
[INPUT]150 H     99.511900000000 106.279000000000  95.772300000000 AA  188.050237135106 200.838202792650 180.983417319682 Bohr   0.0
[INPUT]151 O    103.065000000000 106.418000000000  98.404100000000 AA  194.764623028298 201.100874723965 185.956798534313 Bohr   0.0
[INPUT]152 H    102.945000000000 107.087000000000  97.670300000000 AA  194.537855893350 202.365101501299 184.570117504107 Bohr   0.0
[INPUT]153 H    103.919000000000 106.605000000000  98.888900000000 AA  196.378449138677 201.454253509258 186.872937759502 Bohr   0.0
[INPUT]154 O    100.125000000000 101.870000000000  92.894300000000 AA  189.208828222077 192.506400309443 175.544785533184 Bohr   0.0
[INPUT]155 H     99.428600000000 101.298000000000  92.459700000000 AA  187.892822948930 191.425476966192 174.723510559448 Bohr   0.0
[INPUT]156 H     99.896600000000 101.996000000000  93.859700000000 AA  188.777214775226 192.744505801138 177.369127133839 Bohr   0.0
[INPUT]157 O    102.160000000000  94.349500000000  98.747200000000 AA  193.054420885567 178.294714989651 186.605163567651 Bohr   0.0
[INPUT]158 H    102.527000000000  93.534300000000  98.299300000000 AA  193.747950373282 176.754210252906 185.758755236458 Bohr   0.0
[INPUT]159 H    102.436000000000  94.354600000000  99.708300000000 AA  193.575985295947 178.304352592887 188.421379345971 Bohr   0.0
[INPUT]160 O    101.909000000000  92.717000000000 101.661000000000 AA  192.580099628301 175.209737091299 192.111447549409 Bohr   0.0
[INPUT]161 H    102.638000000000  93.177700000000 102.168000000000 AA  193.957709973109 176.080333916886 193.069538694563 Bohr   0.0
[INPUT]162 H    102.284000000000  91.918600000000 101.190000000000 AA  193.288746925013 173.700979753446 191.221386544739 Bohr   0.0
[INPUT]163 O     97.894300000000  93.636500000000  97.704600000000 AA  184.993416156010 176.947340262836 184.634935110180 Bohr   0.0
[INPUT]164 H     96.921800000000  93.462300000000  97.549500000000 AA  183.155657499870 176.618149971937 184.341838588259 Bohr   0.0
[INPUT]165 H     98.231600000000  94.279000000000  97.016600000000 AA  185.630820777825 178.161489297869 183.334803536479 Bohr   0.0
[INPUT]166 O     98.771600000000 100.739000000000 106.197000000000 AA  186.651272885090 190.369120062560 200.683245250436 Bohr   0.0
[INPUT]167 H     99.398100000000 101.178000000000 106.840000000000 AA  187.835186302130 191.198709831244 201.898339148531 Bohr   0.0
[INPUT]168 H     99.297200000000 100.231000000000 105.514000000000 AA  187.644512936162 189.409139191281 199.392562307358 Bohr   0.0
[INPUT]169 O     94.443800000000  94.651000000000  99.373500000000 AA  178.472916163198 178.864467416208 187.788699039466 Bohr   0.0
[INPUT]170 H     95.293900000000  94.301900000000  99.767700000000 AA  180.079372341691 178.204764026122 188.533629077770 Bohr   0.0
[INPUT]171 H     94.463600000000  95.650800000000  99.370600000000 AA  178.510332740464 180.753815595548 187.783218833705 Bohr   0.0
[INPUT]172 O    103.454000000000  97.589900000000  96.421800000000 AA  195.499726490754 184.418183523692 182.210794437587 Bohr   0.0
[INPUT]173 H    103.885000000000  98.135100000000  95.702500000000 AA  196.314198450441 185.448462206805 180.851514436188 Bohr   0.0
[INPUT]174 H    104.142000000000  97.009800000000  96.857500000000 AA  196.799858064455 183.321953398832 183.034148110060 Bohr   0.0
[INPUT]175 O     97.663000000000 103.755000000000  93.716600000000 AA  184.556322503398 196.068534054248 177.098707325414 Bohr   0.0
[INPUT]176 H     97.878200000000 104.678000000000  94.035900000000 AA  184.962991565404 197.812751267222 177.702096876988 Bohr   0.0
[INPUT]177 H     98.124000000000 103.587000000000  92.845200000000 AA  185.427486246822 195.751060065321 175.451999980468 Bohr   0.0
[INPUT]178 O     95.630300000000  99.996600000000  98.245400000000 AA  180.715076209994 188.966187387683 185.656898998344 Bohr   0.0
[INPUT]179 H     96.540400000000 100.410000000000  98.268900000000 AA  182.434915955961 189.747400167578 185.701307562272 Bohr   0.0
[INPUT]180 H     94.982900000000 100.638000000000  97.834500000000 AA  179.491667516951 190.178257723979 184.880410533761 Bohr   0.0
[INPUT]181 O     99.505700000000  94.600000000000  99.762000000000 AA  188.038520833134 178.768091383855 188.522857638860 Bohr   0.0
[INPUT]182 H     98.915000000000  94.230400000000  99.044800000000 AA  186.922259611353 178.069648608216 187.167546062322 Bohr   0.0
[INPUT]183 H    100.455000000000  94.596700000000  99.446700000000 AA  189.832437843183 178.761855287644 187.927026991784 Bohr   0.0
[INPUT]184 O     93.723900000000 101.482000000000 100.592000000000 AA  177.112502326123 191.773186573112 190.091330322249 Bohr   0.0
[INPUT]185 H     93.285300000000 102.174000000000 100.019000000000 AA  176.283668447889 193.080877051311 189.008517252873 Bohr   0.0
[INPUT]186 H     93.374700000000 100.577000000000 100.347000000000 AA  176.452609963425 190.062984430380 189.628347421730 Bohr   0.0
[INPUT]187 O    102.360000000000 101.551000000000  99.964500000000 AA  193.432366110480 191.903577675707 188.905527179084 Bohr   0.0
[INPUT]188 H    102.675000000000 102.370000000000 100.444000000000 AA  194.027629839718 193.451263371725 189.811650855813 Bohr   0.0
[INPUT]189 H    101.556000000000 101.180000000000 100.430000000000 AA  191.913026306329 191.202489283493 189.785194690069 Bohr   0.0
[INPUT]190 O     99.128800000000  95.980100000000  96.602100000000 AA  187.326283056785 181.376102408367 182.551512057847 Bohr   0.0
[INPUT]191 H     99.037300000000  96.941600000000  96.861200000000 AA  187.153373116387 183.193074077136 183.041140096721 Bohr   0.0
[INPUT]192 H    100.097000000000  95.729200000000  96.588100000000 AA  189.155915890589 180.901970123714 182.525055892103 Bohr   0.0
[INPUT]193 O    103.544000000000  99.038500000000 104.412000000000 AA  195.669801841965 187.155640787737 197.310084118087 Bohr   0.0
[INPUT]194 H    104.182000000000  99.184200000000 103.655000000000 AA  196.875447109437 187.430973884086 195.879561441791 Bohr   0.0
[INPUT]195 H    102.605000000000  99.102500000000 104.073000000000 AA  193.895349010998 187.276583259709 196.669466961860 Bohr   0.0
[INPUT]196 O     99.482600000000  98.237100000000  94.256600000000 AA  187.994868159656 185.641214271510 178.119159432679 Bohr   0.0
[INPUT]197 H     98.968300000000  98.764500000000  93.580400000000 AA  187.022982013792 186.637855829606 176.841326627248 Bohr   0.0
[INPUT]198 H    100.018000000000  98.859300000000  94.827300000000 AA  189.006627526748 186.817001866215 179.197626131968 Bohr   0.0
[INPUT]199 O     97.111700000000 105.889000000000 101.284000000000 AA  183.514516490925 200.101209604070 191.399020800448 Bohr   0.0
[INPUT]200 H     97.802500000000 106.403000000000 101.792000000000 AA  184.819939297774 201.072528832096 192.359001671727 Bohr   0.0
[INPUT]201 H     97.487600000000 105.002000000000 101.014000000000 AA  184.224864541149 198.425022531581 190.888794746815 Bohr   0.0
[INPUT]202 O    103.133000000000 101.981000000000 104.535000000000 AA  194.893124404769 192.716159909270 197.542520431409 Bohr   0.0
[INPUT]203 H    103.581000000000 102.216000000000 103.673000000000 AA  195.739721708574 193.160245548542 195.913576512034 Bohr   0.0
[INPUT]204 H    102.678000000000 101.095000000000 104.444000000000 AA  194.033299018091 191.041862562905 197.370555354073 Bohr   0.0
[INPUT]205 O    101.858000000000  95.959800000000 104.565000000000 AA  192.483723595948 181.337740968038 197.599212215146 Bohr   0.0
[INPUT]206 H    102.487000000000  95.187200000000 104.478000000000 AA  193.672361328299 179.877738564199 197.434806042309 Bohr   0.0
[INPUT]207 H    100.951000000000  95.624200000000 104.818000000000 AA  190.769742000968 180.703548880634 198.077312924661 Bohr   0.0
[INPUT]208 O    106.341000000000  99.341900000000  99.395500000000 AA  200.955365812373 187.728983693930 187.830273014207 Bohr   0.0
[INPUT]209 H    105.471000000000  98.930500000000  99.666400000000 AA  199.311304084002 186.951550366284 188.342199821351 Bohr   0.0
[INPUT]210 H    107.040000000000  99.120000000000 100.075000000000 AA  202.276284373444 187.309653466889 189.114341915849 Bohr   0.0
[INPUT]211 O    101.744000000000  97.726000000000 106.886000000000 AA  192.268294817748 184.675375249245 201.985266550261 Bohr   0.0
[INPUT]212 H    102.077000000000  97.166200000000 106.128000000000 AA  192.897573617228 183.617506564714 200.552854147841 Bohr   0.0
[INPUT]213 H    102.140000000000  98.642000000000 106.824000000000 AA  193.016626363075 186.406364379347 201.868103530538 Bohr   0.0
[INPUT]214 O     95.154200000000  95.840000000000  96.171700000000 AA  179.815377602089 181.111351778316 181.738173933834 Bohr   0.0
[INPUT]215 H     95.973800000000  95.821000000000  95.599100000000 AA  181.364197133782 181.075446981949 180.656116754908 Bohr   0.0
[INPUT]216 H     95.413800000000  96.026700000000  97.119200000000 AA  180.305950504026 181.464163645772 183.528689436859 Bohr   0.0
[INPUT]217 O    101.836000000000  97.446700000000 102.110000000000 AA  192.442149621208 184.147574742654 192.959934579338 Bohr   0.0
[INPUT]218 H    100.860000000000  97.397400000000 101.898000000000 AA  190.597776923632 184.054411244713 192.559312640931 Bohr   0.0
[INPUT]219 H    101.991000000000  97.133400000000 103.047000000000 AA  192.735057170515 183.555523547828 194.730607958056 Bohr   0.0
[INPUT]220 O    101.665000000000  98.316100000000  98.319400000000 AA  192.119006453907 185.790502635351 185.796738731562 Bohr   0.0
[INPUT]221 H    101.904000000000  99.233800000000  98.002000000000 AA  192.570650997678 187.524704299864 185.196939659625 Bohr   0.0
[INPUT]222 H    102.224000000000  97.640900000000  97.837700000000 AA  193.175363357539 184.514559556045 184.886457657359 Bohr   0.0
[INPUT]223 O     99.984700000000 103.272000000000 102.307000000000 AA  188.943699646800 195.155796336083 193.332210625878 Bohr   0.0
[INPUT]224 H     99.640700000000 103.104000000000 103.231000000000 AA  188.293633859950 194.838322347156 195.078317564976 Bohr   0.0
[INPUT]225 H     99.216500000000 103.453000000000 101.693000000000 AA  187.492012037909 195.497836764629 192.171918785395 Bohr   0.0
[INPUT]226 O     98.710500000000  97.265300000000 106.544000000000 AA  186.535810618880 183.804778423658 201.338980215660 Bohr   0.0
[INPUT]227 H     99.310200000000  97.423100000000 107.329000000000 AA  187.669079375781 184.102977206114 202.822415223443 Bohr   0.0
[INPUT]228 H     98.159900000000  96.446100000000 106.705000000000 AA  185.495327414694 182.256714782414 201.643226121715 Bohr   0.0

nuclear repulsion = 21802.9144441781
number of shells = 912
number of NR pGTOs = 2964
number of NR cGTOs = 1900
basis = def2-SVP
ecp = {}
CPU time:      8470.86


PySCF Results


Initial guess from minao.


******** <class 'pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = False
chkfile to save SCF result = /tmp/tmporuw9mr0
max_memory 1500000 MB (current use 13402 MB)
XC library pyscf.dft.libxc version 6.1.0
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1–5 (2018)
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14fef7d784c0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14fef7dcce50>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 2561048
init E= -5794.24378264104
  HOMO = -0.411543457790782  LUMO = -0.124820078931216
cycle= 1 E= -5792.05284602499  delta_E= 2.19  |g|= 5.85  |ddm|= 12.1
  HOMO = 0.028427262763843  LUMO = 0.0302718259733699
cycle= 2 E= -5763.26615933298  delta_E= 28.8  |g|= 11.2  |ddm|= 16.9
  HOMO = -0.121967002184453  LUMO = -0.119432510238133
cycle= 3 E= -5762.05639780341  delta_E= 1.21  |g|= 7.06  |ddm|= 19.5
  HOMO = -0.176380191680425  LUMO = -0.0760273470121262
cycle= 4 E= -5797.45651984425  delta_E= -35.4  |g|= 2.02  |ddm|= 13.6
  HOMO = -0.165399282683058  LUMO = -0.0760980537970087
cycle= 5 E= -5798.17587783237  delta_E= -0.719  |g|= 0.638  |ddm|= 1.54
  HOMO = -0.143646833161266  LUMO = -0.0794699865813764
cycle= 6 E= -5798.25065529826  delta_E= -0.0748  |g|= 0.292  |ddm|= 0.61
  HOMO = -0.146051769059928  LUMO = -0.0583013532639357
cycle= 7 E= -5798.26678327723  delta_E= -0.0161  |g|= 0.221  |ddm|= 0.37
  HOMO = -0.140755720203367  LUMO = -0.0610501297409319
cycle= 8 E= -5798.27547886217  delta_E= -0.0087  |g|= 0.104  |ddm|= 0.211
  HOMO = -0.12572631866447  LUMO = -0.0668602460623136
cycle= 9 E= -5798.27752772475  delta_E= -0.00205  |g|= 0.0323  |ddm|= 0.102
  HOMO = -0.119734738005898  LUMO = -0.0689911397875064
cycle= 10 E= -5798.27769617816  delta_E= -0.000168  |g|= 0.0166  |ddm|= 0.0377
  HOMO = -0.119923556596181  LUMO = -0.0690437435241491
cycle= 11 E= -5798.27774266793  delta_E= -4.65e-05  |g|= 0.00412  |ddm|= 0.0137
  HOMO = -0.119814219516838  LUMO = -0.0690401435946571
cycle= 12 E= -5798.27774555852  delta_E= -2.89e-06  |g|= 0.00123  |ddm|= 0.00356
  HOMO = -0.119792551242025  LUMO = -0.0690235654220309
cycle= 13 E= -5798.27774571932  delta_E= -1.61e-07  |g|= 0.00078  |ddm|= 0.00122
  HOMO = -0.119820138965696  LUMO = -0.0690321161218333
cycle= 14 E= -5798.27774582555  delta_E= -1.06e-07  |g|= 0.000157  |ddm|= 0.000596
  HOMO = -0.119819315263416  LUMO = -0.0690341825968884
cycle= 15 E= -5798.27774582805  delta_E= -2.51e-09  |g|= 0.000104  |ddm|= 0.000182
  HOMO = -0.119816654105939  LUMO = -0.0690311782216888
Extra cycle  E= -5798.27774582315  delta_E= 4.91e-09  |g|= 0.000197  |ddm|= 0.000217
converged SCF energy = -5798.27774582315
Nuc-Nuc PySCF=  21802.914444178077
One electron integrals energy -51568.55113338954
Coulomb energy  24668.096508796472
EXC  -700.7375654081546
PySCF time:  195.3752226489596
PySCF Grid Size:  (2131904,)


 PySCF Dipole moment
Dipole moment(X, Y, Z, A.U.):  6.13889,  4.36153, -5.32321

============================================================
PyFock Python Program for Quantum Chemistry Simulations
                                        by Manas Sharma
============================================================
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m[38;5;45m█[0m  [38;5;51m█[0m[38;5;51m█[0m    [38;5;87m█[0m[38;5;87m█[0m [38;5;123m█[0m[38;5;123m█[0m[38;5;123m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m  [38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m   [38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m   [38;5;213m█[0m[38;5;213m█[0m
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m█[0m[38;5;45m█[0m [38;5;45m░[0m[38;5;45m█[0m[38;5;51m█[0m  [38;5;51m█[0m[38;5;51m█[0m[38;5;87m░[0m [38;5;87m█[0m[38;5;87m█[0m[38;5;87m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m [38;5;159m█[0m[38;5;159m█[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;219m░[0m [38;5;219m█[0m[38;5;219m█[0m  [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m 
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m   [38;5;45m░[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m░[0m  [38;5;87m█[0m[38;5;87m█[0m[38;5;87m█[0m[38;5;123m█[0m[38;5;123m█[0m   [38;5;159m█[0m[38;5;159m█[0m    [38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m      [38;5;219m█[0m[38;5;219m█[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m  
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m░[0m[38;5;45m░[0m    [38;5;51m░[0m[38;5;51m█[0m[38;5;87m█[0m[38;5;87m░[0m   [38;5;123m█[0m[38;5;123m█[0m[38;5;123m░[0m[38;5;159m░[0m[38;5;159m░[0m   [38;5;195m█[0m[38;5;195m█[0m    [38;5;225m█[0m[38;5;219m█[0m [38;5;219m█[0m[38;5;219m█[0m      [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m 
[38;5;39m█[0m[38;5;39m█[0m         [38;5;51m█[0m[38;5;87m█[0m    [38;5;123m█[0m[38;5;123m█[0m      [38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;219m░[0m [38;5;219m░[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m  [38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m
[38;5;39m░[0m[38;5;39m░[0m         [38;5;51m░[0m[38;5;87m░[0m    [38;5;123m░[0m[38;5;123m░[0m       [38;5;195m░[0m[38;5;195m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m   [38;5;219m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m [38;5;213m░[0m[38;5;213m░[0m   [38;5;213m░[0m[38;5;213m░[0m

============================================================


Number of atoms: 228


Number of basis functions (atomic orbitals): 1900


Number of auxiliary basis functions: 6460


================================================================================


Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 9334 32-Core Processor
Number of Cores: 64
Number of Threads: 128
Memory (GB): 2267.59
Running DFT using 48 threads for Numba.



Calculating one electron integrals...


Core H size in GB  0.02888
done!
Time taken 0.839292595977895 seconds.

Stricter version of Schwarz screening:  False

Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.7103199718985707 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.10750189004465938
Time taken to evaluate the square roots needed:  0.01203233003616333
Time for significant indices evaluation:  0.07533101900480688
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.043342808
No. of elements in the standard three-centered two electron ERI tensor:  23320600000
No. of elements in the triangular three-centered two electron ERI tensor:  11666437000
No. of significant triplets based on Schwarz inequality and triangularity: 1927740608 or 8.3% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.19715214101597667 seconds.

Two Center Two electron ERI size in GB  0.3338528
Three Center Two electron ERI size in GB  15.421924864
Three-centered two electron evaluation done!
Time taken for Cholesky factorization of two-centered two-electron integrals 3.694213242037222 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  61.719150415970944 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  2131904
Size (in GB) for storing the coordinates of grid:       0.051165696
Size (in GB) for storing the weights of grid:           0.017055232
Size (in GB) for storing the density at gridpoints:     0.017055232

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  5000
No. of batches:  427

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 8.074957138043828 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    644
Average no. of basis functions contributing to a batch of grid points:    375

You have asked to save the values of significant basis functions and their gradients on grid points so as to avoid recalculation for each SCF cycle.
Please note: This will require addtional memory that is approximately :23.9 GB
Calculating the value of significantly contributing basis functions (atomic orbitals)...
done!
Time taken 2.9225638119969517 seconds.



------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Number of electrons:  761.4697423983241



------Iteration 1--------


Energies

Electron-Nuclear Energy       -57321.0434137627817
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5761.3178409472475
Coulomb Energy                 24651.8994434351080
Exchange-Correlation Energy     -692.7571628340474
--------------------------------------------------
Total Energy                   -5797.6688479778786
--------------------------------------------------



Energy difference :  5797.668847977879


HOMO-LUMO gap: 0.25780329548905545 au
HOMO-LUMO gap: 7.015 eV


Time taken for the previous iteration: 5.35296951897908


Number of electrons:  760.0001314650509



------Iteration 2--------


Energies

Electron-Nuclear Energy       -57557.7293727589131
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5854.1502880458347
Coulomb Energy                 24827.2798835174399
Exchange-Correlation Energy     -719.5517899757908
--------------------------------------------------
Total Energy                   -5792.9365469348340
--------------------------------------------------



Energy difference :  4.732301043044572


HOMO-LUMO gap: 0.011562618222068194 au
HOMO-LUMO gap: 0.315 eV


Time taken for the previous iteration: 4.581930226064287


Number of electrons:  760.0003977815516



------Iteration 3--------


Energies

Electron-Nuclear Energy       -56802.3275433217204
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5509.1238605581875
Coulomb Energy                 24386.6764739094288
Exchange-Correlation Energy     -669.7494860602879
--------------------------------------------------
Total Energy                   -5773.3622506777974
--------------------------------------------------



Energy difference :  19.57429625703662


HOMO-LUMO gap: 0.009876267146184683 au
HOMO-LUMO gap: 0.269 eV


Time taken for the previous iteration: 4.547500827000476


Number of electrons:  759.9999848280983



------Iteration 4--------


Energies

Electron-Nuclear Energy       -57249.2962357750803
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5707.2291790318041
Coulomb Energy                 24658.0488164921771
Exchange-Correlation Energy     -697.5784051662891
--------------------------------------------------
Total Energy                   -5778.6822011807963
--------------------------------------------------



Energy difference :  5.319950502998836


HOMO-LUMO gap: 0.05147196138471788 au
HOMO-LUMO gap: 1.401 eV


Time taken for the previous iteration: 4.656874367035925


Number of electrons:  760.0002334532347



------Iteration 5--------


Energies

Electron-Nuclear Energy       -57284.2753901419419
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5719.9964230157493
Coulomb Energy                 24664.0418064275545
Exchange-Correlation Energy     -700.3481474895958
--------------------------------------------------
Total Energy                   -5797.6708639516401
--------------------------------------------------



Energy difference :  18.988662770843803


HOMO-LUMO gap: 0.11070163604173722 au
HOMO-LUMO gap: 3.012 eV


Time taken for the previous iteration: 4.898976829950698


Number of electrons:  760.0001960602592



------Iteration 6--------


Energies

Electron-Nuclear Energy       -57299.8684028980642
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5726.1839704006843
Coulomb Energy                 24673.7225535156686
Exchange-Correlation Energy     -701.2011308109621
--------------------------------------------------
Total Energy                   -5798.2485655560813
--------------------------------------------------



Energy difference :  0.5777016044412449


HOMO-LUMO gap: 0.08389202974183263 au
HOMO-LUMO gap: 2.283 eV


Time taken for the previous iteration: 4.9684998979792


Number of electrons:  760.0002020101192



------Iteration 7--------


Energies

Electron-Nuclear Energy       -57293.8295248056093
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5724.8959463035853
Coulomb Energy                 24668.6640059750171
Exchange-Correlation Energy     -700.9109069823511
--------------------------------------------------
Total Energy                   -5798.2660352727653
--------------------------------------------------



Energy difference :  0.017469716683990555


HOMO-LUMO gap: 0.07978386326826836 au
HOMO-LUMO gap: 2.171 eV


Time taken for the previous iteration: 4.7998414860339835


Number of electrons:  760.0001971723715



------Iteration 8--------


Energies

Electron-Nuclear Energy       -57293.3035453449629
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5724.2510345875990
Coulomb Energy                 24668.6840882008582
Exchange-Correlation Energy     -700.8202860514272
--------------------------------------------------
Total Energy                   -5798.2742643713391
--------------------------------------------------



Energy difference :  0.008229098573792726


HOMO-LUMO gap: 0.07963629449213266 au
HOMO-LUMO gap: 2.167 eV


Time taken for the previous iteration: 5.06435485300608


Number of electrons:  760.0001982269285



------Iteration 9--------


Energies

Electron-Nuclear Energy       -57292.7307453255416
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5723.8635227641053
Coulomb Energy                 24668.4450102465453
Exchange-Correlation Energy     -700.7689960725304
--------------------------------------------------
Total Energy                   -5798.2767641508290
--------------------------------------------------



Energy difference :  0.0024997794898808934


HOMO-LUMO gap: 0.06441841428237106 au
HOMO-LUMO gap: 1.753 eV


Time taken for the previous iteration: 4.95402039703913


Number of electrons:  760.0001975213379



------Iteration 10--------


Energies

Electron-Nuclear Energy       -57291.7380961104427
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5723.4453883661727
Coulomb Energy                 24667.8098670085346
Exchange-Correlation Energy     -700.7090896019082
--------------------------------------------------
Total Energy                   -5798.2774861010512
--------------------------------------------------



Energy difference :  0.0007219502222142182


HOMO-LUMO gap: 0.04603254437518542 au
HOMO-LUMO gap: 1.253 eV


Time taken for the previous iteration: 4.875220856047235


Number of electrons:  760.000197420953



------Iteration 11--------


Energies

Electron-Nuclear Energy       -57293.5726202210863
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5724.3006402543215
Coulomb Energy                 24668.9053859702472
Exchange-Correlation Energy     -700.8252071200958
--------------------------------------------------
Total Energy                   -5798.2773568800258
--------------------------------------------------



Energy difference :  0.00012922102541779168


HOMO-LUMO gap: 0.049774367128129646 au
HOMO-LUMO gap: 1.354 eV


Time taken for the previous iteration: 4.8205426399363205


Number of electrons:  760.0001978833596



------Iteration 12--------


Energies

Electron-Nuclear Energy       -57292.0149765135502
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5723.5722627871446
Coulomb Energy                 24667.9763612645438
Exchange-Correlation Energy     -700.7258102953118
--------------------------------------------------
Total Energy                   -5798.2777185205814
--------------------------------------------------



Energy difference :  0.0003616405556385871


HOMO-LUMO gap: 0.050529196982934246 au
HOMO-LUMO gap: 1.375 eV


Time taken for the previous iteration: 4.875061856932007


Number of electrons:  760.0001978090471



------Iteration 13--------


Energies

Electron-Nuclear Energy       -57292.1084912877268
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5723.6135713256826
Coulomb Energy                 24668.0338517863020
Exchange-Correlation Energy     -700.7311213991657
--------------------------------------------------
Total Energy                   -5798.2777453383133
--------------------------------------------------



Energy difference :  2.6817731850314885e-05


HOMO-LUMO gap: 0.050640407420525085 au
HOMO-LUMO gap: 1.378 eV


Time taken for the previous iteration: 4.900217138114385


Number of electrons:  760.000197663578



------Iteration 14--------


Energies

Electron-Nuclear Energy       -57292.2524004963707
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5723.6765607348543
Coulomb Energy                 24668.1235076973935
Exchange-Correlation Energy     -700.7398590504032
--------------------------------------------------
Total Energy                   -5798.2777468779277
--------------------------------------------------



Energy difference :  1.5396144590340555e-06


HOMO-LUMO gap: 0.050769275951257326 au
HOMO-LUMO gap: 1.381 eV


Time taken for the previous iteration: 4.900834319065325


Number of electrons:  760.0001977466334



------Iteration 15--------


Energies

Electron-Nuclear Energy       -57292.2099892671467
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5723.6593022046827
Coulomb Energy                 24668.0959974721227
Exchange-Correlation Energy     -700.7375020566748
--------------------------------------------------
Total Energy                   -5798.2777474104259
--------------------------------------------------



Energy difference :  5.324982339516282e-07


HOMO-LUMO gap: 0.05079121364280964 au
HOMO-LUMO gap: 1.382 eV


Time taken for the previous iteration: 4.929123640060425


Number of electrons:  760.0001977326331



------Iteration 16--------


Energies

Electron-Nuclear Energy       -57292.2095994393749
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5723.6593680450305
Coulomb Energy                 24668.0955549943283
Exchange-Correlation Energy     -700.7375153612470
--------------------------------------------------
Total Energy                   -5798.2777475246658
--------------------------------------------------



Energy difference :  1.1423981050029397e-07


HOMO-LUMO gap: 0.05078572241216245 au
HOMO-LUMO gap: 1.382 eV


Time taken for the previous iteration: 5.073295717011206


Number of electrons:  760.00019773325



------Iteration 17--------


Energies

Electron-Nuclear Energy       -57292.2081155601554
Nuclear repulsion Energy       21802.9144442365941
Kinetic Energy                  5723.6586005756044
Coulomb Energy                 24668.0947336114295
Exchange-Correlation Energy     -700.7374103888591
--------------------------------------------------
Total Energy                   -5798.2777475253861
--------------------------------------------------



Energy difference :  7.203198038041592e-10

SCF Converged after 17 iterations!

-------------------------------------
Total Energy =  -5798.277747525386
-------------------------------------



Time taken : 156.90866246295627 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           10.99752095004078
Density Fitting                         16.515559735824354
    DF (gamma)                          6.466861766879447
    DF (coeff)                          0.951528126723133
    DF (Jtri)                           5.041954365093261
    DF (Cholesky)                       3.694213242037222
DIIS                                    9.45776072179433
KS matrix diagonalization               14.863251471426338
One electron Integrals (S, T, Vnuc)     0.839292595977895
Coulomb Integrals (2c2e + 3c2e)         58.02493717393372
Grids construction                      0
Exchange-Correlation Term               45.403900551144034
Misc.                                   0.8064392628148198
Complete SCF                            156.90866246295627
Energy diff (PySCF-CrysX) 1.7022393876686692e-06


PyFock Dipole moment
Dipole moment(X, Y, Z, A.U.): 6.138792192243272 4.361400385823799 -5.323253000155091
Max Diff dipole moment (PySCF-CrysX) 0.00012964894995093346

============================================================
Processing: ../../Structures/water_cluster_100.xyz
============================================================
#INFO: **** input file is /home/lu29vow/PyFock/benchmarks_tests/FINAL_Benchmarks_for_paper/Energy_and_Convergence_Validations/3D_Water_Clusters/benchmark_DFT_LDA_DF.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
#numba.config.THREADING_LAYER='tbb'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 48
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(1500000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)


basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'cc-pVDZ'


auxbasis_name = 'def2-universal-jfit'

# List of all molecules to calculate
xyz_files = [
    '../../Structures/water_cluster_1.xyz',
    '../../Structures/water_cluster_5.xyz',
    '../../Structures/water_cluster_10.xyz',
    '../../Structures/water_cluster_20.xyz',
    '../../Structures/water_cluster_32.xyz',
    '../../Structures/water_cluster_47.xyz',
    '../../Structures/water_cluster_76.xyz',
    '../../Structures/water_cluster_100.xyz',
    '../../Structures/water_cluster_139.xyz',
]


# Loop through all molecules
for xyzFilename in xyz_files:
    print(f"\n{'='*60}")
    print(f"Processing: {xyzFilename}")
    print(f"{'='*60}")

    # ---------PySCF---------------
    #Comparison with PySCF
    molPySCF = gto.Mole()
    molPySCF.atom = xyzFilename
    molPySCF.basis = basis_set_name
    molPySCF.cart = True
    molPySCF.verbose = 4
    molPySCF.max_memory=1500000
    molPySCF.build()

    print('\n\nPySCF Results\n\n')
    start=timer()
    mf = dft.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
    mf.xc = funcidpyscf
    mf.verbose = 4
    mf.direct_scf = False
    mf.init_guess = 'minao'
    dmat_init = mf.init_guess_by_minao(molPySCF)
    mf.max_cycle = 50
    mf.conv_tol = 1e-7
    mf.grids.level = 3
    energyPyscf = mf.kernel(dm0=dmat_init)
    print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
    print('One electron integrals energy',mf.scf_summary['e1'])
    print('Coulomb energy ',mf.scf_summary['coul'])
    print('EXC ',mf.scf_summary['exc'])
    duration = timer()-start
    print('PySCF time: ', duration)
    pyscfGrids = mf.grids
    print('PySCF Grid Size: ', pyscfGrids.weights.shape)
    print('\n\n PySCF Dipole moment')
    dmat = mf.make_rdm1()
    mol_dip_pyscf = mf.dip_moment(molPySCF, dmat, unit='AU')
    mf = 0

    #--------------------CrysX --------------------------

    #Initialize a Mol object with somewhat large geometry
    molCrysX = Mol(coordfile=xyzFilename)

    #Initialize a Basis object with a very large basis set
    basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})

    auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})

    dftObj = DFT(molCrysX, basis, auxbasis, xc=funcidcrysx, grids=pyscfGrids)
    dftObj.dmat = dmat_init
    dftObj.conv_crit = 1e-7
    dftObj.max_itr = 50
    dftObj.ncores = ncores
    dftObj.save_ao_values = True
    dftObj.rys = True
    dftObj.DF_algo = 10
    dftObj.blocksize = 5000
    dftObj.XC_algo = 2
    dftObj.debug = False
    dftObj.sortGrids = False
    dftObj.xc_bf_screen = True
    dftObj.threshold_schwarz = 1e-9
    dftObj.strict_schwarz = False
    dftObj.cholesky = True
    dftObj.orthogonalize = True
    # SAO or CAO basis
    dftObj.sao = False

    # GPU acceleration
    dftObj.use_gpu = False
    dftObj.keep_ao_in_gpu = False
    dftObj.use_libxc = False
    dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
    dftObj.n_gpus = 1 # Specify the number of GPUs
    dftObj.free_gpu_mem = True
    dftObj.threads_x = 32
    dftObj.threads_y = 32
    dftObj.dynamic_precision = False
    dftObj.keep_ints3c2e_in_gpu = True


    # Using PySCF grids to compare the energies
    energyCrysX, dmat = dftObj.scf()


    print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf))

    print('\n\nPyFock Dipole moment')
    M = Integrals.dipole_moment_mat_symm(basis)
    mol_dip = molCrysX.get_dipole_moment(M, dmat)
    print('Dipole moment(X, Y, Z, A.U.):', *mol_dip)
    print('Max Diff dipole moment (PySCF-CrysX)', abs(mol_dip_pyscf-mol_dip).max())

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
# import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
# print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='fat04.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64', processor='x86_64')  Threads 48
Python 3.8.6 (default, Oct 28 2021, 14:43:29) 
[GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]
numpy 1.22.4  scipy 1.7.1  h5py 3.5.0
Date: Mon Aug 11 09:27:27 2025
PySCF version 2.7.0
PySCF path  /home/lu29vow/.local/lib/python3.8/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 1500000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 300
[INPUT] num. electrons = 1000
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Cartesian GTO integrals (6d 10f)
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 O    104.008000000000 103.223000000000 106.729000000000 AA  196.546634763763 195.063199755979 201.688579548704 Bohr   0.0
[INPUT]  2 H    105.001000000000 103.340000000000 106.712000000000 AA  198.423132805456 195.284297712553 201.656454204587 Bohr   0.0
[INPUT]  3 H    103.694000000000 102.910000000000 105.833000000000 AA  195.953260760650 194.471715478991 199.995384941094 Bohr   0.0
[INPUT]  4 O     96.287700000000 105.219000000000 103.893000000000 AA  181.957382164283 198.835093100611 196.329316259438 Bohr   0.0
[INPUT]  5 H     96.781000000000 104.419000000000 104.235000000000 AA  182.889584061531 197.323312200959 196.975602594039 Bohr   0.0
[INPUT]  6 H     96.485600000000 105.342000000000 102.921000000000 AA  182.331358964335 199.067529413933 194.492502466361 Bohr   0.0
[INPUT]  7 O    101.140000000000 103.233000000000 105.698000000000 AA  191.126900238510 195.082097017225 199.740271914278 Bohr   0.0
[INPUT]  8 H    101.800000000000 103.577000000000 106.365000000000 AA  192.374119480723 195.732162804075 201.000719239363 Bohr   0.0
[INPUT]  9 H    101.619000000000 102.707000000000 104.996000000000 AA  192.032079052177 194.088101075704 198.413684174833 Bohr   0.0
[INPUT] 10 O     95.023600000000 104.404000000000  95.147300000000 AA  179.568579370221 197.294966309091 179.802338491829 Bohr   0.0
[INPUT] 11 H     94.639700000000 103.512000000000  94.908900000000 AA  178.843113511000 195.609330605979 179.351827783733 Bohr   0.0
[INPUT] 12 H     95.948400000000 104.479000000000  94.774200000000 AA  181.316198090218 197.436695768433 179.097281674754 Bohr   0.0
[INPUT] 13 O     93.054300000000 101.153000000000 103.187000000000 AA  175.847141713115 191.151466678130 194.995169615495 Bohr   0.0
[INPUT] 14 H     93.153500000000 102.024000000000 103.669000000000 AA  176.034602544671 192.797418132626 195.906017607535 Bohr   0.0
[INPUT] 15 H     93.282100000000 101.279000000000 102.221000000000 AA  176.277621324291 191.389572169825 193.169694179165 Bohr   0.0
[INPUT] 16 O    103.662000000000 102.962000000000  95.665500000000 AA  195.892789524663 194.569981237468 180.781594569579 Bohr   0.0
[INPUT] 17 H    104.569000000000 102.981000000000  96.087800000000 AA  197.606771119644 194.605886033835 181.579625911983 Bohr   0.0
[INPUT] 18 H    103.118000000000 102.230000000000  96.076400000000 AA  194.864778512900 193.186701714286 181.558083034163 Bohr   0.0
[INPUT] 19 O    101.495000000000  96.997200000000  93.049900000000 AA  191.797753012731 183.298142849662 175.838826918167 Bohr   0.0
[INPUT] 20 H    100.616000000000  97.208900000000  93.477800000000 AA  190.136683749238 183.698197870233 176.647440726868 Bohr   0.0
[INPUT] 21 H    101.533000000000  96.022200000000  92.831100000000 AA  191.869562605464 181.455659878211 175.425354842112 Bohr   0.0
[INPUT] 22 O     97.873900000000 103.017000000000 100.816000000000 AA  184.954865743068 194.673916174319 190.514628974151 Bohr   0.0
[INPUT] 23 H     98.128600000000 103.038000000000  99.848800000000 AA  185.436178986995 194.713600422935 188.686885866472 Bohr   0.0
[INPUT] 24 H     97.173800000000 102.317000000000 100.960000000000 AA  183.631868483260 193.351107887123 190.786749536089 Bohr   0.0
[INPUT] 25 O    103.316000000000 100.168000000000 106.766000000000 AA  195.238944285564 189.290086445433 201.758499415313 Bohr   0.0
[INPUT] 26 H    103.471000000000  99.766300000000 105.864000000000 AA  195.531851834872 188.530983461195 200.053966450956 Bohr   0.0
[INPUT] 27 H    103.282000000000 101.164000000000 106.687000000000 AA  195.174693597329 191.172253665500 201.609211051473 Bohr   0.0
[INPUT] 28 O    101.099000000000 104.850000000000  99.030700000000 AA  191.049421467403 198.137784160647 187.140900923965 Bohr   0.0
[INPUT] 29 H    101.483000000000 104.260000000000  99.740500000000 AA  191.775076299236 197.022845747153 188.482228527182 Bohr   0.0
[INPUT] 30 H    101.829000000000 105.396000000000  98.619700000000 AA  192.428921538336 199.169574624659 186.364223486769 Bohr   0.0
[INPUT] 31 O     96.773600000000 102.808000000000 107.170000000000 AA  182.875600088209 194.278963414285 202.521948769638 Bohr   0.0
[INPUT] 32 H     96.854200000000 102.589000000000 108.142000000000 AA  183.027912013849 193.865113393005 204.358762562715 Bohr   0.0
[INPUT] 33 H     96.421400000000 102.013000000000 106.676000000000 AA  182.210038547138 192.776631145256 201.588424064103 Bohr   0.0
[INPUT] 34 O    105.665000000000  96.993900000000 105.027000000000 AA  199.677910952167 183.291906753451 198.472265684695 Bohr   0.0
[INPUT] 35 H    104.749000000000  97.393500000000 104.997000000000 AA  197.946921822066 184.047041312827 198.415573900958 Bohr   0.0
[INPUT] 36 H    106.330000000000  97.657600000000 104.684000000000 AA  200.934578825003 184.546117982325 197.824089623969 Bohr   0.0
[INPUT] 37 O    100.645000000000 100.169000000000  95.891500000000 AA  190.191485806851 189.291976171558 181.208672673731 Bohr   0.0
[INPUT] 38 H    101.491000000000 100.305000000000  96.406200000000 AA  191.790194108233 189.548978924499 182.181314710044 Bohr   0.0
[INPUT] 39 H     99.888700000000 100.618000000000  96.367800000000 AA  188.762285938842 190.140463201487 182.108749226861 Bohr   0.0
[INPUT] 40 O     99.814000000000 100.835000000000 101.232000000000 AA  188.621123397337 190.550533770518 191.300755041970 Bohr   0.0
[INPUT] 41 H     99.329200000000  99.976800000000 101.063000000000 AA  187.704984172148 188.928770810416 190.981391326919 Bohr   0.0
[INPUT] 42 H     99.151600000000 101.561000000000 101.414000000000 AA  187.369368812425 191.922474936952 191.644685196641 Bohr   0.0
[INPUT] 43 O     98.804000000000  98.512200000000  97.758100000000 AA  186.712500011526 186.161077928378 184.736035457844 Bohr   0.0
[INPUT] 44 H     99.782100000000  98.646900000000  97.916700000000 AA  188.560841133963 186.415624037357 185.035746021200 Bohr   0.0
[INPUT] 45 H     98.421800000000  99.326500000000  97.321300000000 AA  185.990246686718 187.699881911612 183.910603086634 Bohr   0.0
[INPUT] 46 O    100.747000000000 100.164000000000 103.736000000000 AA  190.384237871556 189.282527540935 196.032629257881 Bohr   0.0
[INPUT] 47 H    100.658000000000 100.628000000000 102.855000000000 AA  190.216052246470 190.159360462733 194.367780542139 Bohr   0.0
[INPUT] 48 H    100.105000000000  99.398600000000 103.776000000000 AA  189.171033699586 187.836131165193 196.108218302864 Bohr   0.0
[INPUT] 49 O     98.070300000000  98.516900000000 100.438000000000 AA  185.326007953933 186.169959641164 189.800312499066 Bohr   0.0
[INPUT] 50 H     97.172800000000  98.878600000000 100.690000000000 AA  183.629978757136 186.853473580419 190.276523482456 Bohr   0.0
[INPUT] 51 H     98.194000000000  98.592200000000  99.448100000000 AA  185.559767075542 186.312256018344 187.929672608359 Bohr   0.0
[INPUT] 52 O     99.241500000000 107.096000000000 102.899000000000 AA  187.539255191024 202.382109036420 194.450928491620 Bohr   0.0
[INPUT] 53 H     99.533400000000 106.810000000000 103.812000000000 AA  188.090866246784 201.841647364794 196.176248443348 Bohr   0.0
[INPUT] 54 H     99.798300000000 107.871000000000 102.599000000000 AA  188.591454697181 203.846646782958 193.884010654251 Bohr   0.0
[INPUT] 55 O     96.373500000000  99.168100000000 103.663000000000 AA  182.119520665771 187.400549293481 195.894679250788 Bohr   0.0
[INPUT] 56 H     96.032600000000  99.385200000000 104.578000000000 AA  181.475313029907 187.810808835124 197.623778654765 Bohr   0.0
[INPUT] 57 H     97.337900000000  98.909800000000 103.720000000000 AA  183.941972540302 186.912433035505 196.002393639888 Bohr   0.0
[INPUT] 58 O     92.236600000000  98.969600000000  99.830200000000 AA  174.301912661058 187.025438657754 188.651736960555 Bohr   0.0
[INPUT] 59 H     92.257200000000  98.492300000000 100.709000000000 AA  174.340841019224 186.123472378499 190.312428278823 Bohr   0.0
[INPUT] 60 H     92.125400000000  98.304300000000  99.091900000000 AA  174.091775116006 185.768203867081 187.256552162789 Bohr   0.0
[INPUT] 61 O     96.740700000000 101.641000000000  95.246600000000 AA  182.813428098711 192.073653026917 179.989988295999 Bohr   0.0
[INPUT] 62 H     95.765200000000 101.625000000000  95.027600000000 AA  180.970000264198 192.043417408924 179.576138274719 Bohr   0.0
[INPUT] 63 H     97.256100000000 101.957000000000  94.450300000000 AA  183.787392943312 192.670806482280 178.485199383007 Bohr   0.0
[INPUT] 64 O    106.873000000000 103.046000000000  96.266300000000 AA  201.960700110642 194.728718231931 181.916942025218 Bohr   0.0
[INPUT] 65 H    106.397000000000 102.273000000000  96.684800000000 AA  201.061190475349 193.267959937643 182.707792408348 Bohr   0.0
[INPUT] 66 H    107.190000000000 102.788000000000  95.353900000000 AA  202.559743292129 194.241168891794 180.192755909164 Bohr   0.0
[INPUT] 67 O     96.855700000000  95.639100000000 102.759000000000 AA  183.030746603036 180.731705799890 194.186366834181 Bohr   0.0
[INPUT] 68 H     96.157300000000  96.250200000000 102.386000000000 AA  181.710961877640 181.886517434612 193.481498989718 Bohr   0.0
[INPUT] 69 H     97.741700000000  95.856700000000 102.349000000000 AA  184.705043949401 181.142910204596 193.411579123110 Bohr   0.0
[INPUT] 70 O     97.209000000000  95.906800000000  94.278900000000 AA  183.698386842845 181.237585483436 178.161300325257 Bohr   0.0
[INPUT] 71 H     97.087400000000  95.813100000000  93.290800000000 AA  183.468596146098 181.060518145565 176.294061941574 Bohr   0.0
[INPUT] 72 H     98.015300000000  96.468800000000  94.463700000000 AA  185.222073017082 182.299611565442 178.510521713077 Bohr   0.0
[INPUT] 73 O    103.969000000000  95.809900000000 100.611000000000 AA  196.472935444905 181.054471021966 190.127235118615 Bohr   0.0
[INPUT] 74 H    104.656000000000  95.771500000000 101.336000000000 AA  197.771177292481 180.981905538783 191.497286558925 Bohr   0.0
[INPUT] 75 H    103.152000000000  96.276300000000 100.950000000000 AA  194.929029201135 181.935839286463 190.767852274843 Bohr   0.0
[INPUT] 76 O    106.587000000000 100.034000000000 103.851000000000 AA  201.420238439016 189.036863144741 196.249947762206 Bohr   0.0
[INPUT] 77 H    105.829000000000 100.104000000000 103.203000000000 AA  199.987826036596 189.169143973461 195.025405233488 Bohr   0.0
[INPUT] 78 H    107.394000000000 100.487000000000 103.470000000000 AA  202.945247421540 189.892909079169 195.529962108747 Bohr   0.0
[INPUT] 79 O     98.463200000000 103.644000000000 104.855000000000 AA  186.068481348275 195.858774454421 198.147232791270 Bohr   0.0
[INPUT] 80 H     99.448900000000 103.710000000000 105.009000000000 AA  187.931184389258 195.983496378643 198.438250614453 Bohr   0.0
[INPUT] 81 H     98.023000000000 103.265000000000 105.669000000000 AA  185.236623908241 195.142568253211 199.685469856666 Bohr   0.0
[INPUT] 82 O    101.993000000000 104.014000000000  93.998500000000 AA  192.738836622764 196.557973120510 177.631421119929 Bohr   0.0
[INPUT] 83 H    102.580000000000 103.877000000000  94.796800000000 AA  193.848105857884 196.299080641445 179.139989485169 Bohr   0.0
[INPUT] 84 H    102.066000000000 103.222000000000  93.391700000000 AA  192.876786629858 195.061310029855 176.484735307543 Bohr   0.0
[INPUT] 85 O     98.548000000000 101.265000000000  97.248600000000 AA  186.228730123638 191.363116004081 183.773219997378 Bohr   0.0
[INPUT] 86 H     98.688900000000 102.140000000000  97.711000000000 AA  186.494992534589 193.016626363075 184.647029357377 Bohr   0.0
[INPUT] 87 H     97.919900000000 101.391000000000  96.480800000000 AA  185.041793144798 191.601221495776 182.322288278937 Bohr   0.0
[INPUT] 88 O     99.706100000000  94.287900000000 105.534000000000 AA  188.417221948497 178.178307860378 199.430356829849 Bohr   0.0
[INPUT] 89 H     98.709100000000  94.214400000000 105.511000000000 AA  186.533165002305 178.039412990223 199.386893128984 Bohr   0.0
[INPUT] 90 H    100.042000000000  93.988200000000 106.427000000000 AA  189.051980953738 177.611956940846 201.117882259086 Bohr   0.0
[INPUT] 91 O    104.764000000000 102.907000000000 101.929000000000 AA  197.975267713934 194.466046300617 192.617894150792 Bohr   0.0
[INPUT] 92 H    104.157000000000 103.650000000000 101.648000000000 AA  196.828203956323 195.870112811169 192.086881109789 Bohr   0.0
[INPUT] 93 H    105.597000000000 103.289000000000 102.328000000000 AA  199.549409575697 195.187921680201 193.371894874494 Bohr   0.0
[INPUT] 94 O    104.727000000000  95.435700000000  98.038700000000 AA  197.905347847325 180.347335506154 185.266292608397 Bohr   0.0
[INPUT] 95 H    103.947000000000  95.065800000000  97.535100000000 AA  196.431361470164 179.648325812677 184.314626532066 Bohr   0.0
[INPUT] 96 H    104.496000000000  95.504800000000  99.009000000000 AA  197.468821112551 180.477915581361 187.099893867062 Bohr   0.0
[INPUT] 97 O    103.898000000000  98.427900000000  99.984500000000 AA  196.338764890061 186.001774016077 188.943321701575 Bohr   0.0
[INPUT] 98 H    103.015000000000  98.654900000000  99.573700000000 AA  194.670136722070 186.430741846354 188.167022209604 Bohr   0.0
[INPUT] 99 H    104.128000000000  97.477300000000  99.776100000000 AA  196.773401898711 184.205400362066 188.549502777216 Bohr   0.0
[INPUT]100 O     99.166600000000  96.442100000000 101.723000000000 AA  187.397714704294 182.249155877916 192.228610569132 Bohr   0.0
[INPUT]101 H     98.843200000000  97.206600000000 101.166000000000 AA  186.786577275609 183.693851500146 191.176033117749 Bohr   0.0
[INPUT]102 H     99.643900000000  95.783700000000 101.141000000000 AA  188.299680983549 181.004960197502 191.128789964635 Bohr   0.0
[INPUT]103 O     94.272300000000 104.861000000000  98.027200000000 AA  178.148828132835 198.158571148017 185.244560757964 Bohr   0.0
[INPUT]104 H     93.274400000000 104.806000000000  97.992700000000 AA  176.263070433131 198.054636211166 185.179365206667 Bohr   0.0
[INPUT]105 H     94.652300000000 104.579000000000  97.146100000000 AA  178.866924060170 197.625668380890 183.579523069610 Bohr   0.0
[INPUT]106 O    107.544000000000  95.677300000000  98.777200000000 AA  203.228706340225 180.803893337849 186.661855351388 Bohr   0.0
[INPUT]107 H    106.627000000000  95.279200000000  98.760300000000 AA  201.495827483999 180.051593367659 186.629918979883 Bohr   0.0
[INPUT]108 H    107.707000000000  96.101300000000  99.668000000000 AA  203.536731698529 181.605137214664 188.345223383151 Bohr   0.0
[INPUT]109 O     94.408300000000 105.314000000000 100.701000000000 AA  178.405830885776 199.014617082445 190.297310469826 Bohr   0.0
[INPUT]110 H     94.396800000000 105.021000000000  99.744600000000 AA  178.384099035343 198.460927327947 188.489976404292 Bohr   0.0
[INPUT]111 H     95.353500000000 105.456000000000 100.995000000000 AA  180.192000018715 199.282958192133 190.852889950448 Bohr   0.0
[INPUT]112 O    106.040000000000  95.593700000000 102.478000000000 AA  200.386558248879 180.645912233835 193.655353793178 Bohr   0.0
[INPUT]113 H    105.762000000000  96.182200000000 103.237000000000 AA  199.861214386250 181.758016058142 195.089655921723 Bohr   0.0
[INPUT]114 H    106.867000000000  95.091200000000 102.732000000000 AA  201.949361753894 179.696324856241 194.135344228818 Bohr   0.0
[INPUT]115 O    102.891000000000 100.842000000000  97.477600000000 AA  194.435810682624 190.563761853390 184.205967279903 Bohr   0.0
[INPUT]116 H    103.837000000000 100.662000000000  97.209700000000 AA  196.223491596462 190.223611150968 183.699709651132 Bohr   0.0
[INPUT]117 H    102.868000000000 101.166000000000  98.423400000000 AA  194.392346981759 191.176033117749 185.993270248517 Bohr   0.0
[INPUT]118 O    107.589000000000 103.376000000000 102.668000000000 AA  203.313744015830 195.352327853038 194.014401756846 Bohr   0.0
[INPUT]119 H    107.461000000000 104.111000000000 103.335000000000 AA  203.071859071886 196.741276554593 195.274849081931 Bohr   0.0
[INPUT]120 H    107.934000000000 103.760000000000 101.812000000000 AA  203.965699528805 196.077982684871 192.396796194218 Bohr   0.0
[INPUT]121 O     96.227200000000 100.990000000000 101.698000000000 AA  181.843053733747 190.843441319826 192.181367416018 Bohr   0.0
[INPUT]122 H     96.148800000000 100.422000000000 102.517000000000 AA  181.694899205581 189.770076881073 193.729053112036 Bohr   0.0
[INPUT]123 H     95.313600000000 101.237000000000 101.375000000000 AA  180.116599946344 191.310203672593 191.570985877783 Bohr   0.0
[INPUT]124 O    107.826000000000  96.984100000000 101.113000000000 AA  203.761609107352 183.273387437430 191.075877633147 Bohr   0.0
[INPUT]125 H    108.466000000000  97.497100000000 101.685000000000 AA  204.971033827074 184.242816939332 192.156800976398 Bohr   0.0
[INPUT]126 H    107.058000000000  96.670200000000 101.672000000000 AA  202.310299443686 182.680202406929 192.132234536779 Bohr   0.0
[INPUT]127 O     92.639000000000  96.955600000000  97.829000000000 AA  175.062338453583 183.219530242880 184.870017040075 Bohr   0.0
[INPUT]128 H     93.628900000000  97.092800000000  97.866000000000 AA  176.932978344290 183.478800667171 184.939936906684 Bohr   0.0
[INPUT]129 H     92.443100000000  96.008400000000  97.575100000000 AA  174.692141105780 181.429581657692 184.390215577048 Bohr   0.0
[INPUT]130 O     95.278100000000  97.169000000000  98.965800000000 AA  180.049514668922 183.622797797862 187.018257698481 Bohr   0.0
[INPUT]131 H     95.144800000000  97.377000000000  99.934800000000 AA  179.797614176518 184.015860831772 188.849402313185 Bohr   0.0
[INPUT]132 H     95.587900000000  97.991100000000  98.488100000000 AA  180.634951822313 185.176341644867 186.115535528776 Bohr   0.0
[INPUT]133 O     98.864800000000  98.222500000000 103.917000000000 AA  186.827395359900 185.613624270092 196.374669686428 Bohr   0.0
[INPUT]134 H     98.949800000000  97.463000000000 103.272000000000 AA  186.988022080488 184.178377278485 195.155796336083 Bohr   0.0
[INPUT]135 H     99.054800000000  97.896400000000 104.843000000000 AA  187.186443323567 184.997384580871 198.124556077775 Bohr   0.0
[INPUT]136 O    104.578000000000 100.035000000000 101.952000000000 AA  197.623778654765 189.038752870866 192.661357851657 Bohr   0.0
[INPUT]137 H    104.419000000000 101.011000000000 101.802000000000 AA  197.323312200959 190.883125568441 192.377898932972 Bohr   0.0
[INPUT]138 H    104.206000000000  99.514900000000 101.184000000000 AA  196.920800536427 188.055906313480 191.210048187991 Bohr   0.0
[INPUT]139 O    102.027000000000 106.876000000000 101.138000000000 AA  192.803087311000 201.966369289016 191.123120786261 Bohr   0.0
[INPUT]140 H    102.200000000000 106.695000000000 100.170000000000 AA  193.130009930549 201.624328860469 189.293865897682 Bohr   0.0
[INPUT]141 H    101.515000000000 107.729000000000 101.232000000000 AA  191.835547535222 203.578305673270 191.300755041970 Bohr   0.0
[INPUT]142 O    102.429000000000 104.060000000000 101.348000000000 AA  193.562757213075 196.644900522240 191.519963272420 Bohr   0.0
[INPUT]143 H    101.757000000000 103.665000000000 101.974000000000 AA  192.292861257367 195.898458703037 192.702931826398 Bohr   0.0
[INPUT]144 H    102.209000000000 105.021000000000 101.185000000000 AA  193.147017465670 198.460927327947 191.211937914116 Bohr   0.0
[INPUT]145 O     96.798000000000  93.944200000000 100.568000000000 AA  182.921709405649 177.528808991365 190.045976895259 Bohr   0.0
[INPUT]146 H     97.508200000000  94.486700000000 100.119000000000 AA  184.263792899315 178.553985413942 189.197489865329 Bohr   0.0
[INPUT]147 H     96.982400000000  93.900400000000 101.550000000000 AA  183.270174903019 177.446038987109 191.901687949582 Bohr   0.0
[INPUT]148 O     95.118700000000  97.700600000000 101.797000000000 AA  179.748292324667 184.627376205681 192.368450302350 Bohr   0.0
[INPUT]149 H     94.171300000000  97.423600000000 101.957000000000 AA  177.957965794254 184.103922069177 192.670806482280 Bohr   0.0
[INPUT]150 H     95.377300000000  98.403200000000 102.460000000000 AA  180.236975500479 185.955097780801 193.621338722936 Bohr   0.0
[INPUT]151 O     99.231100000000  93.154200000000 102.821000000000 AA  187.519602039328 176.035925352959 194.303529853904 Bohr   0.0
[INPUT]152 H     99.331300000000  93.817000000000 103.563000000000 AA  187.708952597010 177.288435828320 195.705706638331 Bohr   0.0
[INPUT]153 H    100.104000000000  93.053400000000 102.344000000000 AA  189.169143973461 175.845440959603 193.402130492487 Bohr   0.0
[INPUT]154 O    103.395000000000  93.763800000000  96.088800000000 AA  195.388232649405 177.187902398494 181.581515638107 Bohr   0.0
[INPUT]155 H    102.541000000000  93.361100000000  95.758700000000 AA  193.774406539026 176.426909688131 180.957717044388 Bohr   0.0
[INPUT]156 H    103.753000000000  94.395700000000  95.401500000000 AA  196.064754601999 178.382020336606 180.282706872694 Bohr   0.0
[INPUT]157 O    103.867000000000  98.228800000000  93.492200000000 AA  196.280183380199 185.625529544677 176.674652783062 Bohr   0.0
[INPUT]158 H    103.007000000000  97.732700000000  93.371700000000 AA  194.655018913073 184.688036414280 176.446940785052 Bohr   0.0
[INPUT]159 H    103.971000000000  98.898600000000  92.757000000000 AA  196.476714897154 186.891268102910 175.285326136281 Bohr   0.0
[INPUT]160 O     99.725400000000 101.618000000000 108.746000000000 AA  188.453693662701 192.030189326052 205.500157141952 Bohr   0.0
[INPUT]161 H     99.296300000000 102.517000000000 108.650000000000 AA  187.642812182650 193.729053112036 205.318743433994 Bohr   0.0
[INPUT]162 H    100.719000000000 101.725000000000 108.777000000000 AA  190.331325540068 192.232390021381 205.558738651814 Bohr   0.0
[INPUT]163 O    105.654000000000 100.606000000000  97.050900000000 AA  199.657123964797 190.117786487993 183.399621142551 Bohr   0.0
[INPUT]164 H    105.817000000000  99.917100000000  96.344600000000 AA  199.965149323101 188.815954160780 182.064907580771 Bohr   0.0
[INPUT]165 H    105.599000000000 100.160000000000  97.944500000000 AA  199.553189027946 189.274968636437 185.088280407463 Bohr   0.0
[INPUT]166 O     98.708200000000 103.752000000000  98.244300000000 AA  186.531464248793 196.062864875874 185.654820299607 Bohr   0.0
[INPUT]167 H     98.397100000000 104.234000000000  97.425400000000 AA  185.943570451441 196.973712867915 184.107323576201 Bohr   0.0
[INPUT]168 H     99.598500000000 104.111000000000  98.524400000000 AA  188.213887417493 196.741276554593 186.184132587098 Bohr   0.0
[INPUT]169 O    104.529000000000  95.238500000000  94.088100000000 AA  197.531182074661 179.974681514390 177.800740580690 Bohr   0.0
[INPUT]170 H    104.552000000000  94.923200000000  93.139400000000 AA  197.574645775526 179.378850867314 176.007957406315 Bohr   0.0
[INPUT]171 H    104.087000000000  96.134100000000  94.131500000000 AA  196.695923127604 181.667120231550 177.882754694496 Bohr   0.0
[INPUT]172 O     95.933300000000 100.069000000000 106.486000000000 AA  181.287663225737 189.103003559101 201.229376100435 Bohr   0.0
[INPUT]173 H     95.896800000000  99.719700000000 107.422000000000 AA  181.218688222191 188.442922223791 202.998159753028 Bohr   0.0
[INPUT]174 H     96.887400000000 100.192000000000 106.213000000000 AA  183.090650921185 189.335439872423 200.713480868429 Bohr   0.0
[INPUT]175 O     97.164700000000  94.924300000000 105.416000000000 AA  183.614671975527 179.380929566051 199.207369147151 Bohr   0.0
[INPUT]176 H     96.958600000000  95.152200000000 104.464000000000 AA  183.225199421254 179.811598149840 197.408349876565 Bohr   0.0
[INPUT]177 H     96.312500000000  94.858500000000 105.935000000000 AA  182.004247372173 179.256585587055 200.188137005800 Bohr   0.0
[INPUT]178 O     97.960300000000  99.738400000000  92.323200000000 AA  185.118138080231 188.478260102320 174.465562943445 Bohr   0.0
[INPUT]179 H     98.025100000000  99.203100000000  91.481000000000 AA  185.240592333103 187.466689707840 172.874035601336 Bohr   0.0
[INPUT]180 H     97.432100000000 100.570000000000  92.149900000000 AA  184.119984741236 190.049756347508 174.138073406058 Bohr   0.0
[INPUT]181 O     95.964200000000 107.132000000000  98.369800000000 AA  181.346055762987 202.450139176904 185.891980928240 Bohr   0.0
[INPUT]182 H     96.229400000000 107.195000000000  99.332000000000 AA  181.847211131221 202.569191922752 187.710275405297 Bohr   0.0
[INPUT]183 H     95.398600000000 106.319000000000  98.232100000000 AA  180.277226666933 200.913791837633 185.631765640888 Bohr   0.0
[INPUT]184 O    103.231000000000 106.520000000000 103.603000000000 AA  195.078317564976 201.293626788670 195.781295683314 Bohr   0.0
[INPUT]185 H    102.896000000000 106.662000000000 102.672000000000 AA  194.445259313247 201.561967898359 194.021960661344 Bohr   0.0
[INPUT]186 H    102.458000000000 106.505000000000 104.237000000000 AA  193.617559270687 201.265280896802 196.979382046288 Bohr   0.0
[INPUT]187 O     92.780100000000  95.010400000000 101.424000000000 AA  175.328978809759 179.543634985376 191.663582457887 Bohr   0.0
[INPUT]188 H     92.910900000000  94.266600000000 102.079000000000 AA  175.576154986852 178.138056693925 192.901353069477 Bohr   0.0
[INPUT]189 H     93.220200000000  94.772800000000 100.558000000000 AA  176.160647277180 179.094636058180 190.027079634013 Bohr   0.0
[INPUT]190 O     99.794600000000  91.488300000000 100.023000000000 AA  188.584462710521 172.887830602046 189.016076157371 Bohr   0.0
[INPUT]191 H    100.445000000000  92.220600000000 100.224000000000 AA  189.813540581938 174.271677043065 189.395911108409 Bohr   0.0
[INPUT]192 H     98.904700000000  91.885300000000  99.798800000000 AA  186.902795432270 173.638051873498 188.592399560244 Bohr   0.0
[INPUT]193 O    106.052000000000  98.653800000000  95.236000000000 AA  200.409234962374 186.428663147617 179.969957199078 Bohr   0.0
[INPUT]194 H    106.528000000000  97.778800000000  95.148400000000 AA  201.308744597667 184.775152788622 179.804417190566 Bohr   0.0
[INPUT]195 H    105.747000000000  98.958900000000  94.333900000000 AA  199.832868494382 187.005218588222 178.265235262108 Bohr   0.0
[INPUT]196 O     99.468000000000 105.283000000000  95.690500000000 AA  187.967278158238 198.956035572583 180.828837722693 Bohr   0.0
[INPUT]197 H    100.395000000000 104.911000000000  95.651600000000 AA  189.719054275709 198.253057454245 180.755327376447 Bohr   0.0
[INPUT]198 H     99.511900000000 106.279000000000  95.772300000000 AA  188.050237135106 200.838202792650 180.983417319682 Bohr   0.0
[INPUT]199 O    103.065000000000 106.418000000000  98.404100000000 AA  194.764623028298 201.100874723965 185.956798534313 Bohr   0.0
[INPUT]200 H    102.945000000000 107.087000000000  97.670300000000 AA  194.537855893350 202.365101501299 184.570117504107 Bohr   0.0
[INPUT]201 H    103.919000000000 106.605000000000  98.888900000000 AA  196.378449138677 201.454253509258 186.872937759502 Bohr   0.0
[INPUT]202 O    100.125000000000 101.870000000000  92.894300000000 AA  189.208828222077 192.506400309443 175.544785533184 Bohr   0.0
[INPUT]203 H     99.428600000000 101.298000000000  92.459700000000 AA  187.892822948930 191.425476966192 174.723510559448 Bohr   0.0
[INPUT]204 H     99.896600000000 101.996000000000  93.859700000000 AA  188.777214775226 192.744505801138 177.369127133839 Bohr   0.0
[INPUT]205 O     92.131300000000  97.642300000000 102.177000000000 AA  174.102924500141 184.517205172619 193.086546229684 Bohr   0.0
[INPUT]206 H     91.317000000000  97.791400000000 102.738000000000 AA  172.564120516908 184.798963337792 194.146682585565 Bohr   0.0
[INPUT]207 H     92.266500000000  96.661000000000 102.040000000000 AA  174.358415472182 182.662816926583 192.827653750619 Bohr   0.0
[INPUT]208 O    102.160000000000  94.349500000000  98.747200000000 AA  193.054420885567 178.294714989651 186.605163567651 Bohr   0.0
[INPUT]209 H    102.527000000000  93.534300000000  98.299300000000 AA  193.747950373282 176.754210252906 185.758755236458 Bohr   0.0
[INPUT]210 H    102.436000000000  94.354600000000  99.708300000000 AA  193.575985295947 178.304352592887 188.421379345971 Bohr   0.0
[INPUT]211 O    101.909000000000  92.717000000000 101.661000000000 AA  192.580099628301 175.209737091299 192.111447549409 Bohr   0.0
[INPUT]212 H    102.638000000000  93.177700000000 102.168000000000 AA  193.957709973109 176.080333916886 193.069538694563 Bohr   0.0
[INPUT]213 H    102.284000000000  91.918600000000 101.190000000000 AA  193.288746925013 173.700979753446 191.221386544739 Bohr   0.0
[INPUT]214 O    101.195000000000 106.928000000000 105.456000000000 AA  191.230835175361 202.064635047493 199.282958192133 Bohr   0.0
[INPUT]215 H    101.206000000000 106.434000000000 106.325000000000 AA  191.251622162732 201.131110341958 200.925130194380 Bohr   0.0
[INPUT]216 H    100.871000000000 107.862000000000 105.607000000000 AA  190.618563911002 203.829639247837 199.568306836942 Bohr   0.0
[INPUT]217 O     97.894300000000  93.636500000000  97.704600000000 AA  184.993416156010 176.947340262836 184.634935110180 Bohr   0.0
[INPUT]218 H     96.921800000000  93.462300000000  97.549500000000 AA  183.155657499870 176.618149971937 184.341838588259 Bohr   0.0
[INPUT]219 H     98.231600000000  94.279000000000  97.016600000000 AA  185.630820777825 178.161489297869 183.334803536479 Bohr   0.0
[INPUT]220 O     98.771600000000 100.739000000000 106.197000000000 AA  186.651272885090 190.369120062560 200.683245250436 Bohr   0.0
[INPUT]221 H     99.398100000000 101.178000000000 106.840000000000 AA  187.835186302130 191.198709831244 201.898339148531 Bohr   0.0
[INPUT]222 H     99.297200000000 100.231000000000 105.514000000000 AA  187.644512936162 189.409139191281 199.392562307358 Bohr   0.0
[INPUT]223 O     94.443800000000  94.651000000000  99.373500000000 AA  178.472916163198 178.864467416208 187.788699039466 Bohr   0.0
[INPUT]224 H     95.293900000000  94.301900000000  99.767700000000 AA  180.079372341691 178.204764026122 188.533629077770 Bohr   0.0
[INPUT]225 H     94.463600000000  95.650800000000  99.370600000000 AA  178.510332740464 180.753815595548 187.783218833705 Bohr   0.0
[INPUT]226 O    103.454000000000  97.589900000000  96.421800000000 AA  195.499726490754 184.418183523692 182.210794437587 Bohr   0.0
[INPUT]227 H    103.885000000000  98.135100000000  95.702500000000 AA  196.314198450441 185.448462206805 180.851514436188 Bohr   0.0
[INPUT]228 H    104.142000000000  97.009800000000  96.857500000000 AA  196.799858064455 183.321953398832 183.034148110060 Bohr   0.0
[INPUT]229 O     97.663000000000 103.755000000000  93.716600000000 AA  184.556322503398 196.068534054248 177.098707325414 Bohr   0.0
[INPUT]230 H     97.878200000000 104.678000000000  94.035900000000 AA  184.962991565404 197.812751267222 177.702096876988 Bohr   0.0
[INPUT]231 H     98.124000000000 103.587000000000  92.845200000000 AA  185.427486246822 195.751060065321 175.451999980468 Bohr   0.0
[INPUT]232 O     93.470000000000  98.898100000000 105.386000000000 AA  176.632700863096 186.890323239848 199.150677363414 Bohr   0.0
[INPUT]233 H     93.191400000000  99.414300000000 104.576000000000 AA  176.106223164793 187.865799865348 197.619999202516 Bohr   0.0
[INPUT]234 H     94.083300000000  99.457800000000 105.943000000000 AA  177.791669895292 187.948002951767 200.203254814796 Bohr   0.0
[INPUT]235 O     92.500500000000 101.454000000000  96.905900000000 AA  174.800611385331 191.720274241624 183.125610854489 Bohr   0.0
[INPUT]236 H     92.032300000000 101.750000000000  97.738200000000 AA  173.915841613809 192.279633174495 184.698429907965 Bohr   0.0
[INPUT]237 H     92.354500000000 100.473000000000  96.773000000000 AA  174.524711371144 189.866452913425 182.874466252535 Bohr   0.0
[INPUT]238 O     95.630300000000  99.996600000000  98.245400000000 AA  180.715076209994 188.966187387683 185.656898998344 Bohr   0.0
[INPUT]239 H     96.540400000000 100.410000000000  98.268900000000 AA  182.434915955961 189.747400167578 185.701307562272 Bohr   0.0
[INPUT]240 H     94.982900000000 100.638000000000  97.834500000000 AA  179.491667516951 190.178257723979 184.880410533761 Bohr   0.0
[INPUT]241 O    103.773000000000  93.788800000000 103.794000000000 AA  196.102549124490 177.235145551608 196.142233373106 Bohr   0.0
[INPUT]242 H    103.865000000000  93.694200000000 104.785000000000 AA  196.276403927950 177.056377460224 198.014951962550 Bohr   0.0
[INPUT]243 H    104.676000000000  93.734600000000 103.368000000000 AA  197.808971814972 177.132722395656 195.337210044041 Bohr   0.0
[INPUT]244 O    105.714000000000 105.895000000000  99.861500000000 AA  199.770507532271 200.112547960817 188.710885388254 Bohr   0.0
[INPUT]245 H    105.704000000000 106.458000000000 100.688000000000 AA  199.751610271025 201.176463768947 190.272744030207 Bohr   0.0
[INPUT]246 H    106.647000000000 105.580000000000  99.685100000000 AA  201.533622006490 199.517284231579 188.377537699881 Bohr   0.0
[INPUT]247 O     99.505700000000  94.600000000000  99.762000000000 AA  188.038520833134 178.768091383855 188.522857638860 Bohr   0.0
[INPUT]248 H     98.915000000000  94.230400000000  99.044800000000 AA  186.922259611353 178.069648608216 187.167546062322 Bohr   0.0
[INPUT]249 H    100.455000000000  94.596700000000  99.446700000000 AA  189.832437843183 178.761855287644 187.927026991784 Bohr   0.0
[INPUT]250 O     93.723900000000 101.482000000000 100.592000000000 AA  177.112502326123 191.773186573112 190.091330322249 Bohr   0.0
[INPUT]251 H     93.285300000000 102.174000000000 100.019000000000 AA  176.283668447889 193.080877051311 189.008517252873 Bohr   0.0
[INPUT]252 H     93.374700000000 100.577000000000 100.347000000000 AA  176.452609963425 190.062984430380 189.628347421730 Bohr   0.0
[INPUT]253 O     92.515400000000 104.356000000000 102.399000000000 AA  174.828768304587 197.204259455112 193.506065429338 Bohr   0.0
[INPUT]254 H     92.834800000000 104.698000000000 103.283000000000 AA  175.432346828773 197.850545789713 195.176583323453 Bohr   0.0
[INPUT]255 H     93.169800000000 104.611000000000 101.687000000000 AA  176.065405080502 197.686139616876 192.160580428647 Bohr   0.0
[INPUT]256 O    102.360000000000 101.551000000000  99.964500000000 AA  193.432366110480 191.903577675707 188.905527179084 Bohr   0.0
[INPUT]257 H    102.675000000000 102.370000000000 100.444000000000 AA  194.027629839718 193.451263371725 189.811650855813 Bohr   0.0
[INPUT]258 H    101.556000000000 101.180000000000 100.430000000000 AA  191.913026306329 191.202489283493 189.785194690069 Bohr   0.0
[INPUT]259 O     99.128800000000  95.980100000000  96.602100000000 AA  187.326283056785 181.376102408367 182.551512057847 Bohr   0.0
[INPUT]260 H     99.037300000000  96.941600000000  96.861200000000 AA  187.153373116387 183.193074077136 183.041140096721 Bohr   0.0
[INPUT]261 H    100.097000000000  95.729200000000  96.588100000000 AA  189.155915890589 180.901970123714 182.525055892103 Bohr   0.0
[INPUT]262 O    103.544000000000  99.038500000000 104.412000000000 AA  195.669801841965 187.155640787737 197.310084118087 Bohr   0.0
[INPUT]263 H    104.182000000000  99.184200000000 103.655000000000 AA  196.875447109437 187.430973884086 195.879561441791 Bohr   0.0
[INPUT]264 H    102.605000000000  99.102500000000 104.073000000000 AA  193.895349010998 187.276583259709 196.669466961860 Bohr   0.0
[INPUT]265 O     99.482600000000  98.237100000000  94.256600000000 AA  187.994868159656 185.641214271510 178.119159432679 Bohr   0.0
[INPUT]266 H     98.968300000000  98.764500000000  93.580400000000 AA  187.022982013792 186.637855829606 176.841326627248 Bohr   0.0
[INPUT]267 H    100.018000000000  98.859300000000  94.827300000000 AA  189.006627526748 186.817001866215 179.197626131968 Bohr   0.0
[INPUT]268 O     97.111700000000 105.889000000000 101.284000000000 AA  183.514516490925 200.101209604070 191.399020800448 Bohr   0.0
[INPUT]269 H     97.802500000000 106.403000000000 101.792000000000 AA  184.819939297774 201.072528832096 192.359001671727 Bohr   0.0
[INPUT]270 H     97.487600000000 105.002000000000 101.014000000000 AA  184.224864541149 198.425022531581 190.888794746815 Bohr   0.0
[INPUT]271 O    103.133000000000 101.981000000000 104.535000000000 AA  194.893124404769 192.716159909270 197.542520431409 Bohr   0.0
[INPUT]272 H    103.581000000000 102.216000000000 103.673000000000 AA  195.739721708574 193.160245548542 195.913576512034 Bohr   0.0
[INPUT]273 H    102.678000000000 101.095000000000 104.444000000000 AA  194.033299018091 191.041862562905 197.370555354073 Bohr   0.0
[INPUT]274 O    101.858000000000  95.959800000000 104.565000000000 AA  192.483723595948 181.337740968038 197.599212215146 Bohr   0.0
[INPUT]275 H    102.487000000000  95.187200000000 104.478000000000 AA  193.672361328299 179.877738564199 197.434806042309 Bohr   0.0
[INPUT]276 H    100.951000000000  95.624200000000 104.818000000000 AA  190.769742000968 180.703548880634 198.077312924661 Bohr   0.0
[INPUT]277 O    106.341000000000  99.341900000000  99.395500000000 AA  200.955365812373 187.728983693930 187.830273014207 Bohr   0.0
[INPUT]278 H    105.471000000000  98.930500000000  99.666400000000 AA  199.311304084002 186.951550366284 188.342199821351 Bohr   0.0
[INPUT]279 H    107.040000000000  99.120000000000 100.075000000000 AA  202.276284373444 187.309653466889 189.114341915849 Bohr   0.0
[INPUT]280 O    101.744000000000  97.726000000000 106.886000000000 AA  192.268294817748 184.675375249245 201.985266550261 Bohr   0.0
[INPUT]281 H    102.077000000000  97.166200000000 106.128000000000 AA  192.897573617228 183.617506564714 200.552854147841 Bohr   0.0
[INPUT]282 H    102.140000000000  98.642000000000 106.824000000000 AA  193.016626363075 186.406364379347 201.868103530538 Bohr   0.0
[INPUT]283 O     95.154200000000  95.840000000000  96.171700000000 AA  179.815377602089 181.111351778316 181.738173933834 Bohr   0.0
[INPUT]284 H     95.973800000000  95.821000000000  95.599100000000 AA  181.364197133782 181.075446981949 180.656116754908 Bohr   0.0
[INPUT]285 H     95.413800000000  96.026700000000  97.119200000000 AA  180.305950504026 181.464163645772 183.528689436859 Bohr   0.0
[INPUT]286 O    101.836000000000  97.446700000000 102.110000000000 AA  192.442149621208 184.147574742654 192.959934579338 Bohr   0.0
[INPUT]287 H    100.860000000000  97.397400000000 101.898000000000 AA  190.597776923632 184.054411244713 192.559312640931 Bohr   0.0
[INPUT]288 H    101.991000000000  97.133400000000 103.047000000000 AA  192.735057170515 183.555523547828 194.730607958056 Bohr   0.0
[INPUT]289 O    101.665000000000  98.316100000000  98.319400000000 AA  192.119006453907 185.790502635351 185.796738731562 Bohr   0.0
[INPUT]290 H    101.904000000000  99.233800000000  98.002000000000 AA  192.570650997678 187.524704299864 185.196939659625 Bohr   0.0
[INPUT]291 H    102.224000000000  97.640900000000  97.837700000000 AA  193.175363357539 184.514559556045 184.886457657359 Bohr   0.0
[INPUT]292 O     99.984700000000 103.272000000000 102.307000000000 AA  188.943699646800 195.155796336083 193.332210625878 Bohr   0.0
[INPUT]293 H     99.640700000000 103.104000000000 103.231000000000 AA  188.293633859950 194.838322347156 195.078317564976 Bohr   0.0
[INPUT]294 H     99.216500000000 103.453000000000 101.693000000000 AA  187.492012037909 195.497836764629 192.171918785395 Bohr   0.0
[INPUT]295 O     94.116000000000 101.973000000000  94.712100000000 AA  177.853463939565 192.701042100273 178.979929682419 Bohr   0.0
[INPUT]296 H     93.626400000000 101.369000000000  94.082700000000 AA  176.928254028978 191.559647521036 177.790536059617 Bohr   0.0
[INPUT]297 H     93.593800000000 102.064000000000  95.560000000000 AA  176.866648957317 192.873007177608 180.582228463437 Bohr   0.0
[INPUT]298 O     98.710500000000  97.265300000000 106.544000000000 AA  186.535810618880 183.804778423658 201.338980215660 Bohr   0.0
[INPUT]299 H     99.310200000000  97.423100000000 107.329000000000 AA  187.669079375781 184.102977206114 202.822415223443 Bohr   0.0
[INPUT]300 H     98.159900000000  96.446100000000 106.705000000000 AA  185.495327414694 182.256714782414 201.643226121715 Bohr   0.0

nuclear repulsion = 34670.2530136105
number of shells = 1200
number of NR pGTOs = 3900
number of NR cGTOs = 2500
basis = def2-SVP
ecp = {}
CPU time:     19090.25


PySCF Results


Initial guess from minao.


******** <class 'pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = False
chkfile to save SCF result = /tmp/tmpqifu3u60
max_memory 1500000 MB (current use 20553 MB)
XC library pyscf.dft.libxc version 6.1.0
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1–5 (2018)
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14fef7d784c0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14fef7dcce50>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 3369800
init E= -7624.07493331908
  HOMO = -0.417673583470052  LUMO = -0.133754085108043
cycle= 1 E= -7621.28828916034  delta_E= 2.79  |g|= 6.69  |ddm|= 13.8
  HOMO = 0.0236489990819734  LUMO = 0.0247207871123773
cycle= 2 E= -7589.66048170452  delta_E= 31.6  |g|= 12.4  |ddm|= 18.3
  HOMO = -0.111370492626325  LUMO = -0.107188792896644
cycle= 3 E= -7601.53860094005  delta_E= -11.9  |g|= 6.05  |ddm|= 18.1
  HOMO = -0.143161382697923  LUMO = -0.113162468852309
cycle= 4 E= -7628.50402025916  delta_E=  -27  |g|= 2.13  |ddm|= 9.95
  HOMO = -0.175146740833272  LUMO = -0.0577159400275295
cycle= 5 E= -7629.31481105497  delta_E= -0.811  |g|= 0.593  |ddm|= 1.44
  HOMO = -0.0702738131324417  LUMO = -0.0682675530553419
cycle= 6 E= -7627.52313623438  delta_E= 1.79  |g|= 1.52  |ddm|= 3.73
  HOMO = -0.14759818409827  LUMO = -0.0694520795784435
cycle= 7 E= -7629.3814324825  delta_E= -1.86  |g|= 0.292  |ddm|= 3.67
  HOMO = -0.157491767642357  LUMO = -0.0587253075714548
cycle= 8 E= -7629.39790948958  delta_E= -0.0165  |g|= 0.174  |ddm|= 0.316
  HOMO = -0.148913025152108  LUMO = -0.0611637787923994
cycle= 9 E= -7629.40302713427  delta_E= -0.00512  |g|= 0.097  |ddm|= 0.185
  HOMO = -0.141382522133024  LUMO = -0.0662522973816089
cycle= 10 E= -7629.40455886395  delta_E= -0.00153  |g|= 0.038  |ddm|= 0.0957
  HOMO = -0.1424972961053  LUMO = -0.065604432912276
cycle= 11 E= -7629.40471375411  delta_E= -0.000155  |g|= 0.0282  |ddm|= 0.0289
  HOMO = -0.142080447671474  LUMO = -0.0653092038494327
cycle= 12 E= -7629.40481925529  delta_E= -0.000106  |g|= 0.0168  |ddm|= 0.0165
  HOMO = -0.142580973435697  LUMO = -0.0648903987123651
cycle= 13 E= -7629.40486745251  delta_E= -4.82e-05  |g|= 0.00782  |ddm|= 0.0139
  HOMO = -0.142434350592016  LUMO = -0.0648484595647523
cycle= 14 E= -7629.40487347892  delta_E= -6.03e-06  |g|= 0.00579  |ddm|= 0.0068
  HOMO = -0.142420585039346  LUMO = -0.06470355793262
cycle= 15 E= -7629.40487940818  delta_E= -5.93e-06  |g|= 0.00229  |ddm|= 0.00657
  HOMO = -0.142443536325643  LUMO = -0.0647165277231363
cycle= 16 E= -7629.40488027692  delta_E= -8.69e-07  |g|= 0.000671  |ddm|= 0.00202
  HOMO = -0.142448588366738  LUMO = -0.0647236343948827
cycle= 17 E= -7629.40488035949  delta_E= -8.26e-08  |g|= 0.000205  |ddm|= 0.000632
  HOMO = -0.142455756469013  LUMO = -0.0647230211340598
Extra cycle  E= -7629.40488033942  delta_E= 2.01e-08  |g|= 0.000393  |ddm|= 0.000407
converged SCF energy = -7629.40488033942
Nuc-Nuc PySCF=  34670.25301361051
One electron integrals energy -79815.52083976481
Coulomb energy  38437.82270367911
EXC  -921.9597578642313
PySCF time:  406.8012443680782
PySCF Grid Size:  (2791656,)


 PySCF Dipole moment
Dipole moment(X, Y, Z, A.U.):  6.28536,  3.75438, -4.53743

============================================================
PyFock Python Program for Quantum Chemistry Simulations
                                        by Manas Sharma
============================================================
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m[38;5;45m█[0m  [38;5;51m█[0m[38;5;51m█[0m    [38;5;87m█[0m[38;5;87m█[0m [38;5;123m█[0m[38;5;123m█[0m[38;5;123m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m  [38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m   [38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m   [38;5;213m█[0m[38;5;213m█[0m
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m█[0m[38;5;45m█[0m [38;5;45m░[0m[38;5;45m█[0m[38;5;51m█[0m  [38;5;51m█[0m[38;5;51m█[0m[38;5;87m░[0m [38;5;87m█[0m[38;5;87m█[0m[38;5;87m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m [38;5;159m█[0m[38;5;159m█[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;219m░[0m [38;5;219m█[0m[38;5;219m█[0m  [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m 
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m   [38;5;45m░[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m░[0m  [38;5;87m█[0m[38;5;87m█[0m[38;5;87m█[0m[38;5;123m█[0m[38;5;123m█[0m   [38;5;159m█[0m[38;5;159m█[0m    [38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m      [38;5;219m█[0m[38;5;219m█[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m  
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m░[0m[38;5;45m░[0m    [38;5;51m░[0m[38;5;51m█[0m[38;5;87m█[0m[38;5;87m░[0m   [38;5;123m█[0m[38;5;123m█[0m[38;5;123m░[0m[38;5;159m░[0m[38;5;159m░[0m   [38;5;195m█[0m[38;5;195m█[0m    [38;5;225m█[0m[38;5;219m█[0m [38;5;219m█[0m[38;5;219m█[0m      [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m 
[38;5;39m█[0m[38;5;39m█[0m         [38;5;51m█[0m[38;5;87m█[0m    [38;5;123m█[0m[38;5;123m█[0m      [38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;219m░[0m [38;5;219m░[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m  [38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m
[38;5;39m░[0m[38;5;39m░[0m         [38;5;51m░[0m[38;5;87m░[0m    [38;5;123m░[0m[38;5;123m░[0m       [38;5;195m░[0m[38;5;195m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m   [38;5;219m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m [38;5;213m░[0m[38;5;213m░[0m   [38;5;213m░[0m[38;5;213m░[0m

============================================================


Number of atoms: 300


Number of basis functions (atomic orbitals): 2500


Number of auxiliary basis functions: 8500


================================================================================


Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 9334 32-Core Processor
Number of Cores: 64
Number of Threads: 128
Memory (GB): 2267.59
Running DFT using 48 threads for Numba.



Calculating one electron integrals...


Core H size in GB  0.05
done!
Time taken 1.4959920949768275 seconds.

Stricter version of Schwarz screening:  False

Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 1.183399600093253 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.1679984830552712
Time taken to evaluate the square roots needed:  0.022073948057368398
Time for significant indices evaluation:  0.08728239696938545
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.07503000800000001
No. of elements in the standard three-centered two electron ERI tensor:  53125000000
No. of elements in the triangular three-centered two electron ERI tensor:  26573125000
No. of significant triplets based on Schwarz inequality and triangularity: 3529166800 or 6.6% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.27975166495889425 seconds.

Two Center Two electron ERI size in GB  0.578
Three Center Two electron ERI size in GB  28.2333344
Three-centered two electron evaluation done!
Time taken for Cholesky factorization of two-centered two-electron integrals 8.340708759031259 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  110.18257921701297 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  2791656
Size (in GB) for storing the coordinates of grid:       0.066999744
Size (in GB) for storing the weights of grid:           0.022333248
Size (in GB) for storing the density at gridpoints:     0.022333248

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  5000
No. of batches:  559

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 14.375098288990557 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    649
Average no. of basis functions contributing to a batch of grid points:    399

You have asked to save the values of significant basis functions and their gradients on grid points so as to avoid recalculation for each SCF cycle.
Please note: This will require addtional memory that is approximately :33.2 GB
Calculating the value of significantly contributing basis functions (atomic orbitals)...
done!
Time taken 4.565000080037862 seconds.



------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Number of electrons:  1001.9606679143906



------Iteration 1--------


Energies

Electron-Nuclear Energy       -87412.5854396032955
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7580.8487475001139
Coulomb Energy                 38444.4952964268959
Exchange-Correlation Energy     -911.5755077343748
--------------------------------------------------
Total Energy                   -7628.5638897074168
--------------------------------------------------



Energy difference :  7628.563889707417


HOMO-LUMO gap: 0.24704318460606334 au
HOMO-LUMO gap: 6.722 eV


Time taken for the previous iteration: 7.841259743086994


Number of electrons:  1000.0001831148459



------Iteration 2--------


Energies

Electron-Nuclear Energy       -87690.7025452008675
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7702.0925142877804
Coulomb Energy                 38642.5632871307535
Exchange-Correlation Energy     -946.6429140481815
--------------------------------------------------
Total Energy                   -7622.4366441272650
--------------------------------------------------



Energy difference :  6.1272455801517935


HOMO-LUMO gap: 0.0064138960499689375 au
HOMO-LUMO gap: 0.175 eV


Time taken for the previous iteration: 7.019956544972956


Number of electrons:  1000.0003814973119



------Iteration 3--------


Energies

Electron-Nuclear Energy       -86715.9369798696716
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7251.6632845112590
Coulomb Energy                 38073.4944421495093
Exchange-Correlation Energy     -882.0081591177453
--------------------------------------------------
Total Energy                   -7602.5343986234002
--------------------------------------------------



Energy difference :  19.902245503864833


HOMO-LUMO gap: 0.014283215207245126 au
HOMO-LUMO gap: 0.389 eV


Time taken for the previous iteration: 7.600574590964243


Number of electrons:  999.9999500734657



------Iteration 4--------


Energies

Electron-Nuclear Energy       -87325.5404091282835
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7519.7157171039889
Coulomb Energy                 38433.3540821173301
Exchange-Correlation Energy     -919.9012417275579
--------------------------------------------------
Total Energy                   -7622.1188379312734
--------------------------------------------------



Energy difference :  19.584439307873254


HOMO-LUMO gap: 0.05597586810126309 au
HOMO-LUMO gap: 1.523 eV


Time taken for the previous iteration: 7.786456317058764


Number of electrons:  1000.000260895235



------Iteration 5--------


Energies

Electron-Nuclear Energy       -87351.4037810515147
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7532.5117314294757
Coulomb Energy                 38442.0280842114007
Exchange-Correlation Energy     -922.3094947795330
--------------------------------------------------
Total Energy                   -7628.9204464869254
--------------------------------------------------



Energy difference :  6.80160855565191


HOMO-LUMO gap: 0.115726504353135 au
HOMO-LUMO gap: 3.149 eV


Time taken for the previous iteration: 7.76975295401644


Number of electrons:  1000.0002525984711



------Iteration 6--------


Energies

Electron-Nuclear Energy       -87358.3892678919219
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7535.5185293472396
Coulomb Energy                 38445.9528726626086
Exchange-Correlation Energy     -922.7094953501958
--------------------------------------------------
Total Energy                   -7629.3743475290175
--------------------------------------------------



Energy difference :  0.45390104209218407


HOMO-LUMO gap: 0.09167626438911203 au
HOMO-LUMO gap: 2.495 eV


Time taken for the previous iteration: 8.210056682000868


Number of electrons:  1000.0002527422884



------Iteration 7--------


Energies

Electron-Nuclear Energy       -87348.7939477444452
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7532.4306211426538
Coulomb Energy                 38438.8955957643848
Exchange-Correlation Energy     -922.1811289662872
--------------------------------------------------
Total Energy                   -7629.3958461004440
--------------------------------------------------



Energy difference :  0.021498571426491253


HOMO-LUMO gap: 0.09268034943361503 au
HOMO-LUMO gap: 2.522 eV


Time taken for the previous iteration: 8.32768088101875


Number of electrons:  1000.000252380445



------Iteration 8--------


Energies

Electron-Nuclear Energy       -87348.0628500340536
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7531.5877108139784
Coulomb Energy                 38438.8818469235630
Exchange-Correlation Energy     -922.0612114578671
--------------------------------------------------
Total Energy                   -7629.4014900511320
--------------------------------------------------



Energy difference :  0.005643950687954202


HOMO-LUMO gap: 0.08643538408694162 au
HOMO-LUMO gap: 2.352 eV


Time taken for the previous iteration: 8.27079792006407


Number of electrons:  1000.0002519938491



------Iteration 9--------


Energies

Electron-Nuclear Energy       -87347.1112892360252
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7531.1334513999727
Coulomb Energy                 38438.3186068269933
Exchange-Correlation Energy     -921.9974621660841
--------------------------------------------------
Total Energy                   -7629.4036794718922
--------------------------------------------------



Energy difference :  0.0021894207602599636


HOMO-LUMO gap: 0.07913481735513073 au
HOMO-LUMO gap: 2.153 eV


Time taken for the previous iteration: 7.90451561100781


Number of electrons:  1000.0002516964199



------Iteration 10--------


Energies

Electron-Nuclear Energy       -87346.3748848200921
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7530.8900818116290
Coulomb Energy                 38437.7890722441589
Exchange-Correlation Energy     -921.9619312731288
--------------------------------------------------
Total Energy                   -7629.4046483341881
--------------------------------------------------



Energy difference :  0.0009688622958492488


HOMO-LUMO gap: 0.07707290352090573 au
HOMO-LUMO gap: 2.097 eV


Time taken for the previous iteration: 7.68495669902768


Number of electrons:  1000.0002512273815



------Iteration 11--------


Energies

Electron-Nuclear Energy       -87347.2425419262436
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7531.2894511765126
Coulomb Energy                 38438.3117410654013
Exchange-Correlation Energy     -922.0163972128663
--------------------------------------------------
Total Energy                   -7629.4047331939437
--------------------------------------------------



Energy difference :  8.485975558869541e-05


HOMO-LUMO gap: 0.07844328966951518 au
HOMO-LUMO gap: 2.135 eV


Time taken for the previous iteration: 7.596168454969302


Number of electrons:  1000.0002515273713



------Iteration 12--------


Energies

Electron-Nuclear Energy       -87345.8036652588780
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7530.5650896372845
Coulomb Energy                 38437.4982928824029
Exchange-Correlation Energy     -921.9175524483583
--------------------------------------------------
Total Energy                   -7629.4048214843060
--------------------------------------------------



Energy difference :  8.829036232782528e-05


HOMO-LUMO gap: 0.07775038674303998 au
HOMO-LUMO gap: 2.116 eV


Time taken for the previous iteration: 7.7253372319974005


Number of electrons:  1000.0002514266386



------Iteration 13--------


Energies

Electron-Nuclear Energy       -87346.5215870345273
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7530.9342270672305
Coulomb Energy                 38437.8973707663972
Exchange-Correlation Energy     -921.9679058683656
--------------------------------------------------
Total Energy                   -7629.4048813660193
--------------------------------------------------



Energy difference :  5.988171324133873e-05


HOMO-LUMO gap: 0.07771558602296685 au
HOMO-LUMO gap: 2.115 eV


Time taken for the previous iteration: 7.642024468048476


Number of electrons:  1000.0002514335653



------Iteration 14--------


Energies

Electron-Nuclear Energy       -87346.3900839641719
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7530.8706793566780
Coulomb Energy                 38437.8206763086782
Exchange-Correlation Energy     -921.9591678849233
--------------------------------------------------
Total Energy                   -7629.4048824804922
--------------------------------------------------



Energy difference :  1.1144729796797037e-06


HOMO-LUMO gap: 0.07771107602319494 au
HOMO-LUMO gap: 2.115 eV


Time taken for the previous iteration: 7.5036358560901135


Number of electrons:  1000.0002514367358



------Iteration 15--------


Energies

Electron-Nuclear Energy       -87346.4008770828077
Nuclear repulsion Energy       34670.2530137032445
Kinetic Energy                  7530.8791642430115
Coulomb Energy                 38437.8241342467954
Exchange-Correlation Energy     -921.9603176391540
--------------------------------------------------
Total Energy                   -7629.4048825289065
--------------------------------------------------



Energy difference :  4.8414221964776516e-08

SCF Converged after 15 iterations!

-------------------------------------
Total Energy =  -7629.4048825289065
-------------------------------------



Time taken : 248.18683794897515 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           18.94009836902842
Density Fitting                         27.81428938615136
    DF (gamma)                          9.255865939194337
    DF (coeff)                          1.396696306183003
    DF (Jtri)                           8.297681922791526
    DF (Cholesky)                       8.340708759031259
DIIS                                    14.609601035481319
KS matrix diagonalization               24.87405079009477
One electron Integrals (S, T, Vnuc)     1.4959920949768275
Coulomb Integrals (2c2e + 3c2e)         101.84187045798171
Grids construction                      0
Exchange-Correlation Term               57.447094440925866
Misc.                                   1.1638413743348792
Complete SCF                            248.18683794897515
Energy diff (PySCF-CrysX) 2.1894884412176907e-06


PyFock Dipole moment
Dipole moment(X, Y, Z, A.U.): 6.2854069834866095 3.7542560228030197 -4.537435011414345
Max Diff dipole moment (PySCF-CrysX) 0.0001257988333236426

============================================================
Processing: ../../Structures/water_cluster_139.xyz
============================================================
#INFO: **** input file is /home/lu29vow/PyFock/benchmarks_tests/FINAL_Benchmarks_for_paper/Energy_and_Convergence_Validations/3D_Water_Clusters/benchmark_DFT_LDA_DF.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
#numba.config.THREADING_LAYER='tbb'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 48
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(1500000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)


basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'cc-pVDZ'


auxbasis_name = 'def2-universal-jfit'

# List of all molecules to calculate
xyz_files = [
    '../../Structures/water_cluster_1.xyz',
    '../../Structures/water_cluster_5.xyz',
    '../../Structures/water_cluster_10.xyz',
    '../../Structures/water_cluster_20.xyz',
    '../../Structures/water_cluster_32.xyz',
    '../../Structures/water_cluster_47.xyz',
    '../../Structures/water_cluster_76.xyz',
    '../../Structures/water_cluster_100.xyz',
    '../../Structures/water_cluster_139.xyz',
]


# Loop through all molecules
for xyzFilename in xyz_files:
    print(f"\n{'='*60}")
    print(f"Processing: {xyzFilename}")
    print(f"{'='*60}")

    # ---------PySCF---------------
    #Comparison with PySCF
    molPySCF = gto.Mole()
    molPySCF.atom = xyzFilename
    molPySCF.basis = basis_set_name
    molPySCF.cart = True
    molPySCF.verbose = 4
    molPySCF.max_memory=1500000
    molPySCF.build()

    print('\n\nPySCF Results\n\n')
    start=timer()
    mf = dft.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
    mf.xc = funcidpyscf
    mf.verbose = 4
    mf.direct_scf = False
    mf.init_guess = 'minao'
    dmat_init = mf.init_guess_by_minao(molPySCF)
    mf.max_cycle = 50
    mf.conv_tol = 1e-7
    mf.grids.level = 3
    energyPyscf = mf.kernel(dm0=dmat_init)
    print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
    print('One electron integrals energy',mf.scf_summary['e1'])
    print('Coulomb energy ',mf.scf_summary['coul'])
    print('EXC ',mf.scf_summary['exc'])
    duration = timer()-start
    print('PySCF time: ', duration)
    pyscfGrids = mf.grids
    print('PySCF Grid Size: ', pyscfGrids.weights.shape)
    print('\n\n PySCF Dipole moment')
    dmat = mf.make_rdm1()
    mol_dip_pyscf = mf.dip_moment(molPySCF, dmat, unit='AU')
    mf = 0

    #--------------------CrysX --------------------------

    #Initialize a Mol object with somewhat large geometry
    molCrysX = Mol(coordfile=xyzFilename)

    #Initialize a Basis object with a very large basis set
    basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})

    auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})

    dftObj = DFT(molCrysX, basis, auxbasis, xc=funcidcrysx, grids=pyscfGrids)
    dftObj.dmat = dmat_init
    dftObj.conv_crit = 1e-7
    dftObj.max_itr = 50
    dftObj.ncores = ncores
    dftObj.save_ao_values = True
    dftObj.rys = True
    dftObj.DF_algo = 10
    dftObj.blocksize = 5000
    dftObj.XC_algo = 2
    dftObj.debug = False
    dftObj.sortGrids = False
    dftObj.xc_bf_screen = True
    dftObj.threshold_schwarz = 1e-9
    dftObj.strict_schwarz = False
    dftObj.cholesky = True
    dftObj.orthogonalize = True
    # SAO or CAO basis
    dftObj.sao = False

    # GPU acceleration
    dftObj.use_gpu = False
    dftObj.keep_ao_in_gpu = False
    dftObj.use_libxc = False
    dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
    dftObj.n_gpus = 1 # Specify the number of GPUs
    dftObj.free_gpu_mem = True
    dftObj.threads_x = 32
    dftObj.threads_y = 32
    dftObj.dynamic_precision = False
    dftObj.keep_ints3c2e_in_gpu = True


    # Using PySCF grids to compare the energies
    energyCrysX, dmat = dftObj.scf()


    print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf))

    print('\n\nPyFock Dipole moment')
    M = Integrals.dipole_moment_mat_symm(basis)
    mol_dip = molCrysX.get_dipole_moment(M, dmat)
    print('Dipole moment(X, Y, Z, A.U.):', *mol_dip)
    print('Max Diff dipole moment (PySCF-CrysX)', abs(mol_dip_pyscf-mol_dip).max())

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
# import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
# print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='fat04.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64', processor='x86_64')  Threads 48
Python 3.8.6 (default, Oct 28 2021, 14:43:29) 
[GCC 8.3.1 20191121 (Red Hat 8.3.1-5)]
numpy 1.22.4  scipy 1.7.1  h5py 3.5.0
Date: Mon Aug 11 09:38:25 2025
PySCF version 2.7.0
PySCF path  /home/lu29vow/.local/lib/python3.8/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 1500000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 417
[INPUT] num. electrons = 1390
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Cartesian GTO integrals (6d 10f)
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 O    104.008000000000 103.223000000000 106.729000000000 AA  196.546634763763 195.063199755979 201.688579548704 Bohr   0.0
[INPUT]  2 H    105.001000000000 103.340000000000 106.712000000000 AA  198.423132805456 195.284297712553 201.656454204587 Bohr   0.0
[INPUT]  3 H    103.694000000000 102.910000000000 105.833000000000 AA  195.953260760650 194.471715478991 199.995384941094 Bohr   0.0
[INPUT]  4 O     96.287700000000 105.219000000000 103.893000000000 AA  181.957382164283 198.835093100611 196.329316259438 Bohr   0.0
[INPUT]  5 H     96.781000000000 104.419000000000 104.235000000000 AA  182.889584061531 197.323312200959 196.975602594039 Bohr   0.0
[INPUT]  6 H     96.485600000000 105.342000000000 102.921000000000 AA  182.331358964335 199.067529413933 194.492502466361 Bohr   0.0
[INPUT]  7 O    101.140000000000 103.233000000000 105.698000000000 AA  191.126900238510 195.082097017225 199.740271914278 Bohr   0.0
[INPUT]  8 H    101.800000000000 103.577000000000 106.365000000000 AA  192.374119480723 195.732162804075 201.000719239363 Bohr   0.0
[INPUT]  9 H    101.619000000000 102.707000000000 104.996000000000 AA  192.032079052177 194.088101075704 198.413684174833 Bohr   0.0
[INPUT] 10 O     95.023600000000 104.404000000000  95.147300000000 AA  179.568579370221 197.294966309091 179.802338491829 Bohr   0.0
[INPUT] 11 H     94.639700000000 103.512000000000  94.908900000000 AA  178.843113511000 195.609330605979 179.351827783733 Bohr   0.0
[INPUT] 12 H     95.948400000000 104.479000000000  94.774200000000 AA  181.316198090218 197.436695768433 179.097281674754 Bohr   0.0
[INPUT] 13 O     96.652200000000  92.863600000000  94.168600000000 AA  182.646187336687 175.486770941160 177.952863533717 Bohr   0.0
[INPUT] 14 H     96.603500000000  93.849000000000  94.005100000000 AA  182.554157674421 177.348907064307 177.643893312351 Bohr   0.0
[INPUT] 15 H     95.732400000000  92.507100000000  94.332700000000 AA  180.908017247312 174.813083577753 178.262967590759 Bohr   0.0
[INPUT] 16 O     93.054300000000 101.153000000000 103.187000000000 AA  175.847141713115 191.151466678130 194.995169615495 Bohr   0.0
[INPUT] 17 H     93.153500000000 102.024000000000 103.669000000000 AA  176.034602544671 192.797418132626 195.906017607535 Bohr   0.0
[INPUT] 18 H     93.282100000000 101.279000000000 102.221000000000 AA  176.277621324291 191.389572169825 193.169694179165 Bohr   0.0
[INPUT] 19 O    100.056000000000 104.833000000000  91.780500000000 AA  189.078437119482 198.105658816529 173.440008575644 Bohr   0.0
[INPUT] 20 H    100.663000000000 104.400000000000  92.446900000000 AA  190.225500877093 197.287407404592 174.699322065054 Bohr   0.0
[INPUT] 21 H     99.761600000000 105.723000000000  92.126900000000 AA  188.522101748410 199.787515067392 174.094609705193 Bohr   0.0
[INPUT] 22 O    103.662000000000 102.962000000000  95.665500000000 AA  195.892789524663 194.569981237468 180.781594569579 Bohr   0.0
[INPUT] 23 H    104.569000000000 102.981000000000  96.087800000000 AA  197.606771119644 194.605886033835 181.579625911983 Bohr   0.0
[INPUT] 24 H    103.118000000000 102.230000000000  96.076400000000 AA  194.864778512900 193.186701714286 181.558083034163 Bohr   0.0
[INPUT] 25 O    101.495000000000  96.997200000000  93.049900000000 AA  191.797753012731 183.298142849662 175.838826918167 Bohr   0.0
[INPUT] 26 H    100.616000000000  97.208900000000  93.477800000000 AA  190.136683749238 183.698197870233 176.647440726868 Bohr   0.0
[INPUT] 27 H    101.533000000000  96.022200000000  92.831100000000 AA  191.869562605464 181.455659878211 175.425354842112 Bohr   0.0
[INPUT] 28 O     97.873900000000 103.017000000000 100.816000000000 AA  184.954865743068 194.673916174319 190.514628974151 Bohr   0.0
[INPUT] 29 H     98.128600000000 103.038000000000  99.848800000000 AA  185.436178986995 194.713600422935 188.686885866472 Bohr   0.0
[INPUT] 30 H     97.173800000000 102.317000000000 100.960000000000 AA  183.631868483260 193.351107887123 190.786749536089 Bohr   0.0
[INPUT] 31 O    103.316000000000 100.168000000000 106.766000000000 AA  195.238944285564 189.290086445433 201.758499415313 Bohr   0.0
[INPUT] 32 H    103.471000000000  99.766300000000 105.864000000000 AA  195.531851834872 188.530983461195 200.053966450956 Bohr   0.0
[INPUT] 33 H    103.282000000000 101.164000000000 106.687000000000 AA  195.174693597329 191.172253665500 201.609211051473 Bohr   0.0
[INPUT] 34 O    101.099000000000 104.850000000000  99.030700000000 AA  191.049421467403 198.137784160647 187.140900923965 Bohr   0.0
[INPUT] 35 H    101.483000000000 104.260000000000  99.740500000000 AA  191.775076299236 197.022845747153 188.482228527182 Bohr   0.0
[INPUT] 36 H    101.829000000000 105.396000000000  98.619700000000 AA  192.428921538336 199.169574624659 186.364223486769 Bohr   0.0
[INPUT] 37 O     96.773600000000 102.808000000000 107.170000000000 AA  182.875600088209 194.278963414285 202.521948769638 Bohr   0.0
[INPUT] 38 H     96.854200000000 102.589000000000 108.142000000000 AA  183.027912013849 193.865113393005 204.358762562715 Bohr   0.0
[INPUT] 39 H     96.421400000000 102.013000000000 106.676000000000 AA  182.210038547138 192.776631145256 201.588424064103 Bohr   0.0
[INPUT] 40 O    105.665000000000  96.993900000000 105.027000000000 AA  199.677910952167 183.291906753451 198.472265684695 Bohr   0.0
[INPUT] 41 H    104.749000000000  97.393500000000 104.997000000000 AA  197.946921822066 184.047041312827 198.415573900958 Bohr   0.0
[INPUT] 42 H    106.330000000000  97.657600000000 104.684000000000 AA  200.934578825003 184.546117982325 197.824089623969 Bohr   0.0
[INPUT] 43 O     92.694200000000  96.495000000000 105.409000000000 AA  175.166651335659 182.349122389906 199.194141064279 Bohr   0.0
[INPUT] 44 H     91.854100000000  96.418200000000 104.872000000000 AA  173.579092418412 182.203991423539 198.179358135387 Bohr   0.0
[INPUT] 45 H     92.964700000000  97.455900000000 105.469000000000 AA  175.677822252354 184.164960223000 199.307524631752 Bohr   0.0
[INPUT] 46 O    105.279000000000  92.275800000000 100.558000000000 AA  198.948476668085 174.375989925141 190.027079634013 Bohr   0.0
[INPUT] 47 H    104.667000000000  91.493800000000 100.676000000000 AA  197.791964279851 172.898224095731 190.250067316712 Bohr   0.0
[INPUT] 48 H    105.767000000000  92.188100000000  99.689400000000 AA  199.870663016873 174.210260944016 188.385663522216 Bohr   0.0
[INPUT] 49 O    100.645000000000 100.169000000000  95.891500000000 AA  190.191485806851 189.291976171558 181.208672673731 Bohr   0.0
[INPUT] 50 H    101.491000000000 100.305000000000  96.406200000000 AA  191.790194108233 189.548978924499 182.181314710044 Bohr   0.0
[INPUT] 51 H     99.888700000000 100.618000000000  96.367800000000 AA  188.762285938842 190.140463201487 182.108749226861 Bohr   0.0
[INPUT] 52 O     99.814000000000 100.835000000000 101.232000000000 AA  188.621123397337 190.550533770518 191.300755041970 Bohr   0.0
[INPUT] 53 H     99.329200000000  99.976800000000 101.063000000000 AA  187.704984172148 188.928770810416 190.981391326919 Bohr   0.0
[INPUT] 54 H     99.151600000000 101.561000000000 101.414000000000 AA  187.369368812425 191.922474936952 191.644685196641 Bohr   0.0
[INPUT] 55 O     98.804000000000  98.512200000000  97.758100000000 AA  186.712500011526 186.161077928378 184.736035457844 Bohr   0.0
[INPUT] 56 H     99.782100000000  98.646900000000  97.916700000000 AA  188.560841133963 186.415624037357 185.035746021200 Bohr   0.0
[INPUT] 57 H     98.421800000000  99.326500000000  97.321300000000 AA  185.990246686718 187.699881911612 183.910603086634 Bohr   0.0
[INPUT] 58 O    100.747000000000 100.164000000000 103.736000000000 AA  190.384237871556 189.282527540935 196.032629257881 Bohr   0.0
[INPUT] 59 H    100.658000000000 100.628000000000 102.855000000000 AA  190.216052246470 190.159360462733 194.367780542139 Bohr   0.0
[INPUT] 60 H    100.105000000000  99.398600000000 103.776000000000 AA  189.171033699586 187.836131165193 196.108218302864 Bohr   0.0
[INPUT] 61 O     98.070300000000  98.516900000000 100.438000000000 AA  185.326007953933 186.169959641164 189.800312499066 Bohr   0.0
[INPUT] 62 H     97.172800000000  98.878600000000 100.690000000000 AA  183.629978757136 186.853473580419 190.276523482456 Bohr   0.0
[INPUT] 63 H     98.194000000000  98.592200000000  99.448100000000 AA  185.559767075542 186.312256018344 187.929672608359 Bohr   0.0
[INPUT] 64 O     99.241500000000 107.096000000000 102.899000000000 AA  187.539255191024 202.382109036420 194.450928491620 Bohr   0.0
[INPUT] 65 H     99.533400000000 106.810000000000 103.812000000000 AA  188.090866246784 201.841647364794 196.176248443348 Bohr   0.0
[INPUT] 66 H     99.798300000000 107.871000000000 102.599000000000 AA  188.591454697181 203.846646782958 193.884010654251 Bohr   0.0
[INPUT] 67 O    101.321000000000  92.439600000000  94.597100000000 AA  191.468940667057 174.685527064344 178.762611178094 Bohr   0.0
[INPUT] 68 H    100.828000000000  92.917700000000  93.869600000000 AA  190.537305687646 175.589005124499 177.387835422473 Bohr   0.0
[INPUT] 69 H    100.676000000000  91.895200000000  95.133600000000 AA  190.250067316712 173.656760162131 179.776449243923 Bohr   0.0
[INPUT] 70 O     97.511000000000 109.183000000000  97.591000000000 AA  184.269084132464 206.325967458387 184.420262222429 Bohr   0.0
[INPUT] 71 H     97.971100000000 109.344000000000  98.464100000000 AA  185.138547122376 206.630213364442 186.070182101787 Bohr   0.0
[INPUT] 72 H     97.118900000000 108.263000000000  97.585400000000 AA  183.528122519022 204.587419423787 184.409679756131 Bohr   0.0
[INPUT] 73 O     96.373500000000  99.168100000000 103.663000000000 AA  182.119520665771 187.400549293481 195.894679250788 Bohr   0.0
[INPUT] 74 H     96.032600000000  99.385200000000 104.578000000000 AA  181.475313029907 187.810808835124 197.623778654765 Bohr   0.0
[INPUT] 75 H     97.337900000000  98.909800000000 103.720000000000 AA  183.941972540302 186.912433035505 196.002393639888 Bohr   0.0
[INPUT] 76 O     98.712300000000 104.348000000000 108.710000000000 AA  186.539212125904 197.189141646115 205.432127001468 Bohr   0.0
[INPUT] 77 H     99.403100000000 105.010000000000 108.418000000000 AA  187.844634932753 198.440140340577 204.880326973095 Bohr   0.0
[INPUT] 78 H     97.801400000000 104.702000000000 108.498000000000 AA  184.817860599037 197.858104694211 205.031505063060 Bohr   0.0
[INPUT] 79 O     92.236600000000  98.969600000000  99.830200000000 AA  174.301912661058 187.025438657754 188.651736960555 Bohr   0.0
[INPUT] 80 H     92.257200000000  98.492300000000 100.709000000000 AA  174.340841019224 186.123472378499 190.312428278823 Bohr   0.0
[INPUT] 81 H     92.125400000000  98.304300000000  99.091900000000 AA  174.091775116006 185.768203867081 187.256552162789 Bohr   0.0
[INPUT] 82 O     96.740700000000 101.641000000000  95.246600000000 AA  182.813428098711 192.073653026917 179.989988295999 Bohr   0.0
[INPUT] 83 H     95.765200000000 101.625000000000  95.027600000000 AA  180.970000264198 192.043417408924 179.576138274719 Bohr   0.0
[INPUT] 84 H     97.256100000000 101.957000000000  94.450300000000 AA  183.787392943312 192.670806482280 178.485199383007 Bohr   0.0
[INPUT] 85 O    103.992000000000  93.621500000000 106.488000000000 AA  196.516399145770 176.918994370968 201.233155552684 Bohr   0.0
[INPUT] 86 H    103.820000000000  92.924200000000 107.184000000000 AA  196.191366252345 175.601288344309 202.548404935382 Bohr   0.0
[INPUT] 87 H    104.711000000000  94.239300000000 106.806000000000 AA  197.875112229332 178.086467170724 201.834088460296 Bohr   0.0
[INPUT] 88 O     93.812300000000  95.791400000000  93.897200000000 AA  177.279554115535 181.019511088662 177.439991863511 Bohr   0.0
[INPUT] 89 H     93.511100000000  94.848700000000  93.753200000000 AA  176.710368606816 179.238066271034 177.167871301573 Bohr   0.0
[INPUT] 90 H     94.305800000000  95.854800000000  94.764600000000 AA  178.212133958008 181.139319724959 179.079140303958 Bohr   0.0
[INPUT] 91 O    105.589000000000 107.064000000000 102.225000000000 AA  199.534291766700 202.321637800434 193.177253083663 Bohr   0.0
[INPUT] 92 H    104.796000000000 106.766000000000 102.758000000000 AA  198.035738949920 201.758499415313 194.184477108057 Bohr   0.0
[INPUT] 93 H    105.511000000000 108.041000000000 102.031000000000 AA  199.386893128984 204.167900224134 192.810646215498 Bohr   0.0
[INPUT] 94 O     94.447800000000  93.062900000000  97.104400000000 AA  178.480475067696 175.863393357786 183.500721490216 Bohr   0.0
[INPUT] 95 H     94.685200000000  93.846500000000  96.530300000000 AA  178.929096049668 177.344182748995 182.415829722103 Bohr   0.0
[INPUT] 96 H     94.118000000000  93.387100000000  97.991100000000 AA  177.857243391814 176.476042567370 185.176341644867 Bohr   0.0
[INPUT] 97 O    106.873000000000 103.046000000000  96.266300000000 AA  201.960700110642 194.728718231931 181.916942025218 Bohr   0.0
[INPUT] 98 H    106.397000000000 102.273000000000  96.684800000000 AA  201.061190475349 193.267959937643 182.707792408348 Bohr   0.0
[INPUT] 99 H    107.190000000000 102.788000000000  95.353900000000 AA  202.559743292129 194.241168891794 180.192755909164 Bohr   0.0
[INPUT]100 O     96.855700000000  95.639100000000 102.759000000000 AA  183.030746603036 180.731705799890 194.186366834181 Bohr   0.0
[INPUT]101 H     96.157300000000  96.250200000000 102.386000000000 AA  181.710961877640 181.886517434612 193.481498989718 Bohr   0.0
[INPUT]102 H     97.741700000000  95.856700000000 102.349000000000 AA  184.705043949401 181.142910204596 193.411579123110 Bohr   0.0
[INPUT]103 O     97.209000000000  95.906800000000  94.278900000000 AA  183.698386842845 181.237585483436 178.161300325257 Bohr   0.0
[INPUT]104 H     97.087400000000  95.813100000000  93.290800000000 AA  183.468596146098 181.060518145565 176.294061941574 Bohr   0.0
[INPUT]105 H     98.015300000000  96.468800000000  94.463700000000 AA  185.222073017082 182.299611565442 178.510521713077 Bohr   0.0
[INPUT]106 O    103.969000000000  95.809900000000 100.611000000000 AA  196.472935444905 181.054471021966 190.127235118615 Bohr   0.0
[INPUT]107 H    104.656000000000  95.771500000000 101.336000000000 AA  197.771177292481 180.981905538783 191.497286558925 Bohr   0.0
[INPUT]108 H    103.152000000000  96.276300000000 100.950000000000 AA  194.929029201135 181.935839286463 190.767852274843 Bohr   0.0
[INPUT]109 O    106.587000000000 100.034000000000 103.851000000000 AA  201.420238439016 189.036863144741 196.249947762206 Bohr   0.0
[INPUT]110 H    105.829000000000 100.104000000000 103.203000000000 AA  199.987826036596 189.169143973461 195.025405233488 Bohr   0.0
[INPUT]111 H    107.394000000000 100.487000000000 103.470000000000 AA  202.945247421540 189.892909079169 195.529962108747 Bohr   0.0
[INPUT]112 O     97.068600000000  95.759300000000  91.564500000000 AA  183.433069294956 180.958850880063 173.031827732738 Bohr   0.0
[INPUT]113 H     97.632500000000  96.221500000000  90.880200000000 AA  184.498685856598 181.832282294837 171.738688145698 Bohr   0.0
[INPUT]114 H     97.128400000000  94.769800000000  91.432600000000 AA  183.546074917205 179.088966879806 172.782572856907 Bohr   0.0
[INPUT]115 O    100.377000000000  94.639000000000  92.016300000000 AA  189.685039205467 178.841790702713 173.885605995816 Bohr   0.0
[INPUT]116 H    100.540000000000  94.798900000000  91.042700000000 AA  189.993064563771 179.143957910031 172.045768640940 Bohr   0.0
[INPUT]117 H     99.775700000000  93.847800000000  92.128000000000 AA  188.548746886766 177.346639392957 174.096688403930 Bohr   0.0
[INPUT]118 O     98.463200000000 103.644000000000 104.855000000000 AA  186.068481348275 195.858774454421 198.147232791270 Bohr   0.0
[INPUT]119 H     99.448900000000 103.710000000000 105.009000000000 AA  187.931184389258 195.983496378643 198.438250614453 Bohr   0.0
[INPUT]120 H     98.023000000000 103.265000000000 105.669000000000 AA  185.236623908241 195.142568253211 199.685469856666 Bohr   0.0
[INPUT]121 O    101.993000000000 104.014000000000  93.998500000000 AA  192.738836622764 196.557973120510 177.631421119929 Bohr   0.0
[INPUT]122 H    102.580000000000 103.877000000000  94.796800000000 AA  193.848105857884 196.299080641445 179.139989485169 Bohr   0.0
[INPUT]123 H    102.066000000000 103.222000000000  93.391700000000 AA  192.876786629858 195.061310029855 176.484735307543 Bohr   0.0
[INPUT]124 O     91.476100000000 103.263000000000  99.076600000000 AA  172.864775943326 195.138788800962 187.227639353083 Bohr   0.0
[INPUT]125 H     91.525700000000 104.257000000000  98.982100000000 AA  172.958506359104 197.017176568780 187.049060234311 Bohr   0.0
[INPUT]126 H     90.519400000000 102.973000000000  99.050700000000 AA  171.056874959955 194.590768224838 187.178695446457 Bohr   0.0
[INPUT]127 O     98.548000000000 101.265000000000  97.248600000000 AA  186.228730123638 191.363116004081 183.773219997378 Bohr   0.0
[INPUT]128 H     98.688900000000 102.140000000000  97.711000000000 AA  186.494992534589 193.016626363075 184.647029357377 Bohr   0.0
[INPUT]129 H     97.919900000000 101.391000000000  96.480800000000 AA  185.041793144798 191.601221495776 182.322288278937 Bohr   0.0
[INPUT]130 O     99.706100000000  94.287900000000 105.534000000000 AA  188.417221948497 178.178307860378 199.430356829849 Bohr   0.0
[INPUT]131 H     98.709100000000  94.214400000000 105.511000000000 AA  186.533165002305 178.039412990223 199.386893128984 Bohr   0.0
[INPUT]132 H    100.042000000000  93.988200000000 106.427000000000 AA  189.051980953738 177.611956940846 201.117882259086 Bohr   0.0
[INPUT]133 O    104.764000000000 102.907000000000 101.929000000000 AA  197.975267713934 194.466046300617 192.617894150792 Bohr   0.0
[INPUT]134 H    104.157000000000 103.650000000000 101.648000000000 AA  196.828203956323 195.870112811169 192.086881109789 Bohr   0.0
[INPUT]135 H    105.597000000000 103.289000000000 102.328000000000 AA  199.549409575697 195.187921680201 193.371894874494 Bohr   0.0
[INPUT]136 O    104.727000000000  95.435700000000  98.038700000000 AA  197.905347847325 180.347335506154 185.266292608397 Bohr   0.0
[INPUT]137 H    103.947000000000  95.065800000000  97.535100000000 AA  196.431361470164 179.648325812677 184.314626532066 Bohr   0.0
[INPUT]138 H    104.496000000000  95.504800000000  99.009000000000 AA  197.468821112551 180.477915581361 187.099893867062 Bohr   0.0
[INPUT]139 O    103.898000000000  98.427900000000  99.984500000000 AA  196.338764890061 186.001774016077 188.943321701575 Bohr   0.0
[INPUT]140 H    103.015000000000  98.654900000000  99.573700000000 AA  194.670136722070 186.430741846354 188.167022209604 Bohr   0.0
[INPUT]141 H    104.128000000000  97.477300000000  99.776100000000 AA  196.773401898711 184.205400362066 188.549502777216 Bohr   0.0
[INPUT]142 O    108.743000000000 100.423000000000  97.268200000000 AA  205.494487963579 189.771966607197 183.810258629419 Bohr   0.0
[INPUT]143 H    107.828000000000 100.128000000000  97.542100000000 AA  203.765388559601 189.214497400451 184.327854614938 Bohr   0.0
[INPUT]144 H    109.219000000000  99.663600000000  96.823800000000 AA  206.393997598871 188.336908588203 182.970464339663 Bohr   0.0
[INPUT]145 O     99.166600000000  96.442100000000 101.723000000000 AA  187.397714704294 182.249155877916 192.228610569132 Bohr   0.0
[INPUT]146 H     98.843200000000  97.206600000000 101.166000000000 AA  186.786577275609 183.693851500146 191.176033117749 Bohr   0.0
[INPUT]147 H     99.643900000000  95.783700000000 101.141000000000 AA  188.299680983549 181.004960197502 191.128789964635 Bohr   0.0
[INPUT]148 O     94.272300000000 104.861000000000  98.027200000000 AA  178.148828132835 198.158571148017 185.244560757964 Bohr   0.0
[INPUT]149 H     93.274400000000 104.806000000000  97.992700000000 AA  176.263070433131 198.054636211166 185.179365206667 Bohr   0.0
[INPUT]150 H     94.652300000000 104.579000000000  97.146100000000 AA  178.866924060170 197.625668380890 183.579523069610 Bohr   0.0
[INPUT]151 O    107.544000000000  95.677300000000  98.777200000000 AA  203.228706340225 180.803893337849 186.661855351388 Bohr   0.0
[INPUT]152 H    106.627000000000  95.279200000000  98.760300000000 AA  201.495827483999 180.051593367659 186.629918979883 Bohr   0.0
[INPUT]153 H    107.707000000000  96.101300000000  99.668000000000 AA  203.536731698529 181.605137214664 188.345223383151 Bohr   0.0
[INPUT]154 O     94.408300000000 105.314000000000 100.701000000000 AA  178.405830885776 199.014617082445 190.297310469826 Bohr   0.0
[INPUT]155 H     94.396800000000 105.021000000000  99.744600000000 AA  178.384099035343 198.460927327947 188.489976404292 Bohr   0.0
[INPUT]156 H     95.353500000000 105.456000000000 100.995000000000 AA  180.192000018715 199.282958192133 190.852889950448 Bohr   0.0
[INPUT]157 O    106.040000000000  95.593700000000 102.478000000000 AA  200.386558248879 180.645912233835 193.655353793178 Bohr   0.0
[INPUT]158 H    105.762000000000  96.182200000000 103.237000000000 AA  199.861214386250 181.758016058142 195.089655921723 Bohr   0.0
[INPUT]159 H    106.867000000000  95.091200000000 102.732000000000 AA  201.949361753894 179.696324856241 194.135344228818 Bohr   0.0
[INPUT]160 O    102.891000000000 100.842000000000  97.477600000000 AA  194.435810682624 190.563761853390 184.205967279903 Bohr   0.0
[INPUT]161 H    103.837000000000 100.662000000000  97.209700000000 AA  196.223491596462 190.223611150968 183.699709651132 Bohr   0.0
[INPUT]162 H    102.868000000000 101.166000000000  98.423400000000 AA  194.392346981759 191.176033117749 185.993270248517 Bohr   0.0
[INPUT]163 O    106.874000000000  99.683900000000 106.428000000000 AA  201.962589836766 188.375270028531 201.119771985210 Bohr   0.0
[INPUT]164 H    106.236000000000 100.310000000000 106.876000000000 AA  200.756944569294 189.558427555121 201.966369289016 Bohr   0.0
[INPUT]165 H    106.818000000000  99.803900000000 105.436000000000 AA  201.856765173791 188.602037163479 199.245163669642 Bohr   0.0
[INPUT]166 O    107.589000000000 103.376000000000 102.668000000000 AA  203.313744015830 195.352327853038 194.014401756846 Bohr   0.0
[INPUT]167 H    107.461000000000 104.111000000000 103.335000000000 AA  203.071859071886 196.741276554593 195.274849081931 Bohr   0.0
[INPUT]168 H    107.934000000000 103.760000000000 101.812000000000 AA  203.965699528805 196.077982684871 192.396796194218 Bohr   0.0
[INPUT]169 O     96.227200000000 100.990000000000 101.698000000000 AA  181.843053733747 190.843441319826 192.181367416018 Bohr   0.0
[INPUT]170 H     96.148800000000 100.422000000000 102.517000000000 AA  181.694899205581 189.770076881073 193.729053112036 Bohr   0.0
[INPUT]171 H     95.313600000000 101.237000000000 101.375000000000 AA  180.116599946344 191.310203672593 191.570985877783 Bohr   0.0
[INPUT]172 O    107.826000000000  96.984100000000 101.113000000000 AA  203.761609107352 183.273387437430 191.075877633147 Bohr   0.0
[INPUT]173 H    108.466000000000  97.497100000000 101.685000000000 AA  204.971033827074 184.242816939332 192.156800976398 Bohr   0.0
[INPUT]174 H    107.058000000000  96.670200000000 101.672000000000 AA  202.310299443686 182.680202406929 192.132234536779 Bohr   0.0
[INPUT]175 O     92.639000000000  96.955600000000  97.829000000000 AA  175.062338453583 183.219530242880 184.870017040075 Bohr   0.0
[INPUT]176 H     93.628900000000  97.092800000000  97.866000000000 AA  176.932978344290 183.478800667171 184.939936906684 Bohr   0.0
[INPUT]177 H     92.443100000000  96.008400000000  97.575100000000 AA  174.692141105780 181.429581657692 184.390215577048 Bohr   0.0
[INPUT]178 O     95.278100000000  97.169000000000  98.965800000000 AA  180.049514668922 183.622797797862 187.018257698481 Bohr   0.0
[INPUT]179 H     95.144800000000  97.377000000000  99.934800000000 AA  179.797614176518 184.015860831772 188.849402313185 Bohr   0.0
[INPUT]180 H     95.587900000000  97.991100000000  98.488100000000 AA  180.634951822313 185.176341644867 186.115535528776 Bohr   0.0
[INPUT]181 O    100.904000000000  98.618600000000  90.342100000000 AA  190.680924873113 186.362144788032 170.721826518069 Bohr   0.0
[INPUT]182 H    101.764000000000  98.307000000000  89.937000000000 AA  192.306089340239 185.773306127618 169.956298465008 Bohr   0.0
[INPUT]183 H    100.795000000000  98.208600000000  91.247600000000 AA  190.474944725535 185.587357076960 172.432973523863 Bohr   0.0
[INPUT]184 O     98.864800000000  98.222500000000 103.917000000000 AA  186.827395359900 185.613624270092 196.374669686428 Bohr   0.0
[INPUT]185 H     98.949800000000  97.463000000000 103.272000000000 AA  186.988022080488 184.178377278485 195.155796336083 Bohr   0.0
[INPUT]186 H     99.054800000000  97.896400000000 104.843000000000 AA  187.186443323567 184.997384580871 198.124556077775 Bohr   0.0
[INPUT]187 O    104.578000000000 100.035000000000 101.952000000000 AA  197.623778654765 189.038752870866 192.661357851657 Bohr   0.0
[INPUT]188 H    104.419000000000 101.011000000000 101.802000000000 AA  197.323312200959 190.883125568441 192.377898932972 Bohr   0.0
[INPUT]189 H    104.206000000000  99.514900000000 101.184000000000 AA  196.920800536427 188.055906313480 191.210048187991 Bohr   0.0
[INPUT]190 O    102.027000000000 106.876000000000 101.138000000000 AA  192.803087311000 201.966369289016 191.123120786261 Bohr   0.0
[INPUT]191 H    102.200000000000 106.695000000000 100.170000000000 AA  193.130009930549 201.624328860469 189.293865897682 Bohr   0.0
[INPUT]192 H    101.515000000000 107.729000000000 101.232000000000 AA  191.835547535222 203.578305673270 191.300755041970 Bohr   0.0
[INPUT]193 O    102.429000000000 104.060000000000 101.348000000000 AA  193.562757213075 196.644900522240 191.519963272420 Bohr   0.0
[INPUT]194 H    101.757000000000 103.665000000000 101.974000000000 AA  192.292861257367 195.898458703037 192.702931826398 Bohr   0.0
[INPUT]195 H    102.209000000000 105.021000000000 101.185000000000 AA  193.147017465670 198.460927327947 191.211937914116 Bohr   0.0
[INPUT]196 O    109.444000000000 101.526000000000  99.560200000000 AA  206.819185976899 191.856334522592 188.141510906922 Bohr   0.0
[INPUT]197 H    109.322000000000 101.267000000000  98.601900000000 AA  206.588639389702 191.366895456330 186.330586361752 Bohr   0.0
[INPUT]198 H    110.317000000000 102.000000000000  99.669500000000 AA  208.468916883644 192.752064705636 188.348057972337 Bohr   0.0
[INPUT]199 O     96.798000000000  93.944200000000 100.568000000000 AA  182.921709405649 177.528808991365 190.045976895259 Bohr   0.0
[INPUT]200 H     97.508200000000  94.486700000000 100.119000000000 AA  184.263792899315 178.553985413942 189.197489865329 Bohr   0.0
[INPUT]201 H     96.982400000000  93.900400000000 101.550000000000 AA  183.270174903019 177.446038987109 191.901687949582 Bohr   0.0
[INPUT]202 O    108.101000000000 103.927000000000  99.741400000000 AA  204.281283791608 196.393566947673 188.483929280694 Bohr   0.0
[INPUT]203 H    108.585000000000 103.064000000000  99.882900000000 AA  205.195911235897 194.762733302174 188.751325527320 Bohr   0.0
[INPUT]204 H    108.116000000000 104.162000000000  98.769500000000 AA  204.309629683476 196.837652586946 186.647304460229 Bohr   0.0
[INPUT]205 O     95.118700000000  97.700600000000 101.797000000000 AA  179.748292324667 184.627376205681 192.368450302350 Bohr   0.0
[INPUT]206 H     94.171300000000  97.423600000000 101.957000000000 AA  177.957965794254 184.103922069177 192.670806482280 Bohr   0.0
[INPUT]207 H     95.377300000000  98.403200000000 102.460000000000 AA  180.236975500479 185.955097780801 193.621338722936 Bohr   0.0
[INPUT]208 O     99.231100000000  93.154200000000 102.821000000000 AA  187.519602039328 176.035925352959 194.303529853904 Bohr   0.0
[INPUT]209 H     99.331300000000  93.817000000000 103.563000000000 AA  187.708952597010 177.288435828320 195.705706638331 Bohr   0.0
[INPUT]210 H    100.104000000000  93.053400000000 102.344000000000 AA  189.169143973461 175.845440959603 193.402130492487 Bohr   0.0
[INPUT]211 O    103.395000000000  93.763800000000  96.088800000000 AA  195.388232649405 177.187902398494 181.581515638107 Bohr   0.0
[INPUT]212 H    102.541000000000  93.361100000000  95.758700000000 AA  193.774406539026 176.426909688131 180.957717044388 Bohr   0.0
[INPUT]213 H    103.753000000000  94.395700000000  95.401500000000 AA  196.064754601999 178.382020336606 180.282706872694 Bohr   0.0
[INPUT]214 O    103.867000000000  98.228800000000  93.492200000000 AA  196.280183380199 185.625529544677 176.674652783062 Bohr   0.0
[INPUT]215 H    103.007000000000  97.732700000000  93.371700000000 AA  194.655018913073 184.688036414280 176.446940785052 Bohr   0.0
[INPUT]216 H    103.971000000000  98.898600000000  92.757000000000 AA  196.476714897154 186.891268102910 175.285326136281 Bohr   0.0
[INPUT]217 O     99.725400000000 101.618000000000 108.746000000000 AA  188.453693662701 192.030189326052 205.500157141952 Bohr   0.0
[INPUT]218 H     99.296300000000 102.517000000000 108.650000000000 AA  187.642812182650 193.729053112036 205.318743433994 Bohr   0.0
[INPUT]219 H    100.719000000000 101.725000000000 108.777000000000 AA  190.331325540068 192.232390021381 205.558738651814 Bohr   0.0
[INPUT]220 O    105.654000000000 100.606000000000  97.050900000000 AA  199.657123964797 190.117786487993 183.399621142551 Bohr   0.0
[INPUT]221 H    105.817000000000  99.917100000000  96.344600000000 AA  199.965149323101 188.815954160780 182.064907580771 Bohr   0.0
[INPUT]222 H    105.599000000000 100.160000000000  97.944500000000 AA  199.553189027946 189.274968636437 185.088280407463 Bohr   0.0
[INPUT]223 O     98.708200000000 103.752000000000  98.244300000000 AA  186.531464248793 196.062864875874 185.654820299607 Bohr   0.0
[INPUT]224 H     98.397100000000 104.234000000000  97.425400000000 AA  185.943570451441 196.973712867915 184.107323576201 Bohr   0.0
[INPUT]225 H     99.598500000000 104.111000000000  98.524400000000 AA  188.213887417493 196.741276554593 186.184132587098 Bohr   0.0
[INPUT]226 O     93.574900000000 105.539000000000 104.514000000000 AA  176.830933133563 199.439805460472 197.502836182793 Bohr   0.0
[INPUT]227 H     93.322000000000 106.507000000000 104.525000000000 AA  176.353021396661 201.269060349051 197.523623170163 Bohr   0.0
[INPUT]228 H     94.568500000000 105.454000000000 104.587000000000 AA  178.708565010931 199.279178739884 197.640786189886 Bohr   0.0
[INPUT]229 O    104.529000000000  95.238500000000  94.088100000000 AA  197.531182074661 179.974681514390 177.800740580690 Bohr   0.0
[INPUT]230 H    104.552000000000  94.923200000000  93.139400000000 AA  197.574645775526 179.378850867314 176.007957406315 Bohr   0.0
[INPUT]231 H    104.087000000000  96.134100000000  94.131500000000 AA  196.695923127604 181.667120231550 177.882754694496 Bohr   0.0
[INPUT]232 O    100.150000000000 108.297000000000  95.202800000000 AA  189.256071375191 204.651670112022 179.907218291743 Bohr   0.0
[INPUT]233 H    101.071000000000 108.189000000000  95.577600000000 AA  190.996509135915 204.447579690569 180.615487643230 Bohr   0.0
[INPUT]234 H     99.689000000000 109.055000000000  95.663400000000 AA  188.384907631766 206.084082514443 180.777626144717 Bohr   0.0
[INPUT]235 O     97.590800000000  90.988100000000 102.432000000000 AA  184.419884277204 171.942589594538 193.568426391448 Bohr   0.0
[INPUT]236 H     96.888100000000  91.054500000000 101.724000000000 AA  183.091973729472 172.068067409209 192.230500295256 Bohr   0.0
[INPUT]237 H     98.094000000000  91.850700000000 102.484000000000 AA  185.370794463085 173.572667349588 193.666692149926 Bohr   0.0
[INPUT]238 O     95.933300000000 100.069000000000 106.486000000000 AA  181.287663225737 189.103003559101 201.229376100435 Bohr   0.0
[INPUT]239 H     95.896800000000  99.719700000000 107.422000000000 AA  181.218688222191 188.442922223791 202.998159753028 Bohr   0.0
[INPUT]240 H     96.887400000000 100.192000000000 106.213000000000 AA  183.090650921185 189.335439872423 200.713480868429 Bohr   0.0
[INPUT]241 O     97.164700000000  94.924300000000 105.416000000000 AA  183.614671975527 179.380929566051 199.207369147151 Bohr   0.0
[INPUT]242 H     96.958600000000  95.152200000000 104.464000000000 AA  183.225199421254 179.811598149840 197.408349876565 Bohr   0.0
[INPUT]243 H     96.312500000000  94.858500000000 105.935000000000 AA  182.004247372173 179.256585587055 200.188137005800 Bohr   0.0
[INPUT]244 O     97.960300000000  99.738400000000  92.323200000000 AA  185.118138080231 188.478260102320 174.465562943445 Bohr   0.0
[INPUT]245 H     98.025100000000  99.203100000000  91.481000000000 AA  185.240592333103 187.466689707840 172.874035601336 Bohr   0.0
[INPUT]246 H     97.432100000000 100.570000000000  92.149900000000 AA  184.119984741236 190.049756347508 174.138073406058 Bohr   0.0
[INPUT]247 O     95.964200000000 107.132000000000  98.369800000000 AA  181.346055762987 202.450139176904 185.891980928240 Bohr   0.0
[INPUT]248 H     96.229400000000 107.195000000000  99.332000000000 AA  181.847211131221 202.569191922752 187.710275405297 Bohr   0.0
[INPUT]249 H     95.398600000000 106.319000000000  98.232100000000 AA  180.277226666933 200.913791837633 185.631765640888 Bohr   0.0
[INPUT]250 O    103.231000000000 106.520000000000 103.603000000000 AA  195.078317564976 201.293626788670 195.781295683314 Bohr   0.0
[INPUT]251 H    102.896000000000 106.662000000000 102.672000000000 AA  194.445259313247 201.561967898359 194.021960661344 Bohr   0.0
[INPUT]252 H    102.458000000000 106.505000000000 104.237000000000 AA  193.617559270687 201.265280896802 196.979382046288 Bohr   0.0
[INPUT]253 O     92.780100000000  95.010400000000 101.424000000000 AA  175.328978809759 179.543634985376 191.663582457887 Bohr   0.0
[INPUT]254 H     92.910900000000  94.266600000000 102.079000000000 AA  175.576154986852 178.138056693925 192.901353069477 Bohr   0.0
[INPUT]255 H     93.220200000000  94.772800000000 100.558000000000 AA  176.160647277180 179.094636058180 190.027079634013 Bohr   0.0
[INPUT]256 O     99.794600000000  91.488300000000 100.023000000000 AA  188.584462710521 172.887830602046 189.016076157371 Bohr   0.0
[INPUT]257 H    100.445000000000  92.220600000000 100.224000000000 AA  189.813540581938 174.271677043065 189.395911108409 Bohr   0.0
[INPUT]258 H     98.904700000000  91.885300000000  99.798800000000 AA  186.902795432270 173.638051873498 188.592399560244 Bohr   0.0
[INPUT]259 O    106.052000000000  98.653800000000  95.236000000000 AA  200.409234962374 186.428663147617 179.969957199078 Bohr   0.0
[INPUT]260 H    106.528000000000  97.778800000000  95.148400000000 AA  201.308744597667 184.775152788622 179.804417190566 Bohr   0.0
[INPUT]261 H    105.747000000000  98.958900000000  94.333900000000 AA  199.832868494382 187.005218588222 178.265235262108 Bohr   0.0
[INPUT]262 O     98.547200000000 109.727000000000 100.061000000000 AA  186.227218342738 207.353978470151 189.087885750105 Bohr   0.0
[INPUT]263 H     98.227700000000 109.627000000000 101.003000000000 AA  185.623450845940 207.165005857694 190.868007759445 Bohr   0.0
[INPUT]264 H     98.884800000000 110.658000000000  99.920200000000 AA  186.865189882391 209.113313492121 188.821812311766 Bohr   0.0
[INPUT]265 O     98.521800000000  99.296300000000 109.570000000000 AA  186.179219299174 187.642812182650 207.057291468594 Bohr   0.0
[INPUT]266 H     99.206400000000  98.567900000000 109.543000000000 AA  187.472925804051 186.266335673517 207.006268863231 Bohr   0.0
[INPUT]267 H     98.932100000000 100.151000000000 109.251000000000 AA  186.954573928083 189.257961101315 206.454468834858 Bohr   0.0
[INPUT]268 O     99.468000000000 105.283000000000  95.690500000000 AA  187.967278158238 198.956035572583 180.828837722693 Bohr   0.0
[INPUT]269 H    100.395000000000 104.911000000000  95.651600000000 AA  189.719054275709 198.253057454245 180.755327376447 Bohr   0.0
[INPUT]270 H     99.511900000000 106.279000000000  95.772300000000 AA  188.050237135106 200.838202792650 180.983417319682 Bohr   0.0
[INPUT]271 O    103.065000000000 106.418000000000  98.404100000000 AA  194.764623028298 201.100874723965 185.956798534313 Bohr   0.0
[INPUT]272 H    102.945000000000 107.087000000000  97.670300000000 AA  194.537855893350 202.365101501299 184.570117504107 Bohr   0.0
[INPUT]273 H    103.919000000000 106.605000000000  98.888900000000 AA  196.378449138677 201.454253509258 186.872937759502 Bohr   0.0
[INPUT]274 O    100.125000000000 101.870000000000  92.894300000000 AA  189.208828222077 192.506400309443 175.544785533184 Bohr   0.0
[INPUT]275 H     99.428600000000 101.298000000000  92.459700000000 AA  187.892822948930 191.425476966192 174.723510559448 Bohr   0.0
[INPUT]276 H     99.896600000000 101.996000000000  93.859700000000 AA  188.777214775226 192.744505801138 177.369127133839 Bohr   0.0
[INPUT]277 O     92.131300000000  97.642300000000 102.177000000000 AA  174.102924500141 184.517205172619 193.086546229684 Bohr   0.0
[INPUT]278 H     91.317000000000  97.791400000000 102.738000000000 AA  172.564120516908 184.798963337792 194.146682585565 Bohr   0.0
[INPUT]279 H     92.266500000000  96.661000000000 102.040000000000 AA  174.358415472182 182.662816926583 192.827653750619 Bohr   0.0
[INPUT]280 O    102.160000000000  94.349500000000  98.747200000000 AA  193.054420885567 178.294714989651 186.605163567651 Bohr   0.0
[INPUT]281 H    102.527000000000  93.534300000000  98.299300000000 AA  193.747950373282 176.754210252906 185.758755236458 Bohr   0.0
[INPUT]282 H    102.436000000000  94.354600000000  99.708300000000 AA  193.575985295947 178.304352592887 188.421379345971 Bohr   0.0
[INPUT]283 O    101.909000000000  92.717000000000 101.661000000000 AA  192.580099628301 175.209737091299 192.111447549409 Bohr   0.0
[INPUT]284 H    102.638000000000  93.177700000000 102.168000000000 AA  193.957709973109 176.080333916886 193.069538694563 Bohr   0.0
[INPUT]285 H    102.284000000000  91.918600000000 101.190000000000 AA  193.288746925013 173.700979753446 191.221386544739 Bohr   0.0
[INPUT]286 O     93.189700000000  99.957300000000  93.042600000000 AA  176.103010630381 188.891921150987 175.825031917457 Bohr   0.0
[INPUT]287 H     92.585400000000  99.291400000000  93.479900000000 AA  174.961049133306 187.633552524639 176.651409151730 Bohr   0.0
[INPUT]288 H     93.929500000000  99.477100000000  92.571400000000 AA  177.501030017334 187.984474665971 174.934592967562 Bohr   0.0
[INPUT]289 O     97.613900000000 109.323000000000 102.431000000000 AA  184.463536950681 206.590529115826 193.566536665324 Bohr   0.0
[INPUT]290 H     98.079300000000 108.566000000000 102.889000000000 AA  185.343015489054 205.160006439531 194.432031230375 Bohr   0.0
[INPUT]291 H     97.464100000000 110.066000000000 103.084000000000 AA  184.180455977222 207.994595626378 194.800527824665 Bohr   0.0
[INPUT]292 O    101.195000000000 106.928000000000 105.456000000000 AA  191.230835175361 202.064635047493 199.282958192133 Bohr   0.0
[INPUT]293 H    101.206000000000 106.434000000000 106.325000000000 AA  191.251622162732 201.131110341958 200.925130194380 Bohr   0.0
[INPUT]294 H    100.871000000000 107.862000000000 105.607000000000 AA  190.618563911002 203.829639247837 199.568306836942 Bohr   0.0
[INPUT]295 O     97.894300000000  93.636500000000  97.704600000000 AA  184.993416156010 176.947340262836 184.634935110180 Bohr   0.0
[INPUT]296 H     96.921800000000  93.462300000000  97.549500000000 AA  183.155657499870 176.618149971937 184.341838588259 Bohr   0.0
[INPUT]297 H     98.231600000000  94.279000000000  97.016600000000 AA  185.630820777825 178.161489297869 183.334803536479 Bohr   0.0
[INPUT]298 O     98.771600000000 100.739000000000 106.197000000000 AA  186.651272885090 190.369120062560 200.683245250436 Bohr   0.0
[INPUT]299 H     99.398100000000 101.178000000000 106.840000000000 AA  187.835186302130 191.198709831244 201.898339148531 Bohr   0.0
[INPUT]300 H     99.297200000000 100.231000000000 105.514000000000 AA  187.644512936162 189.409139191281 199.392562307358 Bohr   0.0
[INPUT]301 O     96.613800000000 101.997000000000  91.481900000000 AA  182.573621853504 192.746395527263 172.875736354849 Bohr   0.0
[INPUT]302 H     96.731600000000 102.040000000000  90.489800000000 AA  182.796231590978 192.827653750619 171.000939066668 Bohr   0.0
[INPUT]303 H     96.070000000000 102.779000000000  91.787000000000 AA  181.545988786965 194.224161356672 173.452291795453 Bohr   0.0
[INPUT]304 O     94.443800000000  94.651000000000  99.373500000000 AA  178.472916163198 178.864467416208 187.788699039466 Bohr   0.0
[INPUT]305 H     95.293900000000  94.301900000000  99.767700000000 AA  180.079372341691 178.204764026122 188.533629077770 Bohr   0.0
[INPUT]306 H     94.463600000000  95.650800000000  99.370600000000 AA  178.510332740464 180.753815595548 187.783218833705 Bohr   0.0
[INPUT]307 O    102.486000000000 102.214000000000 109.341000000000 AA  193.670471602175 193.156466096293 206.624544186068 Bohr   0.0
[INPUT]308 H    103.154000000000 101.634000000000 109.808000000000 AA  194.932808653384 192.060424944046 207.507046286240 Bohr   0.0
[INPUT]309 H    102.963000000000 102.838000000000 108.721000000000 AA  194.571870963592 194.335655198022 205.452913988838 Bohr   0.0
[INPUT]310 O    103.454000000000  97.589900000000  96.421800000000 AA  195.499726490754 184.418183523692 182.210794437587 Bohr   0.0
[INPUT]311 H    103.885000000000  98.135100000000  95.702500000000 AA  196.314198450441 185.448462206805 180.851514436188 Bohr   0.0
[INPUT]312 H    104.142000000000  97.009800000000  96.857500000000 AA  196.799858064455 183.321953398832 183.034148110060 Bohr   0.0
[INPUT]313 O     97.663000000000 103.755000000000  93.716600000000 AA  184.556322503398 196.068534054248 177.098707325414 Bohr   0.0
[INPUT]314 H     97.878200000000 104.678000000000  94.035900000000 AA  184.962991565404 197.812751267222 177.702096876988 Bohr   0.0
[INPUT]315 H     98.124000000000 103.587000000000  92.845200000000 AA  185.427486246822 195.751060065321 175.451999980468 Bohr   0.0
[INPUT]316 O     94.716800000000  95.339500000000 106.730000000000 AA  178.988811395204 180.165543852971 201.690469274829 Bohr   0.0
[INPUT]317 H     94.731500000000  95.780000000000 107.628000000000 AA  179.016590369235 180.997968210842 203.387443334688 Bohr   0.0
[INPUT]318 H     94.004900000000  95.757200000000 106.165000000000 AA  177.643515367126 180.954882455202 200.622774014450 Bohr   0.0
[INPUT]319 O    100.740000000000 109.200000000000 101.978000000000 AA  190.371009788684 206.358092802505 192.710490730896 Bohr   0.0
[INPUT]320 H    100.530000000000 109.974000000000 102.574000000000 AA  189.974167302526 207.820740822918 193.836767501137 Bohr   0.0
[INPUT]321 H    100.204000000000 109.272000000000 101.137000000000 AA  189.358116585917 206.494153083473 191.121231060137 Bohr   0.0
[INPUT]322 O    108.674000000000 100.948000000000 102.346000000000 AA  205.364096860984 190.764072822594 193.405909944736 Bohr   0.0
[INPUT]323 H    108.614000000000 100.958000000000 101.348000000000 AA  205.250713293510 190.782970083840 191.519963272420 Bohr   0.0
[INPUT]324 H    108.378000000000 101.833000000000 102.706000000000 AA  204.804737928112 192.436480442834 194.086211349579 Bohr   0.0
[INPUT]325 O    104.383000000000 100.426000000000  91.793300000000 AA  197.255282060475 189.777635785571 173.464197070038 Bohr   0.0
[INPUT]326 H    103.614000000000 101.043000000000  91.624700000000 AA  195.802082670684 190.943596804428 173.145589245436 Bohr   0.0
[INPUT]327 H    105.239000000000 100.940000000000  91.747600000000 AA  198.872887623103 190.748955013597 173.377836586145 Bohr   0.0
[INPUT]328 O     93.470000000000  98.898100000000 105.386000000000 AA  176.632700863096 186.890323239848 199.150677363414 Bohr   0.0
[INPUT]329 H     93.191400000000  99.414300000000 104.576000000000 AA  176.106223164793 187.865799865348 197.619999202516 Bohr   0.0
[INPUT]330 H     94.083300000000  99.457800000000 105.943000000000 AA  177.791669895292 187.948002951767 200.203254814796 Bohr   0.0
[INPUT]331 O     92.500500000000 101.454000000000  96.905900000000 AA  174.800611385331 191.720274241624 183.125610854489 Bohr   0.0
[INPUT]332 H     92.032300000000 101.750000000000  97.738200000000 AA  173.915841613809 192.279633174495 184.698429907965 Bohr   0.0
[INPUT]333 H     92.354500000000 100.473000000000  96.773000000000 AA  174.524711371144 189.866452913425 182.874466252535 Bohr   0.0
[INPUT]334 O     95.630300000000  99.996600000000  98.245400000000 AA  180.715076209994 188.966187387683 185.656898998344 Bohr   0.0
[INPUT]335 H     96.540400000000 100.410000000000  98.268900000000 AA  182.434915955961 189.747400167578 185.701307562272 Bohr   0.0
[INPUT]336 H     94.982900000000 100.638000000000  97.834500000000 AA  179.491667516951 190.178257723979 184.880410533761 Bohr   0.0
[INPUT]337 O     91.348100000000  98.770100000000  96.465200000000 AA  172.622890999382 186.648438295904 182.292808551394 Bohr   0.0
[INPUT]338 H     91.788200000000  98.003500000000  96.932700000000 AA  173.454559466803 185.199774248812 183.176255514628 Bohr   0.0
[INPUT]339 H     90.438200000000  98.918700000000  96.852400000000 AA  170.903429198640 186.929251598014 183.024510506825 Bohr   0.0
[INPUT]340 O    103.773000000000  93.788800000000 103.794000000000 AA  196.102549124490 177.235145551608 196.142233373106 Bohr   0.0
[INPUT]341 H    103.865000000000  93.694200000000 104.785000000000 AA  196.276403927950 177.056377460224 198.014951962550 Bohr   0.0
[INPUT]342 H    104.676000000000  93.734600000000 103.368000000000 AA  197.808971814972 177.132722395656 195.337210044041 Bohr   0.0
[INPUT]343 O    105.714000000000 105.895000000000  99.861500000000 AA  199.770507532271 200.112547960817 188.710885388254 Bohr   0.0
[INPUT]344 H    105.704000000000 106.458000000000 100.688000000000 AA  199.751610271025 201.176463768947 190.272744030207 Bohr   0.0
[INPUT]345 H    106.647000000000 105.580000000000  99.685100000000 AA  201.533622006490 199.517284231579 188.377537699881 Bohr   0.0
[INPUT]346 O     99.505700000000  94.600000000000  99.762000000000 AA  188.038520833134 178.768091383855 188.522857638860 Bohr   0.0
[INPUT]347 H     98.915000000000  94.230400000000  99.044800000000 AA  186.922259611353 178.069648608216 187.167546062322 Bohr   0.0
[INPUT]348 H    100.455000000000  94.596700000000  99.446700000000 AA  189.832437843183 178.761855287644 187.927026991784 Bohr   0.0
[INPUT]349 O     93.723900000000 101.482000000000 100.592000000000 AA  177.112502326123 191.773186573112 190.091330322249 Bohr   0.0
[INPUT]350 H     93.285300000000 102.174000000000 100.019000000000 AA  176.283668447889 193.080877051311 189.008517252873 Bohr   0.0
[INPUT]351 H     93.374700000000 100.577000000000 100.347000000000 AA  176.452609963425 190.062984430380 189.628347421730 Bohr   0.0
[INPUT]352 O     92.515400000000 104.356000000000 102.399000000000 AA  174.828768304587 197.204259455112 193.506065429338 Bohr   0.0
[INPUT]353 H     92.834800000000 104.698000000000 103.283000000000 AA  175.432346828773 197.850545789713 195.176583323453 Bohr   0.0
[INPUT]354 H     93.169800000000 104.611000000000 101.687000000000 AA  176.065405080502 197.686139616876 192.160580428647 Bohr   0.0
[INPUT]355 O    102.360000000000 101.551000000000  99.964500000000 AA  193.432366110480 191.903577675707 188.905527179084 Bohr   0.0
[INPUT]356 H    102.675000000000 102.370000000000 100.444000000000 AA  194.027629839718 193.451263371725 189.811650855813 Bohr   0.0
[INPUT]357 H    101.556000000000 101.180000000000 100.430000000000 AA  191.913026306329 191.202489283493 189.785194690069 Bohr   0.0
[INPUT]358 O     99.128800000000  95.980100000000  96.602100000000 AA  187.326283056785 181.376102408367 182.551512057847 Bohr   0.0
[INPUT]359 H     99.037300000000  96.941600000000  96.861200000000 AA  187.153373116387 183.193074077136 183.041140096721 Bohr   0.0
[INPUT]360 H    100.097000000000  95.729200000000  96.588100000000 AA  189.155915890589 180.901970123714 182.525055892103 Bohr   0.0
[INPUT]361 O     95.836300000000  91.031200000000 100.005000000000 AA  181.104359791655 172.024036790507 188.982061087129 Bohr   0.0
[INPUT]362 H     95.675500000000  91.876800000000  99.496200000000 AA  180.800491830825 173.621989201439 188.020568434950 Bohr   0.0
[INPUT]363 H     95.236400000000  91.004200000000 100.805000000000 AA  179.970713089528 171.973014185144 190.493841986781 Bohr   0.0
[INPUT]364 O    100.395000000000  90.892200000000  97.253800000000 AA  189.719054275709 171.761364859193 183.783046573226 Bohr   0.0
[INPUT]365 H     99.729500000000  90.724800000000  97.981200000000 AA  188.461441539811 171.445024705940 185.157633356234 Bohr   0.0
[INPUT]366 H    101.269000000000  91.162100000000  97.657400000000 AA  191.370674908579 172.271401940213 184.545740037100 Bohr   0.0
[INPUT]367 O    103.544000000000  99.038500000000 104.412000000000 AA  195.669801841965 187.155640787737 197.310084118087 Bohr   0.0
[INPUT]368 H    104.182000000000  99.184200000000 103.655000000000 AA  196.875447109437 187.430973884086 195.879561441791 Bohr   0.0
[INPUT]369 H    102.605000000000  99.102500000000 104.073000000000 AA  193.895349010998 187.276583259709 196.669466961860 Bohr   0.0
[INPUT]370 O     99.482600000000  98.237100000000  94.256600000000 AA  187.994868159656 185.641214271510 178.119159432679 Bohr   0.0
[INPUT]371 H     98.968300000000  98.764500000000  93.580400000000 AA  187.022982013792 186.637855829606 176.841326627248 Bohr   0.0
[INPUT]372 H    100.018000000000  98.859300000000  94.827300000000 AA  189.006627526748 186.817001866215 179.197626131968 Bohr   0.0
[INPUT]373 O     97.111700000000 105.889000000000 101.284000000000 AA  183.514516490925 200.101209604070 191.399020800448 Bohr   0.0
[INPUT]374 H     97.802500000000 106.403000000000 101.792000000000 AA  184.819939297774 201.072528832096 192.359001671727 Bohr   0.0
[INPUT]375 H     97.487600000000 105.002000000000 101.014000000000 AA  184.224864541149 198.425022531581 190.888794746815 Bohr   0.0
[INPUT]376 O    103.133000000000 101.981000000000 104.535000000000 AA  194.893124404769 192.716159909270 197.542520431409 Bohr   0.0
[INPUT]377 H    103.581000000000 102.216000000000 103.673000000000 AA  195.739721708574 193.160245548542 195.913576512034 Bohr   0.0
[INPUT]378 H    102.678000000000 101.095000000000 104.444000000000 AA  194.033299018091 191.041862562905 197.370555354073 Bohr   0.0
[INPUT]379 O    101.858000000000  95.959800000000 104.565000000000 AA  192.483723595948 181.337740968038 197.599212215146 Bohr   0.0
[INPUT]380 H    102.487000000000  95.187200000000 104.478000000000 AA  193.672361328299 179.877738564199 197.434806042309 Bohr   0.0
[INPUT]381 H    100.951000000000  95.624200000000 104.818000000000 AA  190.769742000968 180.703548880634 198.077312924661 Bohr   0.0
[INPUT]382 O    102.969000000000 107.814000000000  95.734000000000 AA  194.583209320340 203.738932393858 180.911040809112 Bohr   0.0
[INPUT]383 H    102.874000000000 108.030000000000  94.762400000000 AA  194.403685338506 204.147113236764 179.074982906484 Bohr   0.0
[INPUT]384 H    103.931000000000 107.884000000000  95.998000000000 AA  196.401125852171 203.871213222577 181.409928505997 Bohr   0.0
[INPUT]385 O    106.341000000000  99.341900000000  99.395500000000 AA  200.955365812373 187.728983693930 187.830273014207 Bohr   0.0
[INPUT]386 H    105.471000000000  98.930500000000  99.666400000000 AA  199.311304084002 186.951550366284 188.342199821351 Bohr   0.0
[INPUT]387 H    107.040000000000  99.120000000000 100.075000000000 AA  202.276284373444 187.309653466889 189.114341915849 Bohr   0.0
[INPUT]388 O    101.744000000000  97.726000000000 106.886000000000 AA  192.268294817748 184.675375249245 201.985266550261 Bohr   0.0
[INPUT]389 H    102.077000000000  97.166200000000 106.128000000000 AA  192.897573617228 183.617506564714 200.552854147841 Bohr   0.0
[INPUT]390 H    102.140000000000  98.642000000000 106.824000000000 AA  193.016626363075 186.406364379347 201.868103530538 Bohr   0.0
[INPUT]391 O     95.154200000000  95.840000000000  96.171700000000 AA  179.815377602089 181.111351778316 181.738173933834 Bohr   0.0
[INPUT]392 H     95.973800000000  95.821000000000  95.599100000000 AA  181.364197133782 181.075446981949 180.656116754908 Bohr   0.0
[INPUT]393 H     95.413800000000  96.026700000000  97.119200000000 AA  180.305950504026 181.464163645772 183.528689436859 Bohr   0.0
[INPUT]394 O    101.836000000000  97.446700000000 102.110000000000 AA  192.442149621208 184.147574742654 192.959934579338 Bohr   0.0
[INPUT]395 H    100.860000000000  97.397400000000 101.898000000000 AA  190.597776923632 184.054411244713 192.559312640931 Bohr   0.0
[INPUT]396 H    101.991000000000  97.133400000000 103.047000000000 AA  192.735057170515 183.555523547828 194.730607958056 Bohr   0.0
[INPUT]397 O    101.665000000000  98.316100000000  98.319400000000 AA  192.119006453907 185.790502635351 185.796738731562 Bohr   0.0
[INPUT]398 H    101.904000000000  99.233800000000  98.002000000000 AA  192.570650997678 187.524704299864 185.196939659625 Bohr   0.0
[INPUT]399 H    102.224000000000  97.640900000000  97.837700000000 AA  193.175363357539 184.514559556045 184.886457657359 Bohr   0.0
[INPUT]400 O     99.984700000000 103.272000000000 102.307000000000 AA  188.943699646800 195.155796336083 193.332210625878 Bohr   0.0
[INPUT]401 H     99.640700000000 103.104000000000 103.231000000000 AA  188.293633859950 194.838322347156 195.078317564976 Bohr   0.0
[INPUT]402 H     99.216500000000 103.453000000000 101.693000000000 AA  187.492012037909 195.497836764629 192.171918785395 Bohr   0.0
[INPUT]403 O     92.533800000000 103.109000000000 105.488000000000 AA  174.863539265279 194.847770977779 199.343429428119 Bohr   0.0
[INPUT]404 H     92.597100000000 102.910000000000 106.466000000000 AA  174.983158928963 194.471715478991 201.191581577944 Bohr   0.0
[INPUT]405 H     93.148200000000 103.865000000000 105.261000000000 AA  176.024586996211 196.276403927950 198.914461597843 Bohr   0.0
[INPUT]406 O     94.116000000000 101.973000000000  94.712100000000 AA  177.853463939565 192.701042100273 178.979929682419 Bohr   0.0
[INPUT]407 H     93.626400000000 101.369000000000  94.082700000000 AA  176.928254028978 191.559647521036 177.790536059617 Bohr   0.0
[INPUT]408 H     93.593800000000 102.064000000000  95.560000000000 AA  176.866648957317 192.873007177608 180.582228463437 Bohr   0.0
[INPUT]409 O     96.662300000000 107.245000000000 105.890000000000 AA  182.665273570545 202.663678228980 200.103099330194 Bohr   0.0
[INPUT]410 H     96.449100000000 106.611000000000 105.147000000000 AA  182.262383960788 201.465591866006 198.699032819643 Bohr   0.0
[INPUT]411 H     96.367500000000 106.851000000000 106.761000000000 AA  182.108182309024 201.919126135901 201.749050784691 Bohr   0.0
[INPUT]412 O    102.243000000000 102.219000000000  91.223000000000 AA  193.211268153906 193.165914726916 172.386486261199 Bohr   0.0
[INPUT]413 H    102.226000000000 102.797000000000  90.406800000000 AA  193.179142809788 194.258176426915 170.844091798329 Bohr   0.0
[INPUT]414 H    101.309000000000 102.079000000000  91.551900000000 AA  191.446263953562 192.901353069477 173.008017183568 Bohr   0.0
[INPUT]415 O     98.710500000000  97.265300000000 106.544000000000 AA  186.535810618880 183.804778423658 201.338980215660 Bohr   0.0
[INPUT]416 H     99.310200000000  97.423100000000 107.329000000000 AA  187.669079375781 184.102977206114 202.822415223443 Bohr   0.0
[INPUT]417 H     98.159900000000  96.446100000000 106.705000000000 AA  185.495327414694 182.256714782414 201.643226121715 Bohr   0.0

nuclear repulsion = 59868.4795223821
number of shells = 1668
number of NR pGTOs = 5421
number of NR cGTOs = 3475
basis = def2-SVP
ecp = {}
CPU time:     37869.76


PySCF Results


Initial guess from minao.


******** <class 'pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = False
chkfile to save SCF result = /tmp/tmpxnr8qhpl
max_memory 1500000 MB (current use 28870 MB)
XC library pyscf.dft.libxc version 6.1.0
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1–5 (2018)
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14fef7d784c0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14fef7dcce50>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 4684024
init E= -10597.5263436163
  HOMO = -0.426514309533814  LUMO = -0.146912073765314
cycle= 1 E= -10593.6587014541  delta_E= 3.87  |g|= 7.88  |ddm|= 16.3
  HOMO = 0.0267735605965267  LUMO = 0.0282740989595156
cycle= 2 E= -10549.0718641578  delta_E= 44.6  |g|= 14.6  |ddm|= 21.1

WARN: HOMO -0.108848161139971 == LUMO -0.108005989341318

cycle= 3 E= -10556.1887601032  delta_E= -7.12  |g|= 8.14  |ddm|= 22.1
  HOMO = -0.140177221757892  LUMO = -0.0836502772565038
cycle= 4 E= -10603.5512064972  delta_E= -47.4  |g|= 2.61  |ddm|= 13.9
  HOMO = -0.161812705483547  LUMO = -0.069610458196917
cycle= 5 E= -10604.7359128338  delta_E= -1.18  |g|= 0.859  |ddm|= 1.82
  HOMO = -0.0932050910278746  LUMO = -0.0726736150878557
cycle= 6 E= -10604.8687639831  delta_E= -0.133  |g|= 0.422  |ddm|= 0.762
  HOMO = -0.162894037270732  LUMO = -0.0548841486274434
cycle= 7 E= -10604.8995987862  delta_E= -0.0308  |g|= 0.333  |ddm|= 0.527
  HOMO = -0.143193448996107  LUMO = -0.0633181436104137
cycle= 8 E= -10604.9191492697  delta_E= -0.0196  |g|= 0.152  |ddm|= 0.318
  HOMO = -0.124548290397706  LUMO = -0.0720015805968253
cycle= 9 E= -10604.9234177471  delta_E= -0.00427  |g|= 0.0421  |ddm|= 0.149
  HOMO = -0.121875797860641  LUMO = -0.0735763019346252
cycle= 10 E= -10604.9236730399  delta_E= -0.000255  |g|= 0.0225  |ddm|= 0.046
  HOMO = -0.121736597180797  LUMO = -0.0735495009262499
cycle= 11 E= -10604.9237603422  delta_E= -8.73e-05  |g|= 0.00465  |ddm|= 0.0183
  HOMO = -0.12165480838641  LUMO = -0.0734770070653391
cycle= 12 E= -10604.9237638991  delta_E= -3.56e-06  |g|= 0.00167  |ddm|= 0.00425
  HOMO = -0.121684388589324  LUMO = -0.0734599349229298
cycle= 13 E= -10604.9237642009  delta_E= -3.02e-07  |g|= 0.00103  |ddm|= 0.00168
  HOMO = -0.121694829211129  LUMO = -0.0734777316237463
cycle= 14 E= -10604.9237643924  delta_E= -1.91e-07  |g|= 0.000155  |ddm|= 0.000794
  HOMO = -0.121695818676506  LUMO = -0.0734794934098141
cycle= 15 E= -10604.9237643951  delta_E= -2.69e-09  |g|= 0.000102  |ddm|= 0.00017
  HOMO = -0.121694413141981  LUMO = -0.0734768229525779
Extra cycle  E= -10604.9237643907  delta_E= 4.37e-09  |g|= 0.000192  |ddm|= 0.000208
converged SCF energy = -10604.9237643907
Nuc-Nuc PySCF=  59868.479522382106
One electron integrals energy -134300.9674214239
Coulomb energy  65109.114749616754
EXC  -1281.5506149656526
PySCF time:  805.2565670480253
PySCF Grid Size:  (3872440,)


 PySCF Dipole moment
Dipole moment(X, Y, Z, A.U.):  4.30336, 10.79843, -4.40496

============================================================
PyFock Python Program for Quantum Chemistry Simulations
                                        by Manas Sharma
============================================================
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m[38;5;45m█[0m  [38;5;51m█[0m[38;5;51m█[0m    [38;5;87m█[0m[38;5;87m█[0m [38;5;123m█[0m[38;5;123m█[0m[38;5;123m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m[38;5;159m█[0m  [38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m   [38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m   [38;5;213m█[0m[38;5;213m█[0m
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m█[0m[38;5;45m█[0m [38;5;45m░[0m[38;5;45m█[0m[38;5;51m█[0m  [38;5;51m█[0m[38;5;51m█[0m[38;5;87m░[0m [38;5;87m█[0m[38;5;87m█[0m[38;5;87m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m[38;5;123m░[0m [38;5;159m█[0m[38;5;159m█[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;159m░[0m[38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;219m░[0m [38;5;219m█[0m[38;5;219m█[0m  [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m 
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;39m█[0m[38;5;45m█[0m   [38;5;45m░[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m█[0m[38;5;51m░[0m  [38;5;87m█[0m[38;5;87m█[0m[38;5;87m█[0m[38;5;123m█[0m[38;5;123m█[0m   [38;5;159m█[0m[38;5;159m█[0m    [38;5;195m█[0m[38;5;195m█[0m [38;5;195m█[0m[38;5;225m█[0m      [38;5;219m█[0m[38;5;219m█[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m  
[38;5;39m█[0m[38;5;39m█[0m[38;5;39m░[0m[38;5;39m░[0m[38;5;45m░[0m[38;5;45m░[0m    [38;5;51m░[0m[38;5;51m█[0m[38;5;87m█[0m[38;5;87m░[0m   [38;5;123m█[0m[38;5;123m█[0m[38;5;123m░[0m[38;5;159m░[0m[38;5;159m░[0m   [38;5;195m█[0m[38;5;195m█[0m    [38;5;225m█[0m[38;5;219m█[0m [38;5;219m█[0m[38;5;219m█[0m      [38;5;213m█[0m[38;5;213m█[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m 
[38;5;39m█[0m[38;5;39m█[0m         [38;5;51m█[0m[38;5;87m█[0m    [38;5;123m█[0m[38;5;123m█[0m      [38;5;195m░[0m[38;5;195m█[0m[38;5;195m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;225m█[0m[38;5;219m░[0m [38;5;219m░[0m[38;5;219m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m[38;5;213m█[0m [38;5;213m█[0m[38;5;213m█[0m  [38;5;213m░[0m[38;5;213m█[0m[38;5;213m█[0m
[38;5;39m░[0m[38;5;39m░[0m         [38;5;51m░[0m[38;5;87m░[0m    [38;5;123m░[0m[38;5;123m░[0m       [38;5;195m░[0m[38;5;195m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m[38;5;225m░[0m   [38;5;219m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m[38;5;213m░[0m [38;5;213m░[0m[38;5;213m░[0m   [38;5;213m░[0m[38;5;213m░[0m

============================================================


Number of atoms: 417


Number of basis functions (atomic orbitals): 3475


Number of auxiliary basis functions: 11815


================================================================================


Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 9334 32-Core Processor
Number of Cores: 64
Number of Threads: 128
Memory (GB): 2267.59
Running DFT using 48 threads for Numba.



Calculating one electron integrals...


Core H size in GB  0.096605
done!
Time taken 2.709463899023831 seconds.

Stricter version of Schwarz screening:  False

Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 2.2934859779197723 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.315787784056738
Time taken to evaluate the square roots needed:  0.036512901075184345
Time for significant indices evaluation:  0.16996432305313647
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.144949208
No. of elements in the standard three-centered two electron ERI tensor:  142673509375
No. of elements in the triangular three-centered two electron ERI tensor:  71357283250
No. of significant triplets based on Schwarz inequality and triangularity: 7038841572 or 4.9% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.5250633590621874 seconds.

Two Center Two electron ERI size in GB  1.1167538
Three Center Two electron ERI size in GB  56.310732576
Three-centered two electron evaluation done!
Time taken for Cholesky factorization of two-centered two-electron integrals 22.259675878100097 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  228.42706938507035 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  3872440
Size (in GB) for storing the coordinates of grid:       0.09293856
Size (in GB) for storing the weights of grid:           0.03097952
Size (in GB) for storing the density at gridpoints:     0.03097952

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  5000
No. of batches:  775

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 28.516792081994936 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    773
Average no. of basis functions contributing to a batch of grid points:    437

You have asked to save the values of significant basis functions and their gradients on grid points so as to avoid recalculation for each SCF cycle.
Please note: This will require addtional memory that is approximately :50.6 GB
Calculating the value of significantly contributing basis functions (atomic orbitals)...
done!
Time taken 6.928410758962855 seconds.



------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Number of electrons:  1392.7309643677227



------Iteration 1--------


Energies

Electron-Nuclear Energy       -144903.7800117991574
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10537.3521323497771
Coulomb Energy                 65161.3404878500878
Exchange-Correlation Energy    -1267.1132728108635
--------------------------------------------------
Total Energy                  -10603.7211418673542
--------------------------------------------------



Energy difference :  10603.721141867354


HOMO-LUMO gap: 0.23135850067582953 au
HOMO-LUMO gap: 6.296 eV


Time taken for the previous iteration: 14.479231130098924


Number of electrons:  1390.000175511587



------Iteration 2--------


Energies

Electron-Nuclear Energy       -145248.5813488677668
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10705.9890838799729
Coulomb Energy                 65394.7041244558568
Exchange-Correlation Energy    -1315.8602718303678
--------------------------------------------------
Total Energy                  -10595.2688898195120
--------------------------------------------------



Energy difference :  8.452252047842194


HOMO-LUMO gap: 0.002771436564415362 au
HOMO-LUMO gap: 0.075 eV


Time taken for the previous iteration: 13.291098149958998


Number of electrons:  1390.0004744110117



------Iteration 3--------


Energies

Electron-Nuclear Energy       -143910.6365583015140
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10081.9656794663097
Coulomb Energy                 64617.4532886165325
Exchange-Correlation Energy    -1226.7672338837272
--------------------------------------------------
Total Energy                  -10569.5053015595986
--------------------------------------------------



Energy difference :  25.763588259913377


HOMO-LUMO gap: 0.0002111001153282943 au
HOMO-LUMO gap: 0.006 eV


Time taken for the previous iteration: 13.980147989001125


Number of electrons:  1389.999703844288



------Iteration 4--------


Energies

Electron-Nuclear Energy       -144739.6155794476799
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10450.7861507647140
Coulomb Energy                 65105.2783390866389
Exchange-Correlation Energy    -1278.3964665711321
--------------------------------------------------
Total Energy                  -10593.4680336246820
--------------------------------------------------



Energy difference :  23.9627320650834


HOMO-LUMO gap: 0.06154716508445368 au
HOMO-LUMO gap: 1.675 eV


Time taken for the previous iteration: 14.752863209927455


Number of electrons:  1390.0002538944827



------Iteration 5--------


Energies

Electron-Nuclear Energy       -144766.7775576052663
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10466.0680632077783
Coulomb Energy                 65109.3428500475857
Exchange-Correlation Energy    -1281.4766392494803
--------------------------------------------------
Total Energy                  -10604.3637610565784
--------------------------------------------------



Energy difference :  10.895727431896375


HOMO-LUMO gap: 0.11282091143241768 au
HOMO-LUMO gap: 3.070 eV


Time taken for the previous iteration: 15.083001808961853


Number of electrons:  1390.00024900268



------Iteration 6--------


Energies

Electron-Nuclear Energy       -144778.5427569936437
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10471.3163532509843
Coulomb Energy                 65116.0145035357127
Exchange-Correlation Energy    -1282.1575371637739
--------------------------------------------------
Total Energy                  -10604.8899148279306
--------------------------------------------------



Energy difference :  0.5261537713522557


HOMO-LUMO gap: 0.053875532957920136 au
HOMO-LUMO gap: 1.466 eV


Time taken for the previous iteration: 16.57447743800003


Number of electrons:  1390.0002414873939



------Iteration 7--------


Energies

Electron-Nuclear Energy       -144770.7316506769566
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10469.1626247893691
Coulomb Energy                 65109.9103726792528
Exchange-Correlation Energy    -1281.7371678969043
--------------------------------------------------
Total Energy                  -10604.9162985624425
--------------------------------------------------



Energy difference :  0.026383734511910006


HOMO-LUMO gap: 0.056055630059256956 au
HOMO-LUMO gap: 1.525 eV


Time taken for the previous iteration: 15.815616804058664


Number of electrons:  1390.000244544889



------Iteration 8--------


Energies

Electron-Nuclear Energy       -144770.0555922672502
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10468.4226276942300
Coulomb Energy                 65109.8656299749564
Exchange-Correlation Energy    -1281.6341535877355
--------------------------------------------------
Total Energy                  -10604.9219656430068
--------------------------------------------------



Energy difference :  0.00566708056430798


HOMO-LUMO gap: 0.05321950317011659 au
HOMO-LUMO gap: 1.448 eV


Time taken for the previous iteration: 16.400914301979356


Number of electrons:  1390.0002438325828



------Iteration 9--------


Energies

Electron-Nuclear Energy       -144769.3529888774501
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10468.0430916780115
Coulomb Energy                 65109.4891939943554
Exchange-Correlation Energy    -1281.5821953792638
--------------------------------------------------
Total Energy                  -10604.9233760415736
--------------------------------------------------



Energy difference :  0.0014103985668043606


HOMO-LUMO gap: 0.04915950327073304 au
HOMO-LUMO gap: 1.338 eV


Time taken for the previous iteration: 16.317341736052185


Number of electrons:  1390.0002432901356



------Iteration 10--------


Energies

Electron-Nuclear Energy       -144768.3135913959413
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10467.6021489737159
Coulomb Energy                 65108.8285050886770
Exchange-Correlation Energy    -1281.5202838424398
--------------------------------------------------
Total Energy                  -10604.9236986331962
--------------------------------------------------



Energy difference :  0.00032259162253467366


HOMO-LUMO gap: 0.047341182940170395 au
HOMO-LUMO gap: 1.288 eV


Time taken for the previous iteration: 15.82120079093147


Number of electrons:  1390.0002427658321



------Iteration 11--------


Energies

Electron-Nuclear Energy       -144769.7802402257221
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10468.3054813251838
Coulomb Energy                 65109.6873014646771
Exchange-Correlation Energy    -1281.6157301862008
--------------------------------------------------
Total Energy                  -10604.9236650792518
--------------------------------------------------



Energy difference :  3.3553944376762956e-05


HOMO-LUMO gap: 0.04855114281427894 au
HOMO-LUMO gap: 1.321 eV


Time taken for the previous iteration: 16.19712124101352


Number of electrons:  1390.0002432426222



------Iteration 12--------


Energies

Electron-Nuclear Energy       -144768.7482630913728
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10467.8072143341888
Coulomb Energy                 65109.0855915052962
Exchange-Correlation Energy    -1281.5478290580656
--------------------------------------------------
Total Energy                  -10604.9237637671613
--------------------------------------------------



Energy difference :  9.868790948530659e-05


HOMO-LUMO gap: 0.04814156421754312 au
HOMO-LUMO gap: 1.310 eV


Time taken for the previous iteration: 16.19866324099712


Number of electrons:  1390.0002431782987



------Iteration 13--------


Energies

Electron-Nuclear Energy       -144768.6874984184687
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10467.7765481344286
Coulomb Energy                 65109.0511070034991
Exchange-Correlation Energy    -1281.5434454647952
--------------------------------------------------
Total Energy                  -10604.9237662025553
--------------------------------------------------



Energy difference :  2.435393980704248e-06


HOMO-LUMO gap: 0.048176620034283246 au
HOMO-LUMO gap: 1.311 eV


Time taken for the previous iteration: 16.40290059999097


Number of electrons:  1390.0002431685189



------Iteration 14--------


Energies

Electron-Nuclear Energy       -144768.7974689381372
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10467.8273581117137
Coulomb Energy                 65109.1172282418702
Exchange-Correlation Energy    -1281.5504070129168
--------------------------------------------------
Total Energy                  -10604.9237670546863
--------------------------------------------------



Energy difference :  8.521310519427061e-07


HOMO-LUMO gap: 0.048212234246865826 au
HOMO-LUMO gap: 1.312 eV


Time taken for the previous iteration: 16.030825524940155


Number of electrons:  1390.0002431693183



------Iteration 15--------


Energies

Electron-Nuclear Energy       -144768.7944217241311
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10467.8280145134322
Coulomb Energy                 65109.1136277951664
Exchange-Correlation Energy    -1281.5505102988650
--------------------------------------------------
Total Energy                  -10604.9237671716182
--------------------------------------------------



Energy difference :  1.1693191481754184e-07


HOMO-LUMO gap: 0.04822286500713169 au
HOMO-LUMO gap: 1.312 eV


Time taken for the previous iteration: 16.035814379923977


Number of electrons:  1390.0002431685155



------Iteration 16--------


Energies

Electron-Nuclear Energy       -144768.7898834366642
Nuclear repulsion Energy       59868.4795225427952
Kinetic Energy                 10467.8257963735850
Coulomb Energy                 65109.1110130750676
Exchange-Correlation Energy    -1281.5502157259148
--------------------------------------------------
Total Energy                  -10604.9237671711089
--------------------------------------------------



Energy difference :  5.093170329928398e-10

SCF Converged after 16 iterations!

-------------------------------------
Total Energy =  -10604.923767171109
-------------------------------------



Time taken : 518.3294631800381 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           35.44520284095779
Density Fitting                         64.44271652481984
    DF (gamma)                          18.51918057689909
    DF (coeff)                          2.802982549648732
    DF (Jtri)                           19.66982513119001
    DF (Cholesky)                       22.259675878100097
DIIS                                    42.29992010467686
KS matrix diagonalization               58.987625591806136
One electron Integrals (S, T, Vnuc)     2.709463899023831
Coulomb Integrals (2c2e + 3c2e)         206.16739350697026
Grids construction                      0
Exchange-Correlation Term               105.0929699720582
Misc.                                   3.184170739725232
Complete SCF                            518.3294631800381
/home/lu29vow/.local/lib/python3.8/site-packages/cupy/_environment.py:447: UserWarning: 
--------------------------------------------------------------------------------

  CuPy may not function correctly because multiple CuPy packages are installed
  in your environment:

    cupy, cupy-cuda11x

  Follow these steps to resolve this issue:

    1. For all packages listed above, run the following command to remove all
       existing CuPy installations:

         $ pip uninstall <package_name>

      If you previously installed CuPy via conda, also run the following:

         $ conda uninstall cupy

    2. Install the appropriate CuPy package.
       Refer to the Installation Guide for detailed instructions.

         https://docs.cupy.dev/en/stable/install.html

--------------------------------------------------------------------------------

  warnings.warn(f'''
Energy diff (PySCF-CrysX) 2.7804053388535976e-06


PyFock Dipole moment
Dipole moment(X, Y, Z, A.U.): 4.303250822704285 10.798315275169443 -4.4050604910589755
Max Diff dipole moment (PySCF-CrysX) 0.00011631503002718091



 Package versions
pyscf version 2.7.0
np version 1.22.4
joblib version 1.4.2
numba version 0.58.1
threadpoolctl version 3.5.0
opt_einsum version 3.4.0
llvmlite version 0.41.1
numexpr version 2.8.6
scipy version 1.7.1
