Operating System: Linux 3.10.0-957.1.3.el7.x86_64
System Type: 64bit
CPU Model: Intel(R) Xeon(R) CPU E5-2650 v4 @ 2.20GHz
Number of Cores: 24
Number of Threads: 48
Memory (GB): 125.80519104003906
Number of cores being actually used/requested for the benchmark: 24
Confirming that the environment variables are properly set...
OMP_NUM_THREADS = 24
OPENBLAS_NUM_THREADS = 24
MKL_NUM_THREADS = 24
VECLIB_MAXIMUM_THREADS = 24
NUMEXPR_NUM_THREADS = 24
PYSCF_MAX_MEMORY = 125000
#INFO: **** input file is /home/lu29vow/GPU_Test/benchmark/PyFock/benchmarks_tests/benchmark_DFT_LDA_DF.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
# import numba
# numba.config.THREADING_LAYER='omp'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 24
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(125000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
funcx = 1
funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
# funcx = 101
# funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)

# basis_set_name = 'sto-2g'
# basis_set_name = 'sto-3g'
# basis_set_name = 'sto-6g'
# basis_set_name = '6-31G'
basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-SVPD'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'def2-QZVP'
# basis_set_name = 'def2-TZVPP'
# basis_set_name = 'def2-QZVPP'
# basis_set_name = 'def2-TZVPD'
# basis_set_name = 'def2-QZVPD'
# basis_set_name = 'def2-TZVPPD'
# basis_set_name = 'def2-QZVPPD'
# basis_set_name = 'cc-pVDZ'
# basis_set_name = 'ano-rcc'

auxbasis_name = 'def2-universal-jfit'
# auxbasis_name = 'def2-TZVP'
# auxbasis_name = 'sto-3g'
# auxbasis_name = 'def2-SVP'
# auxbasis_name = '6-31G'

# xyzFilename = 'Benzene-Fulvene_Dimer.xyz'
# xyzFilename = 'Adenine-Thymine.xyz'
# xyzFilename = 'Zn.xyz'
# xyzFilename = 'Zn_dimer.xyz'
# xyzFilename = 'TPP.xyz'
# xyzFilename = 'Zn_TPP.xyz'
# xyzFilename = 'H2O.xyz'

# xyzFilename = 'Caffeine.xyz'
# xyzFilename = 'Serotonin.xyz'
# xyzFilename = 'Cholesterol.xyz'
# xyzFilename = 'C60.xyz'
# xyzFilename = 'Taxol.xyz'
# xyzFilename = 'Valinomycin.xyz'
# xyzFilename = 'Olestra.xyz'
# xyzFilename = 'Ubiquitin.xyz'

### 1D Carbon Alkanes
# xyzFilename = 'Ethane.xyz'
# xyzFilename = 'Decane_C10H22.xyz'
# xyzFilename = 'Icosane_C20H42.xyz'
# xyzFilename = 'Tetracontane_C40H82.xyz'
xyzFilename = 'Pentacontane_C50H102.xyz'
# xyzFilename = 'Octacontane_C80H162.xyz'
# xyzFilename = 'Hectane_C100H202.xyz'
# xyzFilename = 'Icosahectane_C120H242.xyz'

### 2D Carbon
# xyzFilename = 'Graphene_C16.xyz'
# xyzFilename = 'Graphene_C76.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'

### 3d Carbon Fullerenes
# xyzFilename = 'C60.xyz'
# xyzFilename = 'C70.xyz'
# xyzFilename = 'C76.xyz'
# xyzFilename = 'C78a.xyz'
# xyzFilename = 'C84a.xyz'
# xyzFilename = 'C90.xyz'


# ---------PySCF---------------
#Comparison with PySCF
molPySCF = gto.Mole()
molPySCF.atom = xyzFilename
molPySCF.basis = basis_set_name
molPySCF.cart = True
molPySCF.verbose = 4
molPySCF.max_memory=25000
# molPySCF.incore_anyway = True # Keeps the PySCF ERI integrals incore
molPySCF.build()
#print(molPySCF.cart_labels())

print('\n\nPySCF Results\n\n')
start=timer()
mf = dft.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
mf.xc = funcidpyscf
# mf.verbose = 4
mf.direct_scf = False
# mf.with_df.max_memory = 25000
# dmat_init = mf.init_guess_by_1e(molPySCF)
# dmat_init = mf.init_guess_by_huckel(molPySCF)
mf.init_guess = 'minao'
dmat_init = mf.init_guess_by_minao(molPySCF)
# mf.init_guess = 'atom'
# dmat_init = mf.init_guess_by_atom(molPySCF)
mf.max_cycle = 30
mf.conv_tol = 1e-7
mf.grids.level = 5
print('begin df build')
start_df_pyscf=timer()
# mf.with_df.build()
duration_df_pyscf = timer()- start_df_pyscf
print('PySCF df time: ', duration_df_pyscf)
print('end df build')
energyPyscf = mf.kernel(dm0=dmat_init)
print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
print('One electron integrals energy',mf.scf_summary['e1'])
print('Coulomb energy ',mf.scf_summary['coul'])
print('EXC ',mf.scf_summary['exc'])
duration = timer()-start
print('PySCF time: ', duration)
pyscfGrids = mf.grids
print('PySCF Grid Size: ', pyscfGrids.weights.shape)
print('\n\n PySCF Dipole moment')
dmat = mf.make_rdm1()
mol_dip_pyscf = mf.dip_moment(molPySCF, dmat, unit='AU')
mf = 0#None
import psutil

# Get memory information
memory_info = psutil.virtual_memory()

# Convert bytes to human-readable format
used_memory = psutil._common.bytes2human(memory_info.used)


# If you want to print in a more human-readable format, you can use psutil's utility function
print(f"Currently Used memory: {used_memory}")
#--------------------CrysX --------------------------

#Initialize a Mol object with somewhat large geometry
molCrysX = Mol(coordfile=xyzFilename)
print('\n\nNatoms :',molCrysX.natoms)
# print(molCrysX.coordsBohrs)

#Initialize a Basis object with a very large basis set
basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})
print('\n\nNAO :',basis.bfs_nao)

auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})
print('\n\naux NAO :',auxbasis.bfs_nao)

dftObj = DFT(molCrysX, basis, xc=funcidcrysx)
# GPU acceleration
dftObj.use_gpu = True
dftObj.keep_ao_in_gpu = False
dftObj.use_libxc = False
dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
dftObj.n_gpus = 1 # Specify the number of GPUs
dftObj.free_gpu_mem = True
dftObj.threads_x = 16
dftObj.threads_y = 16
# SAO or CAO basis
dftObj.sao = False
# print(dmat_init)
# Using PySCF grids to compare the energies
energyCrysX, dmat = dftObj.scf(max_itr=35, ncores=ncores, dmat=dmat_init, conv_crit=1.0E-7, grids=pyscfGrids, \
                               isDF=True, auxbasis=auxbasis, rys=True, DF_algo=6, blocksize=51200, XC_algo=3, debug=False, \
                                sortGrids=False, save_ao_values=False, xc_bf_screen=True, threshold_schwarz=1e-9, \
                                strict_schwarz=True, cholesky=True, orthogonalize=True)
# print(dmat)

# Using CrysX grids 
# To get the same energies as PySCF (level=5) upto 1e-7 au, use the following settings
# radial_precision=1.0e-13
# level=3
# pruning by density with threshold = 1e-011
# alpha_min and alpha_max corresponding to QZVP
# energyCrysX, dmat = dftObj.scf(max_itr=30, ncores=ncores, dmat=dmat_init, grids=None, gridsLevel=3, isDF=True, auxbasis=auxbasis,
#                             rys=True, DF_algo=6, blocksize=5000, XC_algo=2, debug=False, sortGrids=False, save_ao_values=True,
#                             xc_bf_screen=True,threshold_schwarz=1e-9)


print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf))

print('\n\nPyFock Dipole moment')
M = Integrals.dipole_moment_mat_symm(basis)
mol_dip = molCrysX.get_dipole_moment(M, dmat)
print('Dipole moment(X, Y, Z, A.U.):', *mol_dip)
print('Max Diff dipole moment (PySCF-CrysX)', abs(mol_dip_pyscf-mol_dip).max())

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='node129', release='3.10.0-957.1.3.el7.x86_64', version='#1 SMP Thu Nov 29 14:49:43 UTC 2018', machine='x86_64', processor='x86_64')  Threads 24
Python 3.8.13 | packaged by conda-forge | (default, Mar 25 2022, 06:04:10) 
[GCC 10.3.0]
numpy 1.22.3  scipy 1.10.1
Date: Mon Jan  8 13:57:15 2024
PySCF version 2.4.0
PySCF path  /home/lu29vow/.local/lib/python3.8/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 125000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 152
[INPUT] num. electrons = 402
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Cartesian GTO integrals (6d 10f)
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C     -0.625000000000  -0.441100000000   0.000000000000 AA   -1.181078827853  -0.833558193546   0.000000000000 Bohr   0.0
[INPUT]  2 C     -1.873400000000   0.443500000000   0.000000000000 AA   -3.540212921760   0.838093536245   0.000000000000 Bohr   0.0
[INPUT]  3 C     -3.123500000000  -0.438700000000   0.000000000000 AA   -5.902559550079  -0.829022850847   0.000000000000 Bohr   0.0
[INPUT]  4 C     -4.371900000000   0.445900000000   0.000000000000 AA   -8.261693643986   0.842628878944   0.000000000000 Bohr   0.0
[INPUT]  5 C     -5.622000000000  -0.436300000000   0.000000000000 AA  -10.624040272305  -0.824487508148   0.000000000000 Bohr   0.0
[INPUT]  6 C     -6.870400000000   0.448300000000   0.000000000000 AA  -12.983174366212   0.847164221643   0.000000000000 Bohr   0.0
[INPUT]  7 C     -8.120500000000  -0.433900000000   0.000000000000 AA  -15.345520994531  -0.819952165449   0.000000000000 Bohr   0.0
[INPUT]  8 C     -9.368900000000   0.450700000000   0.000000000000 AA  -17.704655088438   0.851699564341   0.000000000000 Bohr   0.0
[INPUT]  9 C    -10.619000000000  -0.431400000000   0.000000000000 AA  -20.067001716756  -0.815227850137   0.000000000000 Bohr   0.0
[INPUT] 10 C    -11.867300000000   0.453100000000   0.000000000000 AA  -22.425946838051   0.856234907040   0.000000000000 Bohr   0.0
[INPUT] 11 C    -13.117400000000  -0.429000000000   0.000000000000 AA  -24.788293466370  -0.810692507438   0.000000000000 Bohr   0.0
[INPUT] 12 C    -14.365800000000   0.455500000000   0.000000000000 AA  -27.147427560277   0.860770249739   0.000000000000 Bohr   0.0
[INPUT] 13 C    -15.615900000000  -0.426600000000   0.000000000000 AA  -29.509774188596  -0.806157164739   0.000000000000 Bohr   0.0
[INPUT] 14 C    -16.864300000000   0.457900000000   0.000000000000 AA  -31.868908282503   0.865305592438   0.000000000000 Bohr   0.0
[INPUT] 15 C    -18.114401000000  -0.424200000000   0.000000000000 AA  -34.231256800547  -0.801621822040   0.000000000000 Bohr   0.0
[INPUT] 16 C    -19.362801000000   0.460300000000   0.000000000000 AA  -36.590390894455   0.869840935137   0.000000000000 Bohr   0.0
[INPUT] 17 C    -20.612900000000  -0.421800000000   0.000000000000 AA  -38.952735633047  -0.797086479342   0.000000000000 Bohr   0.0
[INPUT] 18 C    -21.861300000000   0.462700000000   0.000000000000 AA  -41.311869726954   0.874376277836   0.000000000000 Bohr   0.0
[INPUT] 19 C    -23.111300000000  -0.419400000000   0.000000000000 AA  -43.674027382661  -0.792551136643   0.000000000000 Bohr   0.0
[INPUT] 20 C    -24.359699000000   0.465100000000   0.000000000000 AA  -46.033159586841   0.878911620535   0.000000000000 Bohr   0.0
[INPUT] 21 C    -25.609800000000  -0.417000000000   0.000000000000 AA  -48.395508104886  -0.788015793944   0.000000000000 Bohr   0.0
[INPUT] 22 C    -26.858200000000   0.467500000000   0.000000000000 AA  -50.754642198793   0.883446963234   0.000000000000 Bohr   0.0
[INPUT] 23 C    -28.108299000000  -0.414600000000   0.000000000000 AA  -53.116986937386  -0.783480451245   0.000000000000 Bohr   0.0
[INPUT] 24 C    -29.356701000000   0.469900000000   0.000000000000 AA  -55.476124810745   0.887982305933   0.000000000000 Bohr   0.0
[INPUT] 25 C    -30.606800000000  -0.412200000000   0.000000000000 AA  -57.838469549338  -0.778945108546   0.000000000000 Bohr   0.0
[INPUT] 26 C      0.625000000000   0.441100000000   0.000000000000 AA    1.181078827853   0.833558193546   0.000000000000 Bohr   0.0
[INPUT] 27 C      1.873400000000  -0.443500000000   0.000000000000 AA    3.540212921760  -0.838093536245   0.000000000000 Bohr   0.0
[INPUT] 28 C      3.123500000000   0.438700000000   0.000000000000 AA    5.902559550079   0.829022850847   0.000000000000 Bohr   0.0
[INPUT] 29 C      4.371900000000  -0.445900000000   0.000000000000 AA    8.261693643986  -0.842628878944   0.000000000000 Bohr   0.0
[INPUT] 30 C      5.622000000000   0.436300000000   0.000000000000 AA   10.624040272305   0.824487508148   0.000000000000 Bohr   0.0
[INPUT] 31 C      6.870400000000  -0.448300000000   0.000000000000 AA   12.983174366212  -0.847164221643   0.000000000000 Bohr   0.0
[INPUT] 32 C      8.120500000000   0.433900000000   0.000000000000 AA   15.345520994531   0.819952165449   0.000000000000 Bohr   0.0
[INPUT] 33 C      9.368900000000  -0.450700000000   0.000000000000 AA   17.704655088438  -0.851699564341   0.000000000000 Bohr   0.0
[INPUT] 34 C     10.619000000000   0.431400000000   0.000000000000 AA   20.067001716756   0.815227850137   0.000000000000 Bohr   0.0
[INPUT] 35 C     11.867300000000  -0.453100000000   0.000000000000 AA   22.425946838051  -0.856234907040   0.000000000000 Bohr   0.0
[INPUT] 36 C     13.117400000000   0.429000000000   0.000000000000 AA   24.788293466370   0.810692507438   0.000000000000 Bohr   0.0
[INPUT] 37 C     14.365800000000  -0.455500000000   0.000000000000 AA   27.147427560277  -0.860770249739   0.000000000000 Bohr   0.0
[INPUT] 38 C     15.615900000000   0.426600000000   0.000000000000 AA   29.509774188596   0.806157164739   0.000000000000 Bohr   0.0
[INPUT] 39 C     16.864300000000  -0.457900000000   0.000000000000 AA   31.868908282503  -0.865305592438   0.000000000000 Bohr   0.0
[INPUT] 40 C     18.114401000000   0.424200000000   0.000000000000 AA   34.231256800547   0.801621822040   0.000000000000 Bohr   0.0
[INPUT] 41 C     19.362801000000  -0.460300000000   0.000000000000 AA   36.590390894455  -0.869840935137   0.000000000000 Bohr   0.0
[INPUT] 42 C     20.612900000000   0.421800000000   0.000000000000 AA   38.952735633047   0.797086479342   0.000000000000 Bohr   0.0
[INPUT] 43 C     21.861300000000  -0.462700000000   0.000000000000 AA   41.311869726954  -0.874376277836   0.000000000000 Bohr   0.0
[INPUT] 44 C     23.111300000000   0.419400000000   0.000000000000 AA   43.674027382661   0.792551136643   0.000000000000 Bohr   0.0
[INPUT] 45 C     24.359699000000  -0.465100000000   0.000000000000 AA   46.033159586841  -0.878911620535   0.000000000000 Bohr   0.0
[INPUT] 46 C     25.609800000000   0.417000000000   0.000000000000 AA   48.395508104886   0.788015793944   0.000000000000 Bohr   0.0
[INPUT] 47 C     26.858200000000  -0.467500000000   0.000000000000 AA   50.754642198793  -0.883446963234   0.000000000000 Bohr   0.0
[INPUT] 48 C     28.108299000000   0.414600000000   0.000000000000 AA   53.116986937386   0.783480451245   0.000000000000 Bohr   0.0
[INPUT] 49 C     29.356701000000  -0.469900000000   0.000000000000 AA   55.476124810745  -0.887982305933   0.000000000000 Bohr   0.0
[INPUT] 50 C     30.606800000000   0.412200000000   0.000000000000 AA   57.838469549338   0.778945108546   0.000000000000 Bohr   0.0
[INPUT] 51 H     -0.625700000000  -1.070400000000   0.890000000000 AA   -1.182401636140  -2.022762843734   1.681856250863 Bohr   0.0
[INPUT] 52 H     -0.625700000000  -1.070400000000  -0.890000000000 AA   -1.182401636140  -2.022762843734  -1.681856250863 Bohr   0.0
[INPUT] 53 H     -1.872800000000   1.072800000000   0.890000000000 AA   -3.539079086085   2.027298186433   1.681856250863 Bohr   0.0
[INPUT] 54 H     -1.872800000000   1.072800000000  -0.890000000000 AA   -3.539079086085   2.027298186433  -1.681856250863 Bohr   0.0
[INPUT] 55 H     -3.124100000000  -1.068000000000  -0.890000000000 AA   -5.903693385754  -2.018227501035  -1.681856250863 Bohr   0.0
[INPUT] 56 H     -3.124100000000  -1.068000000000   0.890000000000 AA   -5.903693385754  -2.018227501035   1.681856250863 Bohr   0.0
[INPUT] 57 H     -4.371300000000   1.075200000000   0.890000000000 AA   -8.260559808311   2.031833529132   1.681856250863 Bohr   0.0
[INPUT] 58 H     -4.371300000000   1.075200000000  -0.890000000000 AA   -8.260559808311   2.031833529132  -1.681856250863 Bohr   0.0
[INPUT] 59 H     -5.622600000000  -1.065600000000  -0.890000000000 AA  -10.625174107980  -2.013692158337  -1.681856250863 Bohr   0.0
[INPUT] 60 H     -5.622600000000  -1.065600000000   0.890000000000 AA  -10.625174107980  -2.013692158337   1.681856250863 Bohr   0.0
[INPUT] 61 H     -6.869800000000   1.077600000000   0.890000000000 AA  -12.982040530537   2.036368871831   1.681856250863 Bohr   0.0
[INPUT] 62 H     -6.869800000000   1.077600000000  -0.890000000000 AA  -12.982040530537   2.036368871831  -1.681856250863 Bohr   0.0
[INPUT] 63 H     -8.121100000000  -1.063200000000  -0.890000000000 AA  -15.346654830205  -2.009156815638  -1.681856250863 Bohr   0.0
[INPUT] 64 H     -8.121100000000  -1.063200000000   0.890000000000 AA  -15.346654830205  -2.009156815638   1.681856250863 Bohr   0.0
[INPUT] 65 H     -9.368300000000   1.080000000000   0.890000000000 AA  -17.703521252763   2.040904214530   1.681856250863 Bohr   0.0
[INPUT] 66 H     -9.368300000000   1.080000000000  -0.890000000000 AA  -17.703521252763   2.040904214530  -1.681856250863 Bohr   0.0
[INPUT] 67 H    -10.619600000000  -1.060800000000  -0.890000000000 AA  -20.068135552431  -2.004621472939  -1.681856250863 Bohr   0.0
[INPUT] 68 H    -10.619600000000  -1.060800000000   0.890000000000 AA  -20.068135552431  -2.004621472939   1.681856250863 Bohr   0.0
[INPUT] 69 H    -11.866700000000   1.082400000000   0.890000000000 AA  -22.424813002376   2.045439557229   1.681856250863 Bohr   0.0
[INPUT] 70 H    -11.866700000000   1.082400000000  -0.890000000000 AA  -22.424813002376   2.045439557229  -1.681856250863 Bohr   0.0
[INPUT] 71 H    -13.118000000000  -1.058400000000  -0.890000000000 AA  -24.789427302044  -2.000086130240  -1.681856250863 Bohr   0.0
[INPUT] 72 H    -13.118000000000  -1.058400000000   0.890000000000 AA  -24.789427302044  -2.000086130240   1.681856250863 Bohr   0.0
[INPUT] 73 H    -14.365200000000   1.084800000000   0.890000000000 AA  -27.146293724602   2.049974899928   1.681856250863 Bohr   0.0
[INPUT] 74 H    -14.365200000000   1.084800000000  -0.890000000000 AA  -27.146293724602   2.049974899928  -1.681856250863 Bohr   0.0
[INPUT] 75 H    -15.616500000000  -1.055900000000  -0.890000000000 AA  -29.510908024270  -1.995361814928  -1.681856250863 Bohr   0.0
[INPUT] 76 H    -15.616500000000  -1.055900000000   0.890000000000 AA  -29.510908024270  -1.995361814928   1.681856250863 Bohr   0.0
[INPUT] 77 H    -16.863701000000   1.087200000000   0.890000000000 AA  -31.867776336554   2.054510242627   1.681856250863 Bohr   0.0
[INPUT] 78 H    -16.863701000000   1.087200000000  -0.890000000000 AA  -31.867776336554   2.054510242627  -1.681856250863 Bohr   0.0
[INPUT] 79 H    -18.115000000000  -1.053500000000  -0.890000000000 AA  -34.232388746496  -1.990826472229  -1.681856250863 Bohr   0.0
[INPUT] 80 H    -18.115000000000  -1.053500000000   0.890000000000 AA  -34.232388746496  -1.990826472229   1.681856250863 Bohr   0.0
[INPUT] 81 H    -19.362200000000   1.089600000000   0.890000000000 AA  -36.589255169054   2.059045585326   1.681856250863 Bohr   0.0
[INPUT] 82 H    -19.362200000000   1.089600000000  -0.890000000000 AA  -36.589255169054   2.059045585326  -1.681856250863 Bohr   0.0
[INPUT] 83 H    -20.613501000000  -1.051100000000  -0.890000000000 AA  -38.953871358448  -1.986291129530  -1.681856250863 Bohr   0.0
[INPUT] 84 H    -20.613501000000  -1.051100000000   0.890000000000 AA  -38.953871358448  -1.986291129530   1.681856250863 Bohr   0.0
[INPUT] 85 H    -21.860701000000   1.092000000000   0.890000000000 AA  -41.310737781006   2.063580928025   1.681856250863 Bohr   0.0
[INPUT] 86 H    -21.860701000000   1.092000000000  -0.890000000000 AA  -41.310737781006   2.063580928025  -1.681856250863 Bohr   0.0
[INPUT] 87 H    -23.112000000000  -1.048700000000  -0.890000000000 AA  -43.675350190948  -1.981755786831  -1.681856250863 Bohr   0.0
[INPUT] 88 H    -23.112000000000  -1.048700000000   0.890000000000 AA  -43.675350190948  -1.981755786831   1.681856250863 Bohr   0.0
[INPUT] 89 H    -24.359100000000   1.094400000000   0.890000000000 AA  -46.032027640893   2.068116270724   1.681856250863 Bohr   0.0
[INPUT] 90 H    -24.359100000000   1.094400000000  -0.890000000000 AA  -46.032027640893   2.068116270724  -1.681856250863 Bohr   0.0
[INPUT] 91 H    -25.610399000000  -1.046300000000  -0.890000000000 AA  -48.396640050835  -1.977220444132  -1.681856250863 Bohr   0.0
[INPUT] 92 H    -25.610399000000  -1.046300000000   0.890000000000 AA  -48.396640050835  -1.977220444132   1.681856250863 Bohr   0.0
[INPUT] 93 H    -26.857599000000   1.096800000000   0.890000000000 AA  -50.753506473392   2.072651613423   1.681856250863 Bohr   0.0
[INPUT] 94 H    -26.857599000000   1.096800000000  -0.890000000000 AA  -50.753506473392   2.072651613423  -1.681856250863 Bohr   0.0
[INPUT] 95 H    -28.108900000000  -1.043900000000  -0.890000000000 AA  -53.118122662787  -1.972685101433  -1.681856250863 Bohr   0.0
[INPUT] 96 H    -28.108900000000  -1.043900000000   0.890000000000 AA  -53.118122662787  -1.972685101433   1.681856250863 Bohr   0.0
[INPUT] 97 H    -29.356100000000   1.099300000000   0.890000000000 AA  -55.474989085344   2.077375928734   1.681856250863 Bohr   0.0
[INPUT] 98 H    -29.356100000000   1.099300000000  -0.890000000000 AA  -55.474989085344   2.077375928734  -1.681856250863 Bohr   0.0
[INPUT] 99 H    -30.607401000000  -1.041500000000   0.890000000000 AA  -57.839605274739  -1.968149758735   1.681856250863 Bohr   0.0
[INPUT]100 H    -31.496201000000   0.218000000000   0.000000000000 AA  -59.519193854252   0.411960295155   0.000000000000 Bohr   0.0
[INPUT]101 H    -30.607401000000  -1.041500000000  -0.890000000000 AA  -57.839605274739  -1.968149758735  -1.681856250863 Bohr   0.0
[INPUT]102 H      0.625700000000   1.070400000000  -0.890000000000 AA    1.182401636140   2.022762843734  -1.681856250863 Bohr   0.0
[INPUT]103 H      0.625700000000   1.070400000000   0.890000000000 AA    1.182401636140   2.022762843734   1.681856250863 Bohr   0.0
[INPUT]104 H      1.872800000000  -1.072800000000   0.890000000000 AA    3.539079086085  -2.027298186433   1.681856250863 Bohr   0.0
[INPUT]105 H      1.872800000000  -1.072800000000  -0.890000000000 AA    3.539079086085  -2.027298186433  -1.681856250863 Bohr   0.0
[INPUT]106 H      3.124100000000   1.068000000000  -0.890000000000 AA    5.903693385754   2.018227501035  -1.681856250863 Bohr   0.0
[INPUT]107 H      3.124100000000   1.068000000000   0.890000000000 AA    5.903693385754   2.018227501035   1.681856250863 Bohr   0.0
[INPUT]108 H      4.371300000000  -1.075200000000   0.890000000000 AA    8.260559808311  -2.031833529132   1.681856250863 Bohr   0.0
[INPUT]109 H      4.371300000000  -1.075200000000  -0.890000000000 AA    8.260559808311  -2.031833529132  -1.681856250863 Bohr   0.0
[INPUT]110 H      5.622600000000   1.065600000000  -0.890000000000 AA   10.625174107980   2.013692158337  -1.681856250863 Bohr   0.0
[INPUT]111 H      5.622600000000   1.065600000000   0.890000000000 AA   10.625174107980   2.013692158337   1.681856250863 Bohr   0.0
[INPUT]112 H      6.869800000000  -1.077600000000   0.890000000000 AA   12.982040530537  -2.036368871831   1.681856250863 Bohr   0.0
[INPUT]113 H      6.869800000000  -1.077600000000  -0.890000000000 AA   12.982040530537  -2.036368871831  -1.681856250863 Bohr   0.0
[INPUT]114 H      8.121100000000   1.063200000000  -0.890000000000 AA   15.346654830205   2.009156815638  -1.681856250863 Bohr   0.0
[INPUT]115 H      8.121100000000   1.063200000000   0.890000000000 AA   15.346654830205   2.009156815638   1.681856250863 Bohr   0.0
[INPUT]116 H      9.368300000000  -1.080000000000   0.890000000000 AA   17.703521252763  -2.040904214530   1.681856250863 Bohr   0.0
[INPUT]117 H      9.368300000000  -1.080000000000  -0.890000000000 AA   17.703521252763  -2.040904214530  -1.681856250863 Bohr   0.0
[INPUT]118 H     10.619600000000   1.060800000000  -0.890000000000 AA   20.068135552431   2.004621472939  -1.681856250863 Bohr   0.0
[INPUT]119 H     10.619600000000   1.060800000000   0.890000000000 AA   20.068135552431   2.004621472939   1.681856250863 Bohr   0.0
[INPUT]120 H     11.866700000000  -1.082400000000   0.890000000000 AA   22.424813002376  -2.045439557229   1.681856250863 Bohr   0.0
[INPUT]121 H     11.866700000000  -1.082400000000  -0.890000000000 AA   22.424813002376  -2.045439557229  -1.681856250863 Bohr   0.0
[INPUT]122 H     13.118000000000   1.058400000000  -0.890000000000 AA   24.789427302044   2.000086130240  -1.681856250863 Bohr   0.0
[INPUT]123 H     13.118000000000   1.058400000000   0.890000000000 AA   24.789427302044   2.000086130240   1.681856250863 Bohr   0.0
[INPUT]124 H     14.365200000000  -1.084800000000   0.890000000000 AA   27.146293724602  -2.049974899928   1.681856250863 Bohr   0.0
[INPUT]125 H     14.365200000000  -1.084800000000  -0.890000000000 AA   27.146293724602  -2.049974899928  -1.681856250863 Bohr   0.0
[INPUT]126 H     15.616500000000   1.055900000000  -0.890000000000 AA   29.510908024270   1.995361814928  -1.681856250863 Bohr   0.0
[INPUT]127 H     15.616500000000   1.055900000000   0.890000000000 AA   29.510908024270   1.995361814928   1.681856250863 Bohr   0.0
[INPUT]128 H     16.863701000000  -1.087200000000   0.890000000000 AA   31.867776336554  -2.054510242627   1.681856250863 Bohr   0.0
[INPUT]129 H     16.863701000000  -1.087200000000  -0.890000000000 AA   31.867776336554  -2.054510242627  -1.681856250863 Bohr   0.0
[INPUT]130 H     18.115000000000   1.053500000000  -0.890000000000 AA   34.232388746496   1.990826472229  -1.681856250863 Bohr   0.0
[INPUT]131 H     18.115000000000   1.053500000000   0.890000000000 AA   34.232388746496   1.990826472229   1.681856250863 Bohr   0.0
[INPUT]132 H     19.362200000000  -1.089600000000   0.890000000000 AA   36.589255169054  -2.059045585326   1.681856250863 Bohr   0.0
[INPUT]133 H     19.362200000000  -1.089600000000  -0.890000000000 AA   36.589255169054  -2.059045585326  -1.681856250863 Bohr   0.0
[INPUT]134 H     20.613501000000   1.051100000000  -0.890000000000 AA   38.953871358448   1.986291129530  -1.681856250863 Bohr   0.0
[INPUT]135 H     20.613501000000   1.051100000000   0.890000000000 AA   38.953871358448   1.986291129530   1.681856250863 Bohr   0.0
[INPUT]136 H     21.860701000000  -1.092000000000   0.890000000000 AA   41.310737781006  -2.063580928025   1.681856250863 Bohr   0.0
[INPUT]137 H     21.860701000000  -1.092000000000  -0.890000000000 AA   41.310737781006  -2.063580928025  -1.681856250863 Bohr   0.0
[INPUT]138 H     23.112000000000   1.048700000000  -0.890000000000 AA   43.675350190948   1.981755786831  -1.681856250863 Bohr   0.0
[INPUT]139 H     23.112000000000   1.048700000000   0.890000000000 AA   43.675350190948   1.981755786831   1.681856250863 Bohr   0.0
[INPUT]140 H     24.359100000000  -1.094400000000   0.890000000000 AA   46.032027640893  -2.068116270724   1.681856250863 Bohr   0.0
[INPUT]141 H     24.359100000000  -1.094400000000  -0.890000000000 AA   46.032027640893  -2.068116270724  -1.681856250863 Bohr   0.0
[INPUT]142 H     25.610399000000   1.046300000000  -0.890000000000 AA   48.396640050835   1.977220444132  -1.681856250863 Bohr   0.0
[INPUT]143 H     25.610399000000   1.046300000000   0.890000000000 AA   48.396640050835   1.977220444132   1.681856250863 Bohr   0.0
[INPUT]144 H     26.857599000000  -1.096800000000   0.890000000000 AA   50.753506473392  -2.072651613423   1.681856250863 Bohr   0.0
[INPUT]145 H     26.857599000000  -1.096800000000  -0.890000000000 AA   50.753506473392  -2.072651613423  -1.681856250863 Bohr   0.0
[INPUT]146 H     28.108900000000   1.043900000000  -0.890000000000 AA   53.118122662787   1.972685101433  -1.681856250863 Bohr   0.0
[INPUT]147 H     28.108900000000   1.043900000000   0.890000000000 AA   53.118122662787   1.972685101433   1.681856250863 Bohr   0.0
[INPUT]148 H     29.356100000000  -1.099300000000   0.890000000000 AA   55.474989085344  -2.077375928734   1.681856250863 Bohr   0.0
[INPUT]149 H     29.356100000000  -1.099300000000  -0.890000000000 AA   55.474989085344  -2.077375928734  -1.681856250863 Bohr   0.0
[INPUT]150 H     30.607401000000   1.041500000000   0.890000000000 AA   57.839605274739   1.968149758735   1.681856250863 Bohr   0.0
[INPUT]151 H     31.496201000000  -0.218000000000   0.000000000000 AA   59.519193854252  -0.411960295155   0.000000000000 Bohr   0.0
[INPUT]152 H     30.607401000000   1.041500000000  -0.890000000000 AA   57.839605274739   1.968149758735  -1.681856250863 Bohr   0.0

nuclear repulsion = 4624.47185937791
number of shells = 606
number of NR pGTOs = 1964
number of NR cGTOs = 1260
basis = def2-SVP
ecp = {}
CPU time:         4.07


PySCF Results


Initial guess from minao.
begin df build
PySCF df time:  5.220063030719757e-07
end df build


******** <class 'pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 30
direct_scf = False
chkfile to save SCF result = /tmp/tmpu2ppuxin
max_memory 25000 MB (current use 421 MB)
XC library pyscf.dft.libxc version 6.1.0
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1â€“5 (2018)
XC functionals = 1,7
    P. A. M. Dirac.,  Math. Proc. Cambridge Philos. Soc. 26, 376 (1930)
    F. Bloch.,  Z. Phys. 57, 545 (1929)
    S. H. Vosko, L. Wilk, and M. Nusair.,  Can. J. Phys. 58, 1200 (1980)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2af7cd879940>
grids dens level: 5
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2af7cd8798b0>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 4555240
init E= -1948.45465117902
  HOMO = -0.354057868152459  LUMO = -0.0284458298789424
cycle= 1 E= -1945.90684323368  delta_E= 2.55  |g|= 1.83  |ddm|= 12.8
  HOMO = -0.0803836197829336  LUMO = 0.0689638314997883
cycle= 2 E= -1944.71658715385  delta_E= 1.19  |g|= 2.79  |ddm|= 5.82
  HOMO = -0.222761730993108  LUMO = 0.0245150706646623
cycle= 3 E= -1946.90723829386  delta_E= -2.19  |g|= 0.0719  |ddm|= 3.63
  HOMO = -0.223329957198557  LUMO = 0.0226098364210534
cycle= 4 E= -1946.90793590173  delta_E= -0.000698  |g|= 0.0463  |ddm|= 0.179
  HOMO = -0.222879619388132  LUMO = 0.0228057003954373
cycle= 5 E= -1946.90840496667  delta_E= -0.000469  |g|= 0.0184  |ddm|= 0.0761
  HOMO = -0.223203538440365  LUMO = 0.0227293729542244
cycle= 6 E= -1946.90849037443  delta_E= -8.54e-05  |g|= 0.00156  |ddm|= 0.0221
  HOMO = -0.2232728932698  LUMO = 0.0226927136201036
cycle= 7 E= -1946.90849078809  delta_E= -4.14e-07  |g|= 0.000961  |ddm|= 0.00309
  HOMO = -0.223272705917955  LUMO = 0.0226853866232701
cycle= 8 E= -1946.90849101872  delta_E= -2.31e-07  |g|= 0.000188  |ddm|= 0.00128
  HOMO = -0.223277049510818  LUMO = 0.0226823521888023
cycle= 9 E= -1946.90849102816  delta_E= -9.44e-09  |g|= 2.89e-05  |ddm|= 0.000311
  HOMO = -0.223279831423397  LUMO = 0.0226811035131304
Extra cycle  E= -1946.90849102782  delta_E= 3.41e-10  |g|= 4.57e-05  |ddm|= 9.67e-05
converged SCF energy = -1946.90849102782
Nuc-Nuc PySCF=  4624.471859377914
One electron integrals energy -11839.201370194829
Coulomb energy  5557.474724251503
EXC  -289.6537044624073
PySCF time:  336.02197416406125
PySCF Grid Size:  (3688056,)


 PySCF Dipole moment
Dipole moment(X, Y, Z, A.U.): -0.00000,  0.00000,  0.00000
Currently Used memory: 2.1G


Natoms : 152


NAO : 1260


aux NAO : 4274
Running DFT using 24 threads for Numba.


GPU acceleration is enabled. Currently this only accelerates AO values and XC term evaluation.
GPU(s) information:
Found 1 CUDA devices
id 0    b'Tesla P100-PCIE-16GB'                              [SUPPORTED]
                      Compute Capability: 6.0
                           PCI Device ID: 0
                              PCI Bus ID: 130
                                    UUID: GPU-e17568b8-4835-bc2b-3693-4b0248298efa
                                Watchdog: Disabled
             FP32/FP64 Performance Ratio: 2
Summary:
	1/1 devices are supported
True
Max threads per block supported by the GPU:  1024
The user has specified to use 1 GPU(s).
Threads per block configuration:  (16, 16)


Will use dynamic precision. 
This means that the XC term will be evaluated in single precision until the 
relative energy difference b/w successive iterations is less than 5.0E-7.

Calculating overlap and kinetic integrals...


Core H size in GB  0.0254016
done!
Time taken 1.7615079380339012 seconds.


Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 11.550407505012117 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  3.256990678026341
Time taken to evaluate the square roots needed:  0.016232074005529284
Time for significant indices evaluation:  2.1298542600125074
Size of permanent array storing the significant indices of 3c2e ERI in GB  2.698652352
No. of elements in the standard three-centered two electron ERI tensor:  6785402400
No. of elements in the triangular three-centered two electron ERI tensor:  3395393820
No. of significant triplets based on Schwarz inequality and triangularity: 449775392 or 6.6% of original
Schwarz screening done!
Total time taken for Schwarz screening 5.404020286980085 seconds.

Time taken to evaluate the nuclear potential matrix with strict Schwarz screening:  14.029091814998537
Two Center Two electron ERI size in GB  0.146136608
Three Center Two electron ERI size in GB  3.598203136
Three-centered two electron evaluation done!
Time taken for Cholesky factorization fo two-centered two-electron integrals 0.20490049093496054 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  1117.602208847995 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  3688056
Size (in GB) for storing the coordinates of grid:       0.088513344
Size (in GB) for storing the weights of grid:           0.029504448
Size (in GB) for storing the density at gridpoints:     0.029504448

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  51200
No. of batches:  73

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 15.120804339996539 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    188
Average no. of basis functions contributing to a batch of grid points:    166


------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [1, 7]


Description of exchange functional: 

The Exchange function belongs to the family: LDA
Functional ID: 1
Functional Name: lda_x
Attributes:
    Name: Slater exchange
    Kind: 0
  Family: 1
Citations:
   P. A. M. Dirac, Math. Proc. Cambridge Philos. Soc. 26, 376 (1930)
   F. Bloch, Z. Phys. 57, 545 (1929)


Description of correlation functional: 

 The Correlation function belongs to the family: LDA
Functional ID: 7
Functional Name: lda_c_vwn
Attributes:
    Name: Vosko, Wilk & Nusair (VWN5)
    Kind: 1
  Family: 1
Citations:
   S. H. Vosko, L. Wilk, and M. Nusair, Can. J. Phys. 58, 1200 (1980)
------------------------------------------------------




Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  401.16312



------Iteration 1--------


Energies
Electron-Nuclear Energy       -13749.502826033618
Nuclear repulsion Energy      4624.471859390324
Kinetic Energy                1966.691388871229
Coulomb Energy                5498.820907022795
Exchange-Correlation Energy   -288.04095
-------------------------
Total Energy  -1947.5596253391132
-------------------------



Energy difference :  1947.5596253391132


Time taken for the previous iteration: 2.025677938014269


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  402.0



------Iteration 2--------


Energies
Electron-Nuclear Energy       -13829.320228070901
Nuclear repulsion Energy      4624.471859390324
Kinetic Energy                1937.046404899817
Coulomb Energy                5616.0014008546705
Exchange-Correlation Energy   -293.90036
-------------------------
Total Energy  -1945.7009230335116
-------------------------



Energy difference :  1.8587023056015823


Time taken for the previous iteration: 1.3256761819357052


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  401.9999



------Iteration 3--------


Energies
Electron-Nuclear Energy       -13642.988931223052
Nuclear repulsion Energy      4624.471859390324
Kinetic Energy                1883.661335795099
Coulomb Energy                5474.293369427172
Exchange-Correlation Energy   -283.9049
-------------------------
Total Energy  -1944.4672738370182
-------------------------



Energy difference :  1.2336491964933884


Time taken for the previous iteration: 1.3262062270659953


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  402.00003



------Iteration 4--------


Energies
Electron-Nuclear Energy       -13758.630845677697
Nuclear repulsion Energy      4624.471859390324
Kinetic Energy                1918.0057175868778
Coulomb Energy                5558.976157763584
Exchange-Correlation Energy   -289.72925
-------------------------
Total Energy  -1946.9063589837851
-------------------------



Energy difference :  2.4390851467669563


Time taken for the previous iteration: 1.43198046204634


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  401.99994



------Iteration 5--------


Energies
Electron-Nuclear Energy       -13756.910688615313
Nuclear repulsion Energy      4624.471859390324
Kinetic Energy                1917.5267700194333
Coulomb Energy                5557.676735406379
Exchange-Correlation Energy   -289.67282
-------------------------
Total Energy  -1946.9081448440993
-------------------------



Energy difference :  0.0017858603141576168


Time taken for the previous iteration: 1.3869700309587643


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  402.0



------Iteration 6--------


Energies
Electron-Nuclear Energy       -13756.687270007034
Nuclear repulsion Energy      4624.471859390324
Kinetic Energy                1917.4300703299807
Coulomb Energy                5557.5367891691785
Exchange-Correlation Energy   -289.65982
-------------------------
Total Energy  -1946.9083716741907
-------------------------



Energy difference :  0.00022683009137836052

Switching to double precision for XC evaluation after 6 iterations!


Time taken for the previous iteration: 1.3880453520687297


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  401.99995137472143



------Iteration 7--------


Energies
Electron-Nuclear Energy       -13756.59652348321
Nuclear repulsion Energy      4624.471859390324
Kinetic Energy                1917.3908673529327
Coulomb Energy                5557.479459939718
Exchange-Correlation Energy   -289.65414544608166
-------------------------
Total Energy  -1946.9084822463155
-------------------------



Energy difference :  0.00011057212486775825


Time taken for the previous iteration: 1.391522360034287


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  401.99995137278114



------Iteration 8--------


Energies
Electron-Nuclear Energy       -13756.589588096027
Nuclear repulsion Energy      4624.471859390324
Kinetic Energy                1917.3887332453257
Coulomb Energy                5557.474198158755
Exchange-Correlation Energy   -289.6536853508382
-------------------------
Total Energy  -1946.9084826524613
-------------------------



Energy difference :  4.061457730131224e-07


Time taken for the previous iteration: 1.4334492230555043


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  401.9999513726318



------Iteration 9--------


Energies
Electron-Nuclear Energy       -13756.588593032726
Nuclear repulsion Energy      4624.471859390324
Kinetic Energy                1917.388584959116
Coulomb Energy                5557.473285476441
Exchange-Correlation Energy   -289.6536196355201
-------------------------
Total Energy  -1946.9084828423647
-------------------------



Energy difference :  1.899034032248892e-07


Time taken for the previous iteration: 1.391073863953352


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  401.9999513728486



------Iteration 10--------


Energies
Electron-Nuclear Energy       -13756.58897127173
Nuclear repulsion Energy      4624.471859390324
Kinetic Energy                1917.3887526401531
Coulomb Energy                5557.4735144401475
Exchange-Correlation Energy   -289.65363804893565
-------------------------
Total Energy  -1946.9084828500427
-------------------------



Energy difference :  7.67795427236706e-09


Time taken for the previous iteration: 1.4188204921083525



SCF Converged after 10 iterations!

-------------------------------------
Total Energy =  -1946.9084828500427
-------------------------------------



Time taken : 1149.2224724050611 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           15.120804339996539
Density Fitting                         4.851389579009265
    DF (gamma)                          2.2418251278577372
    DF (coeff)                          0.49331569019705057
    DF (Jtri)                           1.649037022027187
    DF (Cholesky)                       0.20490049093496054
DIIS                                    0.25934812414925545
KS matrix diagonalization               1.6408364386297762
One electron Integrals (S, T, Vnuc)     1.7615079380339012
Coulomb Integrals (2c2e + 3c2e)         1117.39730835706
Grids construction                      0
Exchange-Correlation Term               7.856084199855104
Misc.                                   0.33519342832732946
Complete SCF                            1149.2224724050611
Energy diff (PySCF-CrysX) 8.17777618067339e-06


PyFock Dipole moment
Dipole moment(X, Y, Z, A.U.): 2.190076574537514e-07 -5.124751804690131e-08 -4.4547482190050725e-08
Max Diff dipole moment (PySCF-CrysX) 2.190920699307597e-07



 Package versions
pyscf version 2.4.0
np version 1.22.3
joblib version 1.3.2
numba version 0.56.4
threadpoolctl version 3.2.0
opt_einsum version v3.3.0
llvmlite version 0.39.1
cupy version 12.3.0
numexpr version 2.8.3
scipy version 1.10.1
