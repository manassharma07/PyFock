#INFO: **** input file is /home/lu29vow/GPU_Test/pyscf_gpu.py ****
from pyscf import gto
from gpu4pyscf.dft import rks
import os
from timeit import default_timer as timer

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN
funcx = 1
funcc = 7

# LDA_X LDA_C_PW
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
# funcx = 101
# funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)

# basis_set_name = 'sto-2g'
# basis_set_name = 'sto-3g'
# basis_set_name = 'sto-6g'
# basis_set_name = '6-31G'
basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-SVPD'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'def2-QZVP'
# basis_set_name = 'def2-TZVPP'
# basis_set_name = 'def2-QZVPP'
# basis_set_name = 'def2-TZVPD'
# basis_set_name = 'def2-QZVPD'
# basis_set_name = 'def2-TZVPPD'
# basis_set_name = 'def2-QZVPPD'
# basis_set_name = 'cc-pVDZ'
# basis_set_name = 'ano-rcc'

auxbasis_name = 'def2-universal-jfit'
# auxbasis_name = 'def2-TZVP'
# auxbasis_name = 'sto-3g'
# auxbasis_name = 'def2-SVP'
# auxbasis_name = '6-31G'

# xyzFilename = 'Benzene-Fulvene_Dimer.xyz'
# xyzFilename = 'Adenine-Thymine.xyz'
# xyzFilename = 'Zn.xyz'
# xyzFilename = 'Zn_dimer.xyz'
# xyzFilename = 'TPP.xyz'
# xyzFilename = 'Zn_TPP.xyz'
# xyzFilename = 'H2O.xyz'

# xyzFilename = 'Caffeine.xyz'
# xyzFilename = 'Serotonin.xyz'
# xyzFilename = 'Cholesterol.xyz'
# xyzFilename = 'C60.xyz'
# xyzFilename = 'Taxol.xyz'
# xyzFilename = 'Valinomycin.xyz'
# xyzFilename = 'Olestra.xyz'
# xyzFilename = 'Ubiquitin.xyz'

### 1D Carbon Alkanes
# xyzFilename = 'Ethane.xyz'
xyzFilename = 'Decane_C10H22.xyz'
# xyzFilename = 'Icosane_C20H42.xyz'
# xyzFilename = 'Tetracontane_C40H82.xyz'
# xyzFilename = 'Pentacontane_C50H102.xyz'
# xyzFilename = 'Octacontane_C80H162.xyz'
# xyzFilename = 'Hectane_C100H202.xyz'
# xyzFilename = 'Icosahectane_C120H242.xyz'

### 2D Carbon
# xyzFilename = 'Graphene_C16.xyz'
# xyzFilename = 'Graphene_C76.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'

### 3d Carbon Fullerenes
# xyzFilename = 'C60.xyz'
# xyzFilename = 'C70.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'

molPySCF = gto.Mole()
molPySCF.atom = 'molecular-structures/'+xyzFilename
molPySCF.basis = basis_set_name
# molPySCF.cart = True
molPySCF.verbose = 6
#molPySCF.max_memory=25000
# molPySCF.incore_anyway = True # Keeps the PySCF ERI integrals incore
molPySCF.build()

print('\n\nPySCF Results\n\n')
start=timer()
mf = rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
mf.xc = funcidpyscf
mf.verbose = 7
mf.direct_scf = True
# mf.with_df.max_memory = 25000
# dmat_init = mf.init_guess_by_1e(molPySCF)
# dmat_init = mf.init_guess_by_huckel(molPySCF)
mf.init_guess = 'minao'
dmat_init = mf.init_guess_by_minao(molPySCF)
# mf.init_guess = 'atom'
# dmat_init = mf.init_guess_by_atom(molPySCF)
mf.max_cycle = 30
mf.conv_tol = 1e-7
mf.grids.level = 5
# print('begin df build')
# start_df_pyscf=timer()
# mf.with_df.build()
# duration_df_pyscf = timer()- start_df_pyscf
# print('PySCF df time: ', duration_df_pyscf)
# print('end df build')
energyPyscf = mf.kernel(dm0=dmat_init)
print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
print('One electron integrals energy',mf.scf_summary['e1'])
print('Coulomb energy ',mf.scf_summary['coul'])
print('EXC ',mf.scf_summary['exc'])
duration = timer()-start
print('PySCF time: ', duration)
pyscfGrids = mf.grids
print('PySCF Grid Size: ', pyscfGrids.weights.shape)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='gpu006.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64')  Threads 2
Python 3.10.13 (tags/v3.10.13-25-g07fbd8e9251-dirty:07fbd8e9251, Sep 27 2023, 23:32:09) [GCC 13.2.0]
numpy 1.26.3  scipy 1.12.0
Date: Wed Jan 31 20:54:35 2024
PySCF version 2.4.0
PySCF path  /home/lu29vow/.conda/envs/PySCF_GPU/lib/python3.10/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 6
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 32
[INPUT] num. electrons = 82
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.660900000000   0.387900000000   0.066100000000 AA    1.248919995725   0.733024763719   0.124910896834 Bohr   0.0
[INPUT]  2 C     -0.642900000000  -0.416100000000   0.097200000000 AA   -1.214904925483  -0.786315040432   0.183681379308 Bohr   0.0
[INPUT]  3 C      1.914100000000  -0.489400000000   0.024000000000 AA    3.617124775030  -0.924831965362   0.045353426990 Bohr   0.0
[INPUT]  4 C     -1.896200000000   0.462500000000   0.063500000000 AA   -3.583298677400   0.873998332611   0.119997608910 Bohr   0.0
[INPUT]  5 C      3.185800000000   0.361800000000   0.007100000000 AA    6.020289487639   0.683702911868   0.013417055484 Bohr   0.0
[INPUT]  6 C     -3.199200000000  -0.343000000000   0.034200000000 AA   -6.045611817709  -0.648176060726   0.064628633460 Bohr   0.0
[INPUT]  7 C      4.438100000000  -0.511000000000  -0.073500000000 AA    8.386793513432  -0.965650049653  -0.138894870156 Bohr   0.0
[INPUT]  8 C     -4.449800000000   0.530500000000  -0.074800000000 AA   -8.408903309090   1.002499709082  -0.141351514117 Bohr   0.0
[INPUT]  9 C      5.705000000000   0.329500000000  -0.056800000000 AA   10.780887540644   0.622664758044  -0.107336443875 Bohr   0.0
[INPUT] 10 C     -5.715800000000  -0.312900000000  -0.087000000000 AA  -10.801296582789  -0.591295304376  -0.164406172837 Bohr   0.0
[INPUT] 11 H      0.654500000000   1.046100000000  -0.811600000000 AA    1.236825748528   1.976842498908  -1.533701722697 Bohr   0.0
[INPUT] 12 H      0.700300000000   1.037900000000   0.949000000000 AA    1.323375205033   1.961346744686   1.793350092212 Bohr   0.0
[INPUT] 13 H     -0.661800000000  -1.040700000000   0.998600000000 AA   -1.250620749237  -1.966637977835   1.887080507991 Bohr   0.0
[INPUT] 14 H     -0.661600000000  -1.098500000000  -0.761600000000 AA   -1.250242804012  -2.075864147835  -1.439215416469 Bohr   0.0
[INPUT] 15 H      1.926200000000  -1.154000000000   0.896400000000 AA    3.639990461137  -2.180743947748   1.693950498060 Bohr   0.0
[INPUT] 16 H      1.883700000000  -1.126300000000  -0.868200000000 AA    3.559677100843  -2.128398534098  -1.640660221347 Bohr   0.0
[INPUT] 17 H     -1.899000000000   1.124300000000   0.938300000000 AA   -3.588589910549   2.124619081848   1.773130022679 Bohr   0.0
[INPUT] 18 H     -1.856400000000   1.108400000000  -0.822400000000 AA   -3.508087577643   2.094572436468  -1.554110764842 Bohr   0.0
[INPUT] 19 H      3.160900000000   1.045500000000  -0.850300000000 AA    5.973235307138   1.975708663233  -1.606834123718 Bohr   0.0
[INPUT] 20 H      3.224700000000   0.980000000000   0.912300000000 AA    6.093799833885   1.851931602074   1.723997143441 Bohr   0.0
[INPUT] 21 H     -3.172100000000  -1.037400000000  -0.814900000000 AA   -5.994400239733  -1.960401881624  -1.539937818908 Bohr   0.0
[INPUT] 22 H     -3.260200000000  -0.955900000000   0.942100000000 AA   -6.160885111307  -1.806389202472   1.780310981953 Bohr   0.0
[INPUT] 23 H      4.460200000000  -1.209400000000   0.771100000000 AA    8.428556460785  -2.285434775049   1.457167814652 Bohr   0.0
[INPUT] 24 H      4.415400000000  -1.111100000000  -0.990500000000 AA    8.343896730405  -2.099674697004  -1.871773726382 Bohr   0.0
[INPUT] 25 H     -4.488700000000   1.228900000000   0.769100000000 AA   -8.482413655335   2.322284434478   1.453388362403 Bohr   0.0
[INPUT] 26 H     -4.405200000000   1.129900000000  -0.991300000000 AA   -8.324621523934   2.135201548146  -1.873285507281 Bohr   0.0
[INPUT] 27 H      6.587900000000  -0.314500000000  -0.116200000000 AA   12.449326736022  -0.594318866176  -0.219586175674 Bohr   0.0
[INPUT] 28 H      5.774200000000   0.916700000000   0.864500000000 AA   10.911656588464   1.732311938389   1.633668234686 Bohr   0.0
[INPUT] 29 H      5.729400000000   1.019000000000  -0.906700000000 AA   10.826996858083   1.925630920932  -1.713414677143 Bohr   0.0
[INPUT] 30 H     -6.598200000000   0.329900000000  -0.165500000000 AA  -12.468790915105   0.623420648494  -0.312749673616 Bohr   0.0
[INPUT] 31 H     -5.720200000000  -1.001500000000  -0.937900000000 AA  -10.809611377737  -1.892560713752  -1.772374132230 Bohr   0.0
[INPUT] 32 H     -5.804400000000  -0.900800000000   0.832000000000 AA  -10.968726317425  -1.702265293008   1.572252135638 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] H
[INPUT] 0    0    [3    /1   ]  13.010701         0.019682158
                                1.9622572         0.13796524
                                0.44453796        0.47831935
[INPUT] 0    0    [1    /1   ]  0.12194962           1
[INPUT] 1    0    [1    /1   ]  0.8                  1
[INPUT] C
[INPUT] 0    0    [5    /1   ]  1238.4016938      0.0054568832082
                                186.29004992      0.040638409211
                                42.251176346      0.18025593888
                                11.676557932      0.46315121755
                                3.5930506482      0.44087173314
[INPUT] 0    0    [1    /1   ]  0.40245147363        1
[INPUT] 0    0    [1    /1   ]  0.13090182668        1
[INPUT] 1    0    [3    /1   ]  9.4680970621      0.038387871728
                                2.0103545142      0.21117025112
                                0.54771004707     0.51328172114
[INPUT] 1    0    [1    /1   ]  0.15268613795        1
[INPUT] 2    0    [1    /1   ]  0.8                  1

nuclear repulsion = 519.13846685665
number of shells = 126
number of NR pGTOs = 394
number of NR cGTOs = 250
basis = def2-SVP
ecp = {}
CPU time:         2.02


PySCF Results


Initial guess from minao.


******** <class 'gpu4pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'gpu4pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 30
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /tmp/tmpc0yyh1n1
max_memory 4000 MB (current use 1719 MB)
XC library pyscf.dft.libxc version 6.1.0
    unable to decode the reference due to https://github.com/NVIDIA/cuda-python/issues/29
XC functionals = 1,7
    P. A. M. Dirac.,  Math. Proc. Cambridge Philos. Soc. 26, 376 (1930)
    F. Bloch.,  Z. Phys. 57, 545 (1929)
    S. H. Vosko, L. Wilk, and M. Nusair.,  Can. J. Phys. 58, 1200 (1980)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14e95f888a60>
grids dens level: 5
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14e95f888820>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
num shells = 260, num cGTOs = 732
    CPU time for                                               2c2e      0.08 sec, wall time      0.04 sec, GPU time for     40.37 ms
Number of shells for each [l, nctr] group
    [0 1] : 42
    [0 3] : 22
    [0 5] : 10
    [1 1] : 32
    [1 3] : 10
    [2 1] : 10
Number of shells for each [l, nctr] group
    [0 1] : 94
    [0 3] : 22
    [0 7] : 10
    [1 1] : 30
    [1 2] : 32
    [2 1] : 42
    [2 2] : 10
    [3 2] : 10
    [4 1] : 10
atom C rad-grids = 105, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50
  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86
  86  86  86  86  86  86  86  86  86  86 590 590 590 590 590 590 590 590
 590 770 770 770 770 770 770 770 770 770 770 770 770 770 770 770 770 770
 770 770 770 770 770 770 770 770 770 770 770 590 590 590 590 590 590 590
 590 590 590 590 590 590 590 590 590 590 590 590 590 590 590]
    CPU time for                                  Initialize q_cond      0.03 sec, wall time      0.01 sec, GPU time for     13.97 ms
    CPU time for                                        Get pairing      0.00 sec, wall time      0.00 sec, GPU time for      1.25 ms
atom H rad-grids = 70, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50
  50  50  86  86  86  86  86 434 434 434 434 434 434 590 590 590 590 590
 590 590 590 590 590 590 590 590 590 590 590 590 590 434 434 434 434 434
 434 434 434 434 434 434 434 434 434 434 434 434 434 434 434 434]
    CPU time for                                  AO cart2sph coeff      0.01 sec, wall time      0.01 sec, GPU time for      7.80 ms
    CPU time for                                 aux cart2sph coeff      0.01 sec, wall time      0.00 sec, GPU time for      4.51 ms
    CPU time for                                       Get AO pairs      0.01 sec, wall time      0.01 sec, GPU time for      8.85 ms
    CPU time for                               Initialize GPU cache      0.02 sec, wall time      0.03 sec, GPU time for     33.44 ms
    CPU time for                                     prepare intopt      0.09 sec, wall time      0.07 sec, GPU time for     73.08 ms
Padding 44 grids
size of aux basis 732
tot grids = 949120
Number of shells for each [l, nctr] group
    [0 1] : 42
    [0 3] : 22
    [0 5] : 10
    [1 1] : 32
    [1 3] : 10
    [2 1] : 10
Available GPU mem 37884.648550 Mb, block_size 16384
    CPU time for                                       solve 0 / 21      0.42 sec, wall time      0.71 sec, GPU time for    706.50 ms
    CPU time for                                       solve 1 / 21      0.01 sec, wall time      0.00 sec, GPU time for      6.64 ms
    CPU time for                                       solve 2 / 21      0.01 sec, wall time      0.00 sec, GPU time for      4.91 ms
    CPU time for                                       solve 3 / 21      0.01 sec, wall time      0.00 sec, GPU time for      4.27 ms
    CPU time for                                       solve 4 / 21      0.01 sec, wall time      0.00 sec, GPU time for      4.47 ms
    CPU time for                                       solve 5 / 21      0.01 sec, wall time      0.01 sec, GPU time for      5.38 ms
    CPU time for                                       solve 6 / 21      0.01 sec, wall time      0.01 sec, GPU time for      5.62 ms
    CPU time for                                       solve 7 / 21      0.01 sec, wall time      0.00 sec, GPU time for      4.68 ms
    CPU time for                                       solve 8 / 21      0.01 sec, wall time      0.00 sec, GPU time for      4.48 ms
    CPU time for                                       solve 9 / 21      0.01 sec, wall time      0.01 sec, GPU time for     10.29 ms
    CPU time for                                      solve 10 / 21      0.01 sec, wall time      0.01 sec, GPU time for      8.39 ms
    CPU time for                                      solve 11 / 21      0.01 sec, wall time      0.01 sec, GPU time for      5.47 ms
    CPU time for                                      solve 12 / 21      0.01 sec, wall time      0.01 sec, GPU time for      5.73 ms
    CPU time for                                      solve 13 / 21      0.01 sec, wall time      0.00 sec, GPU time for      5.19 ms
    CPU time for                                      solve 14 / 21      0.01 sec, wall time      0.01 sec, GPU time for      5.68 ms
    CPU time for                                      solve 15 / 21      0.01 sec, wall time      0.00 sec, GPU time for      4.71 ms
    CPU time for                                      solve 16 / 21      0.01 sec, wall time      0.01 sec, GPU time for      5.37 ms
    CPU time for                                           eval rho      0.49 sec, wall time      0.76 sec, GPU time for    763.72 ms
    CPU time for                                      solve 17 / 21      0.02 sec, wall time      0.03 sec, GPU time for     28.11 ms
    CPU time for                                      solve 18 / 21      0.00 sec, wall time      0.00 sec, GPU time for      3.40 ms
    CPU time for                                      solve 19 / 21      0.00 sec, wall time      0.00 sec, GPU time for      3.69 ms
    CPU time for                                      solve 20 / 21      0.01 sec, wall time      0.01 sec, GPU time for      7.24 ms
    CPU time for                                       cholesky_eri      0.73 sec, wall time      0.96 sec, GPU time for    963.20 ms
Drop grids 175399
prune_by_density_: 39 padding grids
    CPU time for                                   setting up grids      0.82 sec, wall time      1.08 sec, GPU time for   1074.95 ms
Number of shells for each [l, nctr] group
    [0 1] : 42
    [0 3] : 22
    [0 5] : 10
    [1 1] : 32
    [1 3] : 10
    [2 1] : 10
Available GPU mem 37909.335142 Mb, block_size 16384
    CPU time for                                           eval rho      0.08 sec, wall time      0.08 sec, GPU time for     76.83 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      4.75 ms
Available GPU mem 37880.136294 Mb, block_size 16384
    CPU time for                                    vxc integration      0.01 sec, wall time      0.01 sec, GPU time for     11.51 ms
    CPU time for                                            vxc tot      0.09 sec, wall time      0.10 sec, GPU time for     96.15 ms
GPU Memory 37.916 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.01 sec, GPU time for      5.38 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.01 sec, GPU time for      6.85 ms
E1 = -1549.8552728358036  Ecoul = 698.492456676146  Exc = -58.12443736565727
init E= -390.348786668665
    CPU time for                                         total prep      1.30 sec, wall time      1.43 sec, GPU time for   1434.66 ms
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      0.01 ms
    CPU time for                                                eig      0.00 sec, wall time      0.00 sec, GPU time for      4.96 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      2.70 ms
Available GPU mem 37906.214502 Mb, block_size 16384
    CPU time for                                           eval rho      0.02 sec, wall time      0.02 sec, GPU time for     21.94 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.12 ms
Available GPU mem 37877.397094 Mb, block_size 16384
    CPU time for                                    vxc integration      0.01 sec, wall time      0.01 sec, GPU time for     11.16 ms
    CPU time for                                            vxc tot      0.03 sec, wall time      0.03 sec, GPU time for     34.52 ms
GPU Memory 37.912 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for      1.41 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      1.76 ms
    CPU time for                                               veff      0.04 sec, wall time      0.04 sec, GPU time for     36.34 ms
E1 = -1567.0427138071243  Ecoul = 717.2401097553272  Exc = -59.41150076622705
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.56 ms
    CPU time for                                              total      0.04 sec, wall time      0.05 sec, GPU time for     47.05 ms
cycle= 1 E= -390.075637961374  delta_E= 0.273  |ddm|= 5.48
diis-norm(errvec)=1.96995
diis-c [-3.88071459  1.        ]
    CPU time for                                               DIIS      0.01 sec, wall time      0.01 sec, GPU time for     12.69 ms
    CPU time for                                                eig      0.00 sec, wall time      0.00 sec, GPU time for      4.97 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.77 ms
Available GPU mem 37905.695846 Mb, block_size 16384
    CPU time for                                           eval rho      0.02 sec, wall time      0.02 sec, GPU time for     22.29 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.08 ms
Available GPU mem 37876.878438 Mb, block_size 16384
    CPU time for                                    vxc integration      0.01 sec, wall time      0.01 sec, GPU time for     10.87 ms
    CPU time for                                            vxc tot      0.03 sec, wall time      0.03 sec, GPU time for     34.54 ms
GPU Memory 37.912 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for      1.42 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      1.76 ms
    CPU time for                                               veff      0.04 sec, wall time      0.04 sec, GPU time for     36.36 ms
E1 = -1541.67143435998  Ecoul = 690.1068555491973  Exc = -57.3697520454957
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.56 ms
    CPU time for                                              total      0.05 sec, wall time      0.06 sec, GPU time for     55.44 ms
cycle= 2 E= -389.795863999628  delta_E= 0.28  |ddm|= 2.65
diis-norm(errvec)=3.02988
diis-c [-0.04275172  0.60676131  0.39323869]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.08 ms
    CPU time for                                                eig      0.00 sec, wall time      0.00 sec, GPU time for      3.94 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.74 ms
Available GPU mem 37904.695398 Mb, block_size 16384
    CPU time for                                           eval rho      0.02 sec, wall time      0.02 sec, GPU time for     21.72 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.51 ms
Available GPU mem 37875.877990 Mb, block_size 16384
    CPU time for                                    vxc integration      0.01 sec, wall time      0.01 sec, GPU time for      9.57 ms
    CPU time for                                            vxc tot      0.03 sec, wall time      0.03 sec, GPU time for     33.09 ms
GPU Memory 37.911 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for      1.41 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      1.76 ms
    CPU time for                                               veff      0.03 sec, wall time      0.03 sec, GPU time for     34.91 ms
E1 = -1557.6135301126467  Ecoul = 706.7485288289723  Exc = -58.55925942442438
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.56 ms
    CPU time for                                              total      0.04 sec, wall time      0.04 sec, GPU time for     41.33 ms
cycle= 3 E= -390.285793851448  delta_E= -0.49  |ddm|= 1.71
diis-norm(errvec)=0.122156
diis-c [-0.00219026  0.19649023  0.13826233  0.66524745]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.20 ms
    CPU time for                                                eig      0.00 sec, wall time      0.00 sec, GPU time for      3.94 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.75 ms
Available GPU mem 37903.694950 Mb, block_size 16384
    CPU time for                                           eval rho      0.02 sec, wall time      0.02 sec, GPU time for     21.87 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.03 ms
Available GPU mem 37874.877542 Mb, block_size 16384
    CPU time for                                    vxc integration      0.01 sec, wall time      0.01 sec, GPU time for      9.60 ms
    CPU time for                                            vxc tot      0.03 sec, wall time      0.03 sec, GPU time for     32.79 ms
GPU Memory 37.910 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for      1.80 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      2.16 ms
    CPU time for                                               veff      0.03 sec, wall time      0.04 sec, GPU time for     35.01 ms
E1 = -1557.3638355897763  Ecoul = 706.4928513103354  Exc = -58.55381507639806
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.56 ms
    CPU time for                                              total      0.04 sec, wall time      0.04 sec, GPU time for     41.56 ms
cycle= 4 E= -390.286332499189  delta_E= -0.000539  |ddm|= 0.094
diis-norm(errvec)=0.0466078
diis-c [-3.27600632e-04  7.44830563e-02  5.55437010e-02  3.42461758e-01
  5.27511484e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.36 ms
    CPU time for                                                eig      0.00 sec, wall time      0.00 sec, GPU time for      3.92 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.74 ms
Available GPU mem 37902.694502 Mb, block_size 16384
    CPU time for                                           eval rho      0.02 sec, wall time      0.02 sec, GPU time for     21.79 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.04 ms
Available GPU mem 37873.877094 Mb, block_size 16384
    CPU time for                                    vxc integration      0.01 sec, wall time      0.01 sec, GPU time for      9.57 ms
    CPU time for                                            vxc tot      0.03 sec, wall time      0.03 sec, GPU time for     32.69 ms
GPU Memory 37.909 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for      1.40 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      1.75 ms
    CPU time for                                               veff      0.03 sec, wall time      0.03 sec, GPU time for     34.50 ms
E1 = -1557.3491923423983  Ecoul = 706.4762912612862  Exc = -58.55199882811932
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.55 ms
    CPU time for                                              total      0.04 sec, wall time      0.04 sec, GPU time for     41.17 ms
cycle= 5 E= -390.286433052581  delta_E= -0.000101  |ddm|= 0.0289
diis-norm(errvec)=0.0161478
diis-c [-1.15482999e-05  7.97543125e-03  7.97307933e-03  6.75854176e-02
  2.80152267e-01  6.36313804e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.49 ms
    CPU time for                                                eig      0.00 sec, wall time      0.00 sec, GPU time for      3.92 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.74 ms
Available GPU mem 37901.694054 Mb, block_size 16384
    CPU time for                                           eval rho      0.02 sec, wall time      0.02 sec, GPU time for     21.72 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.57 ms
Available GPU mem 37872.876646 Mb, block_size 16384
    CPU time for                                    vxc integration      0.01 sec, wall time      0.01 sec, GPU time for      9.80 ms
    CPU time for                                            vxc tot      0.03 sec, wall time      0.03 sec, GPU time for     33.37 ms
GPU Memory 37.908 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for      1.41 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      1.76 ms
    CPU time for                                               veff      0.03 sec, wall time      0.04 sec, GPU time for     35.19 ms
E1 = -1557.3326707693063  Ecoul = 706.4583361163911  Exc = -58.550578806435055
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.56 ms
    CPU time for                                              total      0.04 sec, wall time      0.04 sec, GPU time for     41.99 ms
cycle= 6 E= -390.2864466027  delta_E= -1.36e-05  |ddm|= 0.00971
diis-norm(errvec)=0.00292407
diis-c [-1.13432706e-06  1.63977300e-03  2.24640300e-03  2.06918683e-02
  1.11415890e-01  2.94693691e-01  5.69312375e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.63 ms
    CPU time for                                                eig      0.00 sec, wall time      0.00 sec, GPU time for      3.91 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.75 ms
Available GPU mem 37900.693606 Mb, block_size 16384
    CPU time for                                           eval rho      0.02 sec, wall time      0.02 sec, GPU time for     21.67 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      0.98 ms
Available GPU mem 37871.876198 Mb, block_size 16384
    CPU time for                                    vxc integration      0.01 sec, wall time      0.01 sec, GPU time for      9.60 ms
    CPU time for                                            vxc tot      0.03 sec, wall time      0.03 sec, GPU time for     32.52 ms
GPU Memory 37.907 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for      1.41 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      1.75 ms
    CPU time for                                               veff      0.03 sec, wall time      0.03 sec, GPU time for     34.34 ms
E1 = -1557.3283782866185  Ecoul = 706.4537826316424  Exc = -58.55031819308129
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.58 ms
    CPU time for                                              total      0.04 sec, wall time      0.04 sec, GPU time for     41.30 ms
cycle= 7 E= -390.286446991407  delta_E= -3.89e-07  |ddm|= 0.00207
diis-norm(errvec)=0.00106291
diis-c [-1.00558393e-07  1.69642073e-04  4.93118096e-04  4.38415209e-03
  3.05253571e-02  9.25534334e-02  3.09201558e-01  5.62672739e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.76 ms
    CPU time for                                                eig      0.00 sec, wall time      0.00 sec, GPU time for      3.90 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.74 ms
Available GPU mem 37899.693158 Mb, block_size 16384
    CPU time for                                           eval rho      0.02 sec, wall time      0.02 sec, GPU time for     21.74 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.02 ms
Available GPU mem 37870.875750 Mb, block_size 16384
    CPU time for                                    vxc integration      0.01 sec, wall time      0.01 sec, GPU time for      9.56 ms
    CPU time for                                            vxc tot      0.03 sec, wall time      0.03 sec, GPU time for     32.60 ms
GPU Memory 37.906 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for      1.41 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      1.76 ms
    CPU time for                                               veff      0.03 sec, wall time      0.03 sec, GPU time for     34.42 ms
E1 = -1557.3281684241242  Ecoul = 706.4535103035719  Exc = -58.55025578673301
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.56 ms
    CPU time for                                              total      0.04 sec, wall time      0.04 sec, GPU time for     41.50 ms
cycle= 8 E= -390.286447050635  delta_E= -5.92e-08  |ddm|= 0.00059
    CPU time for                                                SCF      1.66 sec, wall time      1.81 sec, GPU time for   1805.17 ms
converged SCF energy = -390.286447050635
Nuc-Nuc PySCF=  519.1384668566502
One electron integrals energy -1557.3281684241242
Coulomb energy  706.4535103035719
EXC  -58.55025578673301
PySCF time:  1.8822992481291294
PySCF Grid Size:  (773760,)
