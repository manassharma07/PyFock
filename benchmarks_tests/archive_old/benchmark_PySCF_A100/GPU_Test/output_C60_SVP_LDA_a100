#INFO: **** input file is /home/lu29vow/GPU_Test/pyscf_gpu.py ****
from pyscf import gto
from gpu4pyscf.dft import rks
import os
from timeit import default_timer as timer

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN
funcx = 1
funcc = 7

# LDA_X LDA_C_PW
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
# funcx = 101
# funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)

# basis_set_name = 'sto-2g'
# basis_set_name = 'sto-3g'
# basis_set_name = 'sto-6g'
# basis_set_name = '6-31G'
basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-SVPD'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'def2-QZVP'
# basis_set_name = 'def2-TZVPP'
# basis_set_name = 'def2-QZVPP'
# basis_set_name = 'def2-TZVPD'
# basis_set_name = 'def2-QZVPD'
# basis_set_name = 'def2-TZVPPD'
# basis_set_name = 'def2-QZVPPD'
# basis_set_name = 'cc-pVDZ'
# basis_set_name = 'ano-rcc'

auxbasis_name = 'def2-universal-jfit'
# auxbasis_name = 'def2-TZVP'
# auxbasis_name = 'sto-3g'
# auxbasis_name = 'def2-SVP'
# auxbasis_name = '6-31G'

# xyzFilename = 'Benzene-Fulvene_Dimer.xyz'
# xyzFilename = 'Adenine-Thymine.xyz'
# xyzFilename = 'Zn.xyz'
# xyzFilename = 'Zn_dimer.xyz'
# xyzFilename = 'TPP.xyz'
# xyzFilename = 'Zn_TPP.xyz'
# xyzFilename = 'H2O.xyz'

# xyzFilename = 'Caffeine.xyz'
# xyzFilename = 'Serotonin.xyz'
# xyzFilename = 'Cholesterol.xyz'
xyzFilename = 'C60.xyz'
# xyzFilename = 'Taxol.xyz'
# xyzFilename = 'Valinomycin.xyz'
# xyzFilename = 'Olestra.xyz'
# xyzFilename = 'Ubiquitin.xyz'

### 1D Carbon Alkanes
# xyzFilename = 'Ethane.xyz'
# xyzFilename = 'Decane_C10H22.xyz'
# xyzFilename = 'Icosane_C20H42.xyz'
# xyzFilename = 'Tetracontane_C40H82.xyz'
# xyzFilename = 'Pentacontane_C50H102.xyz'
# xyzFilename = 'Octacontane_C80H162.xyz'
# xyzFilename = 'Hectane_C100H202.xyz'
# xyzFilename = 'Icosahectane_C120H242.xyz'

### 2D Carbon
# xyzFilename = 'Graphene_C16.xyz'
# xyzFilename = 'Graphene_C76.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'

### 3d Carbon Fullerenes
# xyzFilename = 'C60.xyz'
# xyzFilename = 'C70.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'

molPySCF = gto.Mole()
molPySCF.atom = 'molecular-structures/'+xyzFilename
molPySCF.basis = basis_set_name
# molPySCF.cart = True
molPySCF.verbose = 6
#molPySCF.max_memory=25000
# molPySCF.incore_anyway = True # Keeps the PySCF ERI integrals incore
molPySCF.build()

print('\n\nPySCF Results\n\n')
start=timer()
mf = rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
mf.xc = funcidpyscf
mf.verbose = 7
mf.direct_scf = True
# mf.with_df.max_memory = 25000
# dmat_init = mf.init_guess_by_1e(molPySCF)
# dmat_init = mf.init_guess_by_huckel(molPySCF)
mf.init_guess = 'minao'
dmat_init = mf.init_guess_by_minao(molPySCF)
# mf.init_guess = 'atom'
# dmat_init = mf.init_guess_by_atom(molPySCF)
mf.max_cycle = 30
mf.conv_tol = 1e-7
mf.grids.level = 5
# print('begin df build')
# start_df_pyscf=timer()
# mf.with_df.build()
# duration_df_pyscf = timer()- start_df_pyscf
# print('PySCF df time: ', duration_df_pyscf)
# print('end df build')
energyPyscf = mf.kernel(dm0=dmat_init)
print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
print('One electron integrals energy',mf.scf_summary['e1'])
print('Coulomb energy ',mf.scf_summary['coul'])
print('EXC ',mf.scf_summary['exc'])
duration = timer()-start
print('PySCF time: ', duration)
pyscfGrids = mf.grids
print('PySCF Grid Size: ', pyscfGrids.weights.shape)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='gpu006.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64')  Threads 2
Python 3.10.13 (tags/v3.10.13-25-g07fbd8e9251-dirty:07fbd8e9251, Sep 27 2023, 23:32:09) [GCC 13.2.0]
numpy 1.26.3  scipy 1.12.0
Date: Wed Jan 31 21:11:41 2024
PySCF version 2.4.0
PySCF path  /home/lu29vow/.conda/envs/PySCF_GPU/lib/python3.10/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 6
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 60
[INPUT] num. electrons = 360
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      0.725906000000  -0.999124000000   3.322588000000 AA    1.371763532179  -1.888070724480   6.278781344766 Bohr   0.0
[INPUT]  2 C     -0.725906000000  -0.999124000000   3.322588000000 AA   -1.371763532179  -1.888070724480   6.278781344766 Bohr   0.0
[INPUT]  3 C     -1.422153000000  -1.957425000000   2.590511000000 AA   -2.687479677229  -3.698997159377   4.895356312673 Bohr   0.0
[INPUT]  4 C     -0.696247000000  -2.956549000000   1.827248000000 AA   -1.315716145050  -5.587067883857   3.452998281659 Bohr   0.0
[INPUT]  5 C      0.696247000000  -2.956549000000   1.827248000000 AA    1.315716145050  -5.587067883857   3.452998281659 Bohr   0.0
[INPUT]  6 C      1.422153000000  -1.957425000000   2.590511000000 AA    2.687479677229  -3.698997159377   4.895356312673 Bohr   0.0
[INPUT]  7 C      1.174541000000   0.381631000000   3.322588000000 AA    2.219560812073   0.721178070644   6.278781344766 Bohr   0.0
[INPUT]  8 C      0.000000000000   1.234985000000   3.322588000000 AA    0.000000000000   2.333783417946   6.278781344766 Bohr   0.0
[INPUT]  9 C     -1.174541000000   0.381631000000   3.322588000000 AA   -2.219560812073   0.721178070644   6.278781344766 Bohr   0.0
[INPUT] 10 C     -2.301092000000   0.747670000000   2.590511000000 AA   -4.348433667428   1.412891531554   4.895356312673 Bohr   0.0
[INPUT] 11 C     -2.596693000000  -1.575794000000   1.827248000000 AA   -4.907038599575  -2.977819088733   3.452998281659 Bohr   0.0
[INPUT] 12 C     -1.422153000000  -3.192411000000   0.592263000000 AA   -2.687479677229  -6.032782467049   1.119214863713 Bohr   0.0
[INPUT] 13 C     -0.725906000000  -3.418635000000  -0.592263000000 AA   -1.371763532179  -6.460283869852  -1.119214863713 Bohr   0.0
[INPUT] 14 C      0.725906000000  -3.418635000000  -0.592263000000 AA    1.371763532179  -6.460283869852  -1.119214863713 Bohr   0.0
[INPUT] 15 C      1.422153000000  -3.192411000000   0.592263000000 AA    2.687479677229  -6.032782467049   1.119214863713 Bohr   0.0
[INPUT] 16 C      2.596693000000  -2.339057000000   0.592263000000 AA    4.907038599575  -4.420177119747   1.119214863713 Bohr   0.0
[INPUT] 17 C      2.596693000000  -1.575794000000   1.827248000000 AA    4.907038599575  -2.977819088733   3.452998281659 Bohr   0.0
[INPUT] 18 C      3.026998000000  -0.251454000000   1.827248000000 AA    5.720197199606  -0.475179192926   3.452998281659 Bohr   0.0
[INPUT] 19 C      2.301092000000   0.747670000000   2.590511000000 AA    4.348433667428   1.412891531554   4.895356312673 Bohr   0.0
[INPUT] 20 C      0.000000000000   2.419511000000   2.590511000000 AA    0.000000000000   4.572213145373   4.895356312673 Bohr   0.0
[INPUT] 21 C      1.174541000000   2.801142000000   1.827248000000 AA    2.219560812073   5.293391216016   3.452998281659 Bohr   0.0
[INPUT] 22 C      2.301092000000   1.982655000000   1.827248000000 AA    4.348433667428   3.746674949500   3.452998281659 Bohr   0.0
[INPUT] 23 C      3.026998000000   1.746794000000   0.592263000000 AA    5.720197199606   3.300962256034   1.119214863713 Bohr   0.0
[INPUT] 24 C      3.475632000000   0.366039000000   0.592263000000 AA    6.567992589774   0.691713460910   1.119214863713 Bohr   0.0
[INPUT] 25 C      3.475632000000  -0.366039000000  -0.592263000000 AA    6.567992589774  -0.691713460910  -1.119214863713 Bohr   0.0
[INPUT] 26 C      3.026998000000  -1.746794000000  -0.592263000000 AA    5.720197199606  -3.300962256034  -1.119214863713 Bohr   0.0
[INPUT] 27 C      2.301092000000  -1.982655000000  -1.827248000000 AA    4.348433667428  -3.746674949500  -3.452998281659 Bohr   0.0
[INPUT] 28 C      1.174541000000  -2.801142000000  -1.827248000000 AA    2.219560812073  -5.293391216016  -3.452998281659 Bohr   0.0
[INPUT] 29 C     -2.596693000000  -2.339057000000   0.592263000000 AA   -4.907038599575  -4.420177119747   1.119214863713 Bohr   0.0
[INPUT] 30 C     -1.174541000000  -0.381631000000  -3.322588000000 AA   -2.219560812073  -0.721178070644  -6.278781344766 Bohr   0.0
[INPUT] 31 C     -2.301092000000  -0.747670000000  -2.590511000000 AA   -4.348433667428  -1.412891531554  -4.895356312673 Bohr   0.0
[INPUT] 32 C     -3.026998000000   0.251454000000  -1.827248000000 AA   -5.720197199606   0.475179192926  -3.452998281659 Bohr   0.0
[INPUT] 33 C     -2.596693000000   1.575794000000  -1.827248000000 AA   -4.907038599575   2.977819088733  -3.452998281659 Bohr   0.0
[INPUT] 34 C     -1.422153000000   1.957425000000  -2.590511000000 AA   -2.687479677229   3.698997159377  -4.895356312673 Bohr   0.0
[INPUT] 35 C      0.725906000000   0.999124000000  -3.322588000000 AA    1.371763532179   1.888070724480  -6.278781344766 Bohr   0.0
[INPUT] 36 C      1.174541000000  -0.381631000000  -3.322588000000 AA    2.219560812073  -0.721178070644  -6.278781344766 Bohr   0.0
[INPUT] 37 C      0.000000000000  -1.234985000000  -3.322588000000 AA    0.000000000000  -2.333783417946  -6.278781344766 Bohr   0.0
[INPUT] 38 C      0.000000000000  -2.419511000000  -2.590511000000 AA    0.000000000000  -4.572213145373  -4.895356312673 Bohr   0.0
[INPUT] 39 C     -1.174541000000  -2.801142000000  -1.827248000000 AA   -2.219560812073  -5.293391216016  -3.452998281659 Bohr   0.0
[INPUT] 40 C     -2.301092000000  -1.982655000000  -1.827248000000 AA   -4.348433667428  -3.746674949500  -3.452998281659 Bohr   0.0
[INPUT] 41 C     -3.475632000000  -0.366039000000  -0.592263000000 AA   -6.567992589774  -0.691713460910  -1.119214863713 Bohr   0.0
[INPUT] 42 C     -3.475632000000   0.366039000000   0.592263000000 AA   -6.567992589774   0.691713460910   1.119214863713 Bohr   0.0
[INPUT] 43 C     -3.026998000000   1.746794000000   0.592263000000 AA   -5.720197199606   3.300962256034   1.119214863713 Bohr   0.0
[INPUT] 44 C     -2.596693000000   2.339057000000  -0.592263000000 AA   -4.907038599575   4.420177119747  -1.119214863713 Bohr   0.0
[INPUT] 45 C     -1.422153000000   3.192411000000  -0.592263000000 AA   -2.687479677229   6.032782467049  -1.119214863713 Bohr   0.0
[INPUT] 46 C     -0.696247000000   2.956549000000  -1.827248000000 AA   -1.315716145050   5.587067883857  -3.452998281659 Bohr   0.0
[INPUT] 47 C      0.696247000000   2.956549000000  -1.827248000000 AA    1.315716145050   5.587067883857  -3.452998281659 Bohr   0.0
[INPUT] 48 C      1.422153000000   1.957425000000  -2.590511000000 AA    2.687479677229   3.698997159377  -4.895356312673 Bohr   0.0
[INPUT] 49 C      2.301092000000  -0.747670000000  -2.590511000000 AA    4.348433667428  -1.412891531554  -4.895356312673 Bohr   0.0
[INPUT] 50 C      3.026998000000   0.251454000000  -1.827248000000 AA    5.720197199606   0.475179192926  -3.452998281659 Bohr   0.0
[INPUT] 51 C      2.596693000000   1.575794000000  -1.827248000000 AA    4.907038599575   2.977819088733  -3.452998281659 Bohr   0.0
[INPUT] 52 C      2.596693000000   2.339057000000  -0.592263000000 AA    4.907038599575   4.420177119747  -1.119214863713 Bohr   0.0
[INPUT] 53 C      1.422153000000   3.192411000000  -0.592263000000 AA    2.687479677229   6.032782467049  -1.119214863713 Bohr   0.0
[INPUT] 54 C      0.725906000000   3.418635000000   0.592263000000 AA    1.371763532179   6.460283869852   1.119214863713 Bohr   0.0
[INPUT] 55 C     -0.725906000000   3.418635000000   0.592263000000 AA   -1.371763532179   6.460283869852   1.119214863713 Bohr   0.0
[INPUT] 56 C     -1.174541000000   2.801142000000   1.827248000000 AA   -2.219560812073   5.293391216016   3.452998281659 Bohr   0.0
[INPUT] 57 C     -2.301092000000   1.982655000000   1.827248000000 AA   -4.348433667428   3.746674949500   3.452998281659 Bohr   0.0
[INPUT] 58 C     -3.026998000000  -1.746794000000  -0.592263000000 AA   -5.720197199606  -3.300962256034  -1.119214863713 Bohr   0.0
[INPUT] 59 C     -3.026998000000  -0.251454000000   1.827248000000 AA   -5.720197199606  -0.475179192926   3.452998281659 Bohr   0.0
[INPUT] 60 C     -0.725906000000   0.999124000000  -3.322588000000 AA   -1.371763532179   1.888070724480  -6.278781344766 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] C
[INPUT] 0    0    [5    /1   ]  1238.4016938      0.0054568832082
                                186.29004992      0.040638409211
                                42.251176346      0.18025593888
                                11.676557932      0.46315121755
                                3.5930506482      0.44087173314
[INPUT] 0    0    [1    /1   ]  0.40245147363        1
[INPUT] 0    0    [1    /1   ]  0.13090182668        1
[INPUT] 1    0    [3    /1   ]  9.4680970621      0.038387871728
                                2.0103545142      0.21117025112
                                0.54771004707     0.51328172114
[INPUT] 1    0    [1    /1   ]  0.15268613795        1
[INPUT] 2    0    [1    /1   ]  0.8                  1

nuclear repulsion = 8339.14795085143
number of shells = 360
number of NR pGTOs = 1440
number of NR cGTOs = 840
basis = def2-SVP
ecp = {}
CPU time:         1.86


PySCF Results


Initial guess from minao.


******** <class 'gpu4pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'gpu4pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 30
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /tmp/tmpuasv4o20
max_memory 4000 MB (current use 1765 MB)
XC library pyscf.dft.libxc version 6.1.0
    unable to decode the reference due to https://github.com/NVIDIA/cuda-python/issues/29
XC functionals = 1,7
    P. A. M. Dirac.,  Math. Proc. Cambridge Philos. Soc. 26, 376 (1930)
    F. Bloch.,  Z. Phys. 57, 545 (1929)
    S. H. Vosko, L. Wilk, and M. Nusair.,  Can. J. Phys. 58, 1200 (1980)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14acb10a08b0>
grids dens level: 5
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14acb10a0790>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
num shells = 900, num cGTOs = 2940
    CPU time for                                               2c2e      0.67 sec, wall time      0.34 sec, GPU time for    346.98 ms
Number of shells for each [l, nctr] group
    [0 1] : 120
    [0 5] : 60
    [1 1] : 60
    [1 3] : 60
    [2 1] : 60
Number of shells for each [l, nctr] group
    [0 1] : 300
    [0 7] : 60
    [1 1] : 180
    [1 2] : 60
    [2 1] : 120
    [2 2] : 60
    [3 2] : 60
    [4 1] : 60
    CPU time for                                  Initialize q_cond      0.29 sec, wall time      0.15 sec, GPU time for    147.21 ms
    CPU time for                                        Get pairing      0.00 sec, wall time      0.00 sec, GPU time for      2.51 ms
    CPU time for                                  AO cart2sph coeff      0.03 sec, wall time      0.02 sec, GPU time for     16.62 ms
    CPU time for                                 aux cart2sph coeff      0.02 sec, wall time      0.01 sec, GPU time for     11.75 ms
    CPU time for                                       Get AO pairs      0.03 sec, wall time      0.02 sec, GPU time for     16.89 ms
atom C rad-grids = 105, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50
  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86
  86  86  86  86  86  86  86  86  86  86 590 590 590 590 590 590 590 590
 590 770 770 770 770 770 770 770 770 770 770 770 770 770 770 770 770 770
 770 770 770 770 770 770 770 770 770 770 770 590 590 590 590 590 590 590
 590 590 590 590 590 590 590 590 590 590 590 590 590 590 590]
    CPU time for                               Initialize GPU cache      0.04 sec, wall time      0.04 sec, GPU time for     41.48 ms
    CPU time for                                     prepare intopt      0.45 sec, wall time      0.25 sec, GPU time for    243.46 ms
size of aux basis 2940
Padding 104 grids
tot grids = 2557184
Number of shells for each [l, nctr] group
    [0 1] : 120
    [0 5] : 60
    [1 1] : 60
    [1 3] : 60
    [2 1] : 60
Available GPU mem 30612.244070 Mb, block_size 16384
    CPU time for                                       solve 0 / 21      0.82 sec, wall time      1.05 sec, GPU time for   1050.77 ms
    CPU time for                                       solve 1 / 21      0.02 sec, wall time      0.02 sec, GPU time for     16.74 ms
    CPU time for                                       solve 2 / 21      0.01 sec, wall time      0.01 sec, GPU time for      6.81 ms
    CPU time for                                       solve 3 / 21      0.02 sec, wall time      0.01 sec, GPU time for     36.57 ms
    CPU time for                                       solve 4 / 21      0.03 sec, wall time      0.02 sec, GPU time for     24.39 ms
    CPU time for                                       solve 5 / 21      0.01 sec, wall time      0.01 sec, GPU time for     34.13 ms
    CPU time for                                       solve 6 / 21      0.01 sec, wall time      0.01 sec, GPU time for     33.76 ms
    CPU time for                                       solve 7 / 21      0.01 sec, wall time      0.01 sec, GPU time for     15.80 ms
    CPU time for                                       solve 8 / 21      0.02 sec, wall time      0.02 sec, GPU time for     56.42 ms
    CPU time for                                       solve 9 / 21      0.02 sec, wall time      0.02 sec, GPU time for     33.27 ms
    CPU time for                                      solve 10 / 21      0.01 sec, wall time      0.01 sec, GPU time for     38.08 ms
    CPU time for                                      solve 11 / 21      0.01 sec, wall time      0.01 sec, GPU time for     13.85 ms
    CPU time for                                      solve 12 / 21      0.03 sec, wall time      0.03 sec, GPU time for     66.91 ms
    CPU time for                                      solve 13 / 21      0.03 sec, wall time      0.31 sec, GPU time for    337.92 ms
    CPU time for                                      solve 14 / 21      0.03 sec, wall time      0.03 sec, GPU time for     45.39 ms
    CPU time for                                      solve 15 / 21      0.01 sec, wall time      0.01 sec, GPU time for     20.65 ms
    CPU time for                                      solve 16 / 21      0.01 sec, wall time      0.01 sec, GPU time for     10.20 ms
    CPU time for                                      solve 17 / 21      0.03 sec, wall time      0.03 sec, GPU time for     32.20 ms
    CPU time for                                      solve 18 / 21      0.02 sec, wall time      0.01 sec, GPU time for     25.90 ms
    CPU time for                                      solve 19 / 21      0.02 sec, wall time      0.01 sec, GPU time for     23.12 ms
    CPU time for                                      solve 20 / 21      0.01 sec, wall time      0.01 sec, GPU time for     12.23 ms
    CPU time for                                       cholesky_eri      2.21 sec, wall time      2.21 sec, GPU time for   2202.81 ms
    CPU time for                                           eval rho      1.39 sec, wall time      1.30 sec, GPU time for   1304.23 ms
Drop grids 560796
prune_by_density_: 28 padding grids
    CPU time for                                   setting up grids      2.25 sec, wall time      2.49 sec, GPU time for   2483.17 ms
Number of shells for each [l, nctr] group
    [0 1] : 120
    [0 5] : 60
    [1 1] : 60
    [1 3] : 60
    [2 1] : 60
Available GPU mem 31119.810150 Mb, block_size 16384
    CPU time for                                           eval rho      0.35 sec, wall time      0.35 sec, GPU time for    354.37 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      3.76 ms
Available GPU mem 30986.034790 Mb, block_size 16384
    CPU time for                                    vxc integration      0.11 sec, wall time      0.11 sec, GPU time for    110.51 ms
    CPU time for                                            vxc tot      0.47 sec, wall time      0.47 sec, GPU time for    471.30 ms
GPU Memory 31.133 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for     11.98 ms
    CPU time for                                           jk total      0.01 sec, wall time      0.01 sec, GPU time for     13.48 ms
E1 = -19691.814185657433  Ecoul = 9380.799706339189  Exc = -306.13326877583955
init E= -2277.99979724266
    CPU time for                                         total prep      4.14 sec, wall time      3.76 sec, GPU time for   3764.80 ms
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      0.02 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.44 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      2.49 ms
Available GPU mem 31080.053350 Mb, block_size 16384
    CPU time for                                           eval rho      0.07 sec, wall time      0.07 sec, GPU time for     66.02 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.56 ms
Available GPU mem 30948.006502 Mb, block_size 16384
    CPU time for                                    vxc integration      0.11 sec, wall time      0.11 sec, GPU time for    110.56 ms
    CPU time for                                            vxc tot      0.18 sec, wall time      0.18 sec, GPU time for    178.45 ms
GPU Memory 31.093 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for     10.69 ms
    CPU time for                                           jk total      0.01 sec, wall time      0.01 sec, GPU time for     11.05 ms
    CPU time for                                               veff      0.19 sec, wall time      0.19 sec, GPU time for    189.56 ms
E1 = -19724.914733329002  Ecoul = 9427.92016896488  Exc = -306.45260894825196
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.65 ms
    CPU time for                                              total      0.21 sec, wall time      0.21 sec, GPU time for    211.10 ms
cycle= 1 E= -2264.29922246095  delta_E= 13.7  |ddm|= 14.6
diis-norm(errvec)=1.98972
diis-c [-3.95898863  1.        ]
    CPU time for                                               DIIS      0.01 sec, wall time      0.01 sec, GPU time for     12.53 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.46 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.88 ms
Available GPU mem 31069.165670 Mb, block_size 16384
    CPU time for                                           eval rho      0.07 sec, wall time      0.07 sec, GPU time for     65.78 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.31 ms
Available GPU mem 30937.118822 Mb, block_size 16384
    CPU time for                                    vxc integration      0.11 sec, wall time      0.11 sec, GPU time for    110.28 ms
    CPU time for                                            vxc tot      0.18 sec, wall time      0.18 sec, GPU time for    177.67 ms
GPU Memory 31.082 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for     10.71 ms
    CPU time for                                           jk total      0.01 sec, wall time      0.01 sec, GPU time for     11.07 ms
    CPU time for                                               veff      0.19 sec, wall time      0.19 sec, GPU time for    188.81 ms
E1 = -19654.81654494586  Ecoul = 9355.575120091004  Exc = -303.97518331114077
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.64 ms
    CPU time for                                              total      0.21 sec, wall time      0.22 sec, GPU time for    218.43 ms
cycle= 2 E= -2264.06865731457  delta_E= 0.231  |ddm|= 6.72
diis-norm(errvec)=3.25997
diis-c [-0.3294234   0.62747938  0.37252062]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.20 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.74 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      1.09 ms
Available GPU mem 31057.876070 Mb, block_size 16384
    CPU time for                                           eval rho      0.07 sec, wall time      0.07 sec, GPU time for     66.07 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.30 ms
Available GPU mem 30925.829222 Mb, block_size 16384
    CPU time for                                    vxc integration      0.11 sec, wall time      0.11 sec, GPU time for    110.43 ms
    CPU time for                                            vxc tot      0.18 sec, wall time      0.18 sec, GPU time for    178.10 ms
GPU Memory 31.070 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for     10.91 ms
    CPU time for                                           jk total      0.01 sec, wall time      0.01 sec, GPU time for     11.27 ms
    CPU time for                                               veff      0.19 sec, wall time      0.19 sec, GPU time for    189.46 ms
E1 = -19699.24616604558  Ecoul = 9400.653896582699  Exc = -305.0488345839778
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.65 ms
    CPU time for                                              total      0.21 sec, wall time      0.21 sec, GPU time for    208.25 ms
cycle= 3 E= -2264.49315319543  delta_E= -0.424  |ddm|= 6.59
diis-norm(errvec)=0.403082
diis-c [-0.00402604  0.18613007  0.16238898  0.65148095]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.36 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.72 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.87 ms
Available GPU mem 31046.586470 Mb, block_size 16384
    CPU time for                                           eval rho      0.07 sec, wall time      0.07 sec, GPU time for     65.74 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.78 ms
Available GPU mem 30914.539622 Mb, block_size 16384
    CPU time for                                    vxc integration      0.11 sec, wall time      0.11 sec, GPU time for    110.52 ms
    CPU time for                                            vxc tot      0.18 sec, wall time      0.18 sec, GPU time for    178.33 ms
GPU Memory 31.059 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for     10.74 ms
    CPU time for                                           jk total      0.01 sec, wall time      0.01 sec, GPU time for     11.10 ms
    CPU time for                                               veff      0.19 sec, wall time      0.19 sec, GPU time for    189.51 ms
E1 = -19698.339672303882  Ecoul = 9399.925315263295  Exc = -305.23400782971567
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.64 ms
    CPU time for                                              total      0.21 sec, wall time      0.21 sec, GPU time for    208.21 ms
cycle= 4 E= -2264.50041401888  delta_E= -0.00726  |ddm|= 1.07
diis-norm(errvec)=0.0347009
diis-c [-3.45504627e-05  7.46217887e-03  1.98429073e-02  8.61372914e-02
  8.86557622e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.50 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.47 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.87 ms
Available GPU mem 31035.296870 Mb, block_size 16384
    CPU time for                                           eval rho      0.07 sec, wall time      0.07 sec, GPU time for     65.85 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.28 ms
Available GPU mem 30903.250022 Mb, block_size 16384
    CPU time for                                    vxc integration      0.11 sec, wall time      0.11 sec, GPU time for    110.27 ms
    CPU time for                                            vxc tot      0.18 sec, wall time      0.18 sec, GPU time for    177.72 ms
GPU Memory 31.048 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for     10.72 ms
    CPU time for                                           jk total      0.01 sec, wall time      0.01 sec, GPU time for     11.09 ms
    CPU time for                                               veff      0.19 sec, wall time      0.19 sec, GPU time for    188.87 ms
E1 = -19697.620656302613  Ecoul = 9399.16954211696  Exc = -305.1973483973417
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.64 ms
    CPU time for                                              total      0.21 sec, wall time      0.21 sec, GPU time for    207.46 ms
cycle= 5 E= -2264.50051173157  delta_E= -9.77e-05  |ddm|= 0.0688
diis-norm(errvec)=0.00469007
diis-c [-1.71879210e-07  3.92441046e-04  1.05022386e-03  1.13361282e-02
  1.14083546e-01  8.73137660e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.61 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.70 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.86 ms
Available GPU mem 31024.007270 Mb, block_size 16384
    CPU time for                                           eval rho      0.07 sec, wall time      0.07 sec, GPU time for     67.99 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.29 ms
Available GPU mem 30891.960422 Mb, block_size 16384
    CPU time for                                    vxc integration      0.11 sec, wall time      0.11 sec, GPU time for    110.35 ms
    CPU time for                                            vxc tot      0.18 sec, wall time      0.18 sec, GPU time for    179.96 ms
GPU Memory 31.037 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for     10.78 ms
    CPU time for                                           jk total      0.01 sec, wall time      0.01 sec, GPU time for     11.15 ms
    CPU time for                                               veff      0.19 sec, wall time      0.19 sec, GPU time for    191.18 ms
E1 = -19697.68909740532  Ecoul = 9399.239656387634  Exc = -305.19902259742094
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.63 ms
    CPU time for                                              total      0.21 sec, wall time      0.21 sec, GPU time for    210.09 ms
cycle= 6 E= -2264.50051276368  delta_E= -1.03e-06  |ddm|= 0.0129
diis-norm(errvec)=0.00109888
diis-c [-5.94198484e-08  2.78330047e-04  7.45140984e-04  8.37915538e-03
  8.42018150e-02  6.66909260e-01  2.39486299e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.78 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.76 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.86 ms
Available GPU mem 31012.717670 Mb, block_size 16384
    CPU time for                                           eval rho      0.07 sec, wall time      0.07 sec, GPU time for     65.73 ms
    CPU time for                                           eval vxc      0.00 sec, wall time      0.00 sec, GPU time for      1.54 ms
Available GPU mem 30880.670822 Mb, block_size 16384
    CPU time for                                    vxc integration      0.11 sec, wall time      0.11 sec, GPU time for    110.26 ms
    CPU time for                                            vxc tot      0.18 sec, wall time      0.18 sec, GPU time for    177.82 ms
GPU Memory 31.025 GB available, block size = 128
    CPU time for                                          vj and vk      0.00 sec, wall time      0.00 sec, GPU time for     10.82 ms
    CPU time for                                           jk total      0.01 sec, wall time      0.01 sec, GPU time for     11.18 ms
    CPU time for                                               veff      0.19 sec, wall time      0.19 sec, GPU time for    189.07 ms
E1 = -19697.688983153195  Ecoul = 9399.239541483874  Exc = -305.1990220261522
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.64 ms
    CPU time for                                              total      0.21 sec, wall time      0.21 sec, GPU time for    208.22 ms
cycle= 7 E= -2264.50051284405  delta_E= -8.04e-08  |ddm|= 0.00131
    CPU time for                                                SCF      5.62 sec, wall time      5.26 sec, GPU time for   5263.24 ms
converged SCF energy = -2264.50051284405
Nuc-Nuc PySCF=  8339.147950851428
One electron integrals energy -19697.688983153195
Coulomb energy  9399.239541483874
EXC  -305.1990220261522
PySCF time:  5.581796143203974
PySCF Grid Size:  (1996416,)
