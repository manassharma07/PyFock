Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 73F3 16-Core Processor
Number of Cores: 32
Number of Threads: 64
Memory (GB): 503.74189376831055
Number of cores being actually used/requested for the benchmark: 2
Confirming that the environment variables are properly set...
OMP_NUM_THREADS = 2
OPENBLAS_NUM_THREADS = 2
MKL_NUM_THREADS = 2
VECLIB_MAXIMUM_THREADS = 2
NUMEXPR_NUM_THREADS = 2
PYSCF_MAX_MEMORY = 225000
#INFO: **** input file is /home/lu29vow/GPU_Test/tmp_dir/PyFock/benchmarks_tests/bench_PySCF_vs_PyFock_GPU.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
numba.config.THREADING_LAYER='omp'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 2
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(225000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf
from gpu4pyscf import dft as dft_gpu

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)

# basis_set_name = 'sto-2g'
# basis_set_name = 'sto-3g'
# basis_set_name = 'sto-6g'
# basis_set_name = '6-31G'
basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-SVPD'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'def2-QZVP'
# basis_set_name = 'def2-TZVPP'
# basis_set_name = 'def2-QZVPP'
# basis_set_name = 'def2-TZVPD'
# basis_set_name = 'def2-QZVPD'
# basis_set_name = 'def2-TZVPPD'
# basis_set_name = 'def2-QZVPPD'
# basis_set_name = 'cc-pVDZ'
# basis_set_name = 'ano-rcc'

auxbasis_name = 'def2-universal-jfit'
# auxbasis_name = 'def2-universal-jkfit'
# auxbasis_name = 'def2-TZVP'
# auxbasis_name = 'sto-3g'
# auxbasis_name = 'def2-SVP'
# auxbasis_name = '6-31G'

# xyzFilename = 'Benzene-Fulvene_Dimer.xyz'
# xyzFilename = 'Adenine-Thymine.xyz'
# xyzFilename = 'Zn.xyz'
# xyzFilename = 'Zn_dimer.xyz'
# xyzFilename = 'TPP.xyz'
xyzFilename = 'Zn_TPP.xyz'
# xyzFilename = 'H2O.xyz'

# xyzFilename = 'Caffeine.xyz'
# xyzFilename = 'Serotonin.xyz'
# xyzFilename = 'Cholesterol.xyz'
# xyzFilename = 'C60.xyz'
# xyzFilename = 'Taxol.xyz'
# xyzFilename = 'Valinomycin.xyz'
# xyzFilename = 'Olestra.xyz'
# xyzFilename = 'Ubiquitin.xyz'

### 1D Carbon Alkanes
# xyzFilename = 'Ethane.xyz'
# xyzFilename = 'Decane_C10H22.xyz'
# xyzFilename = 'Icosane_C20H42.xyz'
# xyzFilename = 'Tetracontane_C40H82.xyz'
# xyzFilename = 'Pentacontane_C50H102.xyz'
# xyzFilename = 'Octacontane_C80H162.xyz'
# xyzFilename = 'Hectane_C100H202.xyz'
# xyzFilename = 'Icosahectane_C120H242.xyz'

### 2D Carbon
# xyzFilename = 'Graphene_C16.xyz'
# xyzFilename = 'Graphene_C76.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'

### 3d Carbon Fullerenes
# xyzFilename = 'C60.xyz'
# xyzFilename = 'C70.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'


# ---------PySCF---------------
#Comparison with PySCF
molPySCF = gto.Mole()
molPySCF.atom = xyzFilename
molPySCF.basis = basis_set_name
molPySCF.cart = False
molPySCF.verbose = 4
molPySCF.max_memory=25000
# molPySCF.incore_anyway = True # Keeps the PySCF ERI integrals incore
molPySCF.build()
#print(molPySCF.cart_labels())

print('\n\nPySCF Results\n\n')
start=timer()
mf = dft_gpu.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
# mf = scf.RHF(molPySCF).density_fit(auxbasis=auxbasis_name)
mf.xc = funcidpyscf
mf.verbose = 6
# dmat_init = mf.init_guess_by_1e(molPySCF)
# dmat_init = mf.init_guess_by_huckel(molPySCF)
mf.init_guess = 'minao'
dmat_init = mf.init_guess_by_minao(molPySCF)
# mf.init_guess = 'atom'
# dmat_init = mf.init_guess_by_atom(molPySCF)
mf.max_cycle = 30
mf.conv_tol = 1e-7
mf.grids.level = 5
energyPyscf = mf.kernel(dm0=dmat_init)
print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
print('One electron integrals energy',mf.scf_summary['e1'])
print('Coulomb energy ',mf.scf_summary['coul'])
print('EXC ',mf.scf_summary['exc'])
duration = timer()-start
print('PySCF time: ', duration)
pyscfGrids = mf.grids
print('PySCF Grid Size: ', pyscfGrids.weights.shape)
mf = 0#None

# Get an initial guess for dmat from PySCF using CAO basis (Need to use CPU pyscf for this as GPU version oesnt support SAO yet)
molPySCF.cart = True
molPySCF.build()
mf2 = dft_gpu.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
mf2.init_guess = 'minao'
dmat_init = mf2.init_guess_by_minao(molPySCF)
import cupy as cp
cp._default_memory_pool.free_all_blocks()

import psutil

# Get memory information
memory_info = psutil.virtual_memory()

# Convert bytes to human-readable format
used_memory = psutil._common.bytes2human(memory_info.used)


# If you want to print in a more human-readable format, you can use psutil's utility function
print(f"Currently Used memory: {used_memory}")
#--------------------CrysX --------------------------

#Initialize a Mol object with somewhat large geometry
molCrysX = Mol(coordfile=xyzFilename)
print('\n\nNatoms :',molCrysX.natoms)
# print(molCrysX.coordsBohrs)

#Initialize a Basis object with a very large basis set
basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})
print('\n\nNAO :',basis.bfs_nao)

auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})
print('\n\naux NAO :',auxbasis.bfs_nao)

dftObj = DFT(molCrysX, basis, xc=funcidcrysx)
# GPU acceleration
dftObj.use_gpu = True
dftObj.keep_ao_in_gpu = False
dftObj.use_libxc = False
dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
dftObj.n_gpus = 1 # Specify the number of GPUs
dftObj.free_gpu_mem = True
dftObj.threads_x = 32
dftObj.threads_y = 32
dftObj.dynamic_precision = False
dftObj.keep_ints3c2e_in_gpu = True
# SAO or CAO basis
dftObj.sao = False
# print(dmat_init)
# Using PySCF grids to compare the energies
energyCrysX, dmat = dftObj.scf(max_itr=35, ncores=ncores, dmat=dmat_init, conv_crit=1.0E-7, grids=pyscfGrids, \
                               isDF=True, auxbasis=auxbasis, rys=True, DF_algo=10, blocksize=51200, XC_algo=3, debug=False, \
                                sortGrids=False, save_ao_values=False, xc_bf_screen=True, threshold_schwarz=1e-9, \
                                strict_schwarz=False, cholesky=True, orthogonalize=True)
# print(dmat)

# Using CrysX grids 
# To get the same energies as PySCF (level=5) upto 1e-7 au, use the following settings
# radial_precision=1.0e-13
# level=3
# pruning by density with threshold = 1e-011
# alpha_min and alpha_max corresponding to QZVP
# energyCrysX, dmat = dftObj.scf(max_itr=30, ncores=ncores, dmat=dmat_init, grids=None, gridsLevel=3, isDF=True, auxbasis=auxbasis,
#                             rys=True, DF_algo=6, blocksize=5000, XC_algo=2, debug=False, sortGrids=False, save_ao_values=True,
#                             xc_bf_screen=True,threshold_schwarz=1e-9)


print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf[0]))

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='gpu016.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64')  Threads 2
Python 3.10.13 (tags/v3.10.13-25-g07fbd8e9251-dirty:07fbd8e9251, Sep 27 2023, 23:32:09) [GCC 13.2.0]
numpy 1.26.3  scipy 1.10.1
Date: Sun Feb  4 11:45:51 2024
PySCF version 2.4.0
PySCF path  /home/lu29vow/.conda/envs/GPU2/lib/python3.10/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 225000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 77
[INPUT] num. electrons = 350
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C      3.795568100000  -2.009046400000  -0.110827900000 AA    7.172584196136  -3.796547467543  -0.209434377961 Bohr   0.0
[INPUT]  2 C      4.232715100000  -0.709199200000  -0.162733500000 AA    7.998672302311  -1.340192255761  -0.307521746292 Bohr   0.0
[INPUT]  3 C      3.052486000000   0.134498200000  -0.118590100000 AA    5.768362539069   0.254164762247  -0.224102810085 Bohr   0.0
[INPUT]  4 N      1.920069000000  -0.651702900000  -0.061494500000 AA    3.628404550268  -1.231539995585  -0.116207763167 Bohr   0.0
[INPUT]  5 C      2.346160000000  -1.964108700000  -0.055524900000 AA    4.433599844410  -3.711627521876  -0.104926854094 Bohr   0.0
[INPUT]  6 C     -2.043309800000  -3.824932600000   0.171365700000 AA   -3.861295909640  -7.228075058921   0.323834240144 Bohr   0.0
[INPUT]  7 C     -0.742887800000  -4.262102100000   0.137471300000 AA   -1.403854483281  -8.054205683934   0.259783106988 Bohr   0.0
[INPUT]  8 C      0.097231500000  -3.080462400000   0.075221000000 AA    0.183740905681  -5.821230273020   0.142147088816 Bohr   0.0
[INPUT]  9 N     -0.691351800000  -1.948309400000   0.060263100000 AA   -1.306465557725  -3.681771171916   0.113880754417 Bohr   0.0
[INPUT] 10 C     -2.002382300000  -2.375377900000   0.110321100000 AA   -3.783954143677  -4.488813673344   0.208476664761 Bohr   0.0
[INPUT] 11 C      1.512778500000  -3.108018900000   0.015493700000 AA    2.858737052130  -5.873304510972   0.029278849656 Bohr   0.0
[INPUT] 12 C     -3.866099300000   2.015264400000  -0.050364500000 AA   -7.305868847373   3.808297784586  -0.095175111401 Bohr   0.0
[INPUT] 13 C     -4.302396100000   0.714674700000  -0.010878400000 AA   -8.130350308397   1.350539451156  -0.020557196673 Bohr   0.0
[INPUT] 14 C     -3.120790700000  -0.123843700000   0.070208200000 AA   -5.897439715090  -0.234030675253   0.132674269699 Bohr   0.0
[INPUT] 15 N     -1.988730000000   0.665090000000   0.069787700000 AA   -3.758155035706   1.256837948187   0.131879639863 Bohr   0.0
[INPUT] 16 C     -2.416487900000   1.975380500000   0.006438500000 AA   -4.566500314325   3.732928136806   0.012167001653 Bohr   0.0
[INPUT] 17 C     -3.148047900000  -1.540738700000   0.109881900000 AA   -5.948948358012  -2.911574172518   0.207646697047 Bohr   0.0
[INPUT] 18 C      1.978762800000   3.835019100000  -0.043589800000 AA    3.739319757478   7.247135781476  -0.082372783825 Bohr   0.0
[INPUT] 19 C      0.678673200000   4.273322800000  -0.009759500000 AA    1.282506476082   8.075409733860  -0.018442782113 Bohr   0.0
[INPUT] 20 C     -0.165195500000   3.093530400000  -0.056636800000 AA   -0.312174252011   5.845925214016  -0.107028040572 Bohr   0.0
[INPUT] 21 N      0.620736400000   1.960517800000  -0.107507800000 AA    1.173021791548   3.704841704335  -0.203160298255 Bohr   0.0
[INPUT] 22 C      1.933340700000   2.386091900000  -0.110017800000 AA    3.653484428475   4.509060199043  -0.207903510827 Bohr   0.0
[INPUT] 23 C      3.079201300000   1.551620700000  -0.137626000000 AA    5.818847139405   2.932138172206  -0.260075447619 Bohr   0.0
[INPUT] 24 C     -1.582556000000   3.121682300000  -0.027342400000 AA   -2.990597416787   5.899124594902  -0.051669647588 Bohr   0.0
[INPUT] 25 C     -4.490572400000  -2.204407400000   0.144789200000 AA   -8.485951978531  -4.165726252965   0.273611933795 Bohr   0.0
[INPUT] 26 C     -2.248879700000   4.462476100000  -0.032934900000 AA   -4.249766720094   8.432857666417  -0.062237940940 Bohr   0.0
[INPUT] 27 C      4.418936400000   2.220491400000  -0.180879500000 AA    8.350579557871   4.196120607952  -0.341812716548 Bohr   0.0
[INPUT] 28 C      2.179532200000  -4.450600100000   0.027809900000 AA    4.118718937671  -8.410415278962   0.052553094552 Bohr   0.0
[INPUT] 29 C      2.185326600000  -5.243440300000   1.196645600000 AA    4.129668766727  -9.908666117507   2.261332452166 Bohr   0.0
[INPUT] 30 C      2.809442000000  -6.500422500000   1.208223600000 AA    5.309075942850 -12.284018218961   2.283211701236 Bohr   0.0
[INPUT] 31 C      3.438039400000  -6.987872600000   0.051159300000 AA    6.496952871464 -13.205165407352   0.096677065724 Bohr   0.0
[INPUT] 32 C      3.438876000000  -6.209605000000  -1.117532800000 AA    6.498533816340 -11.734452791730  -2.111830927218 Bohr   0.0
[INPUT] 33 C      2.815777600000  -4.952130200000  -1.129107700000 AA    5.321048491685  -9.358169811188  -2.133704318138 Bohr   0.0
[INPUT] 34 C     -4.949055200000  -2.970630400000  -0.950045700000 AA   -9.352358903355  -5.613677873307  -1.795326178821 Bohr   0.0
[INPUT] 35 C     -6.208173900000  -3.589230500000  -0.916554400000 AA  -11.731748404673  -6.782662642936  -1.732036794265 Bohr   0.0
[INPUT] 36 C     -7.031650700000  -3.455165900000   0.212864100000 AA  -13.287894026606  -6.529317265936   0.402254850752 Bohr   0.0
[INPUT] 37 C     -6.587970100000  -2.696626400000   1.308025300000 AA  -12.449459205824  -5.095885356272   2.471809581002 Bohr   0.0
[INPUT] 38 C     -5.329913500000  -2.075883900000   1.273875200000 AA  -10.072076782622  -3.922852037394   2.407275244876 Bohr   0.0
[INPUT] 39 C     -2.141569800000   5.319753900000  -1.151099300000 AA   -4.046980398640  10.052877921087  -2.175262419179 Bohr   0.0
[INPUT] 40 C     -2.767601000000   6.575523900000  -1.156359900000 AA   -5.230007912072  12.425939296532  -2.185203512429 Bohr   0.0
[INPUT] 41 C     -3.510314700000   6.999717000000  -0.042733100000 AA   -6.633533394035  13.227548079462  -0.080753855454 Bohr   0.0
[INPUT] 42 C     -3.623879900000   6.158473000000   1.075795300000 AA   -6.848140519316  11.637827315529   2.032958483094 Bohr   0.0
[INPUT] 43 C     -3.000582400000   4.901373500000   1.080199300000 AA   -5.670278950190   9.262253549201   2.041280836947 Bohr   0.0
[INPUT] 44 C      5.306835900000   2.138189700000   0.914970400000 AA   10.028466439010   4.040592935366   1.729043468084 Bohr   0.0
[INPUT] 45 C      6.560348800000   2.767580100000   0.872432400000 AA   12.397262513619   5.229968416796   1.648658298197 Bohr   0.0
[INPUT] 46 C      6.950554600000   3.489340300000  -0.267080200000 AA   13.134644607836   6.593897522408  -0.504708431294 Bohr   0.0
[INPUT] 47 C      6.077697800000   3.578908900000  -1.363289200000 AA   11.485184309872   6.763157645768  -2.576243216577 Bohr   0.0
[INPUT] 48 C      4.823182800000   2.951644100000  -1.320158000000 AA    9.114494540713   5.577798966188  -2.494737061154 Bohr   0.0
[INPUT] 49 Zn    -0.034632100000   0.006136300000  -0.009701200000 AA   -0.065445184119   0.011595926418  -0.018332611080 Bohr   0.0
[INPUT] 50 H      4.401770600000  -2.920931100000  -0.109903800000 AA    8.318140897162  -5.519759807725  -0.207688082049 Bohr   0.0
[INPUT] 51 H      5.265711900000  -0.351794000000  -0.226257900000 AA    9.950753341863  -0.664794312265  -0.427565464519 Bohr   0.0
[INPUT] 52 H     -2.952701800000  -4.431556300000   0.233433900000 AA   -5.579797729510  -8.374427712591   0.441126139189 Bohr   0.0
[INPUT] 53 H     -0.382302300000  -5.295897700000   0.152728500000 AA   -0.722446643791 -10.007796236714   0.288615036416 Bohr   0.0
[INPUT] 54 H     -4.472575000000   2.923129200000  -0.133280000000 AA   -8.451941821577   5.523913614719  -0.251862697882 Bohr   0.0
[INPUT] 55 H     -5.334820400000   0.352413000000  -0.053626400000 AA  -10.081349479743   0.665964052736  -0.101339209046 Bohr   0.0
[INPUT] 56 H      2.891100200000   4.439359900000  -0.005712800000 AA    5.463387576675   8.389174379377  -0.010795627404 Bohr   0.0
[INPUT] 57 H      0.321464700000   5.305821600000   0.062763400000 AA    0.607480241715  10.026549689802   0.118605636647 Bohr   0.0
[INPUT] 58 H     -4.308563300000  -3.070199800000  -1.839735800000 AA   -8.142004627352  -5.801836769694  -3.476596803558 Bohr   0.0
[INPUT] 59 H     -4.980937200000  -1.487169900000   2.136067100000 AA   -9.412607151658  -2.810343811697   4.036581802694 Bohr   0.0
[INPUT] 60 H     -1.566722000000   4.985796100000  -2.028439100000 AA   -2.960675493331   9.421789141925  -3.833194359359 Bohr   0.0
[INPUT] 61 H     -3.084073400000   4.246915200000   1.961316900000 AA   -5.828054074056   8.025506602252   3.706351784481 Bohr   0.0
[INPUT] 62 H      4.999649200000   1.579830800000   1.812543000000 AA    9.447967706901   2.985447535153   3.425209858998 Bohr   0.0
[INPUT] 63 H      4.143009600000   3.017200100000  -2.183190400000 AA    7.829153475444   5.701681852010  -4.125631933780 Bohr   0.0
[INPUT] 64 H      1.698572100000  -4.859971400000   2.106524000000 AA    3.209836071827  -9.184014919219   3.980753434823 Bohr   0.0
[INPUT] 65 H      2.811495400000  -4.346209100000  -2.048176700000 AA    5.312956306474  -8.213144879092  -3.870493017715 Bohr   0.0
[INPUT] 66 H      2.807730900000  -7.101631700000   2.130641900000 AA    5.305842432479 -13.420138950529   4.026329660523 Bohr   0.0
[INPUT] 67 H      3.927145300000  -7.974047500000   0.060207700000 AA    7.421229068373 -15.068765879273   0.113776063590 Bohr   0.0
[INPUT] 68 H      3.925195100000  -6.585602600000  -2.031001000000 AA    7.417543724485 -12.444985279224  -3.838035648718 Bohr   0.0
[INPUT] 69 H     -6.550074100000  -4.176899500000  -1.782595800000 AA  -12.377846144607  -7.893196104833  -3.368617852800 Bohr   0.0
[INPUT] 70 H     -8.018991400000  -3.941277600000   0.239328400000 AA  -15.153697541243  -7.447935244883   0.452265129830 Bohr   0.0
[INPUT] 71 H     -7.224710500000  -2.589820500000   2.199900900000 AA  -13.652724174270  -4.894051456784   4.157210202184 Bohr   0.0
[INPUT] 72 H     -2.677964200000   7.225725200000  -2.040377700000 AA   -5.060618909390  13.654641679368  -3.855755043670 Bohr   0.0
[INPUT] 73 H     -4.000411700000   7.985429900000  -0.046561600000 AA   -7.559682498506  15.090275497913  -0.087988671922 Bohr   0.0
[INPUT] 74 H     -4.199149900000   6.484854200000   1.956035300000 AA   -7.935243266995  12.254598395735   3.696371006981 Bohr   0.0
[INPUT] 75 H      7.235495600000   2.697031000000   1.739317100000 AA   13.673105059496   5.096649939462   3.286832962773 Bohr   0.0
[INPUT] 76 H      7.934323200000   3.982211900000  -0.300604200000 AA   14.993697831783   7.525289860984  -0.568059609894 Bohr   0.0
[INPUT] 77 H      6.376790700000   4.138677600000  -2.263017100000 AA   12.050387976674   7.820967181872  -4.276482534207 Bohr   0.0

nuclear repulsion = 6423.39398634784
number of shells = 383
number of NR pGTOs = 1421
number of NR cGTOs = 843
basis = def2-SVP
ecp = {}
CPU time:         3.35


PySCF Results


Initial guess from minao.


******** <class 'gpu4pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'gpu4pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 30
direct_scf = False
chkfile to save SCF result = /tmp/tmp88xcs7ms
max_memory 25000 MB (current use 1898 MB)
XC library pyscf.dft.libxc version 6.1.0
    unable to decode the reference due to https://github.com/NVIDIA/cuda-python/issues/29
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14c8576bd750>
grids dens level: 5
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14c8576bd5a0>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 2757632
prune_by_density_: 59 padding grids
    CPU time for                                   setting up grids      2.52 sec, wall time      1.86 sec, GPU time for   1862.67 ms
    CPU time for                                            vxc tot      0.58 sec, wall time      0.59 sec, GPU time for    588.64 ms
    CPU time for                                           jk total      0.01 sec, wall time      0.01 sec, GPU time for      8.04 ms
E1 = -17846.837339945985  Ecoul = 8074.11521392802  Exc = -344.6636969040862
init E= -3693.99183657421
    CPU time for                                         total prep      4.71 sec, wall time      2.92 sec, GPU time for   2919.02 ms
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      0.02 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.70 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      3.55 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    208.06 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.20 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    214.34 ms
E1 = -17881.17217594504  Ecoul = 8116.53525529584  Exc = -346.2203063640075
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.70 ms
    CPU time for                                              total      0.23 sec, wall time      0.24 sec, GPU time for    238.83 ms
cycle= 1 E= -3687.46324066537  delta_E= 6.53  |ddm|= 12.4
diis-norm(errvec)=2.2923
diis-c [-5.25465241  1.        ]
    CPU time for                                               DIIS      0.01 sec, wall time      0.01 sec, GPU time for     14.15 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     16.02 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.81 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    207.60 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.21 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    213.88 ms
E1 = -17854.702401696242  Ecoul = 8087.6881748704  Exc = -343.4964186501401
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.71 ms
    CPU time for                                              total      0.24 sec, wall time      0.25 sec, GPU time for    245.66 ms
cycle= 2 E= -3687.11665912814  delta_E= 0.347  |ddm|= 3.58
diis-norm(errvec)=3.25195
diis-c [-0.21333363  0.58909632  0.41090368]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.17 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.98 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.81 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    207.39 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.21 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    213.67 ms
E1 = -17858.648807978458  Ecoul = 8092.007677663155  Exc = -344.5449211038835
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.70 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    232.43 ms
cycle= 3 E= -3687.79206507135  delta_E= -0.675  |ddm|= 2.39
diis-norm(errvec)=0.584084
diis-c [-0.02897082  0.30038699  0.24218049  0.45743251]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.30 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.72 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.80 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    206.98 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.18 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    213.23 ms
E1 = -17868.230744439814  Ecoul = 8101.844946093484  Exc = -344.8188502685647
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.70 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    231.87 ms
cycle= 4 E= -3687.81066226705  delta_E= -0.0186  |ddm|= 0.605
diis-norm(errvec)=0.254649
diis-c [-0.00474835  0.13653369  0.11861083  0.3198387   0.42501678]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.42 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.90 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.81 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    207.73 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.21 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    214.02 ms
E1 = -17865.902719936104  Ecoul = 8099.501356613509  Exc = -344.80711733788263
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.70 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    232.94 ms
cycle= 5 E= -3687.81449431264  delta_E= -0.00383  |ddm|= 0.227
diis-norm(errvec)=0.101211
diis-c [-0.00063832  0.05244542  0.05019252  0.16092071  0.30010926  0.43633209]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.57 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.69 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.81 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    207.29 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.21 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    213.57 ms
E1 = -17865.788458443276  Ecoul = 8099.359426990322  Exc = -344.7800415614977
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.71 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    232.45 ms
cycle= 6 E= -3687.81508666661  delta_E= -0.000592  |ddm|= 0.0741
diis-norm(errvec)=0.0334819
diis-c [-1.30465641e-04  1.69637222e-02  1.88413687e-02  6.37264308e-02
  1.39149100e-01  2.85784064e-01  4.75535315e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.69 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.95 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.82 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    206.93 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.20 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    213.19 ms
E1 = -17865.67356010348  Ecoul = 8099.241722342147  Exc = -344.7772184261252
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.70 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    232.44 ms
cycle= 7 E= -3687.81506983962  delta_E= 1.68e-05  |ddm|= 0.0451
diis-norm(errvec)=0.0341959
diis-c [-1.99449286e-05  4.29021801e-03  6.85782883e-03  2.46314866e-02
  6.61135439e-02  1.76465745e-01  4.51408711e-01  2.70232467e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.82 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.87 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.82 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    207.79 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.19 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    214.05 ms
E1 = -17865.690612597835  Ecoul = 8099.259792065899  Exc = -344.77833215761467
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.71 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    233.37 ms
cycle= 8 E= -3687.81516634171  delta_E= -9.65e-05  |ddm|= 0.0294
diis-norm(errvec)=0.00791805
diis-c [-3.16594144e-06  5.73188080e-04  2.37491165e-03  8.97056350e-03
  2.97612016e-02  9.24434474e-02  2.73836144e-01  2.06078910e-01
  3.85961633e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.97 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.93 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.81 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    208.64 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.23 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    214.94 ms
E1 = -17865.748918356978  Ecoul = 8099.319112227415  Exc = -344.77935119267613
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.70 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    234.45 ms
cycle= 9 E= -3687.8151709744  delta_E= -4.63e-06  |ddm|= 0.00659
diis-norm(errvec)=0.0016194
diis-c [-1.82235743e-07  6.03429424e-01  5.47678409e-04  1.71580444e-03
  7.16469519e-03  2.53268866e-02  8.03435352e-02  6.96609099e-02
  2.11811067e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.98 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.66 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.81 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    207.31 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.20 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    213.57 ms
E1 = -17865.732161707958  Ecoul = 8099.301606230566  Exc = -344.77860198109244
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.70 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    232.84 ms
cycle= 10 E= -3687.81517111065  delta_E= -1.36e-07  |ddm|= 0.0012
diis-norm(errvec)=0.000685544
diis-c [-7.13006553e-08  3.82388681e-01  5.33231743e-01 -3.64806095e-04
 -4.86730245e-04  8.33571187e-05  2.87901470e-03  8.76335452e-03
  7.35053855e-02]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.97 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.88 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.80 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    207.30 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.21 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    213.58 ms
E1 = -17865.73808695651  Ecoul = 8099.307669158522  Exc = -344.77873967680495
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.70 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    233.03 ms
cycle= 11 E= -3687.81517112695  delta_E= -1.63e-08  |ddm|= 0.000675
    CPU time for                                                SCF      7.30 sec, wall time      5.53 sec, GPU time for   5533.97 ms
converged SCF energy = -3687.81517112695
Nuc-Nuc PySCF=  6423.393986347839
One electron integrals energy -17865.73808695651
Coulomb energy  8099.307669158522
EXC  -344.77873967680495
PySCF time:  5.790546657517552
PySCF Grid Size:  (2247424,)
Initial guess from minao.
Currently Used memory: 4.5G


Natoms : 77


NAO : 896


aux NAO : 3382
Running DFT using 2 threads for Numba.


GPU acceleration is enabled. Currently this only accelerates AO values and XC term evaluation.
GPU(s) information:
Found 2 CUDA devices
id 0    b'NVIDIA A100-SXM4-80GB'                              [SUPPORTED]
                      Compute Capability: 8.0
                           PCI Device ID: 0
                              PCI Bus ID: 1
                                    UUID: GPU-17abb6f3-f142-f016-adda-dcf861cdd488
                                Watchdog: Disabled
             FP32/FP64 Performance Ratio: 2
id 1    b'NVIDIA A100-SXM4-80GB'                              [SUPPORTED]
                      Compute Capability: 8.0
                           PCI Device ID: 0
                              PCI Bus ID: 65
                                    UUID: GPU-cd68b765-b4a5-f2a6-6950-0f2696dd9384
                                Watchdog: Disabled
             FP32/FP64 Performance Ratio: 2
Summary:
	2/2 devices are supported
True
Max threads per block supported by the GPU:  1024
The user has specified to use 1 GPU(s).
Threads per block configuration for the XC term:  (32, 32)
Threads per block configuration for the all other calculations:  (32, 32)

Calculating one electron integrals...


Core H size in GB  0.006422528
done!
Time taken 0.39937571436166763 seconds.


Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.17278006486594677 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.051199935376644135
Time taken to evaluate the square roots needed:  0.0015152860432863235
Time for significant indices evaluation:  0.26594213396310806
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.009644552
No. of elements in the standard three-centered two electron ERI tensor:  2715123712
No. of elements in the triangular three-centered two electron ERI tensor:  1359076992
No. of significant triplets based on Schwarz inequality and triangularity: 498760174 or 18.4% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.3188764527440071 seconds.

Two Center Two electron ERI size in GB  0.091503392
Three Center Two electron ERI size in GB  3.990081392
Three-centered two electron evaluation done!
Time taken for Cholesky factorization fo two-centered two-electron integrals 0.19175702147185802 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  13.214299377053976 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  2247424
Size (in GB) for storing the coordinates of grid:       0.053938176
Size (in GB) for storing the weights of grid:           0.017979392
Size (in GB) for storing the density at gridpoints:     0.017979392

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  51200
No. of batches:  44

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 0.036798298358917236 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    525
Average no. of basis functions contributing to a batch of grid points:    316


------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  348.41979080507696



------Iteration 1--------


Energies
Electron-Nuclear Energy       -21433.472661660824
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3679.853151762139
Coulomb Energy                7980.508439692054
Exchange-Correlation Energy   -343.0681232740772
-------------------------
Total Energy  -3692.7852071156485
-------------------------



Energy difference :  3692.7852071156485


Time taken for the previous iteration: 0.5631982386112213


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  350.0000001326218



------Iteration 2--------


Energies
Electron-Nuclear Energy       -21683.880840044803
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3689.7849487677386
Coulomb Energy                8235.168940118489
Exchange-Correlation Energy   -347.9903009646591
-------------------------
Total Energy  -3683.523265758173
-------------------------



Energy difference :  9.261941357475735


Time taken for the previous iteration: 0.5068918131291866


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  350.0000171697278



------Iteration 3--------


Energies
Electron-Nuclear Energy       -20404.84671073473
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3522.831310871136
Coulomb Energy                7298.121368718261
Exchange-Correlation Energy   -331.29820896471404
-------------------------
Total Energy  -3491.798253744986
-------------------------



Energy difference :  191.72501201318664


Time taken for the previous iteration: 0.5062334891408682


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.9999938228361



------Iteration 4--------


Energies
Electron-Nuclear Energy       -20869.708119742776
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3539.9598362109614
Coulomb Energy                7635.746540153504
Exchange-Correlation Energy   -334.16935585627226
-------------------------
Total Energy  -3604.7771128695213
-------------------------



Energy difference :  112.97885912453512


Time taken for the previous iteration: 0.510365005582571


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.9999958263437



------Iteration 5--------


Energies
Electron-Nuclear Energy       -21403.48035430328
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3638.4463759920823
Coulomb Energy                7999.6394965819045
Exchange-Correlation Energy   -342.1831474535405
-------------------------
Total Energy  -3684.1836428177676
-------------------------



Energy difference :  79.40652994824632


Time taken for the previous iteration: 0.5065787322819233


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.99999866740876



------Iteration 6--------


Energies
Electron-Nuclear Energy       -21075.603967273186
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3560.062283192722
Coulomb Energy                7799.074553430054
Exchange-Correlation Energy   -336.6850182500196
-------------------------
Total Energy  -3629.758162535368
-------------------------



Energy difference :  54.4254802823998


Time taken for the previous iteration: 0.5061564240604639


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.9999977593481



------Iteration 7--------


Energies
Electron-Nuclear Energy       -21525.2438079913
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3654.7692104231646
Coulomb Energy                8103.939984881473
Exchange-Correlation Energy   -344.36157234209986
-------------------------
Total Energy  -3687.5021986636993
-------------------------



Energy difference :  57.74403612833157


Time taken for the previous iteration: 0.5041766073554754


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.9999976708006



------Iteration 8--------


Energies
Electron-Nuclear Energy       -21515.264603818778
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3653.191204962784
Coulomb Energy                8095.74736552942
Exchange-Correlation Energy   -344.38291100903444
-------------------------
Total Energy  -3687.314957970546
-------------------------



Energy difference :  0.18724069315339875


Time taken for the previous iteration: 0.5007443521171808


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.99999773879813



------Iteration 9--------


Energies
Electron-Nuclear Energy       -21526.410173804023
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3657.371407872196
Coulomb Energy                8102.416375395696
Exchange-Correlation Energy   -344.6306263305724
-------------------------
Total Energy  -3687.8590305016405
-------------------------



Energy difference :  0.5440725310945709


Time taken for the previous iteration: 0.5003682337701321


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.9999974775254



------Iteration 10--------


Energies
Electron-Nuclear Energy       -21521.74150517718
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3655.4877529636883
Coulomb Energy                8099.347594759317
Exchange-Correlation Energy   -344.3662220861776
-------------------------
Total Energy  -3687.8783931752887
-------------------------



Energy difference :  0.019362673648174678


Time taken for the previous iteration: 0.5113895200192928


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.9999974249608



------Iteration 11--------


Energies
Electron-Nuclear Energy       -21519.80037596488
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3655.420385573206
Coulomb Energy                8097.456940511899
Exchange-Correlation Energy   -344.376647032131
-------------------------
Total Energy  -3687.905710546843
-------------------------



Energy difference :  0.02731737155409064


Time taken for the previous iteration: 0.5004364009946585


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.9999975186796



------Iteration 12--------


Energies
Electron-Nuclear Energy       -21521.0190579049
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3655.7418242930207
Coulomb Energy                8098.387824375886
Exchange-Correlation Energy   -344.4159102362071
-------------------------
Total Energy  -3687.9113331071367
-------------------------



Energy difference :  0.005622560293886636


Time taken for the previous iteration: 0.5099364593625069


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.9999975476871



------Iteration 13--------


Energies
Electron-Nuclear Energy       -21519.846470853667
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3655.2342167778393
Coulomb Energy                8097.691718141291
Exchange-Correlation Energy   -344.38518528098325
-------------------------
Total Energy  -3687.911734850454
-------------------------



Energy difference :  0.00040174331752496073


Time taken for the previous iteration: 0.5008703880012035


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.9999975367652



------Iteration 14--------


Energies
Electron-Nuclear Energy       -21521.430862388293
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3655.6845159088657
Coulomb Energy                8098.863208258266
Exchange-Correlation Energy   -344.4233316513715
-------------------------
Total Energy  -3687.912483507469
-------------------------



Energy difference :  0.0007486570148103056


Time taken for the previous iteration: 0.4999447949230671


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.99999752804626



------Iteration 15--------


Energies
Electron-Nuclear Energy       -21521.179520689606
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3655.6856085246345
Coulomb Energy                8098.606226206592
Exchange-Correlation Energy   -344.418922305872
-------------------------
Total Energy  -3687.9126218991896
-------------------------



Energy difference :  0.00013839172061125282


Time taken for the previous iteration: 0.49961537308990955


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.99999752827716



------Iteration 16--------


Energies
Electron-Nuclear Energy       -21521.06473800783
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3655.642059830323
Coulomb Energy                8098.529345257106
Exchange-Correlation Energy   -344.4132574812546
-------------------------
Total Energy  -3687.912604036592
-------------------------



Energy difference :  1.7862597815110348e-05


Time taken for the previous iteration: 0.5006825178861618


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.9999975261495



------Iteration 17--------


Energies
Electron-Nuclear Energy       -21521.036943650244
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3655.6238918584922
Coulomb Energy                8098.519221849577
Exchange-Correlation Energy   -344.41278789324423
-------------------------
Total Energy  -3687.9126314703562
-------------------------



Energy difference :  2.7433764444140252e-05


Time taken for the previous iteration: 0.501584853976965


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.9999975269141



------Iteration 18--------


Energies
Electron-Nuclear Energy       -21521.038819549074
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3655.6360269722422
Coulomb Energy                8098.510191590453
Exchange-Correlation Energy   -344.41401754872095
-------------------------
Total Energy  -3687.912632170034
-------------------------



Energy difference :  6.996779120527208e-07


Time taken for the previous iteration: 0.5035269223153591


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.99999752817786



------Iteration 19--------


Energies
Electron-Nuclear Energy       -21521.06817899972
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3655.6434975647016
Coulomb Energy                8098.532740938418
Exchange-Correlation Energy   -344.4146791994517
-------------------------
Total Energy  -3687.9126333309914
-------------------------



Energy difference :  1.160957253887318e-06


Time taken for the previous iteration: 0.5004713647067547


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.9999975276833



------Iteration 20--------


Energies
Electron-Nuclear Energy       -21521.070561730412
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3655.6404619924992
Coulomb Energy                8098.538015286722
Exchange-Correlation Energy   -344.4145357409757
-------------------------
Total Energy  -3687.9126338271053
-------------------------



Energy difference :  4.961138984072022e-07


Time taken for the previous iteration: 0.5000717304646969


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  349.99999752756565



------Iteration 21--------


Energies
Electron-Nuclear Energy       -21521.097002123784
Nuclear repulsion Energy      6423.393986365063
Kinetic Energy                3655.6484743727424
Coulomb Energy                8098.5571739057605
Exchange-Correlation Energy   -344.4152663562337
-------------------------
Total Energy  -3687.912633836454
-------------------------



Energy difference :  9.34869603952393e-09


Time taken for the previous iteration: 0.4982287995517254



SCF Converged after 21 iterations!

-------------------------------------
Total Energy =  -3687.912633836454
-------------------------------------



Time taken : 24.30611809529364 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           0.036798298358917236
Density Fitting                         1.8459351621568203
    DF (gamma)                          0.9709829781204462
    DF (coeff)                          0.2753856424242258
    DF (Jtri)                           0.2609395682811737
    DF (Cholesky)                       0.19175702147185802
DIIS                                    0.06088762730360031
KS matrix diagonalization               0.6263549067080021
One electron Integrals (S, T, Vnuc)     0.39937571436166763
Coulomb Integrals (2c2e + 3c2e)         13.022542355582118
Grids construction                      0
Exchange-Correlation Term               8.24638083577156
Misc.                                   0.06784319505095482
Complete SCF                            24.30611809529364
