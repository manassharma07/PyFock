Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 7343 16-Core Processor
Number of Cores: 32
Number of Threads: 64
Memory (GB): 251.74080657958984
Number of cores being actually used/requested for the benchmark: 2
Confirming that the environment variables are properly set...
OMP_NUM_THREADS = 2
OPENBLAS_NUM_THREADS = 2
MKL_NUM_THREADS = 2
VECLIB_MAXIMUM_THREADS = 2
NUMEXPR_NUM_THREADS = 2
PYSCF_MAX_MEMORY = 225000
#INFO: **** input file is /home/lu29vow/GPU_Test/tmp_dir/PyFock/benchmarks_tests/bench_PySCF_vs_PyFock_GPU.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
numba.config.THREADING_LAYER='omp'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 2
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(225000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf
from gpu4pyscf import dft as dft_gpu

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)

# basis_set_name = 'sto-2g'
# basis_set_name = 'sto-3g'
# basis_set_name = 'sto-6g'
# basis_set_name = '6-31G'
basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-SVPD'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'def2-QZVP'
# basis_set_name = 'def2-TZVPP'
# basis_set_name = 'def2-QZVPP'
# basis_set_name = 'def2-TZVPD'
# basis_set_name = 'def2-QZVPD'
# basis_set_name = 'def2-TZVPPD'
# basis_set_name = 'def2-QZVPPD'
# basis_set_name = 'cc-pVDZ'
# basis_set_name = 'ano-rcc'

auxbasis_name = 'def2-universal-jfit'
# auxbasis_name = 'def2-universal-jkfit'
# auxbasis_name = 'def2-TZVP'
# auxbasis_name = 'sto-3g'
# auxbasis_name = 'def2-SVP'
# auxbasis_name = '6-31G'

# xyzFilename = 'Benzene-Fulvene_Dimer.xyz'
# xyzFilename = 'Adenine-Thymine.xyz'
# xyzFilename = 'Zn.xyz'
# xyzFilename = 'Zn_dimer.xyz'
xyzFilename = 'TPP.xyz'
# xyzFilename = 'Zn_TPP.xyz'
# xyzFilename = 'H2O.xyz'

# xyzFilename = 'Caffeine.xyz'
# xyzFilename = 'Serotonin.xyz'
# xyzFilename = 'Cholesterol.xyz'
# xyzFilename = 'C60.xyz'
# xyzFilename = 'Taxol.xyz'
# xyzFilename = 'Valinomycin.xyz'
# xyzFilename = 'Olestra.xyz'
# xyzFilename = 'Ubiquitin.xyz'

### 1D Carbon Alkanes
# xyzFilename = 'Ethane.xyz'
# xyzFilename = 'Decane_C10H22.xyz'
# xyzFilename = 'Icosane_C20H42.xyz'
# xyzFilename = 'Tetracontane_C40H82.xyz'
# xyzFilename = 'Pentacontane_C50H102.xyz'
# xyzFilename = 'Octacontane_C80H162.xyz'
# xyzFilename = 'Hectane_C100H202.xyz'
# xyzFilename = 'Icosahectane_C120H242.xyz'

### 2D Carbon
# xyzFilename = 'Graphene_C16.xyz'
# xyzFilename = 'Graphene_C76.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'

### 3d Carbon Fullerenes
# xyzFilename = 'C60.xyz'
# xyzFilename = 'C70.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'


# ---------PySCF---------------
#Comparison with PySCF
molPySCF = gto.Mole()
molPySCF.atom = xyzFilename
molPySCF.basis = basis_set_name
molPySCF.cart = False
molPySCF.verbose = 4
molPySCF.max_memory=25000
# molPySCF.incore_anyway = True # Keeps the PySCF ERI integrals incore
molPySCF.build()
#print(molPySCF.cart_labels())

print('\n\nPySCF Results\n\n')
start=timer()
mf = dft_gpu.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
# mf = scf.RHF(molPySCF).density_fit(auxbasis=auxbasis_name)
mf.xc = funcidpyscf
mf.verbose = 6
# dmat_init = mf.init_guess_by_1e(molPySCF)
# dmat_init = mf.init_guess_by_huckel(molPySCF)
mf.init_guess = 'minao'
dmat_init = mf.init_guess_by_minao(molPySCF)
# mf.init_guess = 'atom'
# dmat_init = mf.init_guess_by_atom(molPySCF)
mf.max_cycle = 30
mf.conv_tol = 1e-7
mf.grids.level = 5
energyPyscf = mf.kernel(dm0=dmat_init)
print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
print('One electron integrals energy',mf.scf_summary['e1'])
print('Coulomb energy ',mf.scf_summary['coul'])
print('EXC ',mf.scf_summary['exc'])
duration = timer()-start
print('PySCF time: ', duration)
pyscfGrids = mf.grids
print('PySCF Grid Size: ', pyscfGrids.weights.shape)
mf = 0#None

# Get an initial guess for dmat from PySCF using CAO basis (Need to use CPU pyscf for this as GPU version oesnt support SAO yet)
molPySCF.cart = True
molPySCF.build()
mf2 = dft_gpu.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
mf2.init_guess = 'minao'
dmat_init = mf2.init_guess_by_minao(molPySCF)
import cupy as cp
cp._default_memory_pool.free_all_blocks()

import psutil

# Get memory information
memory_info = psutil.virtual_memory()

# Convert bytes to human-readable format
used_memory = psutil._common.bytes2human(memory_info.used)


# If you want to print in a more human-readable format, you can use psutil's utility function
print(f"Currently Used memory: {used_memory}")
#--------------------CrysX --------------------------

#Initialize a Mol object with somewhat large geometry
molCrysX = Mol(coordfile=xyzFilename)
print('\n\nNatoms :',molCrysX.natoms)
# print(molCrysX.coordsBohrs)

#Initialize a Basis object with a very large basis set
basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})
print('\n\nNAO :',basis.bfs_nao)

auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})
print('\n\naux NAO :',auxbasis.bfs_nao)

dftObj = DFT(molCrysX, basis, xc=funcidcrysx)
# GPU acceleration
dftObj.use_gpu = True
dftObj.keep_ao_in_gpu = False
dftObj.use_libxc = False
dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
dftObj.n_gpus = 1 # Specify the number of GPUs
dftObj.free_gpu_mem = True
dftObj.threads_x = 32
dftObj.threads_y = 32
dftObj.dynamic_precision = False
dftObj.keep_ints3c2e_in_gpu = True
# SAO or CAO basis
dftObj.sao = False
# print(dmat_init)
# Using PySCF grids to compare the energies
energyCrysX, dmat = dftObj.scf(max_itr=35, ncores=ncores, dmat=dmat_init, conv_crit=1.0E-7, grids=pyscfGrids, \
                               isDF=True, auxbasis=auxbasis, rys=True, DF_algo=10, blocksize=20480, XC_algo=3, debug=False, \
                                sortGrids=False, save_ao_values=False, xc_bf_screen=True, threshold_schwarz=1e-9, \
                                strict_schwarz=False, cholesky=True, orthogonalize=True)
# print(dmat)

# Using CrysX grids 
# To get the same energies as PySCF (level=5) upto 1e-7 au, use the following settings
# radial_precision=1.0e-13
# level=3
# pruning by density with threshold = 1e-011
# alpha_min and alpha_max corresponding to QZVP
# energyCrysX, dmat = dftObj.scf(max_itr=30, ncores=ncores, dmat=dmat_init, grids=None, gridsLevel=3, isDF=True, auxbasis=auxbasis,
#                             rys=True, DF_algo=6, blocksize=5000, XC_algo=2, debug=False, sortGrids=False, save_ao_values=True,
#                             xc_bf_screen=True,threshold_schwarz=1e-9)


print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf[0]))

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='gpu011.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64')  Threads 2
Python 3.10.13 (tags/v3.10.13-25-g07fbd8e9251-dirty:07fbd8e9251, Sep 27 2023, 23:32:09) [GCC 13.2.0]
numpy 1.26.3  scipy 1.10.1
Date: Sun Feb  4 00:38:32 2024
PySCF version 2.4.0
PySCF path  /home/lu29vow/.conda/envs/GPU2/lib/python3.10/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 225000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 78
[INPUT] num. electrons = 322
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C     -0.464811100000   5.743779700000   0.867095200000 AA   -0.878365678658  10.854170552836   1.638572451925 Bohr   0.0
[INPUT]  2 C      0.028083000000   4.961336500000  -0.190079600000 AA    0.053069178756   9.375567196808  -0.359198385867 Bohr   0.0
[INPUT]  3 C      0.521125500000   5.613720800000  -1.332166500000 AA    0.984784471527  10.608394851774  -2.517429837320 Bohr   0.0
[INPUT]  4 C      0.522199500000   7.007308300000  -1.413923100000 AA    0.986814037385  13.241893557392  -2.671927420196 Bohr   0.0
[INPUT]  5 C      0.033354600000   7.774360400000  -0.353689100000 AA    0.063031058994  14.691411949664  -0.668375532244 Bohr   0.0
[INPUT]  6 C     -0.459781900000   7.137722700000   0.787542700000 AA   -0.868861868032  13.488341056091   1.488240014401 Bohr   0.0
[INPUT]  7 C      0.022668500000   3.469970800000  -0.103918300000 AA    0.042837256655   6.557294472238  -0.196377126330 Bohr   0.0
[INPUT]  8 C      1.265069900000   2.797238300000  -0.055714600000 AA    2.390635639431   5.286014292144  -0.105285335140 Bohr   0.0
[INPUT]  9 C      2.546108300000   3.493287200000  -0.039168100000 AA    4.811447370482   6.601356082449  -0.074016981820 Bohr   0.0
[INPUT] 10 C      3.504093000000   2.530322800000  -0.012954600000 AA    6.621776085006   4.781617098743  -0.024480646053 Bohr   0.0
[INPUT] 11 C      2.801428700000   1.253141900000   0.003653200000 AA    5.293933000496   2.368094986217   0.006903547478 Bohr   0.0
[INPUT] 12 N      1.443985300000   1.439270300000  -0.018693500000 AA    2.728736744898   2.719826686221  -0.035325595310 Bohr   0.0
[INPUT] 13 C      3.469826500000   0.007892800000   0.008264900000 AA    6.557021784758   0.014915230356   0.015618397447 Bohr   0.0
[INPUT] 14 C      2.847061500000  -1.253317500000   0.008082300000 AA    5.380166494793  -2.368426822125   0.015273333457 Bohr   0.0
[INPUT] 15 N      1.492328300000  -1.498672600000   0.015342500000 AA    2.820091774938  -2.832080764390   0.028993123066 Bohr   0.0
[INPUT] 16 C      1.244974700000  -2.852496400000   0.055436200000 AA    2.352661215013  -5.390436967308   0.104759235387 Bohr   0.0
[INPUT] 17 C      2.523342700000  -3.502355700000   0.054557200000 AA    4.768426621421  -6.618493063809   0.103098166123 Bohr   0.0
[INPUT] 18 C      3.494956700000  -2.532306200000   0.037976900000 AA    6.604510980214  -4.785365181538   0.071765940060 Bohr   0.0
[INPUT] 19 C     -0.018157000000  -3.470109400000   0.104083500000 AA   -0.034311757244  -6.557556388279   0.196689309086 Bohr   0.0
[INPUT] 20 C     -1.259960800000  -2.794372700000   0.117071900000 AA   -2.380980839688  -5.280599092961   0.221233827882 Bohr   0.0
[INPUT] 21 N     -1.442491600000  -1.440109100000   0.016334600000 AA   -2.725914060986  -2.721411788494   0.030867920354 Bohr   0.0
[INPUT] 22 C     -2.797772200000  -1.251202600000   0.084847100000 AA   -5.287023216922  -2.364430240344   0.160337781464 Bohr   0.0
[INPUT] 23 C     -3.493845800000  -2.520658000000   0.257208700000 AA   -6.602411683462  -4.763353273694   0.486053999855 Bohr   0.0
[INPUT] 24 C     -2.534846300000  -3.482930400000   0.276688000000 AA   -4.790165274867  -6.581784566922   0.522864541954 Bohr   0.0
[INPUT] 25 C     -3.468590200000  -0.007787500000   0.022162500000 AA   -6.554685516350  -0.014716242195   0.041881055236 Bohr   0.0
[INPUT] 26 C     -2.844181300000   1.252164000000  -0.041383500000 AA   -5.374723705609   2.366247023040  -0.078203481076 Bohr   0.0
[INPUT] 27 C     -3.486364500000   2.522858700000  -0.211596300000 AA   -6.588274075406   4.767511993976  -0.399859055971 Bohr   0.0
[INPUT] 28 C     -2.513857700000   3.491705100000  -0.243855400000 AA   -4.750502569129   6.598366346747  -0.460819919996 Bohr   0.0
[INPUT] 29 C     -1.240573800000   2.849779600000  -0.095039400000 AA   -2.344344719311   5.385302959373  -0.179598437043 Bohr   0.0
[INPUT] 30 N     -1.491476100000   1.501048500000   0.020515400000 AA   -2.818481350334   2.836570564689   0.038768487336 Bohr   0.0
[INPUT] 31 C      4.965051400000   0.009450100000   0.020131300000 AA    9.382587340388   0.017858100850   0.038042643531 Bohr   0.0
[INPUT] 32 C     -0.031203900000  -4.963314900000   0.158934200000 AA   -0.058966825018  -9.379305830973   0.300342109827 Bohr   0.0
[INPUT] 33 C     -4.961424700000  -0.011040200000   0.011992600000 AA   -9.375733870652  -0.020862954360   0.022662729521 Bohr   0.0
[INPUT] 34 C      5.672686500000   0.417184700000   1.162420000000 AA   10.719823875518   0.788364826359   2.196655441717 Bohr   0.0
[INPUT] 35 C      7.068840100000   0.416622100000   1.175081900000 AA   13.358171807343   0.787301666441   2.220582964934 Bohr   0.0
[INPUT] 36 C      7.781881500000   0.009518000000   0.045035500000 AA   14.705624768820   0.017986413254   0.085104760883 Bohr   0.0
[INPUT] 37 C      7.089252500000  -0.398247400000  -1.097230400000 AA   13.396745652888  -0.752578515820  -2.073464951547 Bohr   0.0
[INPUT] 38 C      5.692883800000  -0.399780800000  -1.108730300000 AA   10.757991240973  -0.755476221860  -2.095196613007 Bohr   0.0
[INPUT] 39 C      0.447768200000  -5.649674900000   1.286789800000 AA    0.846159265289 -10.676338253830   2.431680301884 Bohr   0.0
[INPUT] 40 C      0.429762800000  -7.044969600000   1.334914400000 AA    0.812133990526 -13.313063099887   2.522622615738 Bohr   0.0
[INPUT] 41 C     -0.063822400000  -7.779062000000   0.253938800000 AA   -0.120606856612 -14.700296686011   0.479874784401 Bohr   0.0
[INPUT] 42 C     -0.541988400000  -7.108107100000  -0.874058900000 AA   -1.024209638691 -13.432375683076  -1.651731937739 Bohr   0.0
[INPUT] 43 C     -0.527408500000  -5.712910300000  -0.920207400000 AA   -0.996657620768 -10.795835841207  -1.738939963798 Bohr   0.0
[INPUT] 44 C     -5.670576800000  -0.585869300000  -1.056022200000 AA  -10.715837120313  -1.107132521791  -1.995592739461 Bohr   0.0
[INPUT] 45 C     -7.066364900000  -0.584430900000  -1.069768700000 AA  -13.353494357240  -1.104414339733  -2.021569859632 Bohr   0.0
[INPUT] 46 C     -7.779581000000  -0.012220000000  -0.013678100000 AA  -14.701277453870  -0.023092453242  -0.025847862904 Bohr   0.0
[INPUT] 47 C     -7.086697700000   0.560179100000   1.055626900000 AA  -13.391917780585   1.058585079705   1.994845730724 Bohr   0.0
[INPUT] 48 C     -5.690717700000   0.563216000000   1.066639500000 AA  -10.753897905215   1.064323988973   2.015656528643 Bohr   0.0
[INPUT] 49 H     -0.770754700000   0.783142300000   0.102781900000 AA   -1.456515292221   1.479924463562   0.194229641562 Bohr   0.0
[INPUT] 50 H      0.770526900000  -0.777827200000  -0.022189600000 AA    1.456084812610  -1.469880380237  -0.041932266814 Bohr   0.0
[INPUT] 51 H     -0.842900000000   5.248958100000   1.762893100000 AA   -1.592850150396   9.919093248317   3.331385145885 Bohr   0.0
[INPUT] 52 H      0.898133200000   5.016426900000  -2.163443300000 AA    1.697225771379   9.479672964901  -4.088315323025 Bohr   0.0
[INPUT] 53 H      0.903918000000   7.495143100000  -2.311936500000 AA    1.708157459065  14.163767723424  -4.368926802386 Bohr   0.0
[INPUT] 54 H      0.036605300000   8.863255200000  -0.416775400000 AA    0.069173991708  16.749124900127  -0.787591361456 Bohr   0.0
[INPUT] 55 H     -0.839013000000   7.727789200000   1.623107000000 AA   -1.585504784950  14.603405136372   3.067227700864 Bohr   0.0
[INPUT] 56 H      2.686357000000   4.569306300000  -0.044017500000 AA    5.076479002808   8.634737486250  -0.083181019688 Bohr   0.0
[INPUT] 57 H      4.581027300000   2.664356200000  -0.009121800000 AA    8.656886966156   5.034903516287  -0.017237703763 Bohr   0.0
[INPUT] 58 H      2.666386000000  -4.576818400000   0.070857100000 AA    5.038739282375  -8.648933297870   0.133900512981 Bohr   0.0
[INPUT] 59 H      4.569487200000  -2.676280000000   0.049740400000 AA    8.635079337706  -5.057436232651   0.093995733326 Bohr   0.0
[INPUT] 60 H     -4.565202800000  -2.648244900000   0.373772400000 AA   -8.626982995098  -5.004457571776   0.706327468921 Bohr   0.0
[INPUT] 61 H     -2.668341700000  -4.551736800000   0.409405300000 AA   -5.042435019756  -8.601535943104   0.773663890945 Bohr   0.0
[INPUT] 62 H     -4.556313900000   2.660882200000  -0.318377900000 AA   -8.610185408549   5.028338607730  -0.601647035114 Bohr   0.0
[INPUT] 63 H     -2.651604800000   4.558374800000  -0.380280000000 AA   -5.010806862582   8.614079945119  -0.718625050650 Bohr   0.0
[INPUT] 64 H      5.117405300000   0.731188300000   2.047441300000 AA    9.670494485398   1.381745632486   3.869103313123 Bohr   0.0
[INPUT] 65 H      7.600893800000   0.733204300000   2.073329300000 AA   14.363607583905   1.385555320353   3.918024543036 Bohr   0.0
[INPUT] 66 H      8.872525900000   0.010766500000   0.054447300000 AA   16.766643984110   0.020345736320   0.102890485222 Bohr   0.0
[INPUT] 67 H      7.637125400000  -0.712853700000  -1.986606200000 AA   14.432075384959  -1.347098259883  -3.754141635363 Bohr   0.0
[INPUT] 68 H      5.154034400000  -0.710941200000  -2.004966700000 AA    9.739713452587  -1.343484158670  -3.788837951873 Bohr   0.0
[INPUT] 69 H      0.824466400000  -5.078686900000   2.136685600000 AA    1.558015694906  -9.597327313416   4.037750598302 Bohr   0.0
[INPUT] 70 H      0.798167400000  -7.559646000000   2.223487900000 AA    1.508317787556 -14.285660538664   4.201783172284 Bohr   0.0
[INPUT] 71 H     -0.077104200000  -8.869041900000   0.291055400000 AA   -0.145705821054 -16.760060178292   0.550014993076 Bohr   0.0
[INPUT] 72 H     -0.926538800000  -7.672480400000  -1.724811300000 AA   -1.750904575783 -14.498886652093  -3.259420973555 Bohr   0.0
[INPUT] 73 H     -0.897835600000  -5.190614100000  -1.803355400000 AA   -1.696663388885  -9.808839067306  -3.407847811255 Bohr   0.0
[INPUT] 74 H     -5.115721400000  -1.027745200000  -1.884722400000 AA   -9.667312375577  -1.942156953836  -3.561609156833 Bohr   0.0
[INPUT] 75 H     -7.598446700000  -1.029564400000  -1.911706500000 AA  -14.358983235105  -1.945594743602  -3.612601715551 Bohr   0.0
[INPUT] 76 H     -8.870248400000  -0.013104600000  -0.023641300000 AA  -16.762340132861  -0.024764104972  -0.044675582229 Bohr   0.0
[INPUT] 77 H     -7.634387000000   1.002863700000   1.888846700000 AA  -14.426900558940   1.895137733268   3.569402954289 Bohr   0.0
[INPUT] 78 H     -5.152291200000   1.002596100000   1.907593500000 AA   -9.736419282007   1.894632042557   3.604829272001 Bohr   0.0

nuclear repulsion = 5344.07181627578
number of shells = 378
number of NR pGTOs = 1362
number of NR cGTOs = 822
basis = def2-SVP
ecp = {}
CPU time:         2.98


PySCF Results


Initial guess from minao.


******** <class 'gpu4pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'gpu4pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 30
direct_scf = False
chkfile to save SCF result = /tmp/tmp_0nz9l7g
max_memory 25000 MB (current use 1857 MB)
XC library pyscf.dft.libxc version 6.1.0
    unable to decode the reference due to https://github.com/NVIDIA/cuda-python/issues/29
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14ee4d039870>
grids dens level: 5
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14ee4d0396c0>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 2760960
prune_by_density_: 93 padding grids
    CPU time for                                   setting up grids      1.77 sec, wall time      1.69 sec, GPU time for   1689.44 ms
    CPU time for                                            vxc tot      0.58 sec, wall time      0.59 sec, GPU time for    586.75 ms
    CPU time for                                           jk total      0.01 sec, wall time      0.01 sec, GPU time for      7.58 ms
E1 = -13205.238413943858  Ecoul = 6218.7808444215425  Exc = -274.50770089032915
init E= -1916.89345413687
    CPU time for                                         total prep      3.70 sec, wall time      3.07 sec, GPU time for   3074.33 ms
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      0.02 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.63 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      4.14 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    210.45 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.17 ms
    CPU time for                                               veff      0.22 sec, wall time      0.22 sec, GPU time for    216.69 ms
E1 = -13248.11885359214  Ecoul = 6271.029350046012  Exc = -276.699146017427
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.74 ms
    CPU time for                                              total      0.24 sec, wall time      0.24 sec, GPU time for    242.18 ms
cycle= 1 E= -1909.71683328778  delta_E= 7.18  |ddm|= 12.5
diis-norm(errvec)=2.19296
diis-c [-4.8090846  1.       ]
    CPU time for                                               DIIS      0.01 sec, wall time      0.02 sec, GPU time for     17.85 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.61 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.89 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    209.81 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.17 ms
    CPU time for                                               veff      0.22 sec, wall time      0.22 sec, GPU time for    216.04 ms
E1 = -13200.93208124144  Ecoul = 6220.458783332393  Exc = -272.9939134184217
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.73 ms
    CPU time for                                              total      0.24 sec, wall time      0.25 sec, GPU time for    251.25 ms
cycle= 2 E= -1909.39539505169  delta_E= 0.321  |ddm|= 3.56
diis-norm(errvec)=3.17885
diis-c [-0.29913436  0.59588563  0.40411437]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.25 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     16.16 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.87 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    209.97 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.13 ms
    CPU time for                                               veff      0.22 sec, wall time      0.22 sec, GPU time for    216.18 ms
E1 = -13220.3865294542  Ecoul = 6241.006912938634  Exc = -274.6678754223856
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.72 ms
    CPU time for                                              total      0.23 sec, wall time      0.24 sec, GPU time for    235.30 ms
cycle= 3 E= -1909.97567566217  delta_E= -0.58  |ddm|= 2.54
diis-norm(errvec)=0.93476
diis-c [-0.042056    0.35407968  0.27547172  0.3704486 ]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.36 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.79 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.86 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    211.21 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.15 ms
    CPU time for                                               veff      0.22 sec, wall time      0.22 sec, GPU time for    217.43 ms
E1 = -13226.037580588443  Ecoul = 6246.793967751445  Exc = -274.8601945299572
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.74 ms
    CPU time for                                              total      0.24 sec, wall time      0.24 sec, GPU time for    236.29 ms
cycle= 4 E= -1910.03199109118  delta_E= -0.0563  |ddm|= 0.778
diis-norm(errvec)=0.273393
diis-c [-0.00541479  0.1477711   0.12357134  0.24943224  0.47922532]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.52 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.82 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.87 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    210.59 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.17 ms
    CPU time for                                               veff      0.22 sec, wall time      0.22 sec, GPU time for    216.83 ms
E1 = -13225.906975871969  Ecoul = 6246.679352761288  Exc = -274.88034281236423
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.78 ms
    CPU time for                                              total      0.23 sec, wall time      0.24 sec, GPU time for    235.93 ms
cycle= 5 E= -1910.03614964727  delta_E= -0.00416  |ddm|= 0.271
diis-norm(errvec)=0.110985
diis-c [-0.00086039  0.06291452  0.05504333  0.13119766  0.33261674  0.41822775]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.65 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.98 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.87 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    210.31 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.16 ms
    CPU time for                                               veff      0.22 sec, wall time      0.22 sec, GPU time for    216.54 ms
E1 = -13225.196429200401  Ecoul = 6245.945873033411  Exc = -274.85816565986113
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.74 ms
    CPU time for                                              total      0.23 sec, wall time      0.24 sec, GPU time for    235.88 ms
cycle= 6 E= -1910.03690555107  delta_E= -0.000756  |ddm|= 0.107
diis-norm(errvec)=0.0389583
diis-c [-1.73746744e-04  2.00177111e-02  1.93307628e-02  5.24626439e-02
  1.53589613e-01  2.83130905e-01  4.71468364e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.79 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.84 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.85 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    210.27 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.15 ms
    CPU time for                                               veff      0.22 sec, wall time      0.22 sec, GPU time for    216.49 ms
E1 = -13225.31852326829  Ecoul = 6246.070550045875  Exc = -274.86079996571715
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.73 ms
    CPU time for                                              total      0.23 sec, wall time      0.24 sec, GPU time for    235.81 ms
cycle= 7 E= -1910.03695691235  delta_E= -5.14e-05  |ddm|= 0.0389
diis-norm(errvec)=0.0256858
diis-c [-3.14908098e-05  4.90444320e-03  5.91690819e-03  1.87051925e-02
  6.32251087e-02  1.53788809e-01  3.90072994e-01  3.63386545e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      2.31 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.75 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.86 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    210.89 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.17 ms
    CPU time for                                               veff      0.22 sec, wall time      0.22 sec, GPU time for    217.12 ms
E1 = -13225.286140225493  Ecoul = 6246.036294085643  Exc = -274.85895612230365
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.74 ms
    CPU time for                                              total      0.24 sec, wall time      0.24 sec, GPU time for    236.90 ms
cycle= 8 E= -1910.03698598638  delta_E= -2.91e-05  |ddm|= 0.029
diis-norm(errvec)=0.0163218
diis-c [-4.54364251e-06  9.67274845e-04  1.98937463e-03  7.60412649e-03
  2.94814321e-02  8.77394931e-02  2.67282557e-01  3.33079178e-01
  2.71856564e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      2.10 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.99 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.87 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    210.25 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.19 ms
    CPU time for                                               veff      0.22 sec, wall time      0.22 sec, GPU time for    216.52 ms
E1 = -13225.275982081488  Ecoul = 6246.025230072959  Exc = -274.85807241258345
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.73 ms
    CPU time for                                              total      0.24 sec, wall time      0.24 sec, GPU time for    236.32 ms
cycle= 9 E= -1910.03700814534  delta_E= -2.22e-05  |ddm|= 0.0138
diis-norm(errvec)=0.00279807
diis-c [-8.13479929e-07  4.70397959e-01  5.30729902e-04  2.59705762e-03
  1.11110215e-02  3.74341922e-02  1.24859489e-01  1.71952012e-01
  1.81117539e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      2.07 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     16.03 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.87 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    209.96 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.15 ms
    CPU time for                                               veff      0.22 sec, wall time      0.22 sec, GPU time for    216.18 ms
E1 = -13225.291513477268  Ecoul = 6246.0410057125155  Exc = -274.85831706505763
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.73 ms
    CPU time for                                              total      0.24 sec, wall time      0.24 sec, GPU time for    236.00 ms
cycle= 10 E= -1910.03700855403  delta_E= -4.09e-07  |ddm|= 0.00283
diis-norm(errvec)=0.0014799
diis-c [-1.09399113e-07  3.70546337e-01  5.06090628e-01  1.10418559e-04
  6.31004096e-04  4.26377510e-03  1.94621077e-02  3.63911843e-02
  6.25045455e-02]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      2.07 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.80 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.87 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    210.75 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.16 ms
    CPU time for                                               veff      0.22 sec, wall time      0.22 sec, GPU time for    216.98 ms
E1 = -13225.281507998809  Ecoul = 6246.030745472356  Exc = -274.8580624260683
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.72 ms
    CPU time for                                              total      0.24 sec, wall time      0.24 sec, GPU time for    236.55 ms
cycle= 11 E= -1910.03700867674  delta_E= -1.23e-07  |ddm|= 0.00136
diis-norm(errvec)=0.000647134
diis-c [-2.34470815e-08  2.34494461e-01  3.62920334e-01  3.32767285e-01
  9.23474993e-05  1.97806922e-03  1.01745892e-02  2.04035660e-02
  3.71693479e-02]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      2.09 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     15.93 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.87 ms
    CPU time for                                            vxc tot      0.21 sec, wall time      0.21 sec, GPU time for    210.31 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      6.14 ms
    CPU time for                                               veff      0.22 sec, wall time      0.22 sec, GPU time for    216.53 ms
E1 = -13225.284237673768  Ecoul = 6246.033600826657  Exc = -274.85818812631265
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.72 ms
    CPU time for                                              total      0.24 sec, wall time      0.24 sec, GPU time for    236.26 ms
cycle= 12 E= -1910.03700869765  delta_E= -2.09e-08  |ddm|= 0.000682
    CPU time for                                                SCF      6.56 sec, wall time      5.97 sec, GPU time for   5966.59 ms
converged SCF energy = -1910.03700869765
Nuc-Nuc PySCF=  5344.071816275777
One electron integrals energy -13225.284237673768
Coulomb energy  6246.033600826657
EXC  -274.85818812631265
PySCF time:  6.34500671364367
PySCF Grid Size:  (2239488,)
Initial guess from minao.
Currently Used memory: 4.3G


Natoms : 78


NAO : 870


aux NAO : 3288
Running DFT using 2 threads for Numba.


GPU acceleration is enabled. Currently this only accelerates AO values and XC term evaluation.
GPU(s) information:
Found 1 CUDA devices
id 0    b'NVIDIA A100 80GB PCIe'                              [SUPPORTED]
                      Compute Capability: 8.0
                           PCI Device ID: 0
                              PCI Bus ID: 129
                                    UUID: GPU-532978f3-f5cc-04fc-9dc8-613a4acb4a20
                                Watchdog: Disabled
             FP32/FP64 Performance Ratio: 2
Summary:
	1/1 devices are supported
True
Max threads per block supported by the GPU:  1024
The user has specified to use 1 GPU(s).
Threads per block configuration for the XC term:  (32, 32)
Threads per block configuration for the all other calculations:  (32, 32)

Calculating one electron integrals...


Core H size in GB  0.0060552
done!
Time taken 0.28762135840952396 seconds.


Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.17628461122512817 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.048838863149285316
Time taken to evaluate the square roots needed:  0.0013972911983728409
Time for significant indices evaluation:  0.24463878385722637
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.009093248
No. of elements in the standard three-centered two electron ERI tensor:  2488687200
No. of elements in the triangular three-centered two electron ERI tensor:  1245773880
No. of significant triplets based on Schwarz inequality and triangularity: 456741558 or 18.4% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.2950869854539633 seconds.

Two Center Two electron ERI size in GB  0.086487552
Three Center Two electron ERI size in GB  3.653932464
Three-centered two electron evaluation done!
Time taken for Cholesky factorization fo two-centered two-electron integrals 0.2613052371889353 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  10.505112074315548 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  2239488
Size (in GB) for storing the coordinates of grid:       0.053747712
Size (in GB) for storing the weights of grid:           0.017915904
Size (in GB) for storing the density at gridpoints:     0.017915904

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  20480
No. of batches:  110

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 0.04055450297892094 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    426
Average no. of basis functions contributing to a batch of grid points:    275


------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.52074607608137



------Iteration 1--------


Energies
Electron-Nuclear Energy       -15106.268306050053
Nuclear repulsion Energy      5344.071816290055
Kinetic Energy                1914.5676233881886
Coulomb Energy                6205.551586389212
Exchange-Correlation Energy   -274.347563336667
-------------------------
Total Energy  -1916.4248433192652
-------------------------



Energy difference :  1916.4248433192652


Time taken for the previous iteration: 0.7028434313833714


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  322.00000047148507



------Iteration 2--------


Energies
Electron-Nuclear Energy       -15141.373295983643
Nuclear repulsion Energy      5344.071816290055
Kinetic Energy                1890.6002424247522
Coulomb Energy                6273.244311035484
Exchange-Correlation Energy   -276.29214797592317
-------------------------
Total Energy  -1909.749074209274
-------------------------



Energy difference :  6.675769109991052


Time taken for the previous iteration: 0.6294556893408298


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  322.00000411774687



------Iteration 3--------


Energies
Electron-Nuclear Energy       -15066.22671639791
Nuclear repulsion Energy      5344.071816290055
Kinetic Energy                1869.9471875460154
Coulomb Energy                6215.314135312428
Exchange-Correlation Energy   -272.55485263478755
-------------------------
Total Energy  -1909.4484298842008
-------------------------



Energy difference :  0.3006443250733355


Time taken for the previous iteration: 0.725762290880084


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  322.000001255517



------Iteration 4--------


Energies
Electron-Nuclear Energy       -15101.54146190407
Nuclear repulsion Energy      5344.071816290055
Kinetic Energy                1880.9955624579966
Coulomb Energy                6240.702068352439
Exchange-Correlation Energy   -274.29765158853786
-------------------------
Total Energy  -1910.069666392118
-------------------------



Energy difference :  0.6212365079172741


Time taken for the previous iteration: 0.7740118000656366


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  322.0000015596455



------Iteration 5--------


Energies
Electron-Nuclear Energy       -15108.435738333968
Nuclear repulsion Energy      5344.071816290055
Kinetic Energy                1882.567162476772
Coulomb Energy                6246.211086380197
Exchange-Correlation Energy   -274.53422824998074
-------------------------
Total Energy  -1910.119901436924
-------------------------



Energy difference :  0.05023504480595875


Time taken for the previous iteration: 0.7740466017276049


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  322.0000013724372



------Iteration 6--------


Energies
Electron-Nuclear Energy       -15107.506500270782
Nuclear repulsion Energy      5344.071816290055
Kinetic Energy                1882.3486993352612
Coulomb Energy                6245.470684805567
Exchange-Correlation Energy   -274.5080786777567
-------------------------
Total Energy  -1910.1233785176546
-------------------------



Energy difference :  0.0034770807305903872


Time taken for the previous iteration: 0.802017392590642


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  322.00000142031337



------Iteration 7--------


Energies
Electron-Nuclear Energy       -15106.995815234455
Nuclear repulsion Energy      5344.071816290055
Kinetic Energy                1882.2558246533883
Coulomb Energy                6245.04117279097
Exchange-Correlation Energy   -274.49693896672306
-------------------------
Total Energy  -1910.1239404667658
-------------------------



Energy difference :  0.0005619491112156538


Time taken for the previous iteration: 0.7670027110725641


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  322.0000014530198



------Iteration 8--------


Energies
Electron-Nuclear Energy       -15106.989720714428
Nuclear repulsion Energy      5344.071816290055
Kinetic Energy                1882.2422321826998
Coulomb Energy                6245.047551423523
Exchange-Correlation Energy   -274.4958780035085
-------------------------
Total Energy  -1910.1239988216585
-------------------------



Energy difference :  5.8354892644274514e-05


Time taken for the previous iteration: 0.8265423104166985


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  322.0000014416333



------Iteration 9--------


Energies
Electron-Nuclear Energy       -15106.982532803911
Nuclear repulsion Energy      5344.071816290055
Kinetic Energy                1882.2275567060883
Coulomb Energy                6245.053227099799
Exchange-Correlation Energy   -274.49416554001795
-------------------------
Total Energy  -1910.1240982479876
-------------------------



Energy difference :  9.942632914317073e-05


Time taken for the previous iteration: 0.8596599642187357


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  322.00000144079524



------Iteration 10--------


Energies
Electron-Nuclear Energy       -15106.924133664419
Nuclear repulsion Energy      5344.071816290055
Kinetic Energy                1882.2064811064454
Coulomb Energy                6245.012528690707
Exchange-Correlation Energy   -274.4908027874537
-------------------------
Total Energy  -1910.1241103646662
-------------------------



Energy difference :  1.211667859024601e-05


Time taken for the previous iteration: 0.7778206933289766


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  322.00000143592234



------Iteration 11--------


Energies
Electron-Nuclear Energy       -15106.98341972516
Nuclear repulsion Energy      5344.071816290055
Kinetic Energy                1882.2254995451121
Coulomb Energy                6245.055654301086
Exchange-Correlation Energy   -274.4936623959223
-------------------------
Total Energy  -1910.1241119848282
-------------------------



Energy difference :  1.6201620383071713e-06


Time taken for the previous iteration: 0.9524115659296513


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  322.0000014389557



------Iteration 12--------


Energies
Electron-Nuclear Energy       -15106.992855785089
Nuclear repulsion Energy      5344.071816290055
Kinetic Energy                1882.228432049921
Coulomb Energy                6245.062548527469
Exchange-Correlation Energy   -274.4940531653542
-------------------------
Total Energy  -1910.124112082999
-------------------------



Energy difference :  9.817085810936987e-08


Time taken for the previous iteration: 1.3420395236462355



SCF Converged after 12 iterations!

-------------------------------------
Total Energy =  -1910.124112082999
-------------------------------------



Time taken : 20.801302747800946 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           0.04055450297892094
Density Fitting                         1.4548715502023697
    DF (gamma)                          0.6827483028173447
    DF (coeff)                          0.2176691833883524
    DF (Jtri)                           0.17596961557865143
    DF (Cholesky)                       0.2613052371889353
DIIS                                    0.06359807029366493
KS matrix diagonalization               0.40786480717360973
One electron Integrals (S, T, Vnuc)     0.28762135840952396
Coulomb Integrals (2c2e + 3c2e)         10.243806837126613
Grids construction                      0
Exchange-Correlation Term               8.219308791682124
Misc.                                   0.08367682993412018
Complete SCF                            20.801302747800946
