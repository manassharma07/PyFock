Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 73F3 16-Core Processor
Number of Cores: 32
Number of Threads: 64
Memory (GB): 503.74185943603516
Number of cores being actually used/requested for the benchmark: 2
Confirming that the environment variables are properly set...
OMP_NUM_THREADS = 2
OPENBLAS_NUM_THREADS = 2
MKL_NUM_THREADS = 2
VECLIB_MAXIMUM_THREADS = 2
NUMEXPR_NUM_THREADS = 2
PYSCF_MAX_MEMORY = 225000
#INFO: **** input file is /home/lu29vow/GPU_Test/tmp_dir/PyFock/benchmarks_tests/bench_PySCF_vs_PyFock_GPU.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
numba.config.THREADING_LAYER='omp'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 2
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(225000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf
from gpu4pyscf import dft as dft_gpu

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)

# basis_set_name = 'sto-2g'
# basis_set_name = 'sto-3g'
# basis_set_name = 'sto-6g'
# basis_set_name = '6-31G'
# basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-SVPD'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'def2-QZVP'
# basis_set_name = 'def2-TZVPP'
# basis_set_name = 'def2-QZVPP'
basis_set_name = 'def2-TZVPD'
# basis_set_name = 'def2-QZVPD'
# basis_set_name = 'def2-TZVPPD'
# basis_set_name = 'def2-QZVPPD'
# basis_set_name = 'cc-pVDZ'
# basis_set_name = 'ano-rcc'

auxbasis_name = 'def2-universal-jfit'
# auxbasis_name = 'def2-universal-jkfit'
# auxbasis_name = 'def2-TZVP'
# auxbasis_name = 'sto-3g'
# auxbasis_name = 'def2-SVP'
# auxbasis_name = '6-31G'

# xyzFilename = 'Benzene-Fulvene_Dimer.xyz'
# xyzFilename = 'Adenine-Thymine.xyz'
# xyzFilename = 'Zn.xyz'
# xyzFilename = 'Zn_dimer.xyz'
# xyzFilename = 'TPP.xyz'
# xyzFilename = 'Zn_TPP.xyz'
# xyzFilename = 'H2O.xyz'

# xyzFilename = 'Caffeine.xyz'
# xyzFilename = 'Serotonin.xyz'
# xyzFilename = 'Cholesterol.xyz'
# xyzFilename = 'C60.xyz'
# xyzFilename = 'Taxol.xyz'
# xyzFilename = 'Valinomycin.xyz'
# xyzFilename = 'Olestra.xyz'
# xyzFilename = 'Ubiquitin.xyz'

### 1D Carbon Alkanes
# xyzFilename = 'Ethane.xyz'
# xyzFilename = 'Decane_C10H22.xyz'
# xyzFilename = 'Icosane_C20H42.xyz'
xyzFilename = 'Tetracontane_C40H82.xyz'
# xyzFilename = 'Pentacontane_C50H102.xyz'
# xyzFilename = 'Octacontane_C80H162.xyz'
# xyzFilename = 'Hectane_C100H202.xyz'
# xyzFilename = 'Icosahectane_C120H242.xyz'

### 2D Carbon
# xyzFilename = 'Graphene_C16.xyz'
# xyzFilename = 'Graphene_C76.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'

### 3d Carbon Fullerenes
# xyzFilename = 'C60.xyz'
# xyzFilename = 'C70.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'


# ---------PySCF---------------
#Comparison with PySCF
molPySCF = gto.Mole()
molPySCF.atom = xyzFilename
molPySCF.basis = basis_set_name
molPySCF.cart = False
molPySCF.verbose = 4
molPySCF.max_memory=25000
# molPySCF.incore_anyway = True # Keeps the PySCF ERI integrals incore
molPySCF.build()
#print(molPySCF.cart_labels())

print('\n\nPySCF Results\n\n')
start=timer()
mf = dft_gpu.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
# mf = scf.RHF(molPySCF).density_fit(auxbasis=auxbasis_name)
mf.xc = funcidpyscf
mf.verbose = 6
# dmat_init = mf.init_guess_by_1e(molPySCF)
# dmat_init = mf.init_guess_by_huckel(molPySCF)
mf.init_guess = 'minao'
dmat_init = mf.init_guess_by_minao(molPySCF)
# mf.init_guess = 'atom'
# dmat_init = mf.init_guess_by_atom(molPySCF)
mf.max_cycle = 30
mf.conv_tol = 1e-7
mf.grids.level = 5
energyPyscf = mf.kernel(dm0=dmat_init)
print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
print('One electron integrals energy',mf.scf_summary['e1'])
print('Coulomb energy ',mf.scf_summary['coul'])
print('EXC ',mf.scf_summary['exc'])
duration = timer()-start
print('PySCF time: ', duration)
pyscfGrids = mf.grids
print('PySCF Grid Size: ', pyscfGrids.weights.shape)
mf = 0#None

# Get an initial guess for dmat from PySCF using CAO basis (Need to use CPU pyscf for this as GPU version oesnt support SAO yet)
molPySCF.cart = True
molPySCF.build()
mf2 = dft_gpu.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
mf2.init_guess = 'minao'
dmat_init = mf2.init_guess_by_minao(molPySCF)
import cupy as cp
cp._default_memory_pool.free_all_blocks()

import psutil

# Get memory information
memory_info = psutil.virtual_memory()

# Convert bytes to human-readable format
used_memory = psutil._common.bytes2human(memory_info.used)


# If you want to print in a more human-readable format, you can use psutil's utility function
print(f"Currently Used memory: {used_memory}")
#--------------------CrysX --------------------------

#Initialize a Mol object with somewhat large geometry
molCrysX = Mol(coordfile=xyzFilename)
print('\n\nNatoms :',molCrysX.natoms)
# print(molCrysX.coordsBohrs)

#Initialize a Basis object with a very large basis set
basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})
print('\n\nNAO :',basis.bfs_nao)

auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})
print('\n\naux NAO :',auxbasis.bfs_nao)

dftObj = DFT(molCrysX, basis, xc=funcidcrysx)
# GPU acceleration
dftObj.use_gpu = True
dftObj.keep_ao_in_gpu = False
dftObj.use_libxc = False
dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
dftObj.n_gpus = 2 # Specify the number of GPUs
dftObj.free_gpu_mem = True
dftObj.threads_x = 32
dftObj.threads_y = 32
dftObj.dynamic_precision = False
dftObj.keep_ints3c2e_in_gpu = True
# SAO or CAO basis
dftObj.sao = False
# print(dmat_init)
# Using PySCF grids to compare the energies
energyCrysX, dmat = dftObj.scf(max_itr=35, ncores=ncores, dmat=dmat_init, conv_crit=1.0E-7, grids=pyscfGrids, \
                               isDF=True, auxbasis=auxbasis, rys=True, DF_algo=10, blocksize=20480, XC_algo=3, debug=False, \
                                sortGrids=False, save_ao_values=False, xc_bf_screen=True, threshold_schwarz=1e-9, \
                                strict_schwarz=False, cholesky=True, orthogonalize=True)
# print(dmat)

# Using CrysX grids 
# To get the same energies as PySCF (level=5) upto 1e-7 au, use the following settings
# radial_precision=1.0e-13
# level=3
# pruning by density with threshold = 1e-011
# alpha_min and alpha_max corresponding to QZVP
# energyCrysX, dmat = dftObj.scf(max_itr=30, ncores=ncores, dmat=dmat_init, grids=None, gridsLevel=3, isDF=True, auxbasis=auxbasis,
#                             rys=True, DF_algo=6, blocksize=5000, XC_algo=2, debug=False, sortGrids=False, save_ao_values=True,
#                             xc_bf_screen=True,threshold_schwarz=1e-9)


print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf[0]))

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='gpu017.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64')  Threads 2
Python 3.10.13 (tags/v3.10.13-25-g07fbd8e9251-dirty:07fbd8e9251, Sep 27 2023, 23:32:09) [GCC 13.2.0]
numpy 1.26.3  scipy 1.10.1
Date: Sun Feb  4 15:30:31 2024
PySCF version 2.4.0
PySCF path  /home/lu29vow/.conda/envs/GPU2/lib/python3.10/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 225000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 122
[INPUT] num. electrons = 322
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C     -0.624000000000  -0.442600000000   0.000000000000 AA   -1.179189101729  -0.836392782732   0.000000000000 Bohr   0.0
[INPUT]  2 C     -1.874500000000   0.438900000000   0.000000000000 AA   -3.542291620497   0.829400796072   0.000000000000 Bohr   0.0
[INPUT]  3 C     -3.122400000000  -0.446400000000   0.000000000000 AA   -5.900480851342  -0.843573742006   0.000000000000 Bohr   0.0
[INPUT]  4 C     -4.373000000000   0.435100000000   0.000000000000 AA   -8.263772342723   0.822219836798   0.000000000000 Bohr   0.0
[INPUT]  5 C     -5.620900000000  -0.450100000000   0.000000000000 AA  -10.621961573568  -0.850565728667   0.000000000000 Bohr   0.0
[INPUT]  6 C     -6.871500000000   0.431400000000   0.000000000000 AA  -12.985253064949   0.815227850137   0.000000000000 Bohr   0.0
[INPUT]  7 C     -8.119400000000  -0.453900000000   0.000000000000 AA  -15.343442295794  -0.857746687940   0.000000000000 Bohr   0.0
[INPUT]  8 C     -9.370000000000   0.427600000000   0.000000000000 AA  -17.706733787175   0.808046890864   0.000000000000 Bohr   0.0
[INPUT]  9 C    -10.617900000000  -0.457600000000   0.000000000000 AA  -20.064923018019  -0.864738674601   0.000000000000 Bohr   0.0
[INPUT] 10 C    -11.868400000000   0.423800000000   0.000000000000 AA  -22.428025536788   0.800865931591   0.000000000000 Bohr   0.0
[INPUT] 11 C    -13.116300000000  -0.461400000000   0.000000000000 AA  -24.786214767633  -0.871919633874   0.000000000000 Bohr   0.0
[INPUT] 12 C    -14.366900000000   0.420100000000   0.000000000000 AA  -27.149506259014   0.793873944930   0.000000000000 Bohr   0.0
[INPUT] 13 C    -15.614800000000  -0.465100000000   0.000000000000 AA  -29.507695489859  -0.878911620535   0.000000000000 Bohr   0.0
[INPUT] 14 C    -16.865400000000   0.416300000000   0.000000000000 AA  -31.870986981240   0.786692985656   0.000000000000 Bohr   0.0
[INPUT] 15 C    -18.113300000000  -0.468900000000   0.000000000000 AA  -34.229176212084  -0.886092579809   0.000000000000 Bohr   0.0
[INPUT] 16 C    -19.363899000000   0.412600000000   0.000000000000 AA  -36.592465813739   0.779700998996   0.000000000000 Bohr   0.0
[INPUT] 17 C    -20.611799000000  -0.472600000000   0.000000000000 AA  -38.950655044584  -0.893084566469   0.000000000000 Bohr   0.0
[INPUT] 18 C    -21.862301000000   0.408800000000   0.000000000000 AA  -41.313761342805   0.772520039722   0.000000000000 Bohr   0.0
[INPUT] 19 C    -23.110201000000  -0.476400000000   0.000000000000 AA  -43.671950573650  -0.900265525743   0.000000000000 Bohr   0.0
[INPUT] 20 C    -24.360800000000   0.405100000000   0.000000000000 AA  -46.035240175305   0.765528053061   0.000000000000 Bohr   0.0
[INPUT] 21 C      0.624000000000   0.442600000000   0.000000000000 AA    1.179189101729   0.836392782732   0.000000000000 Bohr   0.0
[INPUT] 22 C      1.874500000000  -0.438900000000   0.000000000000 AA    3.542291620497  -0.829400796072   0.000000000000 Bohr   0.0
[INPUT] 23 C      3.122400000000   0.446400000000   0.000000000000 AA    5.900480851342   0.843573742006   0.000000000000 Bohr   0.0
[INPUT] 24 C      4.373000000000  -0.435100000000   0.000000000000 AA    8.263772342723  -0.822219836798   0.000000000000 Bohr   0.0
[INPUT] 25 C      5.620900000000   0.450100000000   0.000000000000 AA   10.621961573568   0.850565728667   0.000000000000 Bohr   0.0
[INPUT] 26 C      6.871500000000  -0.431400000000   0.000000000000 AA   12.985253064949  -0.815227850137   0.000000000000 Bohr   0.0
[INPUT] 27 C      8.119400000000   0.453900000000   0.000000000000 AA   15.343442295794   0.857746687940   0.000000000000 Bohr   0.0
[INPUT] 28 C      9.370000000000  -0.427600000000   0.000000000000 AA   17.706733787175  -0.808046890864   0.000000000000 Bohr   0.0
[INPUT] 29 C     10.617900000000   0.457600000000   0.000000000000 AA   20.064923018019   0.864738674601   0.000000000000 Bohr   0.0
[INPUT] 30 C     11.868400000000  -0.423800000000   0.000000000000 AA   22.428025536788  -0.800865931591   0.000000000000 Bohr   0.0
[INPUT] 31 C     13.116300000000   0.461400000000   0.000000000000 AA   24.786214767633   0.871919633874   0.000000000000 Bohr   0.0
[INPUT] 32 C     14.366900000000  -0.420100000000   0.000000000000 AA   27.149506259014  -0.793873944930   0.000000000000 Bohr   0.0
[INPUT] 33 C     15.614800000000   0.465100000000   0.000000000000 AA   29.507695489859   0.878911620535   0.000000000000 Bohr   0.0
[INPUT] 34 C     16.865400000000  -0.416300000000   0.000000000000 AA   31.870986981240  -0.786692985656   0.000000000000 Bohr   0.0
[INPUT] 35 C     18.113300000000   0.468900000000   0.000000000000 AA   34.229176212084   0.886092579809   0.000000000000 Bohr   0.0
[INPUT] 36 C     19.363899000000  -0.412600000000   0.000000000000 AA   36.592465813739  -0.779700998996   0.000000000000 Bohr   0.0
[INPUT] 37 C     20.611799000000   0.472600000000   0.000000000000 AA   38.950655044584   0.893084566469   0.000000000000 Bohr   0.0
[INPUT] 38 C     21.862301000000  -0.408800000000   0.000000000000 AA   41.313761342805  -0.772520039722   0.000000000000 Bohr   0.0
[INPUT] 39 C     23.110201000000   0.476400000000   0.000000000000 AA   43.671950573650   0.900265525743   0.000000000000 Bohr   0.0
[INPUT] 40 C     24.360800000000  -0.405100000000   0.000000000000 AA   46.035240175305  -0.765528053061   0.000000000000 Bohr   0.0
[INPUT] 41 H     -0.623000000000  -1.071900000000   0.890000000000 AA   -1.177299375604  -2.025597432921   1.681856250863 Bohr   0.0
[INPUT] 42 H     -0.623000000000  -1.071900000000  -0.890000000000 AA   -1.177299375604  -2.025597432921  -1.681856250863 Bohr   0.0
[INPUT] 43 H     -1.875500000000   1.068200000000   0.890000000000 AA   -3.544181346622   2.018605446260   1.681856250863 Bohr   0.0
[INPUT] 44 H     -1.875500000000   1.068200000000  -0.890000000000 AA   -3.544181346622   2.018605446260  -1.681856250863 Bohr   0.0
[INPUT] 45 H     -3.121500000000  -1.075700000000  -0.890000000000 AA   -5.898780097830  -2.032778392195  -1.681856250863 Bohr   0.0
[INPUT] 46 H     -3.121500000000  -1.075700000000   0.890000000000 AA   -5.898780097830  -2.032778392195   1.681856250863 Bohr   0.0
[INPUT] 47 H     -4.373900000000   1.064400000000   0.890000000000 AA   -8.265473096235   2.011424486987   1.681856250863 Bohr   0.0
[INPUT] 48 H     -4.373900000000   1.064400000000  -0.890000000000 AA   -8.265473096235   2.011424486987  -1.681856250863 Bohr   0.0
[INPUT] 49 H     -5.620000000000  -1.079400000000  -0.890000000000 AA  -10.620260820056  -2.039770378856  -1.681856250863 Bohr   0.0
[INPUT] 50 H     -5.620000000000  -1.079400000000   0.890000000000 AA  -10.620260820056  -2.039770378856   1.681856250863 Bohr   0.0
[INPUT] 51 H     -6.872400000000   1.060700000000   0.890000000000 AA  -12.986953818461   2.004432500326   1.681856250863 Bohr   0.0
[INPUT] 52 H     -6.872400000000   1.060700000000  -0.890000000000 AA  -12.986953818461   2.004432500326  -1.681856250863 Bohr   0.0
[INPUT] 53 H     -8.118400000000  -1.083200000000  -0.890000000000 AA  -15.341552569669  -2.046951338129  -1.681856250863 Bohr   0.0
[INPUT] 54 H     -8.118400000000  -1.083200000000   0.890000000000 AA  -15.341552569669  -2.046951338129   1.681856250863 Bohr   0.0
[INPUT] 55 H     -9.370900000000   1.056900000000   0.890000000000 AA  -17.708434540687   1.997251541053   1.681856250863 Bohr   0.0
[INPUT] 56 H     -9.370900000000   1.056900000000  -0.890000000000 AA  -17.708434540687   1.997251541053  -1.681856250863 Bohr   0.0
[INPUT] 57 H    -10.616900000000  -1.086900000000  -0.890000000000 AA  -20.063033291895  -2.053943324790  -1.681856250863 Bohr   0.0
[INPUT] 58 H    -10.616900000000  -1.086900000000   0.890000000000 AA  -20.063033291895  -2.053943324790   1.681856250863 Bohr   0.0
[INPUT] 59 H    -11.869400000000   1.053200000000   0.890000000000 AA  -22.429915262913   1.990259554392   1.681856250863 Bohr   0.0
[INPUT] 60 H    -11.869400000000   1.053200000000  -0.890000000000 AA  -22.429915262913   1.990259554392  -1.681856250863 Bohr   0.0
[INPUT] 61 H    -13.115400000000  -1.090700000000  -0.890000000000 AA  -24.784514014121  -2.061124284063  -1.681856250863 Bohr   0.0
[INPUT] 62 H    -13.115400000000  -1.090700000000   0.890000000000 AA  -24.784514014121  -2.061124284063   1.681856250863 Bohr   0.0
[INPUT] 63 H    -14.367800000000   1.049400000000   0.890000000000 AA  -27.151207012526   1.983078595119   1.681856250863 Bohr   0.0
[INPUT] 64 H    -14.367800000000   1.049400000000  -0.890000000000 AA  -27.151207012526   1.983078595119  -1.681856250863 Bohr   0.0
[INPUT] 65 H    -15.613900000000  -1.094400000000  -0.890000000000 AA  -29.505994736346  -2.068116270724  -1.681856250863 Bohr   0.0
[INPUT] 66 H    -15.613900000000  -1.094400000000   0.890000000000 AA  -29.505994736346  -2.068116270724   1.681856250863 Bohr   0.0
[INPUT] 67 H    -16.866301000000   1.045600000000   0.890000000000 AA  -31.872689624478   1.975897635845   1.681856250863 Bohr   0.0
[INPUT] 68 H    -16.866301000000   1.045600000000  -0.890000000000 AA  -31.872689624478   1.975897635845  -1.681856250863 Bohr   0.0
[INPUT] 69 H    -18.112301000000  -1.098200000000  -0.890000000000 AA  -34.227288375686  -2.075297229997  -1.681856250863 Bohr   0.0
[INPUT] 70 H    -18.112301000000  -1.098200000000   0.890000000000 AA  -34.227288375686  -2.075297229997   1.681856250863 Bohr   0.0
[INPUT] 71 H    -19.364799000000   1.041900000000   0.890000000000 AA  -36.594166567251   1.968905649184   1.681856250863 Bohr   0.0
[INPUT] 72 H    -19.364799000000   1.041900000000  -0.890000000000 AA  -36.594166567251   1.968905649184  -1.681856250863 Bohr   0.0
[INPUT] 73 H    -20.610800000000  -1.102000000000  -0.890000000000 AA  -38.948767208186  -2.082478189271  -1.681856250863 Bohr   0.0
[INPUT] 74 H    -20.610800000000  -1.101900000000   0.890000000000 AA  -38.948767208186  -2.082289216658   1.681856250863 Bohr   0.0
[INPUT] 75 H    -21.863300000000   1.038100000000   0.890000000000 AA  -41.315649179203   1.961724689911   1.681856250863 Bohr   0.0
[INPUT] 76 H    -21.863300000000   1.038100000000  -0.890000000000 AA  -41.315649179203   1.961724689911  -1.681856250863 Bohr   0.0
[INPUT] 77 H    -23.109301000000  -1.105700000000  -0.890000000000 AA  -43.670249820138  -2.089470175932  -1.681856250863 Bohr   0.0
[INPUT] 78 H    -23.109301000000  -1.105700000000   0.890000000000 AA  -43.670249820138  -2.089470175932   1.681856250863 Bohr   0.0
[INPUT] 79 H    -24.361799000000   1.034400000000   0.890000000000 AA  -46.037128011703   1.954732703250   1.681856250863 Bohr   0.0
[INPUT] 80 H    -24.361799000000   1.034400000000  -0.890000000000 AA  -46.037128011703   1.954732703250  -1.681856250863 Bohr   0.0
[INPUT] 81 H    -25.249800000000  -0.225600000000   0.000000000000 AA  -47.715206700043  -0.426322213702   0.000000000000 Bohr   0.0
[INPUT] 82 H      0.623000000000   1.071900000000  -0.890000000000 AA    1.177299375604   2.025597432921  -1.681856250863 Bohr   0.0
[INPUT] 83 H      0.623000000000   1.071900000000   0.890000000000 AA    1.177299375604   2.025597432921   1.681856250863 Bohr   0.0
[INPUT] 84 H      1.875500000000  -1.068200000000   0.890000000000 AA    3.544181346622  -2.018605446260   1.681856250863 Bohr   0.0
[INPUT] 85 H      1.875500000000  -1.068200000000  -0.890000000000 AA    3.544181346622  -2.018605446260  -1.681856250863 Bohr   0.0
[INPUT] 86 H      3.121500000000   1.075700000000  -0.890000000000 AA    5.898780097830   2.032778392195  -1.681856250863 Bohr   0.0
[INPUT] 87 H      3.121500000000   1.075700000000   0.890000000000 AA    5.898780097830   2.032778392195   1.681856250863 Bohr   0.0
[INPUT] 88 H      4.373900000000  -1.064400000000   0.890000000000 AA    8.265473096235  -2.011424486987   1.681856250863 Bohr   0.0
[INPUT] 89 H      4.373900000000  -1.064400000000  -0.890000000000 AA    8.265473096235  -2.011424486987  -1.681856250863 Bohr   0.0
[INPUT] 90 H      5.620000000000   1.079400000000  -0.890000000000 AA   10.620260820056   2.039770378856  -1.681856250863 Bohr   0.0
[INPUT] 91 H      5.620000000000   1.079400000000   0.890000000000 AA   10.620260820056   2.039770378856   1.681856250863 Bohr   0.0
[INPUT] 92 H      6.872400000000  -1.060700000000   0.890000000000 AA   12.986953818461  -2.004432500326   1.681856250863 Bohr   0.0
[INPUT] 93 H      6.872400000000  -1.060700000000  -0.890000000000 AA   12.986953818461  -2.004432500326  -1.681856250863 Bohr   0.0
[INPUT] 94 H      8.118400000000   1.083200000000  -0.890000000000 AA   15.341552569669   2.046951338129  -1.681856250863 Bohr   0.0
[INPUT] 95 H      8.118400000000   1.083200000000   0.890000000000 AA   15.341552569669   2.046951338129   1.681856250863 Bohr   0.0
[INPUT] 96 H      9.370900000000  -1.056900000000   0.890000000000 AA   17.708434540687  -1.997251541053   1.681856250863 Bohr   0.0
[INPUT] 97 H      9.370900000000  -1.056900000000  -0.890000000000 AA   17.708434540687  -1.997251541053  -1.681856250863 Bohr   0.0
[INPUT] 98 H     10.616900000000   1.086900000000  -0.890000000000 AA   20.063033291895   2.053943324790  -1.681856250863 Bohr   0.0
[INPUT] 99 H     10.616900000000   1.086900000000   0.890000000000 AA   20.063033291895   2.053943324790   1.681856250863 Bohr   0.0
[INPUT]100 H     11.869400000000  -1.053200000000   0.890000000000 AA   22.429915262913  -1.990259554392   1.681856250863 Bohr   0.0
[INPUT]101 H     11.869400000000  -1.053200000000  -0.890000000000 AA   22.429915262913  -1.990259554392  -1.681856250863 Bohr   0.0
[INPUT]102 H     13.115400000000   1.090700000000  -0.890000000000 AA   24.784514014121   2.061124284063  -1.681856250863 Bohr   0.0
[INPUT]103 H     13.115400000000   1.090700000000   0.890000000000 AA   24.784514014121   2.061124284063   1.681856250863 Bohr   0.0
[INPUT]104 H     14.367800000000  -1.049400000000   0.890000000000 AA   27.151207012526  -1.983078595119   1.681856250863 Bohr   0.0
[INPUT]105 H     14.367800000000  -1.049400000000  -0.890000000000 AA   27.151207012526  -1.983078595119  -1.681856250863 Bohr   0.0
[INPUT]106 H     15.613900000000   1.094400000000  -0.890000000000 AA   29.505994736346   2.068116270724  -1.681856250863 Bohr   0.0
[INPUT]107 H     15.613900000000   1.094400000000   0.890000000000 AA   29.505994736346   2.068116270724   1.681856250863 Bohr   0.0
[INPUT]108 H     16.866301000000  -1.045600000000   0.890000000000 AA   31.872689624478  -1.975897635845   1.681856250863 Bohr   0.0
[INPUT]109 H     16.866301000000  -1.045600000000  -0.890000000000 AA   31.872689624478  -1.975897635845  -1.681856250863 Bohr   0.0
[INPUT]110 H     18.112301000000   1.098200000000  -0.890000000000 AA   34.227288375686   2.075297229997  -1.681856250863 Bohr   0.0
[INPUT]111 H     18.112301000000   1.098200000000   0.890000000000 AA   34.227288375686   2.075297229997   1.681856250863 Bohr   0.0
[INPUT]112 H     19.364799000000  -1.041900000000   0.890000000000 AA   36.594166567251  -1.968905649184   1.681856250863 Bohr   0.0
[INPUT]113 H     19.364799000000  -1.041900000000  -0.890000000000 AA   36.594166567251  -1.968905649184  -1.681856250863 Bohr   0.0
[INPUT]114 H     20.610800000000   1.102000000000  -0.890000000000 AA   38.948767208186   2.082478189271  -1.681856250863 Bohr   0.0
[INPUT]115 H     20.610800000000   1.101900000000   0.890000000000 AA   38.948767208186   2.082289216658   1.681856250863 Bohr   0.0
[INPUT]116 H     21.863300000000  -1.038100000000   0.890000000000 AA   41.315649179203  -1.961724689911   1.681856250863 Bohr   0.0
[INPUT]117 H     21.863300000000  -1.038100000000  -0.890000000000 AA   41.315649179203  -1.961724689911  -1.681856250863 Bohr   0.0
[INPUT]118 H     23.109301000000   1.105700000000  -0.890000000000 AA   43.670249820138   2.089470175932  -1.681856250863 Bohr   0.0
[INPUT]119 H     23.109301000000   1.105700000000   0.890000000000 AA   43.670249820138   2.089470175932   1.681856250863 Bohr   0.0
[INPUT]120 H     24.361799000000  -1.034400000000   0.890000000000 AA   46.037128011703  -1.954732703250   1.681856250863 Bohr   0.0
[INPUT]121 H     24.361799000000  -1.034400000000  -0.890000000000 AA   46.037128011703  -1.954732703250  -1.681856250863 Bohr   0.0
[INPUT]122 H     25.249800000000   0.225600000000   0.000000000000 AA   47.715206700043   0.426322213702   0.000000000000 Bohr   0.0

nuclear repulsion = 3467.77719833212
number of shells = 930
number of NR pGTOs = 2982
number of NR cGTOs = 2218
basis = def2-TZVPD
ecp = {}
CPU time:         2.55


PySCF Results


Initial guess from minao.


******** <class 'gpu4pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'gpu4pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 30
direct_scf = False
chkfile to save SCF result = /tmp/tmpvpcys0jr
max_memory 25000 MB (current use 1935 MB)
XC library pyscf.dft.libxc version 6.1.0
    unable to decode the reference due to https://github.com/NVIDIA/cuda-python/issues/29
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x145f17621750>
grids dens level: 5
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x145f176215a0>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 3653760
prune_by_density_: 126 padding grids
    CPU time for                                   setting up grids      3.96 sec, wall time      3.27 sec, GPU time for   3268.01 ms
    CPU time for                                            vxc tot      1.42 sec, wall time      1.43 sec, GPU time for   1426.65 ms
    CPU time for                                           jk total      0.03 sec, wall time      0.03 sec, GPU time for     31.95 ms
E1 = -8982.450374886437  Ecoul = 4185.102282768441  Exc = -243.7236774363165
init E= -1573.29457122219
    CPU time for                                         total prep     11.15 sec, wall time      7.75 sec, GPU time for   7749.68 ms
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      0.08 ms
    CPU time for                                                eig      0.06 sec, wall time      0.06 sec, GPU time for     64.50 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.01 sec, GPU time for      3.29 ms
    CPU time for                                            vxc tot      0.42 sec, wall time      0.42 sec, GPU time for    425.08 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     26.56 ms
    CPU time for                                               veff      0.45 sec, wall time      0.45 sec, GPU time for    451.73 ms
E1 = -9051.776714516733  Ecoul = 4262.320702780953  Exc = -249.46408294170104
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.13 ms
    CPU time for                                              total      0.52 sec, wall time      0.53 sec, GPU time for    524.62 ms
cycle= 1 E= -1571.14289634536  delta_E= 2.15  |ddm|=   16
diis-norm(errvec)=7.16644
diis-c [-51.35788356   1.        ]
    CPU time for                                               DIIS      0.01 sec, wall time      0.02 sec, GPU time for     16.68 ms
    CPU time for                                                eig      0.06 sec, wall time      0.06 sec, GPU time for     64.55 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.98 ms
    CPU time for                                            vxc tot      0.42 sec, wall time      0.42 sec, GPU time for    424.34 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     26.51 ms
    CPU time for                                               veff      0.45 sec, wall time      0.45 sec, GPU time for    450.93 ms
E1 = -8948.459387293371  Ecoul = 4152.280240789724  Exc = -241.69298368176618
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.16 ms
    CPU time for                                              total      0.53 sec, wall time      0.53 sec, GPU time for    534.49 ms
cycle= 2 E= -1570.09493185329  delta_E= 1.05  |ddm|= 12.9
diis-norm(errvec)=11.3487
diis-c [-0.8826132   0.61418072  0.38581928]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      3.89 ms
    CPU time for                                                eig      0.06 sec, wall time      0.06 sec, GPU time for     64.63 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.98 ms
    CPU time for                                            vxc tot      0.42 sec, wall time      0.42 sec, GPU time for    424.50 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     26.52 ms
    CPU time for                                               veff      0.45 sec, wall time      0.45 sec, GPU time for    451.10 ms
E1 = -9011.999003039946  Ecoul = 4218.407999767997  Exc = -246.13563943872109
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.08 ms
    CPU time for                                              total      0.52 sec, wall time      0.52 sec, GPU time for    521.87 ms
cycle= 3 E= -1571.94944437855  delta_E= -1.85  |ddm|= 9.38
diis-norm(errvec)=0.36348
diis-c [-0.03717656  0.1547892   0.09444387  0.75076693]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      4.11 ms
    CPU time for                                                eig      0.06 sec, wall time      0.06 sec, GPU time for     65.71 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      1.00 ms
    CPU time for                                            vxc tot      0.42 sec, wall time      0.42 sec, GPU time for    424.51 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     26.52 ms
    CPU time for                                               veff      0.45 sec, wall time      0.45 sec, GPU time for    451.10 ms
E1 = -9012.173233255193  Ecoul = 4218.650578436471  Exc = -246.20530482113162
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.07 ms
    CPU time for                                              total      0.52 sec, wall time      0.52 sec, GPU time for    523.17 ms
cycle= 4 E= -1571.95076130773  delta_E= -0.00132  |ddm|= 0.588
diis-norm(errvec)=0.183137
diis-c [-0.00473693  0.05199017  0.03017659  0.37549399  0.54233925]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      4.66 ms
    CPU time for                                                eig      0.06 sec, wall time      0.06 sec, GPU time for     65.74 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.95 ms
    CPU time for                                            vxc tot      0.42 sec, wall time      0.42 sec, GPU time for    425.10 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     26.56 ms
    CPU time for                                               veff      0.45 sec, wall time      0.45 sec, GPU time for    451.74 ms
E1 = -9012.27776333055  Ecoul = 4218.75897971625  Exc = -246.20959663088163
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      3.48 ms
    CPU time for                                              total      0.52 sec, wall time      0.53 sec, GPU time for    526.76 ms
cycle= 5 E= -1571.95118191306  delta_E= -0.000421  |ddm|= 0.122
diis-norm(errvec)=0.068826
diis-c [-1.36255645e-04  7.57500523e-03  3.52468337e-03  1.08962934e-01
  3.09262363e-01  5.70675015e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      4.54 ms
    CPU time for                                                eig      0.06 sec, wall time      0.06 sec, GPU time for     65.39 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.95 ms
    CPU time for                                            vxc tot      0.42 sec, wall time      0.43 sec, GPU time for    426.12 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     26.51 ms
    CPU time for                                               veff      0.45 sec, wall time      0.45 sec, GPU time for    452.71 ms
E1 = -9012.301796363125  Ecoul = 4218.7827355966865  Exc = -246.2093884292469
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.09 ms
    CPU time for                                              total      0.52 sec, wall time      0.52 sec, GPU time for    524.87 ms
cycle= 6 E= -1571.95125086356  delta_E= -6.9e-05  |ddm|= 0.0499
diis-norm(errvec)=0.0081603
diis-c [-1.63329063e-05  1.88841280e-03  7.89578642e-04  3.48791778e-02
  1.09006083e-01  2.27147501e-01  6.26289247e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      4.76 ms
    CPU time for                                                eig      0.06 sec, wall time      0.06 sec, GPU time for     64.50 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.94 ms
    CPU time for                                            vxc tot      0.42 sec, wall time      0.42 sec, GPU time for    424.16 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     26.48 ms
    CPU time for                                               veff      0.45 sec, wall time      0.45 sec, GPU time for    450.71 ms
E1 = -9012.297868817686  Ecoul = 4218.778390972779  Exc = -246.20897207177288
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.08 ms
    CPU time for                                              total      0.52 sec, wall time      0.52 sec, GPU time for    522.18 ms
cycle= 7 E= -1571.95125158456  delta_E= -7.21e-07  |ddm|= 0.00798
diis-norm(errvec)=0.00404743
diis-c [-1.14873322e-06  2.03830728e-04  6.93206085e-05  6.34909972e-03
  2.24407825e-02  5.57256387e-02  3.52555441e-01  5.62655887e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      4.96 ms
    CPU time for                                                eig      0.06 sec, wall time      0.07 sec, GPU time for     66.27 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.99 ms
    CPU time for                                            vxc tot      0.42 sec, wall time      0.42 sec, GPU time for    424.86 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     26.60 ms
    CPU time for                                               veff      0.45 sec, wall time      0.45 sec, GPU time for    451.54 ms
E1 = -9012.29656433552  Ecoul = 4218.77694086612  Exc = -246.20882667210546
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.11 ms
    CPU time for                                              total      0.52 sec, wall time      0.52 sec, GPU time for    525.05 ms
cycle= 8 E= -1571.95125180938  delta_E= -2.25e-07  |ddm|= 0.003
diis-norm(errvec)=0.00104474
diis-c [-4.64704360e-08 -3.91167708e-06 -5.68224254e-06  9.45867531e-04
  4.12168886e-03  1.30740995e-02  1.40159139e-01  2.97280418e-01
  5.44428380e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      5.34 ms
    CPU time for                                                eig      0.06 sec, wall time      0.06 sec, GPU time for     65.74 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.98 ms
    CPU time for                                            vxc tot      0.42 sec, wall time      0.43 sec, GPU time for    425.75 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     26.50 ms
    CPU time for                                               veff      0.45 sec, wall time      0.45 sec, GPU time for    452.32 ms
E1 = -9012.296506257033  Ecoul = 4218.776878091816  Exc = -246.2088219920101
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.07 ms
    CPU time for                                              total      0.52 sec, wall time      0.53 sec, GPU time for    525.64 ms
cycle= 9 E= -1571.95125182511  delta_E= -1.57e-08  |ddm|= 0.000741
    CPU time for                                                SCF     15.94 sec, wall time     12.57 sec, GPU time for  12571.77 ms
converged SCF energy = -1571.95125182511
Nuc-Nuc PySCF=  3467.777198332121
One electron integrals energy -9012.296506257033
Coulomb energy  4218.776878091816
EXC  -246.2088219920101
PySCF time:  14.58447009138763
PySCF Grid Size:  (2998656,)
Initial guess from minao.
Currently Used memory: 10.1G


Natoms : 122


NAO : 2458


aux NAO : 3424
Running DFT using 2 threads for Numba.


GPU acceleration is enabled. Currently this only accelerates AO values and XC term evaluation.
GPU(s) information:
Found 2 CUDA devices
id 0    b'NVIDIA A100-SXM4-80GB'                              [SUPPORTED]
                      Compute Capability: 8.0
                           PCI Device ID: 0
                              PCI Bus ID: 1
                                    UUID: GPU-91ae39d5-a40f-f6b6-3db4-c87f37935afa
                                Watchdog: Disabled
             FP32/FP64 Performance Ratio: 2
id 1    b'NVIDIA A100-SXM4-80GB'                              [SUPPORTED]
                      Compute Capability: 8.0
                           PCI Device ID: 0
                              PCI Bus ID: 65
                                    UUID: GPU-47ecb6a9-8f55-e272-8c11-dfc8991015d1
                                Watchdog: Disabled
             FP32/FP64 Performance Ratio: 2
Summary:
	2/2 devices are supported
True
Max threads per block supported by the GPU:  1024
The user has specified to use 2 GPU(s).
Threads per block configuration for the XC term:  (32, 32)
Threads per block configuration for the all other calculations:  (32, 32)

Calculating one electron integrals...


Core H size in GB  0.048334112
done!
Time taken 1.0926083698868752 seconds.


Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.1670297607779503 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.14226648770272732
Time taken to evaluate the square roots needed:  0.016053032130002975
Time for significant indices evaluation:  0.8691825419664383
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.072530672
No. of elements in the standard three-centered two electron ERI tensor:  20686999936
No. of elements in the triangular three-centered two electron ERI tensor:  10347708064
No. of significant triplets based on Schwarz inequality and triangularity: 2588236212 or 12.5% of original
Schwarz screening done!
Total time taken for Schwarz screening 1.0278214998543262 seconds.

Two Center Two electron ERI size in GB  0.093790208
Three Center Two electron ERI size in GB  20.705889696
Three-centered two electron evaluation done!
Time taken for Cholesky factorization fo two-centered two-electron integrals 0.28799952380359173 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  31.976511616259813 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  2998656
Size (in GB) for storing the coordinates of grid:       0.071967744
Size (in GB) for storing the weights of grid:           0.023989248
Size (in GB) for storing the density at gridpoints:     0.023989248

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  20480
No. of batches:  147

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 0.08056267909705639 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    582
Average no. of basis functions contributing to a batch of grid points:    498


------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  322.353556366716



------Iteration 1--------


Energies
Electron-Nuclear Energy       -10539.864313830914
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1574.6001003413257
Coulomb Energy                4170.24032003603
Exchange-Correlation Energy   -242.6616982273155
-------------------------
Total Energy  -1569.908393339384
-------------------------



Energy difference :  1569.908393339384


Time taken for the previous iteration: 2.166029838845134


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.99997787528446



------Iteration 2--------


Energies
Electron-Nuclear Energy       -10662.980840563729
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1589.8813171290078
Coulomb Energy                4286.336308384671
Exchange-Correlation Energy   -250.97962051024984
-------------------------
Total Energy  -1569.965637218811
-------------------------



Energy difference :  0.057243879427005595


Time taken for the previous iteration: 1.4757348112761974


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.99992043061246



------Iteration 3--------


Energies
Electron-Nuclear Energy       -10413.194061208129
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1524.2130576179927
Coulomb Energy                4093.634182515689
Exchange-Correlation Energy   -238.6088011243832
-------------------------
Total Energy  -1566.1784238573396
-------------------------



Energy difference :  3.7872133614714585


Time taken for the previous iteration: 1.534857714548707


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.99995828821505



------Iteration 4--------


Energies
Electron-Nuclear Energy       -10574.82199922152
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1563.2525712745191
Coulomb Energy                4217.876077591474
Exchange-Correlation Energy   -246.02322032903996
-------------------------
Total Energy  -1571.9393723430767
-------------------------



Energy difference :  5.760948485737117


Time taken for the previous iteration: 1.4546290505677462


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.9999583435332



------Iteration 5--------


Energies
Electron-Nuclear Energy       -10577.999325348977
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1564.6175662759026
Coulomb Energy                4219.841479769244
Exchange-Correlation Energy   -246.2101664914537
-------------------------
Total Energy  -1571.973247453794
-------------------------



Energy difference :  0.033875110717417556


Time taken for the previous iteration: 1.473888712003827


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.9999576964606



------Iteration 6--------


Energies
Electron-Nuclear Energy       -10576.538684628158
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1564.3450205931847
Coulomb Energy                4218.572482416645
Exchange-Correlation Energy   -246.13646197364477
-------------------------
Total Energy  -1571.980445250485
-------------------------



Energy difference :  0.007197796690888936


Time taken for the previous iteration: 1.4895750246942043


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.9999576535267



------Iteration 7--------


Energies
Electron-Nuclear Energy       -10576.348237742239
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1564.2403096877977
Coulomb Energy                4218.473457013961
Exchange-Correlation Energy   -246.12327816141206
-------------------------
Total Energy  -1571.980550860404
-------------------------



Energy difference :  0.00010560991904640105


Time taken for the previous iteration: 1.4957450833171606


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.99995766289726



------Iteration 8--------


Energies
Electron-Nuclear Energy       -10576.306944312402
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1564.2294133902128
Coulomb Energy                4218.441786890049
Exchange-Correlation Energy   -246.12202006303858
-------------------------
Total Energy  -1571.980565753689
-------------------------



Energy difference :  1.4893284969730303e-05


Time taken for the previous iteration: 1.437335543334484


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.999957666202



------Iteration 9--------


Energies
Electron-Nuclear Energy       -10576.306663565016
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1564.2302192756997
Coulomb Energy                4218.440925288905
Exchange-Correlation Energy   -246.12224777983837
-------------------------
Total Energy  -1571.9805684387593
-------------------------



Energy difference :  2.6850702852243558e-06


Time taken for the previous iteration: 1.489074969664216


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.99995766487535



------Iteration 10--------


Energies
Electron-Nuclear Energy       -10576.3051077291
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1564.230132919036
Coulomb Energy                4218.439337685218
Exchange-Correlation Energy   -246.12212971192602
-------------------------
Total Energy  -1571.9805684952835
-------------------------



Energy difference :  5.652418622048572e-08


Time taken for the previous iteration: 1.4690110106021166



SCF Converged after 10 iterations!

-------------------------------------
Total Energy =  -1571.9805684952835
-------------------------------------



Time taken : 48.85323833860457 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           0.08056267909705639
Density Fitting                         3.533995745703578
    DF (gamma)                          2.0631889663636684
    DF (coeff)                          0.14399566315114498
    DF (Jtri)                           0.5713081806898117
    DF (Cholesky)                       0.28799952380359173
DIIS                                    0.3013250380754471
KS matrix diagonalization               1.5261281114071608
One electron Integrals (S, T, Vnuc)     1.0926083698868752
Coulomb Integrals (2c2e + 3c2e)         31.68851209245622
Grids construction                      0
Exchange-Correlation Term               10.287871515378356
Misc.                                   0.3422347865998745
Complete SCF                            48.85323833860457
