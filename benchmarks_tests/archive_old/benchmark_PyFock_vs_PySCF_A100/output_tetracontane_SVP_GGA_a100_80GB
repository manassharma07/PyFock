Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 7343 16-Core Processor
Number of Cores: 32
Number of Threads: 64
Memory (GB): 251.74080657958984
Number of cores being actually used/requested for the benchmark: 2
Confirming that the environment variables are properly set...
OMP_NUM_THREADS = 2
OPENBLAS_NUM_THREADS = 2
MKL_NUM_THREADS = 2
VECLIB_MAXIMUM_THREADS = 2
NUMEXPR_NUM_THREADS = 2
PYSCF_MAX_MEMORY = 225000
#INFO: **** input file is /home/lu29vow/GPU_Test/tmp_dir/PyFock/benchmarks_tests/bench_PySCF_vs_PyFock_GPU.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
numba.config.THREADING_LAYER='omp'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 2
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(225000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf
from gpu4pyscf import dft as dft_gpu

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)

# basis_set_name = 'sto-2g'
# basis_set_name = 'sto-3g'
# basis_set_name = 'sto-6g'
# basis_set_name = '6-31G'
basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-SVPD'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'def2-QZVP'
# basis_set_name = 'def2-TZVPP'
# basis_set_name = 'def2-QZVPP'
# basis_set_name = 'def2-TZVPD'
# basis_set_name = 'def2-QZVPD'
# basis_set_name = 'def2-TZVPPD'
# basis_set_name = 'def2-QZVPPD'
# basis_set_name = 'cc-pVDZ'
# basis_set_name = 'ano-rcc'

auxbasis_name = 'def2-universal-jfit'
# auxbasis_name = 'def2-universal-jkfit'
# auxbasis_name = 'def2-TZVP'
# auxbasis_name = 'sto-3g'
# auxbasis_name = 'def2-SVP'
# auxbasis_name = '6-31G'

# xyzFilename = 'Benzene-Fulvene_Dimer.xyz'
# xyzFilename = 'Adenine-Thymine.xyz'
# xyzFilename = 'Zn.xyz'
# xyzFilename = 'Zn_dimer.xyz'
# xyzFilename = 'TPP.xyz'
# xyzFilename = 'Zn_TPP.xyz'
# xyzFilename = 'H2O.xyz'

# xyzFilename = 'Caffeine.xyz'
# xyzFilename = 'Serotonin.xyz'
# xyzFilename = 'Cholesterol.xyz'
# xyzFilename = 'C60.xyz'
# xyzFilename = 'Taxol.xyz'
# xyzFilename = 'Valinomycin.xyz'
# xyzFilename = 'Olestra.xyz'
# xyzFilename = 'Ubiquitin.xyz'

### 1D Carbon Alkanes
# xyzFilename = 'Ethane.xyz'
# xyzFilename = 'Decane_C10H22.xyz'
# xyzFilename = 'Icosane_C20H42.xyz'
xyzFilename = 'Tetracontane_C40H82.xyz'
# xyzFilename = 'Pentacontane_C50H102.xyz'
# xyzFilename = 'Octacontane_C80H162.xyz'
# xyzFilename = 'Hectane_C100H202.xyz'
# xyzFilename = 'Icosahectane_C120H242.xyz'

### 2D Carbon
# xyzFilename = 'Graphene_C16.xyz'
# xyzFilename = 'Graphene_C76.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'

### 3d Carbon Fullerenes
# xyzFilename = 'C60.xyz'
# xyzFilename = 'C70.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'


# ---------PySCF---------------
#Comparison with PySCF
molPySCF = gto.Mole()
molPySCF.atom = xyzFilename
molPySCF.basis = basis_set_name
molPySCF.cart = False
molPySCF.verbose = 4
molPySCF.max_memory=25000
# molPySCF.incore_anyway = True # Keeps the PySCF ERI integrals incore
molPySCF.build()
#print(molPySCF.cart_labels())

print('\n\nPySCF Results\n\n')
start=timer()
mf = dft_gpu.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
# mf = scf.RHF(molPySCF).density_fit(auxbasis=auxbasis_name)
mf.xc = funcidpyscf
mf.verbose = 6
# dmat_init = mf.init_guess_by_1e(molPySCF)
# dmat_init = mf.init_guess_by_huckel(molPySCF)
mf.init_guess = 'minao'
dmat_init = mf.init_guess_by_minao(molPySCF)
# mf.init_guess = 'atom'
# dmat_init = mf.init_guess_by_atom(molPySCF)
mf.max_cycle = 30
mf.conv_tol = 1e-7
mf.grids.level = 5
energyPyscf = mf.kernel(dm0=dmat_init)
print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
print('One electron integrals energy',mf.scf_summary['e1'])
print('Coulomb energy ',mf.scf_summary['coul'])
print('EXC ',mf.scf_summary['exc'])
duration = timer()-start
print('PySCF time: ', duration)
pyscfGrids = mf.grids
print('PySCF Grid Size: ', pyscfGrids.weights.shape)
mf = 0#None

# Get an initial guess for dmat from PySCF using CAO basis (Need to use CPU pyscf for this as GPU version oesnt support SAO yet)
molPySCF.cart = True
molPySCF.build()
mf2 = dft_gpu.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
mf2.init_guess = 'minao'
dmat_init = mf2.init_guess_by_minao(molPySCF)
import cupy as cp
cp._default_memory_pool.free_all_blocks()

import psutil

# Get memory information
memory_info = psutil.virtual_memory()

# Convert bytes to human-readable format
used_memory = psutil._common.bytes2human(memory_info.used)


# If you want to print in a more human-readable format, you can use psutil's utility function
print(f"Currently Used memory: {used_memory}")
#--------------------CrysX --------------------------

#Initialize a Mol object with somewhat large geometry
molCrysX = Mol(coordfile=xyzFilename)
print('\n\nNatoms :',molCrysX.natoms)
# print(molCrysX.coordsBohrs)

#Initialize a Basis object with a very large basis set
basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})
print('\n\nNAO :',basis.bfs_nao)

auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})
print('\n\naux NAO :',auxbasis.bfs_nao)

dftObj = DFT(molCrysX, basis, xc=funcidcrysx)
# GPU acceleration
dftObj.use_gpu = True
dftObj.keep_ao_in_gpu = False
dftObj.use_libxc = False
dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
dftObj.n_gpus = 1 # Specify the number of GPUs
dftObj.free_gpu_mem = True
dftObj.threads_x = 32
dftObj.threads_y = 32
dftObj.dynamic_precision = False
dftObj.keep_ints3c2e_in_gpu = True
# SAO or CAO basis
dftObj.sao = False
# print(dmat_init)
# Using PySCF grids to compare the energies
energyCrysX, dmat = dftObj.scf(max_itr=35, ncores=ncores, dmat=dmat_init, conv_crit=1.0E-7, grids=pyscfGrids, \
                               isDF=True, auxbasis=auxbasis, rys=True, DF_algo=10, blocksize=20480, XC_algo=3, debug=False, \
                                sortGrids=False, save_ao_values=False, xc_bf_screen=True, threshold_schwarz=1e-9, \
                                strict_schwarz=False, cholesky=True, orthogonalize=True)
# print(dmat)

# Using CrysX grids 
# To get the same energies as PySCF (level=5) upto 1e-7 au, use the following settings
# radial_precision=1.0e-13
# level=3
# pruning by density with threshold = 1e-011
# alpha_min and alpha_max corresponding to QZVP
# energyCrysX, dmat = dftObj.scf(max_itr=30, ncores=ncores, dmat=dmat_init, grids=None, gridsLevel=3, isDF=True, auxbasis=auxbasis,
#                             rys=True, DF_algo=6, blocksize=5000, XC_algo=2, debug=False, sortGrids=False, save_ao_values=True,
#                             xc_bf_screen=True,threshold_schwarz=1e-9)


print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf[0]))

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='gpu011.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64')  Threads 2
Python 3.10.13 (tags/v3.10.13-25-g07fbd8e9251-dirty:07fbd8e9251, Sep 27 2023, 23:32:09) [GCC 13.2.0]
numpy 1.26.3  scipy 1.10.1
Date: Sun Feb  4 00:32:52 2024
PySCF version 2.4.0
PySCF path  /home/lu29vow/.conda/envs/GPU2/lib/python3.10/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 225000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 122
[INPUT] num. electrons = 322
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C     -0.624000000000  -0.442600000000   0.000000000000 AA   -1.179189101729  -0.836392782732   0.000000000000 Bohr   0.0
[INPUT]  2 C     -1.874500000000   0.438900000000   0.000000000000 AA   -3.542291620497   0.829400796072   0.000000000000 Bohr   0.0
[INPUT]  3 C     -3.122400000000  -0.446400000000   0.000000000000 AA   -5.900480851342  -0.843573742006   0.000000000000 Bohr   0.0
[INPUT]  4 C     -4.373000000000   0.435100000000   0.000000000000 AA   -8.263772342723   0.822219836798   0.000000000000 Bohr   0.0
[INPUT]  5 C     -5.620900000000  -0.450100000000   0.000000000000 AA  -10.621961573568  -0.850565728667   0.000000000000 Bohr   0.0
[INPUT]  6 C     -6.871500000000   0.431400000000   0.000000000000 AA  -12.985253064949   0.815227850137   0.000000000000 Bohr   0.0
[INPUT]  7 C     -8.119400000000  -0.453900000000   0.000000000000 AA  -15.343442295794  -0.857746687940   0.000000000000 Bohr   0.0
[INPUT]  8 C     -9.370000000000   0.427600000000   0.000000000000 AA  -17.706733787175   0.808046890864   0.000000000000 Bohr   0.0
[INPUT]  9 C    -10.617900000000  -0.457600000000   0.000000000000 AA  -20.064923018019  -0.864738674601   0.000000000000 Bohr   0.0
[INPUT] 10 C    -11.868400000000   0.423800000000   0.000000000000 AA  -22.428025536788   0.800865931591   0.000000000000 Bohr   0.0
[INPUT] 11 C    -13.116300000000  -0.461400000000   0.000000000000 AA  -24.786214767633  -0.871919633874   0.000000000000 Bohr   0.0
[INPUT] 12 C    -14.366900000000   0.420100000000   0.000000000000 AA  -27.149506259014   0.793873944930   0.000000000000 Bohr   0.0
[INPUT] 13 C    -15.614800000000  -0.465100000000   0.000000000000 AA  -29.507695489859  -0.878911620535   0.000000000000 Bohr   0.0
[INPUT] 14 C    -16.865400000000   0.416300000000   0.000000000000 AA  -31.870986981240   0.786692985656   0.000000000000 Bohr   0.0
[INPUT] 15 C    -18.113300000000  -0.468900000000   0.000000000000 AA  -34.229176212084  -0.886092579809   0.000000000000 Bohr   0.0
[INPUT] 16 C    -19.363899000000   0.412600000000   0.000000000000 AA  -36.592465813739   0.779700998996   0.000000000000 Bohr   0.0
[INPUT] 17 C    -20.611799000000  -0.472600000000   0.000000000000 AA  -38.950655044584  -0.893084566469   0.000000000000 Bohr   0.0
[INPUT] 18 C    -21.862301000000   0.408800000000   0.000000000000 AA  -41.313761342805   0.772520039722   0.000000000000 Bohr   0.0
[INPUT] 19 C    -23.110201000000  -0.476400000000   0.000000000000 AA  -43.671950573650  -0.900265525743   0.000000000000 Bohr   0.0
[INPUT] 20 C    -24.360800000000   0.405100000000   0.000000000000 AA  -46.035240175305   0.765528053061   0.000000000000 Bohr   0.0
[INPUT] 21 C      0.624000000000   0.442600000000   0.000000000000 AA    1.179189101729   0.836392782732   0.000000000000 Bohr   0.0
[INPUT] 22 C      1.874500000000  -0.438900000000   0.000000000000 AA    3.542291620497  -0.829400796072   0.000000000000 Bohr   0.0
[INPUT] 23 C      3.122400000000   0.446400000000   0.000000000000 AA    5.900480851342   0.843573742006   0.000000000000 Bohr   0.0
[INPUT] 24 C      4.373000000000  -0.435100000000   0.000000000000 AA    8.263772342723  -0.822219836798   0.000000000000 Bohr   0.0
[INPUT] 25 C      5.620900000000   0.450100000000   0.000000000000 AA   10.621961573568   0.850565728667   0.000000000000 Bohr   0.0
[INPUT] 26 C      6.871500000000  -0.431400000000   0.000000000000 AA   12.985253064949  -0.815227850137   0.000000000000 Bohr   0.0
[INPUT] 27 C      8.119400000000   0.453900000000   0.000000000000 AA   15.343442295794   0.857746687940   0.000000000000 Bohr   0.0
[INPUT] 28 C      9.370000000000  -0.427600000000   0.000000000000 AA   17.706733787175  -0.808046890864   0.000000000000 Bohr   0.0
[INPUT] 29 C     10.617900000000   0.457600000000   0.000000000000 AA   20.064923018019   0.864738674601   0.000000000000 Bohr   0.0
[INPUT] 30 C     11.868400000000  -0.423800000000   0.000000000000 AA   22.428025536788  -0.800865931591   0.000000000000 Bohr   0.0
[INPUT] 31 C     13.116300000000   0.461400000000   0.000000000000 AA   24.786214767633   0.871919633874   0.000000000000 Bohr   0.0
[INPUT] 32 C     14.366900000000  -0.420100000000   0.000000000000 AA   27.149506259014  -0.793873944930   0.000000000000 Bohr   0.0
[INPUT] 33 C     15.614800000000   0.465100000000   0.000000000000 AA   29.507695489859   0.878911620535   0.000000000000 Bohr   0.0
[INPUT] 34 C     16.865400000000  -0.416300000000   0.000000000000 AA   31.870986981240  -0.786692985656   0.000000000000 Bohr   0.0
[INPUT] 35 C     18.113300000000   0.468900000000   0.000000000000 AA   34.229176212084   0.886092579809   0.000000000000 Bohr   0.0
[INPUT] 36 C     19.363899000000  -0.412600000000   0.000000000000 AA   36.592465813739  -0.779700998996   0.000000000000 Bohr   0.0
[INPUT] 37 C     20.611799000000   0.472600000000   0.000000000000 AA   38.950655044584   0.893084566469   0.000000000000 Bohr   0.0
[INPUT] 38 C     21.862301000000  -0.408800000000   0.000000000000 AA   41.313761342805  -0.772520039722   0.000000000000 Bohr   0.0
[INPUT] 39 C     23.110201000000   0.476400000000   0.000000000000 AA   43.671950573650   0.900265525743   0.000000000000 Bohr   0.0
[INPUT] 40 C     24.360800000000  -0.405100000000   0.000000000000 AA   46.035240175305  -0.765528053061   0.000000000000 Bohr   0.0
[INPUT] 41 H     -0.623000000000  -1.071900000000   0.890000000000 AA   -1.177299375604  -2.025597432921   1.681856250863 Bohr   0.0
[INPUT] 42 H     -0.623000000000  -1.071900000000  -0.890000000000 AA   -1.177299375604  -2.025597432921  -1.681856250863 Bohr   0.0
[INPUT] 43 H     -1.875500000000   1.068200000000   0.890000000000 AA   -3.544181346622   2.018605446260   1.681856250863 Bohr   0.0
[INPUT] 44 H     -1.875500000000   1.068200000000  -0.890000000000 AA   -3.544181346622   2.018605446260  -1.681856250863 Bohr   0.0
[INPUT] 45 H     -3.121500000000  -1.075700000000  -0.890000000000 AA   -5.898780097830  -2.032778392195  -1.681856250863 Bohr   0.0
[INPUT] 46 H     -3.121500000000  -1.075700000000   0.890000000000 AA   -5.898780097830  -2.032778392195   1.681856250863 Bohr   0.0
[INPUT] 47 H     -4.373900000000   1.064400000000   0.890000000000 AA   -8.265473096235   2.011424486987   1.681856250863 Bohr   0.0
[INPUT] 48 H     -4.373900000000   1.064400000000  -0.890000000000 AA   -8.265473096235   2.011424486987  -1.681856250863 Bohr   0.0
[INPUT] 49 H     -5.620000000000  -1.079400000000  -0.890000000000 AA  -10.620260820056  -2.039770378856  -1.681856250863 Bohr   0.0
[INPUT] 50 H     -5.620000000000  -1.079400000000   0.890000000000 AA  -10.620260820056  -2.039770378856   1.681856250863 Bohr   0.0
[INPUT] 51 H     -6.872400000000   1.060700000000   0.890000000000 AA  -12.986953818461   2.004432500326   1.681856250863 Bohr   0.0
[INPUT] 52 H     -6.872400000000   1.060700000000  -0.890000000000 AA  -12.986953818461   2.004432500326  -1.681856250863 Bohr   0.0
[INPUT] 53 H     -8.118400000000  -1.083200000000  -0.890000000000 AA  -15.341552569669  -2.046951338129  -1.681856250863 Bohr   0.0
[INPUT] 54 H     -8.118400000000  -1.083200000000   0.890000000000 AA  -15.341552569669  -2.046951338129   1.681856250863 Bohr   0.0
[INPUT] 55 H     -9.370900000000   1.056900000000   0.890000000000 AA  -17.708434540687   1.997251541053   1.681856250863 Bohr   0.0
[INPUT] 56 H     -9.370900000000   1.056900000000  -0.890000000000 AA  -17.708434540687   1.997251541053  -1.681856250863 Bohr   0.0
[INPUT] 57 H    -10.616900000000  -1.086900000000  -0.890000000000 AA  -20.063033291895  -2.053943324790  -1.681856250863 Bohr   0.0
[INPUT] 58 H    -10.616900000000  -1.086900000000   0.890000000000 AA  -20.063033291895  -2.053943324790   1.681856250863 Bohr   0.0
[INPUT] 59 H    -11.869400000000   1.053200000000   0.890000000000 AA  -22.429915262913   1.990259554392   1.681856250863 Bohr   0.0
[INPUT] 60 H    -11.869400000000   1.053200000000  -0.890000000000 AA  -22.429915262913   1.990259554392  -1.681856250863 Bohr   0.0
[INPUT] 61 H    -13.115400000000  -1.090700000000  -0.890000000000 AA  -24.784514014121  -2.061124284063  -1.681856250863 Bohr   0.0
[INPUT] 62 H    -13.115400000000  -1.090700000000   0.890000000000 AA  -24.784514014121  -2.061124284063   1.681856250863 Bohr   0.0
[INPUT] 63 H    -14.367800000000   1.049400000000   0.890000000000 AA  -27.151207012526   1.983078595119   1.681856250863 Bohr   0.0
[INPUT] 64 H    -14.367800000000   1.049400000000  -0.890000000000 AA  -27.151207012526   1.983078595119  -1.681856250863 Bohr   0.0
[INPUT] 65 H    -15.613900000000  -1.094400000000  -0.890000000000 AA  -29.505994736346  -2.068116270724  -1.681856250863 Bohr   0.0
[INPUT] 66 H    -15.613900000000  -1.094400000000   0.890000000000 AA  -29.505994736346  -2.068116270724   1.681856250863 Bohr   0.0
[INPUT] 67 H    -16.866301000000   1.045600000000   0.890000000000 AA  -31.872689624478   1.975897635845   1.681856250863 Bohr   0.0
[INPUT] 68 H    -16.866301000000   1.045600000000  -0.890000000000 AA  -31.872689624478   1.975897635845  -1.681856250863 Bohr   0.0
[INPUT] 69 H    -18.112301000000  -1.098200000000  -0.890000000000 AA  -34.227288375686  -2.075297229997  -1.681856250863 Bohr   0.0
[INPUT] 70 H    -18.112301000000  -1.098200000000   0.890000000000 AA  -34.227288375686  -2.075297229997   1.681856250863 Bohr   0.0
[INPUT] 71 H    -19.364799000000   1.041900000000   0.890000000000 AA  -36.594166567251   1.968905649184   1.681856250863 Bohr   0.0
[INPUT] 72 H    -19.364799000000   1.041900000000  -0.890000000000 AA  -36.594166567251   1.968905649184  -1.681856250863 Bohr   0.0
[INPUT] 73 H    -20.610800000000  -1.102000000000  -0.890000000000 AA  -38.948767208186  -2.082478189271  -1.681856250863 Bohr   0.0
[INPUT] 74 H    -20.610800000000  -1.101900000000   0.890000000000 AA  -38.948767208186  -2.082289216658   1.681856250863 Bohr   0.0
[INPUT] 75 H    -21.863300000000   1.038100000000   0.890000000000 AA  -41.315649179203   1.961724689911   1.681856250863 Bohr   0.0
[INPUT] 76 H    -21.863300000000   1.038100000000  -0.890000000000 AA  -41.315649179203   1.961724689911  -1.681856250863 Bohr   0.0
[INPUT] 77 H    -23.109301000000  -1.105700000000  -0.890000000000 AA  -43.670249820138  -2.089470175932  -1.681856250863 Bohr   0.0
[INPUT] 78 H    -23.109301000000  -1.105700000000   0.890000000000 AA  -43.670249820138  -2.089470175932   1.681856250863 Bohr   0.0
[INPUT] 79 H    -24.361799000000   1.034400000000   0.890000000000 AA  -46.037128011703   1.954732703250   1.681856250863 Bohr   0.0
[INPUT] 80 H    -24.361799000000   1.034400000000  -0.890000000000 AA  -46.037128011703   1.954732703250  -1.681856250863 Bohr   0.0
[INPUT] 81 H    -25.249800000000  -0.225600000000   0.000000000000 AA  -47.715206700043  -0.426322213702   0.000000000000 Bohr   0.0
[INPUT] 82 H      0.623000000000   1.071900000000  -0.890000000000 AA    1.177299375604   2.025597432921  -1.681856250863 Bohr   0.0
[INPUT] 83 H      0.623000000000   1.071900000000   0.890000000000 AA    1.177299375604   2.025597432921   1.681856250863 Bohr   0.0
[INPUT] 84 H      1.875500000000  -1.068200000000   0.890000000000 AA    3.544181346622  -2.018605446260   1.681856250863 Bohr   0.0
[INPUT] 85 H      1.875500000000  -1.068200000000  -0.890000000000 AA    3.544181346622  -2.018605446260  -1.681856250863 Bohr   0.0
[INPUT] 86 H      3.121500000000   1.075700000000  -0.890000000000 AA    5.898780097830   2.032778392195  -1.681856250863 Bohr   0.0
[INPUT] 87 H      3.121500000000   1.075700000000   0.890000000000 AA    5.898780097830   2.032778392195   1.681856250863 Bohr   0.0
[INPUT] 88 H      4.373900000000  -1.064400000000   0.890000000000 AA    8.265473096235  -2.011424486987   1.681856250863 Bohr   0.0
[INPUT] 89 H      4.373900000000  -1.064400000000  -0.890000000000 AA    8.265473096235  -2.011424486987  -1.681856250863 Bohr   0.0
[INPUT] 90 H      5.620000000000   1.079400000000  -0.890000000000 AA   10.620260820056   2.039770378856  -1.681856250863 Bohr   0.0
[INPUT] 91 H      5.620000000000   1.079400000000   0.890000000000 AA   10.620260820056   2.039770378856   1.681856250863 Bohr   0.0
[INPUT] 92 H      6.872400000000  -1.060700000000   0.890000000000 AA   12.986953818461  -2.004432500326   1.681856250863 Bohr   0.0
[INPUT] 93 H      6.872400000000  -1.060700000000  -0.890000000000 AA   12.986953818461  -2.004432500326  -1.681856250863 Bohr   0.0
[INPUT] 94 H      8.118400000000   1.083200000000  -0.890000000000 AA   15.341552569669   2.046951338129  -1.681856250863 Bohr   0.0
[INPUT] 95 H      8.118400000000   1.083200000000   0.890000000000 AA   15.341552569669   2.046951338129   1.681856250863 Bohr   0.0
[INPUT] 96 H      9.370900000000  -1.056900000000   0.890000000000 AA   17.708434540687  -1.997251541053   1.681856250863 Bohr   0.0
[INPUT] 97 H      9.370900000000  -1.056900000000  -0.890000000000 AA   17.708434540687  -1.997251541053  -1.681856250863 Bohr   0.0
[INPUT] 98 H     10.616900000000   1.086900000000  -0.890000000000 AA   20.063033291895   2.053943324790  -1.681856250863 Bohr   0.0
[INPUT] 99 H     10.616900000000   1.086900000000   0.890000000000 AA   20.063033291895   2.053943324790   1.681856250863 Bohr   0.0
[INPUT]100 H     11.869400000000  -1.053200000000   0.890000000000 AA   22.429915262913  -1.990259554392   1.681856250863 Bohr   0.0
[INPUT]101 H     11.869400000000  -1.053200000000  -0.890000000000 AA   22.429915262913  -1.990259554392  -1.681856250863 Bohr   0.0
[INPUT]102 H     13.115400000000   1.090700000000  -0.890000000000 AA   24.784514014121   2.061124284063  -1.681856250863 Bohr   0.0
[INPUT]103 H     13.115400000000   1.090700000000   0.890000000000 AA   24.784514014121   2.061124284063   1.681856250863 Bohr   0.0
[INPUT]104 H     14.367800000000  -1.049400000000   0.890000000000 AA   27.151207012526  -1.983078595119   1.681856250863 Bohr   0.0
[INPUT]105 H     14.367800000000  -1.049400000000  -0.890000000000 AA   27.151207012526  -1.983078595119  -1.681856250863 Bohr   0.0
[INPUT]106 H     15.613900000000   1.094400000000  -0.890000000000 AA   29.505994736346   2.068116270724  -1.681856250863 Bohr   0.0
[INPUT]107 H     15.613900000000   1.094400000000   0.890000000000 AA   29.505994736346   2.068116270724   1.681856250863 Bohr   0.0
[INPUT]108 H     16.866301000000  -1.045600000000   0.890000000000 AA   31.872689624478  -1.975897635845   1.681856250863 Bohr   0.0
[INPUT]109 H     16.866301000000  -1.045600000000  -0.890000000000 AA   31.872689624478  -1.975897635845  -1.681856250863 Bohr   0.0
[INPUT]110 H     18.112301000000   1.098200000000  -0.890000000000 AA   34.227288375686   2.075297229997  -1.681856250863 Bohr   0.0
[INPUT]111 H     18.112301000000   1.098200000000   0.890000000000 AA   34.227288375686   2.075297229997   1.681856250863 Bohr   0.0
[INPUT]112 H     19.364799000000  -1.041900000000   0.890000000000 AA   36.594166567251  -1.968905649184   1.681856250863 Bohr   0.0
[INPUT]113 H     19.364799000000  -1.041900000000  -0.890000000000 AA   36.594166567251  -1.968905649184  -1.681856250863 Bohr   0.0
[INPUT]114 H     20.610800000000   1.102000000000  -0.890000000000 AA   38.948767208186   2.082478189271  -1.681856250863 Bohr   0.0
[INPUT]115 H     20.610800000000   1.101900000000   0.890000000000 AA   38.948767208186   2.082289216658   1.681856250863 Bohr   0.0
[INPUT]116 H     21.863300000000  -1.038100000000   0.890000000000 AA   41.315649179203  -1.961724689911   1.681856250863 Bohr   0.0
[INPUT]117 H     21.863300000000  -1.038100000000  -0.890000000000 AA   41.315649179203  -1.961724689911  -1.681856250863 Bohr   0.0
[INPUT]118 H     23.109301000000   1.105700000000  -0.890000000000 AA   43.670249820138   2.089470175932  -1.681856250863 Bohr   0.0
[INPUT]119 H     23.109301000000   1.105700000000   0.890000000000 AA   43.670249820138   2.089470175932   1.681856250863 Bohr   0.0
[INPUT]120 H     24.361799000000  -1.034400000000   0.890000000000 AA   46.037128011703  -1.954732703250   1.681856250863 Bohr   0.0
[INPUT]121 H     24.361799000000  -1.034400000000  -0.890000000000 AA   46.037128011703  -1.954732703250  -1.681856250863 Bohr   0.0
[INPUT]122 H     25.249800000000   0.225600000000   0.000000000000 AA   47.715206700043   0.426322213702   0.000000000000 Bohr   0.0

nuclear repulsion = 3467.77719833212
number of shells = 486
number of NR pGTOs = 1534
number of NR cGTOs = 970
basis = def2-SVP
ecp = {}
CPU time:         2.89


PySCF Results


Initial guess from minao.


******** <class 'gpu4pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'gpu4pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 30
direct_scf = False
chkfile to save SCF result = /tmp/tmplwodi3m2
max_memory 25000 MB (current use 1877 MB)
XC library pyscf.dft.libxc version 6.1.0
    unable to decode the reference due to https://github.com/NVIDIA/cuda-python/issues/29
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x154ff1a29750>
grids dens level: 5
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x154ff1a295a0>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 3653760
prune_by_density_: 62 padding grids
    CPU time for                                   setting up grids      2.43 sec, wall time      2.33 sec, GPU time for   2332.13 ms
    CPU time for                                            vxc tot      0.77 sec, wall time      0.78 sec, GPU time for    780.50 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.01 sec, GPU time for      7.22 ms
E1 = -8978.1824421211  Ecoul = 4182.320661248472  Exc = -243.4584800544912
init E= -1571.543062595
    CPU time for                                         total prep      4.70 sec, wall time      3.99 sec, GPU time for   3988.03 ms
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      0.02 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     18.57 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      4.21 ms
    CPU time for                                            vxc tot      0.20 sec, wall time      0.20 sec, GPU time for    202.55 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      5.09 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    207.72 ms
E1 = -9044.990629025597  Ecoul = 4256.33377832883  Exc = -248.69467152314465
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.03 ms
    CPU time for                                              total      0.23 sec, wall time      0.24 sec, GPU time for    235.76 ms
cycle= 1 E= -1569.57432388779  delta_E= 1.97  |ddm|= 11.1
diis-norm(errvec)=3.46772
diis-c [-12.02505357   1.        ]
    CPU time for                                               DIIS      0.01 sec, wall time      0.02 sec, GPU time for     16.10 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     18.44 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.89 ms
    CPU time for                                            vxc tot      0.20 sec, wall time      0.20 sec, GPU time for    203.31 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      5.08 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    208.46 ms
E1 = -8955.320502466038  Ecoul = 4160.546175377947  Exc = -241.8546745368777
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.07 ms
    CPU time for                                              total      0.24 sec, wall time      0.25 sec, GPU time for    245.08 ms
cycle= 2 E= -1568.85180329285  delta_E= 0.723  |ddm|= 4.96
diis-norm(errvec)=5.08633
diis-c [-0.13897159  0.59536242  0.40463758]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.33 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     18.46 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.88 ms
    CPU time for                                            vxc tot      0.20 sec, wall time      0.20 sec, GPU time for    203.46 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      5.09 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    208.62 ms
E1 = -9009.631068475604  Ecoul = 4217.271384155755  Exc = -245.67298609795722
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.02 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    230.41 ms
cycle= 3 E= -1570.25547208569  delta_E= -1.4  |ddm|= 3.02
diis-norm(errvec)=0.177139
diis-c [-0.00449298  0.17317717  0.1248254   0.70199743]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.45 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     18.44 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.88 ms
    CPU time for                                            vxc tot      0.20 sec, wall time      0.20 sec, GPU time for    203.48 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      5.11 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    208.66 ms
E1 = -9009.222726346663  Ecoul = 4216.875649684721  Exc = -245.68674861808898
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.00 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    230.55 ms
cycle= 4 E= -1570.25662694791  delta_E= -0.00115  |ddm|= 0.134
diis-norm(errvec)=0.054014
diis-c [-0.00066301  0.0610161   0.04556934  0.30941199  0.58400256]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.59 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     18.69 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.86 ms
    CPU time for                                            vxc tot      0.20 sec, wall time      0.20 sec, GPU time for    203.69 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      5.12 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    208.88 ms
E1 = -9009.200430491515  Ecoul = 4216.8527675958485  Exc = -245.68628010359387
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.00 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    231.14 ms
cycle= 5 E= -1570.25674466714  delta_E= -0.000118  |ddm|= 0.0418
diis-norm(errvec)=0.0254449
diis-c [-2.14532972e-05  6.80125642e-03  6.31328789e-03  5.87489834e-02
  3.34595719e-01  5.93540753e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.75 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     18.74 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.86 ms
    CPU time for                                            vxc tot      0.20 sec, wall time      0.20 sec, GPU time for    202.95 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      5.10 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    208.12 ms
E1 = -9009.175801782438  Ecoul = 4216.826440797191  Exc = -245.68461614708588
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.01 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    230.60 ms
cycle= 6 E= -1570.25677880021  delta_E= -3.41e-05  |ddm|= 0.0146
diis-norm(errvec)=0.00322083
diis-c [-2.11645472e-06  9.98127648e-04  1.38153786e-03  1.26077187e-02
  9.84417932e-02  2.06458428e-01  6.80112394e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.86 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     18.43 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.87 ms
    CPU time for                                            vxc tot      0.20 sec, wall time      0.20 sec, GPU time for    203.13 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      5.10 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    208.30 ms
E1 = -9009.163155541846  Ecoul = 4216.812790452859  Exc = -245.68361244863863
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.00 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    230.57 ms
cycle= 7 E= -1570.2567792055  delta_E= -4.05e-07  |ddm|= 0.00259
diis-norm(errvec)=0.00156656
diis-c [-1.43602138e-07 -1.43378047e-05  2.67041336e-04  1.47161121e-03
  2.06942276e-02  5.39182193e-02  3.78795832e-01  5.44867406e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      2.01 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     18.80 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.87 ms
    CPU time for                                            vxc tot      0.20 sec, wall time      0.20 sec, GPU time for    204.38 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      5.10 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    209.56 ms
E1 = -9009.158983609066  Ecoul = 4216.808281632126  Exc = -245.68327568494493
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.02 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    232.37 ms
cycle= 8 E= -1570.25677932976  delta_E= -1.24e-07  |ddm|= 0.000998
diis-norm(errvec)=0.000370657
diis-c [-5.11809135e-09 -5.22129955e-05  6.95494525e-05 -4.36381445e-05
  3.66459666e-03  1.27017845e-02  1.44437179e-01  2.79191717e-01
  5.60031025e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      2.16 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     18.72 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.87 ms
    CPU time for                                            vxc tot      0.20 sec, wall time      0.20 sec, GPU time for    203.66 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for      5.09 ms
    CPU time for                                               veff      0.21 sec, wall time      0.21 sec, GPU time for    208.83 ms
E1 = -9009.158068245351  Ecoul = 4216.80729116957  Exc = -245.68320059325615
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.01 ms
    CPU time for                                              total      0.23 sec, wall time      0.23 sec, GPU time for    231.71 ms
cycle= 9 E= -1570.25677933692  delta_E= -7.15e-09  |ddm|= 0.00025
    CPU time for                                                SCF      6.80 sec, wall time      6.12 sec, GPU time for   6124.07 ms
converged SCF energy = -1570.25677933692
Nuc-Nuc PySCF=  3467.777198332121
One electron integrals energy -9009.158068245351
Coulomb energy  4216.80729116957
EXC  -245.68320059325615
PySCF time:  6.73556936532259
PySCF Grid Size:  (2955136,)
Initial guess from minao.
Currently Used memory: 4.4G


Natoms : 122


NAO : 1010


aux NAO : 3424
Running DFT using 2 threads for Numba.


GPU acceleration is enabled. Currently this only accelerates AO values and XC term evaluation.
GPU(s) information:
Found 1 CUDA devices
id 0    b'NVIDIA A100 80GB PCIe'                              [SUPPORTED]
                      Compute Capability: 8.0
                           PCI Device ID: 0
                              PCI Bus ID: 129
                                    UUID: GPU-532978f3-f5cc-04fc-9dc8-613a4acb4a20
                                Watchdog: Disabled
             FP32/FP64 Performance Ratio: 2
Summary:
	1/1 devices are supported
True
Max threads per block supported by the GPU:  1024
The user has specified to use 1 GPU(s).
Threads per block configuration for the XC term:  (32, 32)
Threads per block configuration for the all other calculations:  (32, 32)

Calculating one electron integrals...


Core H size in GB  0.0081608
done!
Time taken 0.3121814578771591 seconds.


Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.18415123224258423 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.05426858179271221
Time taken to evaluate the square roots needed:  0.0020395591855049133
Time for significant indices evaluation:  0.31502948328852654
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.012253328
No. of elements in the standard three-centered two electron ERI tensor:  3492822400
No. of elements in the triangular three-centered two electron ERI tensor:  1748140320
No. of significant triplets based on Schwarz inequality and triangularity: 353577734 or 10.1% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.3715520203113556 seconds.

Two Center Two electron ERI size in GB  0.093790208
Three Center Two electron ERI size in GB  2.828621872
Three-centered two electron evaluation done!
Time taken for Cholesky factorization fo two-centered two-electron integrals 0.29912947304546833 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  7.627033229917288 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  2955136
Size (in GB) for storing the coordinates of grid:       0.070923264
Size (in GB) for storing the weights of grid:           0.023641088
Size (in GB) for storing the density at gridpoints:     0.023641088

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  20480
No. of batches:  145

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 0.057796232402324677 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    202
Average no. of basis functions contributing to a batch of grid points:    173


------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.3302207576126



------Iteration 1--------


Energies
Electron-Nuclear Energy       -10537.361798077438
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1573.5902573750918
Coulomb Energy                4168.317964097081
Exchange-Correlation Energy   -243.18220005969118
-------------------------
Total Energy  -1570.8585783234666
-------------------------



Energy difference :  1570.8585783234666


Time taken for the previous iteration: 0.7535364832729101


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.9999744721203



------Iteration 2--------


Energies
Electron-Nuclear Energy       -10610.746325528627
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1562.4665004530696
Coulomb Energy                4259.58404021013
Exchange-Correlation Energy   -248.57967889783694
-------------------------
Total Energy  -1569.4982654217756
-------------------------



Energy difference :  1.3603129016910316


Time taken for the previous iteration: 0.6719217505306005


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.9999522595525



------Iteration 3--------


Energies
Electron-Nuclear Energy       -10474.432683242772
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1523.1328685476165
Coulomb Energy                4156.143909548222
Exchange-Correlation Energy   -241.35912687283374
-------------------------
Total Energy  -1568.7378336782785
-------------------------



Energy difference :  0.7604317434970653


Time taken for the previous iteration: 0.6753955241292715


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.99996425714517



------Iteration 4--------


Energies
Electron-Nuclear Energy       -10556.795737634611
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1547.402960187156
Coulomb Energy                4216.717981333444
Exchange-Correlation Energy   -245.43316282316545
-------------------------
Total Energy  -1570.330760595687
-------------------------



Energy difference :  1.5929269174084766


Time taken for the previous iteration: 0.6765760406851768


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.9999646118072



------Iteration 5--------


Energies
Electron-Nuclear Energy       -10556.105181276223
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1547.2626638717447
Coulomb Energy                4216.164008036119
Exchange-Correlation Energy   -245.43059386842265
-------------------------
Total Energy  -1570.3319048952926
-------------------------



Energy difference :  0.0011442996055848198


Time taken for the previous iteration: 0.6756519414484501


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.999964596041



------Iteration 6--------


Energies
Electron-Nuclear Energy       -10556.042296855729
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1547.2289118073636
Coulomb Energy                4216.1315063469265
Exchange-Correlation Energy   -245.42740063762722
-------------------------
Total Energy  -1570.3320809975758
-------------------------



Energy difference :  0.0001761022831487935


Time taken for the previous iteration: 0.6679884195327759


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.99996458393656



------Iteration 7--------


Energies
Electron-Nuclear Energy       -10555.996636666381
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1547.2082990009753
Coulomb Energy                4216.103665351614
Exchange-Correlation Energy   -245.42464137447197
-------------------------
Total Energy  -1570.3321153467741
-------------------------



Energy difference :  3.434919835854089e-05


Time taken for the previous iteration: 0.679010409861803


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.99996458132796



------Iteration 8--------


Energies
Electron-Nuclear Energy       -10555.981064011125
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1547.20339489473
Coulomb Energy                4216.09211061452
Exchange-Correlation Energy   -245.42375557089284
-------------------------
Total Energy  -1570.3321157312785
-------------------------



Energy difference :  3.8450434658443555e-07


Time taken for the previous iteration: 0.675630010664463


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.9999645806094



------Iteration 9--------


Energies
Electron-Nuclear Energy       -10555.975751226226
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1547.201786187966
Coulomb Energy                4216.0881109184675
Exchange-Correlation Energy   -245.42346008492592
-------------------------
Total Energy  -1570.3321158632289
-------------------------



Energy difference :  1.319504008279182e-07


Time taken for the previous iteration: 0.6800400651991367


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  321.9999645803734



------Iteration 10--------


Energies
Electron-Nuclear Energy       -10555.973318113418
Nuclear repulsion Energy      3467.77719834149
Kinetic Energy                1547.2010452030074
Coulomb Energy                4216.08628667037
Exchange-Correlation Energy   -245.42332797023988
-------------------------
Total Energy  -1570.3321158687904
-------------------------



Energy difference :  5.561560101341456e-09


Time taken for the previous iteration: 0.6768815089017153



SCF Converged after 10 iterations!

-------------------------------------
Total Energy =  -1570.3321158687904
-------------------------------------



Time taken : 14.882158590480685 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           0.057796232402324677
Density Fitting                         1.1025518123060465
    DF (gamma)                          0.42030662298202515
    DF (coeff)                          0.14861716143786907
    DF (Jtri)                           0.14649850688874722
    DF (Cholesky)                       0.29912947304546833
DIIS                                    0.03416861593723297
KS matrix diagonalization               0.37156879901885986
One electron Integrals (S, T, Vnuc)     0.3121814578771591
Coulomb Integrals (2c2e + 3c2e)         7.3279037568718195
Grids construction                      0
Exchange-Correlation Term               5.600328287109733
Misc.                                   0.07565962895751
Complete SCF                            14.882158590480685
