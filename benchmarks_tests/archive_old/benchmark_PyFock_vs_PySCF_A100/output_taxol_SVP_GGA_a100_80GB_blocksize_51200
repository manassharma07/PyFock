Operating System: Linux 4.18.0-425.13.1.el8_7.x86_64
System Type: 64bit
CPU Model: AMD EPYC 73F3 16-Core Processor
Number of Cores: 32
Number of Threads: 64
Memory (GB): 503.74189376831055
Number of cores being actually used/requested for the benchmark: 2
Confirming that the environment variables are properly set...
OMP_NUM_THREADS = 2
OPENBLAS_NUM_THREADS = 2
MKL_NUM_THREADS = 2
VECLIB_MAXIMUM_THREADS = 2
NUMEXPR_NUM_THREADS = 2
PYSCF_MAX_MEMORY = 225000
#INFO: **** input file is /home/lu29vow/GPU_Test/tmp_dir/PyFock/benchmarks_tests/bench_PySCF_vs_PyFock_GPU.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
numba.config.THREADING_LAYER='omp'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 2
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(225000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf
from gpu4pyscf import dft as dft_gpu

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)

# basis_set_name = 'sto-2g'
# basis_set_name = 'sto-3g'
# basis_set_name = 'sto-6g'
# basis_set_name = '6-31G'
basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-SVPD'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'def2-QZVP'
# basis_set_name = 'def2-TZVPP'
# basis_set_name = 'def2-QZVPP'
# basis_set_name = 'def2-TZVPD'
# basis_set_name = 'def2-QZVPD'
# basis_set_name = 'def2-TZVPPD'
# basis_set_name = 'def2-QZVPPD'
# basis_set_name = 'cc-pVDZ'
# basis_set_name = 'ano-rcc'

auxbasis_name = 'def2-universal-jfit'
# auxbasis_name = 'def2-universal-jkfit'
# auxbasis_name = 'def2-TZVP'
# auxbasis_name = 'sto-3g'
# auxbasis_name = 'def2-SVP'
# auxbasis_name = '6-31G'

# xyzFilename = 'Benzene-Fulvene_Dimer.xyz'
# xyzFilename = 'Adenine-Thymine.xyz'
# xyzFilename = 'Zn.xyz'
# xyzFilename = 'Zn_dimer.xyz'
# xyzFilename = 'TPP.xyz'
# xyzFilename = 'Zn_TPP.xyz'
# xyzFilename = 'H2O.xyz'

# xyzFilename = 'Caffeine.xyz'
# xyzFilename = 'Serotonin.xyz'
# xyzFilename = 'Cholesterol.xyz'
# xyzFilename = 'C60.xyz'
xyzFilename = 'Taxol.xyz'
# xyzFilename = 'Valinomycin.xyz'
# xyzFilename = 'Olestra.xyz'
# xyzFilename = 'Ubiquitin.xyz'

### 1D Carbon Alkanes
# xyzFilename = 'Ethane.xyz'
# xyzFilename = 'Decane_C10H22.xyz'
# xyzFilename = 'Icosane_C20H42.xyz'
# xyzFilename = 'Tetracontane_C40H82.xyz'
# xyzFilename = 'Pentacontane_C50H102.xyz'
# xyzFilename = 'Octacontane_C80H162.xyz'
# xyzFilename = 'Hectane_C100H202.xyz'
# xyzFilename = 'Icosahectane_C120H242.xyz'

### 2D Carbon
# xyzFilename = 'Graphene_C16.xyz'
# xyzFilename = 'Graphene_C76.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'

### 3d Carbon Fullerenes
# xyzFilename = 'C60.xyz'
# xyzFilename = 'C70.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'


# ---------PySCF---------------
#Comparison with PySCF
molPySCF = gto.Mole()
molPySCF.atom = xyzFilename
molPySCF.basis = basis_set_name
molPySCF.cart = False
molPySCF.verbose = 4
molPySCF.max_memory=25000
# molPySCF.incore_anyway = True # Keeps the PySCF ERI integrals incore
molPySCF.build()
#print(molPySCF.cart_labels())

print('\n\nPySCF Results\n\n')
start=timer()
mf = dft_gpu.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
# mf = scf.RHF(molPySCF).density_fit(auxbasis=auxbasis_name)
mf.xc = funcidpyscf
mf.verbose = 6
# dmat_init = mf.init_guess_by_1e(molPySCF)
# dmat_init = mf.init_guess_by_huckel(molPySCF)
mf.init_guess = 'minao'
dmat_init = mf.init_guess_by_minao(molPySCF)
# mf.init_guess = 'atom'
# dmat_init = mf.init_guess_by_atom(molPySCF)
mf.max_cycle = 30
mf.conv_tol = 1e-7
mf.grids.level = 5
energyPyscf = mf.kernel(dm0=dmat_init)
print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
print('One electron integrals energy',mf.scf_summary['e1'])
print('Coulomb energy ',mf.scf_summary['coul'])
print('EXC ',mf.scf_summary['exc'])
duration = timer()-start
print('PySCF time: ', duration)
pyscfGrids = mf.grids
print('PySCF Grid Size: ', pyscfGrids.weights.shape)
mf = 0#None

# Get an initial guess for dmat from PySCF using CAO basis (Need to use CPU pyscf for this as GPU version oesnt support SAO yet)
molPySCF.cart = True
molPySCF.build()
mf2 = dft_gpu.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
mf2.init_guess = 'minao'
dmat_init = mf2.init_guess_by_minao(molPySCF)
import cupy as cp
cp._default_memory_pool.free_all_blocks()

import psutil

# Get memory information
memory_info = psutil.virtual_memory()

# Convert bytes to human-readable format
used_memory = psutil._common.bytes2human(memory_info.used)


# If you want to print in a more human-readable format, you can use psutil's utility function
print(f"Currently Used memory: {used_memory}")
#--------------------CrysX --------------------------

#Initialize a Mol object with somewhat large geometry
molCrysX = Mol(coordfile=xyzFilename)
print('\n\nNatoms :',molCrysX.natoms)
# print(molCrysX.coordsBohrs)

#Initialize a Basis object with a very large basis set
basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})
print('\n\nNAO :',basis.bfs_nao)

auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})
print('\n\naux NAO :',auxbasis.bfs_nao)

dftObj = DFT(molCrysX, basis, xc=funcidcrysx)
# GPU acceleration
dftObj.use_gpu = True
dftObj.keep_ao_in_gpu = False
dftObj.use_libxc = False
dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
dftObj.n_gpus = 1 # Specify the number of GPUs
dftObj.free_gpu_mem = True
dftObj.threads_x = 32
dftObj.threads_y = 32
dftObj.dynamic_precision = False
dftObj.keep_ints3c2e_in_gpu = True
# SAO or CAO basis
dftObj.sao = False
# print(dmat_init)
# Using PySCF grids to compare the energies
energyCrysX, dmat = dftObj.scf(max_itr=35, ncores=ncores, dmat=dmat_init, conv_crit=1.0E-7, grids=pyscfGrids, \
                               isDF=True, auxbasis=auxbasis, rys=True, DF_algo=10, blocksize=51200, XC_algo=3, debug=False, \
                                sortGrids=False, save_ao_values=False, xc_bf_screen=True, threshold_schwarz=1e-9, \
                                strict_schwarz=False, cholesky=True, orthogonalize=True)
# print(dmat)

# Using CrysX grids 
# To get the same energies as PySCF (level=5) upto 1e-7 au, use the following settings
# radial_precision=1.0e-13
# level=3
# pruning by density with threshold = 1e-011
# alpha_min and alpha_max corresponding to QZVP
# energyCrysX, dmat = dftObj.scf(max_itr=30, ncores=ncores, dmat=dmat_init, grids=None, gridsLevel=3, isDF=True, auxbasis=auxbasis,
#                             rys=True, DF_algo=6, blocksize=5000, XC_algo=2, debug=False, sortGrids=False, save_ao_values=True,
#                             xc_bf_screen=True,threshold_schwarz=1e-9)


print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf[0]))

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='gpu016.cluster', release='4.18.0-425.13.1.el8_7.x86_64', version='#1 SMP Tue Feb 21 04:20:52 EST 2023', machine='x86_64')  Threads 2
Python 3.10.13 (tags/v3.10.13-25-g07fbd8e9251-dirty:07fbd8e9251, Sep 27 2023, 23:32:09) [GCC 13.2.0]
numpy 1.26.3  scipy 1.10.1
Date: Sun Feb  4 11:41:07 2024
PySCF version 2.4.0
PySCF path  /home/lu29vow/.conda/envs/GPU2/lib/python3.10/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 225000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 110
[INPUT] num. electrons = 446
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C     -6.396061564700   1.637550066100  -1.016739058200 AA  -12.086804633140   3.094521140192  -1.921358360146 Bohr   0.0
[INPUT]  2 C     -5.597601192200   1.947965607200   0.315676374200 AA  -10.577933207797   3.681121497680   0.596541891234 Bohr   0.0
[INPUT]  3 C     -4.135842384000   1.388888589200   0.306155918000 AA   -7.815609400128   2.624619051122   0.578550836435 Bohr   0.0
[INPUT]  4 C     -4.090011640200  -0.206933977200   0.075990814700 AA   -7.729001846261  -0.391048542775   0.143601827766 Bohr   0.0
[INPUT]  5 C     -5.300524405000  -0.555969592700  -0.783118944300 AA  -10.016539442023  -1.050630263789  -1.479880327686 Bohr   0.0
[INPUT]  6 C     -5.640835284600   0.556015173100  -1.745417447800 AA  -10.659633801677   1.050716398262  -3.298360949379 Bohr   0.0
[INPUT]  7 C     -2.820311909500  -0.772342744000  -0.595116107900 AA   -5.329617094804  -1.459516260455  -1.124606456248 Bohr   0.0
[INPUT]  8 C     -3.440516750000   1.980980107400   1.595493238500 AA   -6.501634384479   3.743509861197   3.015045254360 Bohr   0.0
[INPUT]  9 C     -1.572295462900  -0.076963891700  -0.171925309700 AA   -2.971207811777  -0.145440676794  -0.324891749214 Bohr   0.0
[INPUT] 10 O     -2.695327527400  -2.159027379100  -0.169770843700 AA   -5.093430842787  -4.079970441937  -0.320820398529 Bohr   0.0
[INPUT] 11 O     -1.869349329500   1.230862673500  -0.775122350900 AA   -3.532558263894   2.325993349865  -1.464768956230 Bohr   0.0
[INPUT] 12 C     -1.333406430700  -0.117630791300   1.410157626200 AA   -2.519772966757  -0.222289979373   2.664811705985 Bohr   0.0
[INPUT] 13 C     -0.888104477000   1.287458473900   1.484531634600 AA   -1.678274231530   2.432943912421   2.805358212647 Bohr   0.0
[INPUT] 14 C      0.319603685200   1.577056732000   0.964060531500 AA    0.603963433430   2.980205306382   1.821810372038 Bohr   0.0
[INPUT] 15 O     -4.036062750800   2.449790375900   2.504798933800 AA   -7.627053220571   4.629432873046   4.733383981985 Bohr   0.0
[INPUT] 16 O     -1.950498051900   2.187079970700   1.749235754400 AA   -3.685907124589   4.132982157145   3.305576503113 Bohr   0.0
[INPUT] 17 C     -0.219863679800  -0.374403691900  -0.807226987500 AA   -0.415482139561  -0.707520437717  -1.525437926733 Bohr   0.0
[INPUT] 18 C      0.836132195700   0.539296024600  -0.088230555700 AA    1.580060853804   1.019121786561  -0.166731586091 Bohr   0.0
[INPUT] 19 O     -6.370565030200  -0.746143686600   0.181496281200 AA  -12.038623165810  -1.410007217247   0.342978264095 Bohr   0.0
[INPUT] 20 C     -7.507988525600  -1.531254437900   0.176444232000 AA  -14.188042059761  -2.893651514656   0.333431274739 Bohr   0.0
[INPUT] 21 O     -7.734316826100  -2.187242945900   1.153245967700 AA  -14.615740561944  -4.133290135638   2.179319033212 Bohr   0.0
[INPUT] 22 C     -8.452324994200  -1.415750032000  -0.993925961500 AA  -15.972579354854  -2.675379821324  -1.878247855330 Bohr   0.0
[INPUT] 23 C     -5.416105677100  -1.509102368300  -2.007000280900 AA  -10.234956391421  -2.851790170020  -3.792680862826 Bohr   0.0
[INPUT] 24 O     -6.219257155500  -0.445446729500  -2.690295002600 AA  -11.752692722137  -0.841772321838  -5.083920749200 Bohr   0.0
[INPUT] 25 O     -5.426762618400   3.377443710700   0.377624349800 AA  -10.255095091804   6.382443614358   0.713606599089 Bohr   0.0
[INPUT] 26 O     -1.612244111800   4.180117047300   0.034377943200 AA   -3.046699817245   7.899276388023   0.064964897374 Bohr   0.0
[INPUT] 27 C     -0.794092369800   5.225773959700   0.299056712600 AA   -1.500617096529   9.875281572717   0.565135282527 Bohr   0.0
[INPUT] 28 O     -0.304894727700   5.864576594300  -0.589533255500 AA   -0.576167532177  11.082443599762  -1.114056394218 Bohr   0.0
[INPUT] 29 C     -0.543214174700   5.473698439400   1.776387391800 AA   -1.026526017165  10.343790938925   3.356885661632 Bohr   0.0
[INPUT] 30 C      1.229858006800   2.785290850200   1.031503473200 AA    2.324094804955   5.263436884135   1.949259060886 Bohr   0.0
[INPUT] 31 O      1.936123048500  -0.333421221700   0.359950655700 AA    3.658742305123  -0.630074793131   0.680208157631 Bohr   0.0
[INPUT] 32 C      3.192397144200   0.039286786400   0.073200795100 AA    6.032756283382   0.074241266610   0.138329454839 Bohr   0.0
[INPUT] 33 O      3.456461255000   1.047408955900  -0.522978964200 AA    6.531765132120   1.979316067068  -0.988287011247 Bohr   0.0
[INPUT] 34 C      4.174164986500  -1.007473311900   0.540936065300 AA    7.888028623234  -1.903848637300   1.022221014317 Bohr   0.0
[INPUT] 35 C      5.592310295000  -0.550779205700   0.230542475400 AA   10.567934861136  -1.040821853878   0.435662138585 Bohr   0.0
[INPUT] 36 C      6.653503278000  -1.627665426600   0.426784996400 AA   12.573298964316  -3.075841878697   0.806506757269 Bohr   0.0
[INPUT] 37 C      6.353114519400  -2.959042713200   0.657847841100 AA   12.005646479664  -5.591780318838   1.243152251315 Bohr   0.0
[INPUT] 38 C      7.348437698100  -3.922347432300   0.594643275800 AA   13.886534692838  -7.412162412438   1.123712933076 Bohr   0.0
[INPUT] 39 C      8.655326457300  -3.557762202800   0.326277333500 AA   16.356196522999  -6.723196179621   0.616574800968 Bohr   0.0
[INPUT] 40 C      8.972123689100  -2.217405424100   0.175106751400 AA   16.954856528121  -4.190288958674   0.330903802708 Bohr   0.0
[INPUT] 41 C      7.978088025400  -1.261540852700   0.232347201700 AA   15.076401365678  -2.383966706553   0.439072577022 Bohr   0.0
[INPUT] 42 O      4.011755464700  -1.278115329800   1.932573167900 AA    7.581119107010  -2.415287928930   3.652034003014 Bohr   0.0
[INPUT] 43 N      5.970826675100   0.681000337400   0.887341574600 AA   11.283227153186   1.286904128422   1.676832554934 Bohr   0.0
[INPUT] 44 C      6.108301065900   1.957142945000   0.395614199900 AA   11.543016100940   3.698464152675   0.747602488800 Bohr   0.0
[INPUT] 45 O      6.319315793300   2.880362062300   1.168289144900 AA   11.941776143976   5.443095437334   2.207746518163 Bohr   0.0
[INPUT] 46 C      5.885623634200   2.229477153600  -1.068436850000 AA   11.122216740905   4.213101221279  -2.019053027893 Bohr   0.0
[INPUT] 47 C      6.118275612100   1.353094594300  -2.115426193500 AA   11.561865261475   2.556978203856  -3.997576142446 Bohr   0.0
[INPUT] 48 C      5.566609265300   1.598592691300  -3.362752178600 AA   10.519366953883   3.020902371288  -6.354680642338 Bohr   0.0
[INPUT] 49 C      4.850499290200   2.766099107700  -3.588064516700 AA    9.166115225875   5.227169746957  -6.780459253833 Bohr   0.0
[INPUT] 50 C      4.760052371500   3.710251180900  -2.585973860900 AA    8.995195320721   7.011358585245  -4.886782362385 Bohr   0.0
[INPUT] 51 C      5.275830833200   3.441999371300  -1.332664493800 AA    9.969875354284   6.504436132682  -2.518370909214 Bohr   0.0
[INPUT] 52 C     -2.136694961600  -3.047630587200  -1.030050594200 AA   -4.037768289162  -5.759187138655  -1.946513517484 Bohr   0.0
[INPUT] 53 O     -2.145165515400  -2.853379761400  -2.232887053200 AA   -4.053775315967  -5.392106278423  -4.219544997635 Bohr   0.0
[INPUT] 54 C     -1.503371455400  -4.203008750800  -0.369107513400 AA   -2.840960314195  -7.942535438162  -0.697512110845 Bohr   0.0
[INPUT] 55 C     -1.439572693900  -4.326698110800   1.005418559300 AA   -2.720398127873  -8.176274453085   1.899965717632 Bohr   0.0
[INPUT] 56 C     -0.763882981100  -5.398975150400   1.562724199700 AA   -1.443529625495 -10.202584387588   2.953120745663 Bohr   0.0
[INPUT] 57 C     -0.172850418300  -6.346860650400   0.742771627300 AA   -0.326639951104 -11.993828380035   1.403634948695 Bohr   0.0
[INPUT] 58 C     -0.255582963000  -6.227538696200  -0.635320316300 AA   -0.482981802175 -11.768342565949  -1.200581399179 Bohr   0.0
[INPUT] 59 C     -0.915559396300  -5.150964364100  -1.191110363800 AA   -1.730156509779  -9.733911925543  -2.250872371713 Bohr   0.0
[INPUT] 60 C     -0.209739279600  -1.154747445200   1.836434036800 AA   -0.396349796008  -2.182156414469   3.470357375381 Bohr   0.0
[INPUT] 61 C     -2.430050207100  -0.456231276800   2.470764120300 AA   -4.592129360362  -0.862152162613   4.669067505769 Bohr   0.0
[INPUT] 62 H     -3.649174243900   1.868315247200  -0.515583022000 AA   -6.895939901788   3.530604131557  -0.974310706056 Bohr   0.0
[INPUT] 63 H     -4.244203967400  -0.729802896800   0.994607092800 AA   -8.020383115178  -1.379127599866   1.879535006942 Bohr   0.0
[INPUT] 64 H     -6.131912630400   1.576165112500   1.173941659700 AA  -11.587635491217   2.978520389719   2.218428223050 Bohr   0.0
[INPUT] 65 H     -6.427809528700   2.562746232100  -1.568208864400 AA  -12.146799590113   4.842888505430  -2.963485259831 Bohr   0.0
[INPUT] 66 H     -7.389638380600   1.305338131800  -0.774495663500 AA  -13.964392698908   2.466731569053  -1.463584688678 Bohr   0.0
[INPUT] 67 H     -4.746570586800   0.945413731500  -2.212048081500 AA   -8.969718439968   1.786573026938  -4.180165048405 Bohr   0.0
[INPUT] 68 H     -2.885555410300  -0.719031232500  -1.668258137000 AA   -5.452909442724  -1.358772104433  -3.152550984007 Bohr   0.0
[INPUT] 69 H     -1.175647165700   1.895844651600  -0.685081522500 AA   -2.221651162294   3.582627166245  -1.294616450525 Bohr   0.0
[INPUT] 70 H     -1.848163242500   3.644203533500   0.809151568400 AA   -3.492522361813   6.886546620487   1.529074857538 Bohr   0.0
[INPUT] 71 H     -0.304022278100  -0.041677911500  -1.833900506100 AA   -0.574518841375  -0.078759838179  -3.465569696230 Bohr   0.0
[INPUT] 72 H      0.091519127800  -1.395292160100  -0.802871562300 AA    0.172946086701  -2.636720046342  -1.517207365949 Bohr   0.0
[INPUT] 73 H      1.266520795800   1.175976322100  -0.836761241800 AA    2.393377435128   2.222273177742  -1.581249578653 Bohr   0.0
[INPUT] 74 H     -7.944775163500  -1.408783598500  -1.939680678900 AA  -15.013449180262  -2.662215169944  -3.665465252231 Bohr   0.0
[INPUT] 75 H     -8.986072482000  -0.473697834000  -0.925412462400 AA  -16.981215926471  -0.895159172060  -1.748776106195 Bohr   0.0
[INPUT] 76 H     -9.171480359000  -2.220572400100  -0.925016649100 AA  -17.331586035338  -4.196273675957  -1.748028127462 Bohr   0.0
[INPUT] 77 H     -5.969665901300  -2.420660834100  -1.871526976700 AA  -11.281033608612  -4.574386016910  -3.536673420698 Bohr   0.0
[INPUT] 78 H     -4.495698786200  -1.691616719700  -2.534152263800 AA   -8.495639444458  -3.196692307968  -4.788853736529 Bohr   0.0
[INPUT] 79 H     -6.185930677800   3.799029211200   0.805798527800 AA  -11.689714806587   7.179124748390   1.522738529120 Bohr   0.0
[INPUT] 80 H     -0.404734860000   4.530281932600   2.291867972200 AA   -0.764838038464   8.560992119679   4.331002781120 Bohr   0.0
[INPUT] 81 H     -1.409225368000   5.959026511700   2.220198800700 AA   -2.663049993309  11.260928076135   4.195567675411 Bohr   0.0
[INPUT] 82 H      0.317104086900   6.093166340400   1.887160888000 AA    0.599239877221  11.514415614774   3.566217231311 Bohr   0.0
[INPUT] 83 H      1.483282415000   3.034329514800   2.056903112700 AA    2.802997529733   5.734051754656   3.886983547768 Bohr   0.0
[INPUT] 84 H      0.868934719800   3.668775640400   0.536584696200 AA    1.642048640548   6.932981172832   1.013998118451 Bohr   0.0
[INPUT] 85 H      2.168488856800   2.534156395300   0.536774474600 AA    4.097850043523   4.788861543932   1.014356747651 Bohr   0.0
[INPUT] 86 H      3.966961336600  -1.892496883600  -0.057258102700 AA    7.496470472913  -3.576300801597  -0.108202132515 Bohr   0.0
[INPUT] 87 H      5.554177213400  -0.351675166300  -0.821799729800 AA   10.495873780626  -0.664569749118  -1.552976418564 Bohr   0.0
[INPUT] 88 H      5.354497454800  -3.255709968700   0.903884794100 AA   10.118533724253  -6.152400181859   1.708094709008 Bohr   0.0
[INPUT] 89 H      7.098913952500  -4.951395815900   0.746928791800 AA   13.415003152079  -9.356782026368   1.411490851054 Bohr   0.0
[INPUT] 90 H      9.417193915600  -4.303693427100   0.240785615900 AA   17.795917362404  -8.132801901310   0.455018868786 Bohr   0.0
[INPUT] 91 H      9.985744399500  -1.917765322200   0.002346766800 AA   18.870322064964  -3.624051230146   0.004434746530 Bohr   0.0
[INPUT] 92 H      8.225473352200  -0.225306477200   0.125341307800 AA   15.543891880566  -0.425767535999   0.236860743837 Bohr   0.0
[INPUT] 93 H      3.129949484700  -1.633786818200   2.108377880300 AA    5.914747309807  -3.087409632323   3.984256760858 Bohr   0.0
[INPUT] 94 H      6.093613832600   0.625074370800   1.885954791400 AA   11.515261252475   1.181219368297   3.563938039057 Bohr   0.0
[INPUT] 95 H      6.708437989200   0.470518045900  -1.983335224700 AA   12.677110523216   0.889150243417  -3.747960387886 Bohr   0.0
[INPUT] 96 H      5.674395070400   0.872785949300  -4.141274988800 AA   10.723052605638   1.649326409546  -7.825875535343 Bohr   0.0
[INPUT] 97 H      4.379845623800   2.927416042800  -4.533595584700 AA    8.276708696857   5.532014573550  -8.567254014620 Bohr   0.0
[INPUT] 98 H      4.256384362700   4.644213865000  -2.766068721700 AA    8.043400726384   8.776292268758  -5.227112325739 Bohr   0.0
[INPUT] 99 H      5.174730580500   4.149532633000  -0.532731135700 AA    9.778823565557   7.841480221315  -1.006715944502 Bohr   0.0
[INPUT]100 H     -1.901596472000  -3.596188188200   1.631624986600 AA   -3.593496531519  -6.795810768094   3.083324362671 Bohr   0.0
[INPUT]101 H     -0.695996068300  -5.495529714400   2.628427147000 AA   -1.315241952861 -10.385046069625   4.967007446202 Bohr   0.0
[INPUT]102 H      0.348232037100  -7.176149168700   1.176606804500 AA    0.658063177918 -13.560956557868   2.223464616805 Bohr   0.0
[INPUT]103 H      0.193485607500  -6.964795002100  -1.268941133600 AA    0.365634807220 -13.161555067709  -2.397951210699 Bohr   0.0
[INPUT]104 H     -0.982607009600  -5.025875283100  -2.251820916800 AA   -1.856858136222  -9.497527821280  -4.255324814319 Bohr   0.0
[INPUT]105 H      0.689530509600  -0.650332549700   2.131803853300 AA    1.303023817676  -1.228950408823   4.028525434029 Bohr   0.0
[INPUT]106 H      0.040855914600  -1.850720327900   1.057093396000 AA    0.077206489163  -3.497354552896   1.997617006526 Bohr   0.0
[INPUT]107 H     -0.549715219000  -1.738796622300   2.673056262200 AA   -1.038811210415  -3.285849402466   5.051344251112 Bohr   0.0
[INPUT]108 H     -2.686469381200  -1.507120461800   2.390316709000 AA   -5.076691372498  -2.848044909530   4.517043930982 Bohr   0.0
[INPUT]109 H     -3.339014287600   0.100051059800   2.468866915800 AA   -6.309822529574   0.189069101494   4.665482308862 Bohr   0.0
[INPUT]110 H     -1.977001952400  -0.295902542000   3.441010099200 AA   -3.735992237766  -0.559174763943   6.502566679350 Bohr   0.0

nuclear repulsion = 9667.06991723445
number of shells = 513
number of NR pGTOs = 1807
number of NR cGTOs = 1099
basis = def2-SVP
ecp = {}
CPU time:         3.36


PySCF Results


Initial guess from minao.


******** <class 'gpu4pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'gpu4pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 30
direct_scf = False
chkfile to save SCF result = /tmp/tmpxtwdix61
max_memory 25000 MB (current use 1878 MB)
XC library pyscf.dft.libxc version 6.1.0
    unable to decode the reference due to https://github.com/NVIDIA/cuda-python/issues/29
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x149ef92e5750>
grids dens level: 5
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x149ef92e55a0>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 3778432
prune_by_density_: 108 padding grids
    CPU time for                                   setting up grids      3.36 sec, wall time      2.60 sec, GPU time for   2600.79 ms
    CPU time for                                            vxc tot      0.97 sec, wall time      0.98 sec, GPU time for    977.57 ms
    CPU time for                                           jk total      0.01 sec, wall time      0.01 sec, GPU time for     12.77 ms
E1 = -23221.813428032452  Ecoul = 11017.492074933944  Exc = -392.74133853169525
init E= -2929.99277439576
    CPU time for                                         total prep      6.88 sec, wall time      4.33 sec, GPU time for   4334.01 ms
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      0.03 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     22.16 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      3.21 ms
    CPU time for                                            vxc tot      0.36 sec, wall time      0.36 sec, GPU time for    362.24 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     11.54 ms
    CPU time for                                               veff      0.37 sec, wall time      0.37 sec, GPU time for    373.85 ms
E1 = -23281.015082394995  Ecoul = 11093.432200692581  Exc = -399.5583221333858
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.93 ms
    CPU time for                                              total      0.40 sec, wall time      0.40 sec, GPU time for    403.43 ms
cycle= 1 E= -2920.07128660135  delta_E= 9.92  |ddm|= 13.5
diis-norm(errvec)=5.00179
diis-c [-25.01794972   1.        ]
    CPU time for                                               DIIS      0.01 sec, wall time      0.01 sec, GPU time for     13.92 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     22.13 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.83 ms
    CPU time for                                            vxc tot      0.36 sec, wall time      0.36 sec, GPU time for    361.31 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     11.48 ms
    CPU time for                                               veff      0.37 sec, wall time      0.37 sec, GPU time for    372.85 ms
E1 = -23264.916422469352  Ecoul = 11079.038121735324  Exc = -388.7977231909555
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.98 ms
    CPU time for                                              total      0.40 sec, wall time      0.41 sec, GPU time for    410.82 ms
cycle= 2 E= -2907.60610669053  delta_E= 12.5  |ddm|= 13.5
diis-norm(errvec)=12.9822
diis-c [-5.09709316  0.74122399  0.25877601]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.33 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     22.18 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.82 ms
    CPU time for                                            vxc tot      0.36 sec, wall time      0.36 sec, GPU time for    361.66 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     11.46 ms
    CPU time for                                               veff      0.37 sec, wall time      0.37 sec, GPU time for    373.18 ms
E1 = -23191.036935923807  Ecoul = 11001.071351972354  Exc = -393.7521872388144
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.89 ms
    CPU time for                                              total      0.40 sec, wall time      0.40 sec, GPU time for    398.50 ms
cycle= 3 E= -2916.64785395582  delta_E= -9.04  |ddm|= 12.1
diis-norm(errvec)=6.42277
diis-c [-2.57713635  0.57585122  0.21833269  0.20581609]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.46 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     22.12 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.81 ms
    CPU time for                                            vxc tot      0.36 sec, wall time      0.36 sec, GPU time for    361.08 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     11.54 ms
    CPU time for                                               veff      0.37 sec, wall time      0.37 sec, GPU time for    372.69 ms
E1 = -23240.117650966426  Ecoul = 11045.953346194243  Exc = -394.363263337841
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.89 ms
    CPU time for                                              total      0.40 sec, wall time      0.40 sec, GPU time for    398.06 ms
cycle= 4 E= -2921.45765087557  delta_E= -4.81  |ddm|= 5.23
diis-norm(errvec)=1.65772
diis-c [-0.91588054  0.27905639  0.11782973  0.10902061  0.49409327]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.57 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     22.18 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.81 ms
    CPU time for                                            vxc tot      0.36 sec, wall time      0.36 sec, GPU time for    361.20 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     11.48 ms
    CPU time for                                               veff      0.37 sec, wall time      0.37 sec, GPU time for    372.74 ms
E1 = -23255.77077734551  Ecoul = 11062.171395747839  Exc = -395.0048787426646
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.90 ms
    CPU time for                                              total      0.40 sec, wall time      0.40 sec, GPU time for    398.30 ms
cycle= 5 E= -2921.53434310589  delta_E= -0.0767  |ddm|= 1.83
diis-norm(errvec)=1.26921
diis-c [-0.09958423  0.06025901  0.02813391  0.02511056  0.39813999  0.48835653]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.72 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     22.12 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.80 ms
    CPU time for                                            vxc tot      0.36 sec, wall time      0.36 sec, GPU time for    361.37 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     11.60 ms
    CPU time for                                               veff      0.37 sec, wall time      0.37 sec, GPU time for    373.04 ms
E1 = -23252.99059879923  Ecoul = 11059.33319078171  Exc = -395.026172978851
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      1.01 ms
    CPU time for                                              total      0.40 sec, wall time      0.40 sec, GPU time for    398.81 ms
cycle= 6 E= -2921.61366376192  delta_E= -0.0793  |ddm|=    1
diis-norm(errvec)=0.585517
diis-c [-0.01285944  0.01217679  0.00527318  0.00470217  0.21566911  0.3687585
  0.39342025]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.95 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     22.55 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.83 ms
    CPU time for                                            vxc tot      0.36 sec, wall time      0.36 sec, GPU time for    362.13 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     11.49 ms
    CPU time for                                               veff      0.37 sec, wall time      0.37 sec, GPU time for    373.69 ms
E1 = -23251.657696570277  Ecoul = 11057.877672117766  Exc = -394.9249131126127
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.90 ms
    CPU time for                                              total      0.40 sec, wall time      0.40 sec, GPU time for    400.01 ms
cycle= 7 E= -2921.63502033068  delta_E= -0.0214  |ddm|= 0.409
diis-norm(errvec)=0.148663
diis-c [-0.00247248  0.00234924  0.00086036 -0.00119932  0.09785944  0.18579244
  0.25412788  0.46020997]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      1.96 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     22.54 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.80 ms
    CPU time for                                            vxc tot      0.36 sec, wall time      0.36 sec, GPU time for    361.88 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     11.56 ms
    CPU time for                                               veff      0.37 sec, wall time      0.37 sec, GPU time for    373.51 ms
E1 = -23251.53482277572  Ecoul = 11057.739481014707  Exc = -394.91068872349433
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.90 ms
    CPU time for                                              total      0.40 sec, wall time      0.40 sec, GPU time for    399.82 ms
cycle= 8 E= -2921.63611325006  delta_E= -0.00109  |ddm|= 0.131
diis-norm(errvec)=0.0715353
diis-c [-2.70815936e-04  4.05211279e-04 -5.50541611e-05 -1.50208448e-03
  3.40080570e-02  6.25877310e-02  1.03503521e-01  3.32404171e-01
  4.68648448e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      2.12 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     22.21 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.81 ms
    CPU time for                                            vxc tot      0.36 sec, wall time      0.36 sec, GPU time for    361.25 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     11.47 ms
    CPU time for                                               veff      0.37 sec, wall time      0.37 sec, GPU time for    372.79 ms
E1 = -23251.62743118728  Ecoul = 11057.83273825103  Exc = -394.9116321727022
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.89 ms
    CPU time for                                              total      0.40 sec, wall time      0.40 sec, GPU time for    398.93 ms
cycle= 9 E= -2921.6364078745  delta_E= -0.000295  |ddm|= 0.054
diis-norm(errvec)=0.0265601
diis-c [-5.14775904e-05  4.06637626e-01 -1.58452682e-04 -1.04530588e-03
  1.55558554e-02  2.48707916e-02  4.63055263e-02  1.83621749e-01
  3.24212210e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      2.14 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     22.20 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.82 ms
    CPU time for                                            vxc tot      0.36 sec, wall time      0.36 sec, GPU time for    361.55 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     11.45 ms
    CPU time for                                               veff      0.37 sec, wall time      0.37 sec, GPU time for    373.07 ms
E1 = -23251.68020597472  Ecoul = 11057.889555997212  Exc = -394.91571557553823
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.92 ms
    CPU time for                                              total      0.40 sec, wall time      0.40 sec, GPU time for    399.26 ms
cycle= 10 E= -2921.6364483186  delta_E= -4.04e-05  |ddm|= 0.0213
diis-norm(errvec)=0.010097
diis-c [-7.48760723e-06  2.82148019e-01  4.98098939e-01 -5.09254491e-04
  5.16808793e-03  4.81479416e-03  1.15782877e-02  6.32888763e-02
  1.35412251e-01]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      2.14 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     22.57 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.81 ms
    CPU time for                                            vxc tot      0.36 sec, wall time      0.36 sec, GPU time for    362.14 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     11.49 ms
    CPU time for                                               veff      0.37 sec, wall time      0.37 sec, GPU time for    373.70 ms
E1 = -23251.67935461529  Ecoul = 11057.89025027969  Exc = -394.9172661657868
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.90 ms
    CPU time for                                              total      0.40 sec, wall time      0.40 sec, GPU time for    400.23 ms
cycle= 11 E= -2921.63645326694  delta_E= -4.95e-06  |ddm|= 0.00745
diis-norm(errvec)=0.0045718
diis-c [-4.11570615e-06  1.20236931e-01  3.58475382e-01  4.94488627e-01
  3.03428439e-04 -2.34956668e-03 -2.45194736e-03  3.83189286e-03
  2.74652533e-02]
    CPU time for                                               DIIS      0.00 sec, wall time      0.00 sec, GPU time for      2.12 ms
    CPU time for                                                eig      0.02 sec, wall time      0.02 sec, GPU time for     22.63 ms
    CPU time for                                                 dm      0.00 sec, wall time      0.00 sec, GPU time for      0.81 ms
    CPU time for                                            vxc tot      0.36 sec, wall time      0.36 sec, GPU time for    361.54 ms
    CPU time for                                           jk total      0.00 sec, wall time      0.00 sec, GPU time for     11.46 ms
    CPU time for                                               veff      0.37 sec, wall time      0.37 sec, GPU time for    373.07 ms
E1 = -23251.679953226383  Ecoul = 11057.888139947994  Exc = -394.9145572364045
    CPU time for                                             energy      0.00 sec, wall time      0.00 sec, GPU time for      0.89 ms
    CPU time for                                              total      0.40 sec, wall time      0.40 sec, GPU time for    399.62 ms
cycle= 12 E= -2921.63645328035  delta_E= -1.34e-08  |ddm|= 0.00621
    CPU time for                                                SCF     11.70 sec, wall time      9.18 sec, GPU time for   9181.36 ms
converged SCF energy = -2921.63645328035
Nuc-Nuc PySCF=  9667.069917234448
One electron integrals energy -23251.679953226383
Coulomb energy  11057.888139947994
EXC  -394.9145572364045
PySCF time:  9.58890214189887
PySCF Grid Size:  (2983936,)
Initial guess from minao.
Currently Used memory: 4.6G


Natoms : 110


NAO : 1160


aux NAO : 4309
Running DFT using 2 threads for Numba.


GPU acceleration is enabled. Currently this only accelerates AO values and XC term evaluation.
GPU(s) information:
Found 2 CUDA devices
id 0    b'NVIDIA A100-SXM4-80GB'                              [SUPPORTED]
                      Compute Capability: 8.0
                           PCI Device ID: 0
                              PCI Bus ID: 1
                                    UUID: GPU-17abb6f3-f142-f016-adda-dcf861cdd488
                                Watchdog: Disabled
             FP32/FP64 Performance Ratio: 2
id 1    b'NVIDIA A100-SXM4-80GB'                              [SUPPORTED]
                      Compute Capability: 8.0
                           PCI Device ID: 0
                              PCI Bus ID: 65
                                    UUID: GPU-cd68b765-b4a5-f2a6-6950-0f2696dd9384
                                Watchdog: Disabled
             FP32/FP64 Performance Ratio: 2
Summary:
	2/2 devices are supported
True
Max threads per block supported by the GPU:  1024
The user has specified to use 1 GPU(s).
Threads per block configuration for the XC term:  (32, 32)
Threads per block configuration for the all other calculations:  (32, 32)

Calculating one electron integrals...


Core H size in GB  0.0107648
done!
Time taken 0.4387183114886284 seconds.


Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.22991125658154488 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.0625769104808569
Time taken to evaluate the square roots needed:  0.0022354312241077423
Time for significant indices evaluation:  0.31396739929914474
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.016161128
No. of elements in the standard three-centered two electron ERI tensor:  5798190400
No. of elements in the triangular three-centered two electron ERI tensor:  2901594420
No. of significant triplets based on Schwarz inequality and triangularity: 980568587 or 16.9% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.3790326826274395 seconds.

Two Center Two electron ERI size in GB  0.148539848
Three Center Two electron ERI size in GB  7.844548696
Three-centered two electron evaluation done!
Time taken for Cholesky factorization fo two-centered two-electron integrals 0.3560262359678745 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  18.02316022850573 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  2983936
Size (in GB) for storing the coordinates of grid:       0.071614464
Size (in GB) for storing the weights of grid:           0.023871488
Size (in GB) for storing the density at gridpoints:     0.023871488

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  51200
No. of batches:  59

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 0.052706481888890266 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    634
Average no. of basis functions contributing to a batch of grid points:    386


------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.70953851350316



------Iteration 1--------


Energies
Electron-Nuclear Energy       -26137.059186982355
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2918.961704722201
Coulomb Energy                11013.77040940359
Exchange-Correlation Energy   -392.79348861275804
-------------------------
Total Energy  -2930.0506442090154
-------------------------



Energy difference :  2930.0506442090154


Time taken for the previous iteration: 0.8538305591791868


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.9999712577576



------Iteration 2--------


Energies
Electron-Nuclear Energy       -26190.38765011691
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2909.549654559955
Coulomb Energy                11092.014258339103
Exchange-Correlation Energy   -398.6158360526436
-------------------------
Total Energy  -2920.369656010189
-------------------------



Energy difference :  9.680988198826526


Time taken for the previous iteration: 0.7927068509161472


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.9999585319298



------Iteration 3--------


Energies
Electron-Nuclear Energy       -26106.342423733036
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2844.6972897452843
Coulomb Energy                11073.462140648388
Exchange-Correlation Energy   -388.7328542728174
-------------------------
Total Energy  -2909.8459303518775
-------------------------



Energy difference :  10.523725658311378


Time taken for the previous iteration: 0.8027103263884783


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.99997452579805



------Iteration 4--------


Energies
Electron-Nuclear Energy       -26058.741712975465
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2875.9339812626317
Coulomb Energy                10992.506197602432
Exchange-Correlation Energy   -393.06937324035454
-------------------------
Total Energy  -2916.3009900904526
-------------------------



Energy difference :  6.455059738575073


Time taken for the previous iteration: 0.7910948432981968


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.9999674815971



------Iteration 5--------


Energies
Electron-Nuclear Energy       -26122.291019691493
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2881.6240563004612
Coulomb Energy                11046.130360532123
Exchange-Correlation Energy   -393.96119549405375
-------------------------
Total Energy  -2921.4278810926553
-------------------------



Energy difference :  5.126891002202683


Time taken for the previous iteration: 0.7905633989721537


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.9999682482069



------Iteration 6--------


Energies
Electron-Nuclear Energy       -26136.819695638333
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2884.7376907677913
Coulomb Energy                11057.720228637761
Exchange-Correlation Energy   -394.41031522700905
-------------------------
Total Energy  -2921.7021741994868
-------------------------



Energy difference :  0.2742931068314647


Time taken for the previous iteration: 0.790157612413168


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.9999674098922



------Iteration 7--------


Energies
Electron-Nuclear Energy       -26136.168302702103
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2885.14826592999
Coulomb Energy                11056.682567404432
Exchange-Correlation Energy   -394.45761108170177
-------------------------
Total Energy  -2921.7251631890776
-------------------------



Energy difference :  0.022988989590885467


Time taken for the previous iteration: 0.7964194528758526


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.99996802653067



------Iteration 8--------


Energies
Electron-Nuclear Energy       -26136.141418111525
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2884.9418064202036
Coulomb Energy                11056.80372982937
Exchange-Correlation Energy   -394.4226931738306
-------------------------
Total Energy  -2921.748657775477
-------------------------



Energy difference :  0.023494586399465334


Time taken for the previous iteration: 0.7924803905189037


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.99996790741864



------Iteration 9--------


Energies
Electron-Nuclear Energy       -26135.28584890614
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2884.7203430966633
Coulomb Energy                11056.138449709879
Exchange-Correlation Energy   -394.3927721558986
-------------------------
Total Energy  -2921.7499109951914
-------------------------



Energy difference :  0.001253219714271836


Time taken for the previous iteration: 0.8109146468341351


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.9999678513147



------Iteration 10--------


Energies
Electron-Nuclear Energy       -26135.311394064982
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2884.4894221604454
Coulomb Energy                11056.36379513822
Exchange-Correlation Energy   -394.36195336096966
-------------------------
Total Energy  -2921.750212866982
-------------------------



Energy difference :  0.00030187179072527215


Time taken for the previous iteration: 0.828760739415884


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.99996789599317



------Iteration 11--------


Energies
Electron-Nuclear Energy       -26136.143116018917
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2884.841484339773
Coulomb Energy                11056.892447042797
Exchange-Correlation Energy   -394.4110167911526
-------------------------
Total Energy  -2921.750284167194
-------------------------



Energy difference :  7.130021185730584e-05


Time taken for the previous iteration: 0.8035792224109173


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.9999678898851



------Iteration 12--------


Energies
Electron-Nuclear Energy       -26135.63550123803
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2884.7192824504873
Coulomb Energy                11056.490050117336
Exchange-Correlation Energy   -394.39412482580695
-------------------------
Total Energy  -2921.7503762357046
-------------------------



Energy difference :  9.206851063936483e-05


Time taken for the previous iteration: 0.7902919128537178


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.99996789014426



------Iteration 13--------


Energies
Electron-Nuclear Energy       -26135.648318599633
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2884.697127182393
Coulomb Energy                11056.521428574697
Exchange-Correlation Energy   -394.39056091130215
-------------------------
Total Energy  -2921.75040649354
-------------------------



Energy difference :  3.025783553312067e-05


Time taken for the previous iteration: 0.8160276804119349


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.99996788927297



------Iteration 14--------


Energies
Electron-Nuclear Energy       -26135.673309030244
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2884.7109911290104
Coulomb Energy                11056.534601287252
Exchange-Correlation Energy   -394.3926083001877
-------------------------
Total Energy  -2921.7504076538626
-------------------------



Energy difference :  1.1603224265854806e-06


Time taken for the previous iteration: 0.8253908157348633


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.9999678924181



------Iteration 15--------


Energies
Electron-Nuclear Energy       -26135.68210087391
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2884.711104984723
Coulomb Energy                11056.543259927595
Exchange-Correlation Energy   -394.3925886342825
-------------------------
Total Energy  -2921.7504073355703
-------------------------



Energy difference :  3.182922228006646e-07


Time taken for the previous iteration: 0.8140782676637173


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.9999678895416



------Iteration 16--------


Energies
Electron-Nuclear Energy       -26135.66922644755
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2884.7083535534507
Coulomb Energy                11056.532765296512
Exchange-Correlation Energy   -394.3922174889742
-------------------------
Total Energy  -2921.7504078262555
-------------------------



Energy difference :  4.906851245323196e-07


Time taken for the previous iteration: 0.8096731901168823


Calculating XC term using GPU and algo 3
Not using LibXC for XC evaluations
Number of electrons:  445.99996788981866



------Iteration 17--------


Energies
Electron-Nuclear Energy       -26135.66927775699
Nuclear repulsion Energy      9667.069917260305
Kinetic Energy                2884.7076116430426
Coulomb Energy                11056.533461439403
Exchange-Correlation Energy   -394.3921204274049
-------------------------
Total Energy  -2921.750407841644
-------------------------



Energy difference :  1.5388650353997946e-08


Time taken for the previous iteration: 0.813211265951395



SCF Converged after 17 iterations!

-------------------------------------
Total Energy =  -2921.750407841644
-------------------------------------



Time taken : 32.272600710392 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           0.052706481888890266
Density Fitting                         2.6879926938563585
    DF (gamma)                          1.4395817406475544
    DF (coeff)                          0.3321468662470579
    DF (Jtri)                           0.37768658995628357
    DF (Cholesky)                       0.3560262359678745
DIIS                                    0.08306950703263283
KS matrix diagonalization               0.7211558688431978
One electron Integrals (S, T, Vnuc)     0.4387183114886284
Coulomb Integrals (2c2e + 3c2e)         17.667133992537856
Grids construction                      0
Exchange-Correlation Term               10.534569604322314
Misc.                                   0.0872542504221201
Complete SCF                            32.272600710392
