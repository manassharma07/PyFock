Operating System: Linux 5.15.0-69-generic
System Type: 64bit
CPU Model: AMD Ryzen Threadripper 3990X 64-Core Processor
Number of Cores: 64
Number of Threads: 128
Memory (GB): 125.64241409301758
Number of cores being actually used/requested for the benchmark: 32
Confirming that the environment variables are properly set...
OMP_NUM_THREADS = 32
OPENBLAS_NUM_THREADS = 32
MKL_NUM_THREADS = 32
VECLIB_MAXIMUM_THREADS = 32
NUMEXPR_NUM_THREADS = 32
PYSCF_MAX_MEMORY = 25000
#INFO: **** input file is /home/manas/temp_pyfock/PyFock/benchmarks_tests/benchmark_DFT_LDA_DF.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for 0.1 seconds for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### Although, recently I have noticed that using taskset makes joblib use only half the number of threads.
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png

import os
import platform
import psutil
# import numba
# numba.config.THREADING_LAYER='omp'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 32
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(25000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

#LDA
funcx = 1
funcc = 7
#PBE
# funcx = 101
# funcc = 130
funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)

# basis_set_name = 'sto-2g'
# basis_set_name = 'sto-3g'
# basis_set_name = 'sto-6g'
# basis_set_name = '6-31G'
basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-SVPD'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'def2-QZVP'
# basis_set_name = 'def2-TZVPP'
# basis_set_name = 'def2-QZVPP'
# basis_set_name = 'def2-TZVPD'
# basis_set_name = 'def2-QZVPD'
# basis_set_name = 'def2-TZVPPD'
# basis_set_name = 'def2-QZVPPD'
# basis_set_name = 'cc-pVDZ'
# basis_set_name = 'ano-rcc'

auxbasis_name = 'def2-universal-jfit'
# auxbasis_name = 'sto-3g'
# auxbasis_name = 'def2-SVP'
# auxbasis_name = '6-31G'

# xyzFilename = 'Benzene-Fulvene_Dimer.xyz'
# xyzFilename = 'Adenine-Thymine.xyz'
# xyzFilename = 'Zn.xyz'
# xyzFilename = 'Zn_dimer.xyz'
# xyzFilename = 'TPP.xyz'
# xyzFilename = 'Zn_TPP.xyz'
# xyzFilename = 'H2O.xyz'

# xyzFilename = 'Caffeine.xyz'
# xyzFilename = 'Serotonin.xyz'
xyzFilename = 'Cholesterol.xyz'
# xyzFilename = 'C60.xyz'
# xyzFilename = 'Taxol.xyz'
# xyzFilename = 'Valinomycin.xyz'
# xyzFilename = 'Olestra.xyz'
# xyzFilename = 'Ubiquitin.xyz'

### 1D Carbon Alkanes
# xyzFilename = 'Ethane.xyz'
# xyzFilename = 'Decane_C10H22.xyz'
# xyzFilename = 'Icosane_C20H42.xyz'
# xyzFilename = 'Tetracontane_C40H82.xyz'
# xyzFilename = 'Pentacontane_C50H102.xyz'
# xyzFilename = 'Octacontane_C80H162.xyz'
# xyzFilename = 'Hectane_C100H202.xyz'
# xyzFilename = 'Icosahectane_C120H242.xyz'

### 2D Carbon
# xyzFilename = 'Graphene_C16.xyz'
# xyzFilename = 'Graphene_C76.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'

### 3d Carbon Fullerenes
# xyzFilename = 'C60.xyz'
# xyzFilename = 'C70.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'


# ---------PySCF---------------
#Comparison with PySCF
molPySCF = gto.Mole()
molPySCF.atom = xyzFilename
molPySCF.basis = basis_set_name
molPySCF.cart = True
molPySCF.verbose = 4
molPySCF.max_memory=25000
# molPySCF.incore_anyway = True # Keeps the PySCF ERI integrals incore
molPySCF.build()
#print(molPySCF.cart_labels())

print('\n\nPySCF Results\n\n')
start=timer()
mf = dft.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
mf.xc = funcidpyscf
# mf.verbose = 4
mf.direct_scf = False
# mf.with_df.max_memory = 25000
# dmat_init = mf.init_guess_by_1e(molPySCF)
# dmat_init = mf.init_guess_by_huckel(molPySCF)
mf.init_guess = 'minao'
dmat_init = mf.init_guess_by_minao(molPySCF)
# mf.init_guess = 'atom'
# dmat_init = mf.init_guess_by_atom(molPySCF)
mf.max_cycle = 35
mf.conv_tol = 1e-7
mf.grids.level = 5
print('begin df build')
start_df_pyscf=timer()
# mf.with_df.build()
duration_df_pyscf = timer()- start_df_pyscf
print('PySCF df time: ', duration_df_pyscf)
print('end df build')
energyPyscf = mf.kernel(dm0=dmat_init)
print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
print('One electron integrals energy',mf.scf_summary['e1'])
print('Coulomb energy ',mf.scf_summary['coul'])
print('EXC ',mf.scf_summary['exc'])
duration = timer()-start
print('PySCF time: ', duration)
pyscfGrids = mf.grids
print('PySCF Grid Size: ', pyscfGrids.weights.shape)
mf = 0#None

#--------------------CrysX --------------------------

#Initialize a Mol object with somewhat large geometry
molCrysX = Mol(coordfile=xyzFilename)
print('\n\nNatoms :',molCrysX.natoms)

#Initialize a Basis object with a very large basis set
basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})
print('\n\nNAO :',basis.bfs_nao)

auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})
print('\n\naux NAO :',auxbasis.bfs_nao)

dftObj = DFT(molCrysX, basis,xc=funcidcrysx)
# GPU acceleration
# dftObj.use_gpu = False
# dftObj.keep_ao_in_gpu = True
# Using PySCF grids to compare the energies
energyCrysX, dmat = dftObj.scf(max_itr=35, ncores=ncores, dmat=dmat_init, conv_crit=1.0E-7, grids=pyscfGrids, isDF=True, auxbasis=auxbasis, rys=True, DF_algo=6, blocksize=5000, XC_algo=2, debug=False, sortGrids=False, save_ao_values=False, xc_bf_screen=True,threshold_schwarz=1e-9)
# Using CrysX grids 
# To get the same energies as PySCF (level=5) upto 1e-7 au, use the following settings
# radial_precision=1.0e-13
# level=3
# pruning by density with threshold = 1e-011
# alpha_min and alpha_max corresponding to QZVP
# energyCrysX, dmat = dftObj.scf(max_itr=30, ncores=ncores, dmat=dmat_init, grids=None, gridsLevel=3, isDF=True, auxbasis=auxbasis, rys=True, DF_algo=6, blocksize=5000, XC_algo=2, debug=False, sortGrids=False, save_ao_values=True, xc_bf_screen=True,threshold_schwarz=1e-9)


print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf))

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='baldr', release='5.15.0-69-generic', version='#76~20.04.1-Ubuntu SMP Mon Mar 20 15:54:19 UTC 2023', machine='x86_64', processor='x86_64')  Threads 32
Python 3.8.10 (default, Mar 13 2023, 10:26:41) 
[GCC 9.4.0]
numpy 1.21.6  scipy 1.7.3
Date: Thu Apr 27 18:36:00 2023
PySCF version 2.1.1
PySCF path  /home/manas/.local/lib/python3.8/site-packages/pyscf
GIT HEAD      /home/manas/.local/lib/python3.8/site-packages/pyscf/.git/HEAD

[ENV] PYSCF_MAX_MEMORY 25000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 74
[INPUT] num. electrons = 216
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Cartesian GTO integrals (6d 10f)
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 C     -7.268720000000  -0.018960000000  -2.017150000000 AA  -13.735890076149  -0.035829207322  -3.811861052166 Bohr   0.0
[INPUT]  2 C     -7.419420000000   0.505640000000  -0.587750000000 AA  -14.020671803121   0.955521117625  -1.110686529713 Bohr   0.0
[INPUT]  3 C     -8.796320000000   0.117840000000  -0.044750000000 AA  -16.622635704034   0.222685326519  -0.084565244074 Bohr   0.0
[INPUT]  4 C     -6.331420000000  -0.105860000000   0.297250000000 AA  -11.964649779594  -0.200046407546   0.561721090527 Bohr   0.0
[INPUT]  5 C     -4.959120000000   0.382640000000  -0.170550000000 AA   -9.371378618853   0.723084804304  -0.322292790545 Bohr   0.0
[INPUT]  6 C     -3.871120000000  -0.228760000000   0.714450000000 AA   -7.315356595326  -0.432293748256   1.350114829696 Bohr   0.0
[INPUT]  7 C     -2.498720000000   0.259740000000   0.246650000000 AA   -4.721896461973   0.490837463595   0.466100948624 Bohr   0.0
[INPUT]  8 H     -2.374720000000   0.034740000000  -0.812650000000 AA   -4.487570422527   0.065649085567  -1.535685935128 Bohr   0.0
[INPUT]  9 C     -2.394420000000   1.770840000000   0.462650000000 AA   -4.524798027181   3.346402610425   0.874281791530 Bohr   0.0
[INPUT] 10 C     -1.404820000000  -0.446960000000   1.049650000000 AA   -2.654725054311  -0.844631988636   1.983551026650 Bohr   0.0
[INPUT] 11 H     -1.524620000000  -0.240260000000   2.113150000000 AA   -2.881114244034  -0.454025598688   3.993274760125 Bohr   0.0
[INPUT] 12 C     -1.450820000000  -1.973560000000   0.791150000000 AA   -2.741652456041  -3.729487890397   1.495056823450 Bohr   0.0
[INPUT] 13 C     -0.049320000000  -2.368660000000   0.250750000000 AA   -0.093201292464  -4.476118682212   0.473848825735 Bohr   0.0
[INPUT] 14 C      0.853980000000  -1.257060000000   0.795950000000 AA    1.613788315856  -2.375499122146   1.504127508848 Bohr   0.0
[INPUT] 15 H      1.040680000000  -1.407860000000   1.859250000000 AA    1.966600183312  -2.660469821730   3.513473297098 Bohr   0.0
[INPUT] 16 C      2.162680000000  -1.046860000000   0.055950000000 AA    4.086872895074  -1.978278690762   0.105730176669 Bohr   0.0
[INPUT] 17 H      1.971580000000  -0.848360000000  -0.998650000000 AA    3.725746232670  -1.603168055036  -1.887174994297 Bohr   0.0
[INPUT] 18 C      3.043680000000  -2.291560000000   0.209550000000 AA    5.751721610816  -4.330420798008   0.395992109403 Bohr   0.0
[INPUT] 19 C      4.396680000000  -2.014360000000  -0.378150000000 AA    8.308521057353  -3.806588716279  -0.714599934004 Bohr   0.0
[INPUT] 20 C      4.901680000000  -0.818360000000  -0.459550000000 AA    9.262832750258  -1.546476271299  -0.868423640544 Bohr   0.0
[INPUT] 21 C      6.285180000000  -0.661460000000  -1.067950000000 AA   11.877268843594  -1.249978242355  -2.018133014729 Bohr   0.0
[INPUT] 22 C      7.147280000000   0.156940000000  -0.102150000000 AA   13.506401735581   0.296573617989  -0.193035523624 Bohr   0.0
[INPUT] 23 H      7.287780000000  -0.402560000000   0.822750000000 AA   13.771908256083  -0.760728148705   1.554772168986 Bohr   0.0
[INPUT] 24 O      8.418980000000   0.415040000000  -0.700550000000 AA   15.909566448191   0.784311930739  -1.323847636564 Bohr   0.0
[INPUT] 25 C      6.449880000000   1.483140000000   0.205250000000 AA   12.188506736310   2.802728404387   0.387866287067 Bohr   0.0
[INPUT] 26 C      5.128580000000   1.216240000000   0.929050000000 AA    9.691611607922   2.298360501741   1.755650056027 Bohr   0.0
[INPUT] 27 C      4.197980000000   0.420540000000   0.009050000000 AA    7.933032476402   0.794705424425   0.017102021427 Bohr   0.0
[INPUT] 28 C      3.887180000000   1.284240000000  -1.214950000000 AA    7.345705596887   2.426861878211  -2.295922755040 Bohr   0.0
[INPUT] 29 C      2.872780000000   0.151040000000   0.701650000000 AA    5.428767416128   0.285424233854   1.325926335301 Bohr   0.0
[INPUT] 30 H      3.075280000000  -0.116260000000   1.738750000000 AA    5.811436956352  -0.219699559242   3.285761299088 Bohr   0.0
[INPUT] 31 C      2.017280000000   1.414940000000   0.688350000000 AA    3.812106716563   2.673849082692   1.300792977844 Bohr   0.0
[INPUT] 32 C      0.632380000000   1.172640000000   1.308350000000 AA    1.195025006652   2.215968442710   2.472423175075 Bohr   0.0
[INPUT] 33 C     -0.026620000000   0.003540000000   0.575550000000 AA   -0.050304509436   0.006689630481   1.087631870993 Bohr   0.0
[INPUT] 34 C     -0.054820000000   0.283140000000  -0.928350000000 AA   -0.103594786149   0.535057054909  -1.754327247740 Bohr   0.0
[INPUT] 35 H     -6.287820000000   0.257340000000  -2.403950000000 AA  -11.882257720563   0.486302120896  -4.542807117148 Bohr   0.0
[INPUT] 36 H     -7.367120000000  -1.104460000000  -2.018050000000 AA  -13.921839126806  -2.087126915537  -3.813561805679 Bohr   0.0
[INPUT] 37 H     -8.043820000000   0.416740000000  -2.647650000000 AA  -15.200616795299   0.787524465151  -5.003333373705 Bohr   0.0
[INPUT] 38 H     -7.321020000000   1.591140000000  -0.586850000000 AA  -13.834722752463   3.006818825840  -1.108985776201 Bohr   0.0
[INPUT] 39 H     -8.894720000000  -0.967660000000  -0.045650000000 AA  -16.808584754691  -1.828612381697  -0.086265997586 Bohr   0.0
[INPUT] 40 H     -8.903620000000   0.491540000000   0.973550000000 AA  -16.825403317200   0.928875979269   1.839742868570 Bohr   0.0
[INPUT] 41 H     -9.571420000000   0.553540000000  -0.675250000000 AA  -18.087362423185   1.046038998992  -1.276037565613 Bohr   0.0
[INPUT] 42 H     -6.491720000000   0.197340000000   1.331950000000 AA  -12.267572877362   0.372918553422   2.517020711614 Bohr   0.0
[INPUT] 43 H     -6.373720000000  -1.192760000000   0.226450000000 AA  -12.044585194663  -2.253989732336   0.427928480908 Bohr   0.0
[INPUT] 44 H     -4.798820000000   0.079440000000  -1.205250000000 AA   -9.068455521085   0.150119843335  -2.277592411632 Bohr   0.0
[INPUT] 45 H     -4.916820000000   1.469540000000  -0.099750000000 AA   -9.291443203784   2.777028129093  -0.188500180925 Bohr   0.0
[INPUT] 46 H     -4.031420000000   0.074440000000   1.749150000000 AA   -7.618279693094   0.140671212713   3.305414450783 Bohr   0.0
[INPUT] 47 H     -3.913420000000  -1.315660000000   0.643650000000 AA   -7.395292010395  -2.486237073045   1.216322220076 Bohr   0.0
[INPUT] 48 H     -1.416720000000   2.118840000000   0.129350000000 AA   -2.677212795194   4.004027301773   0.244436074212 Bohr   0.0
[INPUT] 49 H     -3.173820000000   2.274340000000  -0.109350000000 AA   -5.997650568667   4.297879714143  -0.206641551721 Bohr   0.0
[INPUT] 50 H     -2.518520000000   1.995840000000   1.521950000000 AA   -4.759313039240   3.771590988452   2.876068675282 Bohr   0.0
[INPUT] 51 H     -1.656620000000  -2.504360000000   1.720650000000 AA   -3.130558092477  -4.732554517316   3.251557256233 Bohr   0.0
[INPUT] 52 H     -2.216220000000  -2.204760000000   0.050350000000 AA   -4.188048831784  -4.166392570396   0.095147710372 Bohr   0.0
[INPUT] 53 H      0.255180000000  -3.339560000000   0.641650000000 AA    0.482220312467  -6.310853776552   1.212542767827 Bohr   0.0
[INPUT] 54 H     -0.042820000000  -2.371160000000  -0.839250000000 AA   -0.080918072654  -4.480842997524  -1.585952650041 Bohr   0.0
[INPUT] 55 H      3.148780000000  -2.535060000000   1.266750000000 AA    5.950331826508  -4.790569109340   2.393810568293 Bohr   0.0
[INPUT] 56 H      2.583980000000  -3.129860000000  -0.314050000000 AA    4.883014511354  -5.914578208231  -0.593468489420 Bohr   0.0
[INPUT] 57 H      4.977080000000  -2.845460000000  -0.750650000000 AA    9.405318100050  -5.377140098405  -1.418522915405 Bohr   0.0
[INPUT] 58 H      6.733680000000  -1.643460000000  -1.218350000000 AA   12.724811010461  -3.105689296678  -2.302347823864 Bohr   0.0
[INPUT] 59 H      6.209480000000  -0.141760000000  -2.023050000000 AA   11.734216575964  -0.267887575418  -3.823010436301 Bohr   0.0
[INPUT] 60 H      8.918280000000  -0.382660000000  -0.922750000000 AA   16.853106702186  -0.723122598826  -1.743744781442 Bohr   0.0
[INPUT] 61 H      7.093780000000   2.092940000000   0.839050000000 AA   13.405301387917   3.955083395147   1.585574704816 Bohr   0.0
[INPUT] 62 H      6.252380000000   2.013440000000  -0.726350000000 AA   11.815285826708   3.804850168244  -1.372602570578 Bohr   0.0
[INPUT] 63 H      5.320080000000   0.643340000000   1.836250000000 AA   10.053494160776   1.215736404978   3.470009596233 Bohr   0.0
[INPUT] 64 H      4.658580000000   2.164540000000   1.189650000000 AA    8.803440329376   4.090387785666   2.248112684089 Bohr   0.0
[INPUT] 65 H      4.793180000000   1.415140000000  -1.806750000000 AA    9.057797465743   2.674227027917  -3.414262675558 Bohr   0.0
[INPUT] 66 H      3.124880000000   0.794640000000  -1.821050000000 AA    5.905167372131   1.501651967624  -3.441285759139 Bohr   0.0
[INPUT] 67 H      3.522180000000   2.258240000000  -0.889150000000 AA    6.655955561421   4.267455123538  -1.680249983657 Bohr   0.0
[INPUT] 68 H      2.527580000000   2.195240000000   1.252950000000 AA    4.776433957928   4.148402377690   2.367732347774 Bohr   0.0
[INPUT] 69 H      1.891880000000   1.748140000000  -0.341850000000 AA    3.575135060542   3.303505827397  -0.646002875683 Bohr   0.0
[INPUT] 70 H      0.739080000000   0.882640000000   2.353650000000 AA    1.396658784144   1.667947866586   4.447753893083 Bohr   0.0
[INPUT] 71 H      0.028280000000   2.076740000000   1.232550000000 AA    0.053441454803   3.924469831929   2.329181934833 Bohr   0.0
[INPUT] 72 H      0.953480000000   0.509540000000  -1.274850000000 AA    1.801816065250   0.962891049511  -2.409117349902 Bohr   0.0
[INPUT] 73 H     -0.431120000000  -0.594360000000  -1.454150000000 AA   -0.814698726822  -1.123177619396  -2.747945244036 Bohr   0.0
[INPUT] 74 H     -0.707020000000   1.133540000000  -1.127650000000 AA   -1.336074164590   2.142080151239  -2.130949664366 Bohr   0.0

nuclear repulsion = 2841.48341668081
number of shells = 306
number of NR pGTOs = 1022
number of NR cGTOs = 650
basis = def2-SVP
ecp = {}
CPU time:         2.47


PySCF Results


begin df build
PySCF df time:  2.375105395913124e-06
end df build


******** <class 'pyscf.df.df_jk.density_fit.<locals>.DensityFitting'> ********
method = DensityFitting-RKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 35
direct_scf = False
chkfile to save SCF result = /home/manas/temp_pyfock/PyFock/benchmarks_tests/tmp59z79uj6
max_memory 25000 MB (current use 266 MB)
XC library pyscf.dft.libxc version 5.2.0
    S. Lehtola, C. Steigemann, M. J. Oliveira, and M. A. Marques, SoftwareX 7, 1 (2018)
XC functionals = 1,7
    P. A. M. Dirac, Math. Proc. Cambridge Philos. Soc. 26, 376 (1930)
    F. Bloch, Z. Phys. 57, 545 (1929)
    S. H. Vosko, L. Wilk, and M. Nusair, Can. J. Phys. 58, 1200 (1980)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x7f2e19e3b280>
grids dens level: 5
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x7f2e19e3b1f0>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 2287536
init E= -1122.97713702241
  HOMO = -0.312111000431285  LUMO = -0.102837709402921
cycle= 1 E= -1120.15592291936  delta_E= 2.82  |g|=  1.4  |ddm|= 9.92
  HOMO = -0.047294806839866  LUMO = 0.0672754363944331
cycle= 2 E= -1119.31904747973  delta_E= 0.837  |g|= 2.32  |ddm|= 6.45
  HOMO = -0.203966721996114  LUMO = -0.010546471029722
cycle= 3 E= -1120.65942542547  delta_E= -1.34  |g|= 0.298  |ddm|= 4.99
  HOMO = -0.206213622660494  LUMO = -0.0160842288641244
cycle= 4 E= -1120.67646683919  delta_E= -0.017  |g|= 0.11  |ddm|= 0.676
  HOMO = -0.204856120663465  LUMO = -0.0123768284578323
cycle= 5 E= -1120.6791239415  delta_E= -0.00266  |g|= 0.0337  |ddm|= 0.164
  HOMO = -0.204213862863439  LUMO = -0.0118672477898533
cycle= 6 E= -1120.67931624913  delta_E= -0.000192  |g|= 0.021  |ddm|= 0.0629
  HOMO = -0.204163147736713  LUMO = -0.0121118534421978
cycle= 7 E= -1120.67942154816  delta_E= -0.000105  |g|= 0.00358  |ddm|= 0.0338
  HOMO = -0.204108686377009  LUMO = -0.0120119280762265
cycle= 8 E= -1120.67942440675  delta_E= -2.86e-06  |g|= 0.00125  |ddm|= 0.00738
  HOMO = -0.204127451788969  LUMO = -0.0120504522264449
cycle= 9 E= -1120.67942476116  delta_E= -3.54e-07  |g|= 0.000256  |ddm|= 0.00217
  HOMO = -0.204126637594759  LUMO = -0.012045178388288
cycle= 10 E= -1120.67942477573  delta_E= -1.46e-08  |g|= 9.26e-05  |ddm|= 0.000571
  HOMO = -0.204131346735415  LUMO = -0.0120537937672485
Extra cycle  E= -1120.67942477175  delta_E= 3.98e-09  |g|= 0.000158  |ddm|= 0.000377
converged SCF energy = -1120.67942477175
Nuc-Nuc PySCF=  2841.4834166808128
One electron integrals energy -7178.97772339544
Coulomb energy  3378.320940932542
EXC  -161.5060589896641
PySCF time:  128.16198218311183
PySCF Grid Size:  (1786888,)


Natoms : 74


NAO : 650


aux NAO : 2260
Running DFT using 32 threads for Numba.



Calculating one electron integrals...


Core H size in GB  0.00338
done!
Time taken 0.8123560559470206 seconds.


Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.1818959719967097 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.30614316393621266
Time taken to evaluate the square roots needed:  0.0013864191714674234
Time for significant indices evaluation:  0.80156363802962
Size of permanent array storing the significant indices of 3c2e ERI in GB  1.438813758
No. of elements in the standard three-centered two electron ERI tensor:  954850000
No. of elements in the triangular three-centered two electron ERI tensor:  478159500
No. of significant triplets based on Schwarz inequality and triangularity: 239802293 or 25.1% of original
Schwarz screening done!
Total time taken for Schwarz screening 1.1092476479243487 seconds.

Two Center Two electron ERI size in GB  0.0408608
Three Center Two electron ERI size in GB  1.918418344
Three-centered two electron evaluation done!
Time taken for Coulomb term related calculations (integrals, screening, prelims..) 14.630713415099308 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  1786888
Size (in GB) for storing the coordinates of grid:       0.042885312
Size (in GB) for storing the weights of grid:           0.014295104
Size (in GB) for storing the density at gridpoints:     0.014295104

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  5000
No. of batches:  357

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 1.8544532370287925 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    338
Average no. of basis functions contributing to a batch of grid points:    224


------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [1, 7]


Description of exchange functional: 

The Exchange function belongs to the family: LDA
Functional ID: 1
Functional Name: lda_x
Attributes:
    Name: Slater exchange
    Kind: 0
  Family: 1
Citations:
   P. A. M. Dirac, Math. Proc. Cambridge Philos. Soc. 26, 376 (1930)
   F. Bloch, Z. Phys. 57, 545 (1929)


Description of correlation functional: 

 The Correlation function belongs to the family: LDA
Functional ID: 7
Functional Name: lda_c_vwn
Attributes:
    Name: Vosko, Wilk & Nusair (VWN5)
    Kind: 1
  Family: 1
Citations:
   S. H. Vosko, L. Wilk, and M. Nusair, Can. J. Phys. 58, 1200 (1980)
------------------------------------------------------




Number of electrons:  215.60166850052434



------Iteration 1--------


Energies
Electron-Nuclear Energy       -8281.337617367544
Nuclear repulsion Energy      2841.4836205230044
Kinetic Energy                1131.215540053955
Coulomb Energy                3346.9920105142255
Exchange-Correlation Energy   -160.89707384120223
-------------------------
Total Energy  -1122.5435201175615
-------------------------



Energy difference :  1122.5435201175615


Time taken for the previous iteration: 2.8052882021293044


Number of electrons:  216.00003148785248



------Iteration 2--------


Energies
Electron-Nuclear Energy       -8325.272095206357
Nuclear repulsion Energy      2841.4836205230044
Kinetic Energy                1114.7887375967368
Coulomb Energy                3412.560358638618
Exchange-Correlation Energy   -163.61476186889146
-------------------------
Total Energy  -1120.0541403168909
-------------------------



Energy difference :  2.4893798006705765


Time taken for the previous iteration: 2.6145531609654427


Number of electrons:  216.0000464185305



------Iteration 3--------


Energies
Electron-Nuclear Energy       -8210.58578051277
Nuclear repulsion Energy      2841.4836205230044
Kinetic Energy                1086.0544169937093
Coulomb Energy                3322.364177860029
Exchange-Correlation Energy   -158.4363792368098
-------------------------
Total Energy  -1119.1199443728378
-------------------------



Energy difference :  0.9341959440530445


Time taken for the previous iteration: 2.715756668942049


Number of electrons:  216.000038734071



------Iteration 4--------


Energies
Electron-Nuclear Energy       -8287.022141940604
Nuclear repulsion Energy      2841.4836205230044
Kinetic Energy                1104.9860831494948
Coulomb Energy                3381.4572091504515
Exchange-Correlation Energy   -161.56090235925907
-------------------------
Total Energy  -1120.6561314769124
-------------------------



Energy difference :  1.5361871040745427


Time taken for the previous iteration: 2.7789895399473608


Number of electrons:  216.00003873705646



------Iteration 5--------


Energies
Electron-Nuclear Energy       -8284.03417609118
Nuclear repulsion Energy      2841.4836205230044
Kinetic Energy                1104.8507731850273
Coulomb Energy                3378.567712261716
Exchange-Correlation Energy   -161.54348968400973
-------------------------
Total Energy  -1120.6755598054406
-------------------------



Energy difference :  0.01942832852819265


Time taken for the previous iteration: 2.7591393678449094


Number of electrons:  216.00003856250441



------Iteration 6--------


Energies
Electron-Nuclear Energy       -8283.934715276708
Nuclear repulsion Energy      2841.4836205230044
Kinetic Energy                1104.708546674121
Coulomb Energy                3378.585498733213
Exchange-Correlation Energy   -161.52174992357794
-------------------------
Total Energy  -1120.6787992699483
-------------------------



Energy difference :  0.003239464507714729


Time taken for the previous iteration: 2.817954417085275


Number of electrons:  216.00003864356339



------Iteration 7--------


Energies
Electron-Nuclear Energy       -8283.676901111177
Nuclear repulsion Energy      2841.4836205230044
Kinetic Energy                1104.644736591462
Coulomb Energy                3378.380843670917
Exchange-Correlation Energy   -161.51163395262932
-------------------------
Total Energy  -1120.6793342784222
-------------------------



Energy difference :  0.0005350084738893202


Time taken for the previous iteration: 2.850490079028532


Number of electrons:  216.00003866479614



------Iteration 8--------


Energies
Electron-Nuclear Energy       -8283.599857514635
Nuclear repulsion Energy      2841.4836205230044
Kinetic Energy                1104.6076991912157
Coulomb Energy                3378.3358299525935
Exchange-Correlation Energy   -161.50671352255674
-------------------------
Total Energy  -1120.679421370378
-------------------------



Energy difference :  8.709195572009776e-05


Time taken for the previous iteration: 2.842616615118459


Number of electrons:  216.00003866185136



------Iteration 9--------


Energies
Electron-Nuclear Energy       -8283.579975627128
Nuclear repulsion Energy      2841.4836205230044
Kinetic Energy                1104.604317420843
Coulomb Energy                3378.3186983231503
Exchange-Correlation Energy   -161.50608508699062
-------------------------
Total Energy  -1120.6794244471216
-------------------------



Energy difference :  3.0767437237955164e-06


Time taken for the previous iteration: 2.8478396791033447


Number of electrons:  216.00003866078762



------Iteration 10--------


Energies
Electron-Nuclear Energy       -8283.578396430159
Nuclear repulsion Energy      2841.4836205230044
Kinetic Energy                1104.6029437537222
Coulomb Energy                3378.3182291767184
Exchange-Correlation Energy   -161.50582171485823
-------------------------
Total Energy  -1120.6794246915729
-------------------------



Energy difference :  2.4445125745842233e-07


Time taken for the previous iteration: 2.8683435970451683


Number of electrons:  216.00003866209934



------Iteration 11--------


Energies
Electron-Nuclear Energy       -8283.582549608147
Nuclear repulsion Energy      2841.4836205230044
Kinetic Energy                1104.604489392896
Coulomb Energy                3378.3210782929805
Exchange-Correlation Energy   -161.50606336033402
-------------------------
Total Energy  -1120.6794247596004
-------------------------



Energy difference :  6.802747520850971e-08

SCF Converged after 11 iterations!

-------------------------------------
Total Energy =  -1120.6794247596004
-------------------------------------



Time taken : 48.06385658495128 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           2.963700884953141
Density Fitting                         3.67417754791677
DF (gamma)                              1.3209676947444677
DF (coeff)                              1.3307476448826492
DF (Jtri)                               0.9766039948444813
DIIS                                    0.9324785647913814
KS matrix diagonalization               1.6645901382435113
One electron Integrals (S, T, Vnuc)     0.8123560559470206
Coulomb Integrals (2c2e + 3c2e)         13.52146576717496
Grids construction                      0
Exchange-Correlation Term               24.42065563215874
Misc.                                   0.07443199376575649
Complete SCF                            48.06385658495128
Energy diff (PySCF-CrysX) 1.2149030226282775e-08



 Package versions
pyscf version 2.1.1
np version 1.21.6
joblib version 1.2.0
numba version 0.57.0rc1
threadpoolctl version 3.1.0
opt_einsum version v3.3.0
llvmlite version 0.40.0rc1
cupy version 12.0.0
numexpr version 2.7.3
scipy version 1.7.3
