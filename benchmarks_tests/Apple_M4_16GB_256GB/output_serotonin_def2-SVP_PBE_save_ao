Cupy is not installed. GPU acceleration is not availble.
Operating System: Darwin 24.3.0
System Type: 64bit
CPU Model: Apple M4
Number of Cores: 10
Number of Threads: 10
Memory (GB): 16.0
Number of cores being actually used/requested for the benchmark: 1
Confirming that the environment variables are properly set...
OMP_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
MKL_NUM_THREADS = 1
VECLIB_MAXIMUM_THREADS = 1
NUMEXPR_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 25000
#INFO: **** input file is /Users/manas/Documents/PyFock/benchmarks_tests/benchmark_DFT_LDA_DF.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
#numba.config.THREADING_LAYER='tbb'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 1
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(25000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)

# basis_set_name = 'sto-2g'
# basis_set_name = 'sto-3g'
# basis_set_name = 'sto-6g'
# basis_set_name = '6-31G'
basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-SVPD'
# basis_set_name = 'def2-TZVP'
# basis_set_name = 'def2-QZVP'
# basis_set_name = 'def2-TZVPP'
# basis_set_name = 'def2-QZVPP'
# basis_set_name = 'def2-TZVPD'
# basis_set_name = 'def2-QZVPD'
# basis_set_name = 'def2-TZVPPD'
# basis_set_name = 'def2-QZVPPD'
# basis_set_name = 'cc-pVDZ'
# basis_set_name = 'ano-rcc'

auxbasis_name = 'def2-universal-jfit'
# auxbasis_name = 'def2-universal-jkfit'
# auxbasis_name = 'def2-TZVP'
# auxbasis_name = 'sto-3g'
# auxbasis_name = 'def2-SVP'
# auxbasis_name = '6-31G'

# xyzFilename = 'Benzene-Fulvene_Dimer.xyz'
# xyzFilename = 'Adenine-Thymine.xyz'
# xyzFilename = 'Zn.xyz'
# xyzFilename = 'Zn_dimer.xyz'
# xyzFilename = 'TPP.xyz'
# xyzFilename = 'Zn_TPP.xyz'
# xyzFilename = 'H2O.xyz'

# xyzFilename = 'Caffeine.xyz'
xyzFilename = 'Serotonin.xyz'
# xyzFilename = 'Cholesterol.xyz'
# xyzFilename = 'C60.xyz'
# xyzFilename = 'Taxol.xyz'
# xyzFilename = 'Valinomycin.xyz'
# xyzFilename = 'Olestra.xyz'
# xyzFilename = 'Ubiquitin.xyz'

### 1D Carbon Alkanes
# xyzFilename = 'Ethane.xyz'
# xyzFilename = 'Decane_C10H22.xyz'
# xyzFilename = 'Icosane_C20H42.xyz'
# xyzFilename = 'Tetracontane_C40H82.xyz'
# xyzFilename = 'Pentacontane_C50H102.xyz'
# xyzFilename = 'Octacontane_C80H162.xyz'
# xyzFilename = 'Hectane_C100H202.xyz'
# xyzFilename = 'Icosahectane_C120H242.xyz'

### 2D Carbon
# xyzFilename = 'Graphene_C16.xyz'
# xyzFilename = 'Graphene_C76.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'

### 3d Carbon Fullerenes
# xyzFilename = 'C60.xyz'
# xyzFilename = 'C70.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'


# ---------PySCF---------------
#Comparison with PySCF
molPySCF = gto.Mole()
molPySCF.atom = xyzFilename
molPySCF.basis = basis_set_name
molPySCF.cart = True
molPySCF.verbose = 4
molPySCF.max_memory=5000
# molPySCF.incore_anyway = True # Keeps the PySCF ERI integrals incore
molPySCF.build()
#print(molPySCF.cart_labels())

print('\n\nPySCF Results\n\n')
start=timer()
mf = dft.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
# mf = scf.RHF(molPySCF).density_fit(auxbasis=auxbasis_name)
mf.xc = funcidpyscf
# mf.verbose = 4
mf.direct_scf = False
# mf.with_df.max_memory = 25000
# dmat_init = mf.init_guess_by_1e(molPySCF)
# dmat_init = mf.init_guess_by_huckel(molPySCF)
mf.init_guess = 'minao'
dmat_init = mf.init_guess_by_minao(molPySCF)
# mf.init_guess = 'atom'
# dmat_init = mf.init_guess_by_atom(molPySCF)
mf.max_cycle = 30
mf.conv_tol = 1e-7
mf.grids.level = 3
# print('begin df build')
# start_df_pyscf=timer()
# mf.with_df.build()
# duration_df_pyscf = timer()- start_df_pyscf
# print('PySCF df time: ', duration_df_pyscf)
# print('end df build')
energyPyscf = mf.kernel(dm0=dmat_init)
print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
print('One electron integrals energy',mf.scf_summary['e1'])
print('Coulomb energy ',mf.scf_summary['coul'])
print('EXC ',mf.scf_summary['exc'])
duration = timer()-start
print('PySCF time: ', duration)
pyscfGrids = mf.grids
print('PySCF Grid Size: ', pyscfGrids.weights.shape)
print('\n\n PySCF Dipole moment')
dmat = mf.make_rdm1()
mol_dip_pyscf = mf.dip_moment(molPySCF, dmat, unit='AU')
mf = 0#None
import psutil

# Get memory information
memory_info = psutil.virtual_memory()

# Convert bytes to human-readable format
used_memory = psutil._common.bytes2human(memory_info.used)


# If you want to print in a more human-readable format, you can use psutil's utility function
print(f"Currently Used memory: {used_memory}")
#--------------------CrysX --------------------------

#Initialize a Mol object with somewhat large geometry
molCrysX = Mol(coordfile=xyzFilename)
print('\n\nNatoms :',molCrysX.natoms)
# print(molCrysX.coordsBohrs)

#Initialize a Basis object with a very large basis set
basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})
print('\n\nNAO :',basis.bfs_nao)

auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})
print('\n\naux NAO :',auxbasis.bfs_nao)

dftObj = DFT(molCrysX, basis, xc=funcidcrysx)
# GPU acceleration
dftObj.use_gpu = False
dftObj.keep_ao_in_gpu = False
dftObj.use_libxc = False
dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
dftObj.n_gpus = 1 # Specify the number of GPUs
dftObj.free_gpu_mem = True
dftObj.threads_x = 32
dftObj.threads_y = 32
dftObj.dynamic_precision = False
dftObj.keep_ints3c2e_in_gpu = True
# SAO or CAO basis
dftObj.sao = False
# print(dmat_init)
# Using PySCF grids to compare the energies
energyCrysX, dmat = dftObj.scf(max_itr=35, ncores=ncores, dmat=dmat_init, conv_crit=1.0E-7, grids=pyscfGrids, \
                               isDF=True, auxbasis=auxbasis, rys=True, DF_algo=10, blocksize=5000, XC_algo=2, debug=False, \
                                sortGrids=False, save_ao_values=True, xc_bf_screen=True, threshold_schwarz=1e-9, \
                                strict_schwarz=True, cholesky=True, orthogonalize=True)
# print(dmat)

# Using CrysX grids 
# To get the same energies as PySCF (level=5) upto 1e-7 au, use the following settings
# radial_precision=1.0e-13
# level=3
# pruning by density with threshold = 1e-011
# alpha_min and alpha_max corresponding to QZVP
# energyCrysX, dmat = dftObj.scf(max_itr=30, ncores=ncores, dmat=dmat_init, grids=None, gridsLevel=3, isDF=True, auxbasis=auxbasis,
#                             rys=True, DF_algo=6, blocksize=5000, XC_algo=2, debug=False, sortGrids=False, save_ao_values=True,
#                             xc_bf_screen=True,threshold_schwarz=1e-9)


print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf))

print('\n\nPyFock Dipole moment')
M = Integrals.dipole_moment_mat_symm(basis)
mol_dip = molCrysX.get_dipole_moment(M, dmat)
print('Dipole moment(X, Y, Z, A.U.):', *mol_dip)
print('Max Diff dipole moment (PySCF-CrysX)', abs(mol_dip_pyscf-mol_dip).max())

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Manass-MacBook-Air.local', release='24.3.0', version='Darwin Kernel Version 24.3.0: Thu Jan  2 20:31:46 PST 2025; root:xnu-11215.81.4~4/RELEASE_ARM64_T8132', machine='arm64')  Threads 1
Python 3.9.6 (default, Mar 12 2025, 20:22:46) 
[Clang 17.0.0 (clang-1700.0.13.3)]
numpy 1.26.4  scipy 1.10.1  h5py 3.13.0
Date: Mon May 19 13:40:48 2025
PySCF version 2.9.0
PySCF path  /Users/manas/Library/Python/3.9/lib/python/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 25000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 25
[INPUT] num. electrons = 94
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Cartesian GTO integrals (6d 10f)
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 O     -3.597300000000  -1.276500000000  -0.361600000000 AA   -6.797911787898  -2.412235398007  -0.683324966643 Bohr   0.0
[INPUT]  2 N      0.198600000000   2.542400000000  -0.375200000000 AA    0.375299608339   4.804439699094  -0.709025241937 Bohr   0.0
[INPUT]  3 N      3.042300000000  -2.350400000000   1.087300000000 AA    5.749113788764  -4.441612283178   2.054699215240 Bohr   0.0
[INPUT]  4 C      0.938900000000   0.427300000000  -0.387300000000 AA    1.774263858354   0.807479973027  -0.731890928044 Bohr   0.0
[INPUT]  5 C     -0.454700000000   0.418700000000  -0.380900000000 AA   -0.859258468840   0.791228328355  -0.719796680847 Bohr   0.0
[INPUT]  6 C      1.841400000000  -0.741800000000  -0.367100000000 AA    3.479741685774  -1.401798839202  -0.693718460328 Bohr   0.0
[INPUT]  7 C     -0.884000000000   1.749800000000  -0.376400000000 AA   -1.670517894116   3.306642772764  -0.711292913286 Bohr   0.0
[INPUT]  8 C      1.301700000000   1.775500000000  -0.381800000000 AA    2.459856496346   3.355208734165  -0.721497434359 Bohr   0.0
[INPUT]  9 C      2.153800000000  -1.186300000000   1.079100000000 AA    4.070092127088  -2.241782101572   2.039203461018 Bohr   0.0
[INPUT] 10 C     -1.382600000000  -0.638900000000  -0.370800000000 AA   -2.612735339824  -1.207346020985  -0.700710446989 Bohr   0.0
[INPUT] 11 C     -2.254400000000   2.064000000000  -0.368400000000 AA   -4.260198575219   3.900394721102  -0.696175104290 Bohr   0.0
[INPUT] 12 C     -2.760600000000  -0.338900000000  -0.365900000000 AA   -5.216777939474  -0.640428183615  -0.691450788978 Bohr   0.0
[INPUT] 13 C     -3.191200000000   1.008400000000  -0.365500000000 AA   -6.030494008712   1.905599824011  -0.690694898529 Bohr   0.0
[INPUT] 14 H      2.768500000000  -0.501100000000  -0.892800000000 AA    5.231706775858  -0.946941761020  -1.687147484012 Bohr   0.0
[INPUT] 15 H      1.384600000000  -1.570600000000  -0.914700000000 AA    2.616514792073  -2.968003851242  -1.728532486140 Bohr   0.0
[INPUT] 16 H      2.258200000000   2.134300000000  -0.376100000000 AA    4.267379534493   4.033242467659  -0.710725995449 Bohr   0.0
[INPUT] 17 H      0.191000000000   3.512900000000  -0.366400000000 AA    0.360937689792   6.638418902985  -0.692395652041 Bohr   0.0
[INPUT] 18 H      1.237800000000  -1.458100000000   1.609800000000 AA    2.339102996987  -2.755409662228   3.042081115325 Bohr   0.0
[INPUT] 19 H      2.645000000000  -0.381200000000   1.630400000000 AA    4.998325599475  -0.720363598684   3.081009473491 Bohr   0.0
[INPUT] 20 H     -1.060100000000  -1.609100000000  -0.365500000000 AA   -2.003298664651  -3.040758307038  -0.690694898529 Bohr   0.0
[INPUT] 21 H     -2.562300000000   3.039000000000  -0.363700000000 AA   -4.842045248973   5.742877692553  -0.687293391504 Bohr   0.0
[INPUT] 22 H     -4.189700000000   1.228600000000  -0.361900000000 AA   -7.917385544090   2.321717516641  -0.683891884480 Bohr   0.0
[INPUT] 23 H      3.172200000000  -2.618600000000   2.064900000000 AA    5.994589212345  -4.948436829786   3.902095474614 Bohr   0.0
[INPUT] 24 H      2.533000000000  -3.112400000000   0.634700000000 AA    4.786676273523  -5.881583590096   1.199409171261 Bohr   0.0
[INPUT] 25 H     -3.330200000000  -2.117200000000  -0.364000000000 AA   -6.293165940027  -4.000928150929  -0.687860309342 Bohr   0.0

nuclear repulsion = 764.128203722317
number of shells = 114
number of NR pGTOs = 409
number of NR cGTOs = 255
basis = def2-SVP
ecp = {}
CPU time:         2.96


PySCF Results


Initial guess from minao.


******** <class 'pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 30
direct_scf = False
chkfile to save SCF result = /var/folders/2v/15wx3xrs0tj4bz4kdgj4gfwh0000gn/T/tmpnr2qj0ko
max_memory 5000 MB (current use 0 MB)
XC library pyscf.dft.libxc version 7.0.0
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1â€“5 (2018)
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x146c65940>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x146b951f0>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 300768
init E= -573.973374990099
  HOMO = -0.254765144905674  LUMO = -0.128721770168708
cycle= 1 E= -571.678387526875  delta_E= 2.29  |g|= 0.91  |ddm|= 6.69
  HOMO = -0.0653500702022261  LUMO = 0.0302105746901473
cycle= 2 E= -571.38766972851  delta_E= 0.291  |g|= 1.45  |ddm|= 3.31
  HOMO = -0.149460556007018  LUMO = -0.0192957559932951
cycle= 3 E= -571.836195024884  delta_E= -0.449  |g|= 0.367  |ddm|= 2.37
  HOMO = -0.157002851486987  LUMO = -0.0349060185010557
cycle= 4 E= -571.8698075159  delta_E= -0.0336  |g|= 0.123  |ddm|= 0.584
  HOMO = -0.161126540169985  LUMO = -0.0383984731839153
cycle= 5 E= -571.872997487942  delta_E= -0.00319  |g|= 0.0603  |ddm|= 0.203
  HOMO = -0.158182090950842  LUMO = -0.0353860858689996
cycle= 6 E= -571.87387989127  delta_E= -0.000882  |g|= 0.0145  |ddm|= 0.0862
  HOMO = -0.158090251863748  LUMO = -0.035061542199002
cycle= 7 E= -571.873924907822  delta_E= -4.5e-05  |g|= 0.00638  |ddm|= 0.0237
  HOMO = -0.158162858719576  LUMO = -0.0352969839477175
cycle= 8 E= -571.873935153693  delta_E= -1.02e-05  |g|= 0.00181  |ddm|= 0.00965
  HOMO = -0.158238240630893  LUMO = -0.0353032261111934
cycle= 9 E= -571.873936010562  delta_E= -8.57e-07  |g|= 0.000633  |ddm|= 0.00318
  HOMO = -0.15823034142118  LUMO = -0.0353021066552895
cycle= 10 E= -571.873936110178  delta_E= -9.96e-08  |g|= 0.000276  |ddm|= 0.00114
  HOMO = -0.158224426844119  LUMO = -0.0353108760181875
Extra cycle  E= -571.873936013553  delta_E= 9.66e-08  |g|= 0.000652  |ddm|= 0.00117
converged SCF energy = -571.873936013553
Nuc-Nuc PySCF=  764.1282037223167
One electron integrals energy -2291.473832261572
Coulomb energy  1036.0854142848198
EXC  -80.61372175911731
PySCF time:  16.832671208
PySCF Grid Size:  (250672,)


 PySCF Dipole moment
Dipole moment(X, Y, Z, A.U.): -0.02510,  0.08805,  0.27603
Currently Used memory: 4.4G


Natoms : 25


NAO : 255


aux NAO : 937
Running DFT using 1 threads for Numba.



Calculating overlap and kinetic integrals...


Core H size in GB  0.0010404
done!
Time taken 0.12248699999999957 seconds.


Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.29483875000000026 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.03701433399999843
Time taken to evaluate the square roots needed:  4.3166999997623634e-05
Time for significant indices evaluation:  0.004701624999999154
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.000783368
No. of elements in the standard three-centered two electron ERI tensor:  60928425
No. of elements in the triangular three-centered two electron ERI tensor:  30583680
No. of significant triplets based on Schwarz inequality and triangularity: 20230767 or 33.2% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.041834416000000374 seconds.

Time taken to evaluate the nuclear potential matrix with strict Schwarz screening:  0.12272087499999884
Two Center Two electron ERI size in GB  0.007023752
Three Center Two electron ERI size in GB  0.161846136
Three-centered two electron evaluation done!
Time taken for Cholesky factorization fo two-centered two-electron integrals 0.006816458000002967 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  15.824557457999997 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  250672
Size (in GB) for storing the coordinates of grid:       0.006016128
Size (in GB) for storing the weights of grid:           0.002005376
Size (in GB) for storing the density at gridpoints:     0.002005376

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  5000
No. of batches:  51

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 0.026082375000001434 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    212
Average no. of basis functions contributing to a batch of grid points:    159

You have asked to save the values of significant basis functions and their gradients on grid points so as to avoid recalculation for each SCF cycle.
Please note: This will require addtional memory that is approximately :1.2 GB
Calculating the value of significantly contributing basis functions (atomic orbitals)...
done!
Time taken 0.9413420409999986 seconds.



------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Number of electrons:  93.90071434655567



------Iteration 1--------


Energies
Electron-Nuclear Energy       -2855.869922223354
Nuclear repulsion Energy      764.1282037243633
Kinetic Energy                572.6245800657355
Coulomb Energy                1025.505158000084
Exchange-Correlation Energy   -80.2856550074731
-------------------------
Total Energy  -573.8976354406441
-------------------------



Energy difference :  573.8976354406441


Time taken for the previous iteration: 0.8427035830000023


Number of electrons:  94.00000820834602



------Iteration 2--------


Energies
Electron-Nuclear Energy       -2870.760546119093
Nuclear repulsion Energy      764.1282037243633
Kinetic Energy                569.4280190367232
Coulomb Energy                1046.9463302949212
Exchange-Correlation Energy   -81.40900218703041
-------------------------
Total Energy  -571.6669952501156
-------------------------



Energy difference :  2.2306401905284474


Time taken for the previous iteration: 0.9322475000000026


Number of electrons:  94.00003018398799



------Iteration 3--------


Energies
Electron-Nuclear Energy       -2836.4947831412896
Nuclear repulsion Energy      764.1282037243633
Kinetic Energy                558.736651264058
Coulomb Energy                1021.9181342553112
Exchange-Correlation Energy   -79.66560959314478
-------------------------
Total Energy  -571.3774034907022
-------------------------



Energy difference :  0.28959175941338344


Time taken for the previous iteration: 0.9441637079999978


Number of electrons:  94.00001154818806



------Iteration 4--------


Energies
Electron-Nuclear Energy       -2855.2218923923992
Nuclear repulsion Energy      764.1282037243633
Kinetic Energy                564.3091742237102
Coulomb Energy                1035.463600254005
Exchange-Correlation Energy   -80.50798890628744
-------------------------
Total Energy  -571.828903096608
-------------------------



Energy difference :  0.4514996059057239


Time taken for the previous iteration: 0.9531396250000057


Number of electrons:  94.00001543807116



------Iteration 5--------


Energies
Electron-Nuclear Energy       -2856.6921973751246
Nuclear repulsion Energy      764.1282037243633
Kinetic Energy                565.1829849451477
Coulomb Energy                1036.1430755854556
Exchange-Correlation Energy   -80.63300961658592
-------------------------
Total Energy  -571.8709427367442
-------------------------



Energy difference :  0.04203964013618133


Time taken for the previous iteration: 0.9533045419999979


Number of electrons:  94.00001465248123



------Iteration 6--------


Energies
Electron-Nuclear Energy       -2856.6226165590365
Nuclear repulsion Energy      764.1282037243633
Kinetic Energy                565.043428421526
Coulomb Energy                1036.1935154467212
Exchange-Correlation Energy   -80.61595997167335
-------------------------
Total Energy  -571.8734289380993
-------------------------



Energy difference :  0.002486201355168305


Time taken for the previous iteration: 0.9468497089999985


Number of electrons:  94.00001470224585



------Iteration 7--------


Energies
Electron-Nuclear Energy       -2856.51905814426
Nuclear repulsion Energy      764.1282037243633
Kinetic Energy                565.0338753765028
Coulomb Energy                1036.0978296416126
Exchange-Correlation Energy   -80.61473710495494
-------------------------
Total Energy  -571.8738865067364
-------------------------



Energy difference :  0.0004575686371026677


Time taken for the previous iteration: 0.9515289160000009


Number of electrons:  94.0000148031679



------Iteration 8--------


Energies
Electron-Nuclear Energy       -2856.5028468641103
Nuclear repulsion Energy      764.1282037243633
Kinetic Energy                565.0339196276851
Coulomb Energy                1036.0815777360012
Exchange-Correlation Energy   -80.61478207181426
-------------------------
Total Energy  -571.8739278478752
-------------------------



Energy difference :  4.134113873988099e-05


Time taken for the previous iteration: 0.959085249999994


Number of electrons:  94.00001475273896



------Iteration 9--------


Energies
Electron-Nuclear Energy       -2856.4967208564294
Nuclear repulsion Energy      764.1282037243633
Kinetic Energy                565.0255850261694
Coulomb Energy                1036.082669605999
Exchange-Correlation Energy   -80.61367354370063
-------------------------
Total Energy  -571.8739360435984
-------------------------



Energy difference :  8.195723239623476e-06


Time taken for the previous iteration: 0.964437666000002


Number of electrons:  94.00001476785121



------Iteration 10--------


Energies
Electron-Nuclear Energy       -2856.493802885823
Nuclear repulsion Energy      764.1282037243633
Kinetic Energy                565.0242336636768
Coulomb Energy                1036.0808481531028
Exchange-Correlation Energy   -80.61341886762541
-------------------------
Total Energy  -571.8739362123058
-------------------------



Energy difference :  1.6870740182639565e-07


Time taken for the previous iteration: 0.9501625409999974


Number of electrons:  94.00001475676908



------Iteration 11--------


Energies
Electron-Nuclear Energy       -2856.5039456885443
Nuclear repulsion Energy      764.1282037243633
Kinetic Energy                565.0280451598569
Coulomb Energy                1036.0877376579163
Exchange-Correlation Energy   -80.61397723514577
-------------------------
Total Energy  -571.8739363815537
-------------------------



Energy difference :  1.6924786905292422e-07


Time taken for the previous iteration: 0.9574570420000015


Number of electrons:  94.00001476123722



------Iteration 12--------


Energies
Electron-Nuclear Energy       -2856.5003499587633
Nuclear repulsion Energy      764.1282037243633
Kinetic Energy                565.0269737347255
Coulomb Energy                1036.0850616557977
Exchange-Correlation Energy   -80.61382558146934
-------------------------
Total Energy  -571.8739364253461
-------------------------



Energy difference :  4.379239726404194e-08


Time taken for the previous iteration: 0.9526261660000017



SCF Converged after 12 iterations!

-------------------------------------
Total Energy =  -571.8739364253461
-------------------------------------



Time taken : 28.230814125 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           0.9674244160000001
Density Fitting                         0.9582246669999961
    DF (gamma)                          0.19197066600001733
    DF (coeff)                          0.03652320799998421
    DF (Jtri)                           0.6976854979999985
    DF (Cholesky)                       0.006816458000002967
DIIS                                    0.15384141800000606
KS matrix diagonalization               0.10290254300001322
One electron Integrals (S, T, Vnuc)     0.12248699999999957
Coulomb Integrals (2c2e + 3c2e)         15.817740999999995
Grids construction                      0
Exchange-Correlation Term               10.081350336000021
Misc.                                   0.02684274499996775
Complete SCF                            28.230814125
Energy diff (PySCF-CrysX) 4.1179316667694366e-07


PyFock Dipole moment
Dipole moment(X, Y, Z, A.U.): -0.023143557412424798 0.08883410217457666 0.2761053056703986
Max Diff dipole moment (PySCF-CrysX) 0.0019578800540216434
