Cupy is not installed. GPU acceleration is not availble.
Operating System: Darwin 24.3.0
System Type: 64bit
CPU Model: Apple M4
Number of Cores: 10
Number of Threads: 10
Memory (GB): 16.0
Number of cores being actually used/requested for the benchmark: 1
Confirming that the environment variables are properly set...
OMP_NUM_THREADS = 1
OPENBLAS_NUM_THREADS = 1
MKL_NUM_THREADS = 1
VECLIB_MAXIMUM_THREADS = 1
NUMEXPR_NUM_THREADS = 1
PYSCF_MAX_MEMORY = 25000
#INFO: **** input file is /Users/manas/Documents/PyFock/benchmarks_tests/benchmark_DFT_LDA_DF.py ****
####### NOTE: The scipy.linalg library appears to be using double the number of threads supplied for some reason.
####### To avoid such issues messing up the benchmarks, the benchmark should be run as 'taskset --cpu-list 0-3 python3 benchmark_DFT_LDA_DF.py'
####### This way one can set the number of CPUs seen by the python process and the benchmark would be much more reliable.
####### Furthermore, to confirm the CPU and memory usage throughout the whole process, one can profilie it using  
####### psrecord 13447 --interval 1 --duration 120 --plot 13447.png
#######
####### This may be required in some cases when using GPU on WSL
####### export NUMBA_CUDA_DRIVER="/usr/lib/wsl/lib/libcuda.so.1"

import os
import platform
import psutil
import numba
#numba.config.THREADING_LAYER='tbb'
# Set the number of threads/cores to be used by PyFock and PySCF
ncores = 1
os.environ['OMP_NUM_THREADS'] = str(ncores)
os.environ["OPENBLAS_NUM_THREADS"] = str(ncores) # export OPENBLAS_NUM_THREADS=4 
os.environ["MKL_NUM_THREADS"] = str(ncores) # export MKL_NUM_THREADS=4
os.environ["VECLIB_MAXIMUM_THREADS"] = str(ncores) # export VECLIB_MAXIMUM_THREADS=4
# os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=4
os.environ["NUMEXPR_NUM_THREADS"] = str(ncores) # export NUMEXPR_NUM_THREADS=1
# Set the max memory for PySCF
os.environ["PYSCF_MAX_MEMORY"] = str(25000) 

# Print system information 
from pyfock import Utils

Utils.print_sys_info()

# Check if the environment variables are properly set
print("Number of cores being actually used/requested for the benchmark:", ncores)
print('Confirming that the environment variables are properly set...')
print('OMP_NUM_THREADS =', os.environ.get('OMP_NUM_THREADS', None))
print('OPENBLAS_NUM_THREADS =', os.environ.get('OPENBLAS_NUM_THREADS', None))
print('MKL_NUM_THREADS =', os.environ.get('MKL_NUM_THREADS', None))
print('VECLIB_MAXIMUM_THREADS =', os.environ.get('VECLIB_MAXIMUM_THREADS', None))
print('NUMEXPR_NUM_THREADS =', os.environ.get('NUMEXPR_NUM_THREADS', None))
print('PYSCF_MAX_MEMORY =', os.environ.get('PYSCF_MAX_MEMORY', None))


# Run your tasks here
from pyfock import Basis
from pyfock import Mol
from pyfock import Integrals
from pyfock import DFT
from timeit import default_timer as timer
import numpy as np
import scipy

from pyscf import gto, dft, df, scf

#DFT SCF benchmark and comparison with PySCF
#Benchmarking and performance assessment and comparison using various techniques and different softwares

# LDA_X LDA_C_VWN 
# funcx = 1
# funcc = 7

# LDA_X LDA_C_PW 
# funcx = 1
# funcc = 12

# LDA_X LDA_C_PW_MOD 
# funcx = 1
# funcc = 13

# GGA_X_PBE, GGA_C_PBE (PBE)
funcx = 101
funcc = 130

# GGA_X_B88, GGA_C_LYP (BLYP)
# funcx = 106
# funcc = 131

funcidcrysx = [funcx, funcc]
funcidpyscf = str(funcx)+','+str(funcc)

# basis_set_name = 'sto-2g'
# basis_set_name = 'sto-3g'
# basis_set_name = 'sto-6g'
# basis_set_name = '6-31G'
# basis_set_name = 'def2-SVP'
# basis_set_name = 'def2-SVPD'
basis_set_name = 'def2-TZVP'
# basis_set_name = 'def2-QZVP'
# basis_set_name = 'def2-TZVPP'
# basis_set_name = 'def2-QZVPP'
# basis_set_name = 'def2-TZVPD'
# basis_set_name = 'def2-QZVPD'
# basis_set_name = 'def2-TZVPPD'
# basis_set_name = 'def2-QZVPPD'
# basis_set_name = 'cc-pVDZ'
# basis_set_name = 'ano-rcc'

auxbasis_name = 'def2-universal-jfit'
# auxbasis_name = 'def2-universal-jkfit'
# auxbasis_name = 'def2-TZVP'
# auxbasis_name = 'sto-3g'
# auxbasis_name = 'def2-SVP'
# auxbasis_name = '6-31G'

# xyzFilename = 'Benzene-Fulvene_Dimer.xyz'
# xyzFilename = 'Adenine-Thymine.xyz'
# xyzFilename = 'Zn.xyz'
# xyzFilename = 'Zn_dimer.xyz'
# xyzFilename = 'TPP.xyz'
# xyzFilename = 'Zn_TPP.xyz'
# xyzFilename = 'H2O.xyz'

xyzFilename = 'Caffeine.xyz'
# xyzFilename = 'Serotonin.xyz'
# xyzFilename = 'Cholesterol.xyz'
# xyzFilename = 'C60.xyz'
# xyzFilename = 'Taxol.xyz'
# xyzFilename = 'Valinomycin.xyz'
# xyzFilename = 'Olestra.xyz'
# xyzFilename = 'Ubiquitin.xyz'

### 1D Carbon Alkanes
# xyzFilename = 'Ethane.xyz'
# xyzFilename = 'Decane_C10H22.xyz'
# xyzFilename = 'Icosane_C20H42.xyz'
# xyzFilename = 'Tetracontane_C40H82.xyz'
# xyzFilename = 'Pentacontane_C50H102.xyz'
# xyzFilename = 'Octacontane_C80H162.xyz'
# xyzFilename = 'Hectane_C100H202.xyz'
# xyzFilename = 'Icosahectane_C120H242.xyz'

### 2D Carbon
# xyzFilename = 'Graphene_C16.xyz'
# xyzFilename = 'Graphene_C76.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'

### 3d Carbon Fullerenes
# xyzFilename = 'C60.xyz'
# xyzFilename = 'C70.xyz'
# xyzFilename = 'Graphene_C102.xyz'
# xyzFilename = 'Graphene_C184.xyz'
# xyzFilename = 'Graphene_C210.xyz'
# xyzFilename = 'Graphene_C294.xyz'


# ---------PySCF---------------
#Comparison with PySCF
molPySCF = gto.Mole()
molPySCF.atom = xyzFilename
molPySCF.basis = basis_set_name
molPySCF.cart = True
molPySCF.verbose = 4
molPySCF.max_memory=5000
# molPySCF.incore_anyway = True # Keeps the PySCF ERI integrals incore
molPySCF.build()
#print(molPySCF.cart_labels())

print('\n\nPySCF Results\n\n')
start=timer()
mf = dft.rks.RKS(molPySCF).density_fit(auxbasis=auxbasis_name)
# mf = scf.RHF(molPySCF).density_fit(auxbasis=auxbasis_name)
mf.xc = funcidpyscf
# mf.verbose = 4
mf.direct_scf = False
# mf.with_df.max_memory = 25000
# dmat_init = mf.init_guess_by_1e(molPySCF)
# dmat_init = mf.init_guess_by_huckel(molPySCF)
mf.init_guess = 'minao'
dmat_init = mf.init_guess_by_minao(molPySCF)
# mf.init_guess = 'atom'
# dmat_init = mf.init_guess_by_atom(molPySCF)
mf.max_cycle = 30
mf.conv_tol = 1e-7
mf.grids.level = 3
# print('begin df build')
# start_df_pyscf=timer()
# mf.with_df.build()
# duration_df_pyscf = timer()- start_df_pyscf
# print('PySCF df time: ', duration_df_pyscf)
# print('end df build')
energyPyscf = mf.kernel(dm0=dmat_init)
print('Nuc-Nuc PySCF= ', molPySCF.energy_nuc())
print('One electron integrals energy',mf.scf_summary['e1'])
print('Coulomb energy ',mf.scf_summary['coul'])
print('EXC ',mf.scf_summary['exc'])
duration = timer()-start
print('PySCF time: ', duration)
pyscfGrids = mf.grids
print('PySCF Grid Size: ', pyscfGrids.weights.shape)
print('\n\n PySCF Dipole moment')
dmat = mf.make_rdm1()
mol_dip_pyscf = mf.dip_moment(molPySCF, dmat, unit='AU')
mf = 0#None
import psutil

# Get memory information
memory_info = psutil.virtual_memory()

# Convert bytes to human-readable format
used_memory = psutil._common.bytes2human(memory_info.used)


# If you want to print in a more human-readable format, you can use psutil's utility function
print(f"Currently Used memory: {used_memory}")
#--------------------CrysX --------------------------

#Initialize a Mol object with somewhat large geometry
molCrysX = Mol(coordfile=xyzFilename)
print('\n\nNatoms :',molCrysX.natoms)
# print(molCrysX.coordsBohrs)

#Initialize a Basis object with a very large basis set
basis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=basis_set_name)})
print('\n\nNAO :',basis.bfs_nao)

auxbasis = Basis(molCrysX, {'all':Basis.load(mol=molCrysX, basis_name=auxbasis_name)})
print('\n\naux NAO :',auxbasis.bfs_nao)

dftObj = DFT(molCrysX, basis, xc=funcidcrysx)
# GPU acceleration
dftObj.use_gpu = False
dftObj.keep_ao_in_gpu = False
dftObj.use_libxc = False
dftObj.n_streams = 1 # Changing this to anything other than 1 won't make any difference 
dftObj.n_gpus = 1 # Specify the number of GPUs
dftObj.free_gpu_mem = True
dftObj.threads_x = 32
dftObj.threads_y = 32
dftObj.dynamic_precision = False
dftObj.keep_ints3c2e_in_gpu = True
# SAO or CAO basis
dftObj.sao = False
# print(dmat_init)
# Using PySCF grids to compare the energies
energyCrysX, dmat = dftObj.scf(max_itr=35, ncores=ncores, dmat=dmat_init, conv_crit=1.0E-7, grids=pyscfGrids, \
                               isDF=True, auxbasis=auxbasis, rys=True, DF_algo=10, blocksize=5000, XC_algo=2, debug=False, \
                                sortGrids=False, save_ao_values=True, xc_bf_screen=True, threshold_schwarz=1e-9, \
                                strict_schwarz=True, cholesky=True, orthogonalize=True)
# print(dmat)

# Using CrysX grids 
# To get the same energies as PySCF (level=5) upto 1e-7 au, use the following settings
# radial_precision=1.0e-13
# level=3
# pruning by density with threshold = 1e-011
# alpha_min and alpha_max corresponding to QZVP
# energyCrysX, dmat = dftObj.scf(max_itr=30, ncores=ncores, dmat=dmat_init, grids=None, gridsLevel=3, isDF=True, auxbasis=auxbasis,
#                             rys=True, DF_algo=6, blocksize=5000, XC_algo=2, debug=False, sortGrids=False, save_ao_values=True,
#                             xc_bf_screen=True,threshold_schwarz=1e-9)


print('Energy diff (PySCF-CrysX)', abs(energyCrysX-energyPyscf))

print('\n\nPyFock Dipole moment')
M = Integrals.dipole_moment_mat_symm(basis)
mol_dip = molCrysX.get_dipole_moment(M, dmat)
print('Dipole moment(X, Y, Z, A.U.):', *mol_dip)
print('Max Diff dipole moment (PySCF-CrysX)', abs(mol_dip_pyscf-mol_dip).max())

#Print package versions
import joblib
import scipy
import numba
import threadpoolctl
import opt_einsum
import pylibxc
import llvmlite 
import cupy
import numexpr
import pyscf
print('\n\n\n Package versions')
print('pyscf version', pyscf.__version__)
# print('psi4 version', psi4.__version__)
print('np version', np.__version__)
print('joblib version', joblib.__version__)
print('numba version', numba.__version__)
print('threadpoolctl version', threadpoolctl.__version__)
print('opt_einsum version', opt_einsum.__version__)
# print('pylibxc version', pylibxc.__version__)
print('llvmlite version', llvmlite.__version__)
print('cupy version', cupy.__version__)
print('numexpr version', numexpr.__version__)
print('scipy version', scipy.__version__)
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Manass-MacBook-Air.local', release='24.3.0', version='Darwin Kernel Version 24.3.0: Thu Jan  2 20:31:46 PST 2025; root:xnu-11215.81.4~4/RELEASE_ARM64_T8132', machine='arm64')  Threads 1
Python 3.9.6 (default, Mar 12 2025, 20:22:46) 
[Clang 17.0.0 (clang-1700.0.13.3)]
numpy 1.26.4  scipy 1.10.1  h5py 3.13.0
Date: Mon May 19 20:08:42 2025
PySCF version 2.9.0
PySCF path  /Users/manas/Library/Python/3.9/lib/python/site-packages/pyscf

[ENV] PYSCF_MAX_MEMORY 25000
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 24
[INPUT] num. electrons = 102
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Cartesian GTO integrals (6d 10f)
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 N      1.580800000000   0.702700000000  -0.227900000000 AA    2.987279057712   1.327910547732  -0.430668583788 Bohr   0.0
[INPUT]  2 C      1.706200000000  -0.737400000000  -0.212600000000 AA    3.224250713733  -1.393484044254  -0.401755774083 Bohr   0.0
[INPUT]  3 N      0.534000000000  -1.567100000000  -0.350300000000 AA    1.009113750518  -2.961389809806  -0.661971061435 Bohr   0.0
[INPUT]  4 C      0.323100000000   1.360000000000   0.027400000000 AA    0.610570510847   2.570027529408   0.051778495813 Bohr   0.0
[INPUT]  5 C     -0.812300000000   0.455300000000   0.081700000000 AA   -1.535024530984   0.860392304514   0.154390624377 Bohr   0.0
[INPUT]  6 C     -0.696700000000  -0.932200000000  -0.066200000000 AA   -1.316572190984  -1.761602693320  -0.125099869446 Bohr   0.0
[INPUT]  7 N     -2.188600000000   0.699000000000   0.278300000000 AA   -4.135854596223   1.320918561071   0.525910780466 Bohr   0.0
[INPUT]  8 C     -2.851200000000  -0.520500000000   0.253200000000 AA   -5.387987126360  -0.983602447836   0.478478654740 Bohr   0.0
[INPUT]  9 N     -1.953700000000  -1.518800000000   0.042600000000 AA   -3.691957929563  -2.870116037989   0.080502332906 Bohr   0.0
[INPUT] 10 C      0.656800000000  -3.027400000000  -0.167500000000 AA    1.241172118614  -5.720956869508  -0.316529125865 Bohr   0.0
[INPUT] 11 O      2.813600000000  -1.255800000000  -0.169300000000 AA    5.316933424076  -2.373118067229  -0.319930632889 Bohr   0.0
[INPUT] 12 O      0.284900000000   2.574400000000   0.159100000000 AA    0.538382972889   4.864910935080   0.300655426418 Bohr   0.0
[INPUT] 13 C     -2.809600000000   2.003100000000   0.503200000000 AA   -5.309374519578   3.785310400116   0.950910185881 Bohr   0.0
[INPUT] 14 C      2.830100000000   1.500400000000  -0.196800000000 AA    5.348113905132   2.835345077297  -0.371898101314 Bohr   0.0
[INPUT] 15 H     -3.927100000000  -0.678700000000   0.376200000000 AA   -7.421143463779  -1.282557120742   0.710914968061 Bohr   0.0
[INPUT] 16 H      1.482300000000  -3.404600000000  -0.786500000000 AA    2.801141034443  -6.433761563694  -1.486269596970 Bohr   0.0
[INPUT] 17 H     -0.270800000000  -3.520400000000  -0.486800000000 AA   -0.511737834532  -6.652591848919  -0.919918677438 Bohr   0.0
[INPUT] 18 H      0.856700000000  -3.299000000000   0.878800000000 AA    1.618928370915  -6.234206484940   1.660691318268 Bohr   0.0
[INPUT] 19 H     -2.412300000000   2.747800000000  -0.201700000000 AA   -4.558586330288   5.192589445080  -0.381157759325 Bohr   0.0
[INPUT] 20 H     -2.604200000000   2.362100000000   1.522100000000 AA   -4.921224773592   4.463722078835   2.876352134200 Bohr   0.0
[INPUT] 21 H     -3.897300000000   1.934400000000   0.369500000000 AA   -7.364829625267   3.655486215359   0.698253803027 Bohr   0.0
[INPUT] 22 H      3.595900000000   1.033300000000  -0.831400000000 AA    6.795266171324   1.952654004513  -1.571118299963 Bohr   0.0
[INPUT] 23 H      3.224900000000   1.579100000000   0.825500000000 AA    6.094177779110   2.984066523301   1.559968915828 Bohr   0.0
[INPUT] 24 H      2.643100000000   2.513000000000  -0.579300000000 AA    4.994735119838   4.748881751032  -1.094718343961 Bohr   0.0

nuclear repulsion = 912.858684489473
number of shells = 194
number of NR pGTOs = 794
number of NR cGTOs = 564
basis = def2-TZVP
ecp = {}
CPU time:         2.96


PySCF Results


Initial guess from minao.


******** <class 'pyscf.df.df_jk.DFRKS'> ********
method = DFRKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 30
direct_scf = False
chkfile to save SCF result = /var/folders/2v/15wx3xrs0tj4bz4kdgj4gfwh0000gn/T/tmp9zgjqgy9
max_memory 5000 MB (current use 0 MB)
XC library pyscf.dft.libxc version 7.0.0
    S. Lehtola, C. Steigemann, M. J.T. Oliveira, and M. A.L. Marques.,  SoftwareX 7, 1–5 (2018)
XC functionals = 101,130
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x13182d8b0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x13175d160>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 0.000316228
tot grids = 294800
init E= -681.59065259707
  HOMO = -0.237827875925903  LUMO = -0.106639794058927
cycle= 1 E= -679.457280010232  delta_E= 2.13  |g|= 1.43  |ddm|= 4.17
  HOMO = -0.0539972904853001  LUMO = -0.0365241534049514
cycle= 2 E= -674.125239768873  delta_E= 5.33  |g|= 4.64  |ddm|= 8.86
  HOMO = -0.150320361564512  LUMO = -0.041794638661946
cycle= 3 E= -679.660800004608  delta_E= -5.54  |g|= 0.793  |ddm|= 7.96
  HOMO = -0.205918777575318  LUMO = -0.0804799219215163
cycle= 4 E= -679.791004783532  delta_E= -0.13  |g|= 0.476  |ddm|= 1.79
  HOMO = -0.209558700494277  LUMO = -0.0884792573098735
cycle= 5 E= -679.819831078341  delta_E= -0.0288  |g|= 0.334  |ddm|= 0.792
  HOMO = -0.202048521636101  LUMO = -0.0747926339755905
cycle= 6 E= -679.844946372499  delta_E= -0.0251  |g|= 0.0979  |ddm|= 0.41
  HOMO = -0.199890415014081  LUMO = -0.0742026660502419
cycle= 7 E= -679.84701175356  delta_E= -0.00207  |g|= 0.0335  |ddm|= 0.0894
  HOMO = -0.200663019830778  LUMO = -0.0745126441282496
cycle= 8 E= -679.84723763601  delta_E= -0.000226  |g|= 0.0123  |ddm|= 0.0364
  HOMO = -0.200883440192144  LUMO = -0.0747728468147883
cycle= 9 E= -679.847265292933  delta_E= -2.77e-05  |g|= 0.0044  |ddm|= 0.0104
  HOMO = -0.200810900213911  LUMO = -0.0747689699486563
cycle= 10 E= -679.847268643713  delta_E= -3.35e-06  |g|= 0.00211  |ddm|= 0.006
  HOMO = -0.200783544921486  LUMO = -0.0747030476566376
cycle= 11 E= -679.847269531265  delta_E= -8.88e-07  |g|= 0.00069  |ddm|= 0.00282
  HOMO = -0.200783556873077  LUMO = -0.0747057755066111
cycle= 12 E= -679.847269616839  delta_E= -8.56e-08  |g|= 0.000187  |ddm|= 0.000506
  HOMO = -0.200793829445021  LUMO = -0.0747218766305914
Extra cycle  E= -679.847269583263  delta_E= 3.36e-08  |g|= 0.000454  |ddm|= 0.000515
converged SCF energy = -679.847269583263
Nuc-Nuc PySCF=  912.8586844894734
One electron integrals energy -2736.815730473818
Coulomb energy  1235.1932273070868
EXC  -91.08345090600478
PySCF time:  52.322426208
PySCF Grid Size:  (249328,)


 PySCF Dipole moment
Dipole moment(X, Y, Z, A.U.): -1.28182,  0.23310,  0.15654
Currently Used memory: 6.6G


Natoms : 24


NAO : 564


aux NAO : 974
Running DFT using 1 threads for Numba.



Calculating overlap and kinetic integrals...


Core H size in GB  0.005089536
done!
Time taken 0.15948245900000302 seconds.


Calculating three centered two electron and two-centered two-electron integrals...


Time taken for two-centered two-electron integrals 0.3224867919999994 seconds.



Performing Schwarz screening...
Threshold  1e-09
Time taken to evaluate the "diagonal" of 4c2e ERI tensor:  0.15542541700000356
Time taken to evaluate the square roots needed:  0.000543708000002141
Time for significant indices evaluation:  0.015436750000006327
Size of permanent array storing the significant indices of 3c2e ERI in GB  0.003823928
No. of elements in the standard three-centered two electron ERI tensor:  309825504
No. of elements in the triangular three-centered two electron ERI tensor:  155187420
No. of significant triplets based on Schwarz inequality and triangularity: 103703728 or 33.5% of original
Schwarz screening done!
Total time taken for Schwarz screening 0.1714917080000049 seconds.

Time taken to evaluate the nuclear potential matrix with strict Schwarz screening:  0.652796084000002
Two Center Two electron ERI size in GB  0.007589408
Three Center Two electron ERI size in GB  0.829629824
Three-centered two electron evaluation done!
Time taken for Cholesky factorization fo two-centered two-electron integrals 0.007887000000010858 seconds.

Time taken for Coulomb term related calculations (integrals, screening, prelims..) with the density fitting approximation  72.762095209 seconds.


Using the user supplied grids!



No. of supplied/generated grid points:  249328
Size (in GB) for storing the coordinates of grid:       0.005983872
Size (in GB) for storing the weights of grid:           0.001994624
Size (in GB) for storing the density at gridpoints:     0.001994624

Will use batching to evaluate the XC term for memory efficiency.
Batch size:  5000
No. of batches:  50

Preliminary processing for XC term evaluations...
Calculating the value of basis functions (atomic orbitals) and get the indices of siginificantly contributing functions...
done!
Time taken 0.05707962500000008 seconds.

Maximum no. of basis functions contributing to a batch of grid points:    483
Average no. of basis functions contributing to a batch of grid points:    335

You have asked to save the values of significant basis functions and their gradients on grid points so as to avoid recalculation for each SCF cycle.
Please note: This will require addtional memory that is approximately :2.5 GB
Calculating the value of significantly contributing basis functions (atomic orbitals)...
done!
Time taken 1.8418157920000056 seconds.



------------------------------------------------------
Exchange-Correlation Functional
------------------------------------------------------

XC Functional IDs supplied:  [101, 130]


Description of exchange functional: 

The Exchange function belongs to the family: GGA
Functional ID: 101
Functional Name: gga_x_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 0
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)


Description of correlation functional: 

 The Correlation function belongs to the family: GGA
Functional ID: 130
Functional Name: gga_c_pbe
Attributes:
    Name: Perdew, Burke & Ernzerhof
    Kind: 1
  Family: 2
Citations:
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 77, 3865 (1996)
   J. P. Perdew, K. Burke, and M. Ernzerhof.,  Phys. Rev. Lett. 78, 1396 (1997)
------------------------------------------------------




Number of electrons:  101.04811586287904



------Iteration 1--------


Energies
Electron-Nuclear Energy       -3393.1453514219065
Nuclear repulsion Energy      912.8586844919183
Kinetic Energy                680.6336072674119
Coulomb Energy                1209.776216544349
Exchange-Correlation Energy   -90.3224304276089
-------------------------
Total Energy  -680.1992735458364
-------------------------



Energy difference :  680.1992735458364


Time taken for the previous iteration: 3.1949635


Number of electrons:  102.0000769060174



------Iteration 2--------


Energies
Electron-Nuclear Energy       -3431.143862678626
Nuclear repulsion Energy      912.8586844919183
Kinetic Energy                682.9323733869464
Coulomb Energy                1248.293378433767
Exchange-Correlation Energy   -92.33521847323264
-------------------------
Total Energy  -679.3946448392271
-------------------------



Energy difference :  0.8046287066092646


Time taken for the previous iteration: 3.249074374999992


Number of electrons:  102.00018894778594



------Iteration 3--------


Energies
Electron-Nuclear Energy       -3387.1798012272657
Nuclear repulsion Energy      912.8586844919183
Kinetic Energy                664.415525016373
Coulomb Energy                1222.57345150005
Exchange-Correlation Energy   -89.34796135859577
-------------------------
Total Energy  -676.6801015775204
-------------------------



Energy difference :  2.7145432617066945


Time taken for the previous iteration: 3.248193208999993


Number of electrons:  102.00013947205272



------Iteration 4--------


Energies
Electron-Nuclear Energy       -3401.941670317625
Nuclear repulsion Energy      912.8586844919183
Kinetic Energy                672.7930336655511
Coulomb Energy                1227.2250520172474
Exchange-Correlation Energy   -90.6467330092992
-------------------------
Total Energy  -679.7116331522075
-------------------------



Energy difference :  3.031531574687051


Time taken for the previous iteration: 3.2541103750000104


Number of electrons:  102.0001177928224



------Iteration 5--------


Energies
Electron-Nuclear Energy       -3412.928615388691
Nuclear repulsion Energy      912.8586844919183
Kinetic Energy                675.529740902345
Coulomb Energy                1235.7704529545586
Exchange-Correlation Energy   -91.05709766060781
-------------------------
Total Energy  -679.8268347004769
-------------------------



Energy difference :  0.11520154826939688


Time taken for the previous iteration: 3.296928707999996


Number of electrons:  102.00011418152846



------Iteration 6--------


Energies
Electron-Nuclear Energy       -3413.42461283886
Nuclear repulsion Energy      912.8586844919183
Kinetic Energy                675.9900566235685
Coulomb Energy                1235.8536256571936
Exchange-Correlation Energy   -91.117166139213
-------------------------
Total Energy  -679.839412205393
-------------------------



Energy difference :  0.01257750491618026


Time taken for the previous iteration: 3.344102042000003


Number of electrons:  102.00011721963227



------Iteration 7--------


Energies
Electron-Nuclear Energy       -3412.5969848977347
Nuclear repulsion Energy      912.8586844919183
Kinetic Energy                675.7717690414795
Coulomb Energy                1235.2052380875534
Exchange-Correlation Energy   -91.08523744936468
-------------------------
Total Energy  -679.8465307261481
-------------------------



Energy difference :  0.007118520755057034


Time taken for the previous iteration: 3.3404797500000143


Number of electrons:  102.00011708922541



------Iteration 8--------


Energies
Electron-Nuclear Energy       -3412.5638106150113
Nuclear repulsion Energy      912.8586844919183
Kinetic Energy                675.7456218635338
Coulomb Energy                1235.194741523422
Exchange-Correlation Energy   -91.0824407099761
-------------------------
Total Energy  -679.8472034461136
-------------------------



Energy difference :  0.0006727199654505966


Time taken for the previous iteration: 3.3535497080000027


Number of electrons:  102.00011705186088



------Iteration 9--------


Energies
Electron-Nuclear Energy       -3412.5248785386666
Nuclear repulsion Energy      912.8586844919183
Kinetic Energy                675.7404931148038
Coulomb Energy                1235.1610017547105
Exchange-Correlation Energy   -91.08254738065372
-------------------------
Total Energy  -679.8472465578875
-------------------------



Energy difference :  4.3111773948112386e-05


Time taken for the previous iteration: 3.3501092920000133


Number of electrons:  102.00011701772394



------Iteration 10--------


Energies
Electron-Nuclear Energy       -3412.6076636002135
Nuclear repulsion Energy      912.8586844919183
Kinetic Energy                675.7574865510693
Coulomb Energy                1235.2295022933147
Exchange-Correlation Energy   -91.08526843427826
-------------------------
Total Energy  -679.8472586981895
-------------------------



Energy difference :  1.2140302033003536e-05


Time taken for the previous iteration: 3.334294041999982


Number of electrons:  102.00011709758365



------Iteration 11--------


Energies
Electron-Nuclear Energy       -3412.554104017696
Nuclear repulsion Energy      912.8586844919183
Kinetic Energy                675.7435531699044
Coulomb Energy                1235.1876249179295
Exchange-Correlation Energy   -91.08302757081287
-------------------------
Total Energy  -679.8472690087569
-------------------------



Energy difference :  1.0310567404303583e-05


Time taken for the previous iteration: 3.3420166250000136


Number of electrons:  102.00011707418552



------Iteration 12--------


Energies
Electron-Nuclear Energy       -3412.5547694304973
Nuclear repulsion Energy      912.8586844919183
Kinetic Energy                675.7440183648293
Coulomb Energy                1235.187888064937
Exchange-Correlation Energy   -91.08309078935935
-------------------------
Total Energy  -679.8472692981718
-------------------------



Energy difference :  2.8941485652467236e-07


Time taken for the previous iteration: 3.3444652919999953


Number of electrons:  102.00011706373142



------Iteration 13--------


Energies
Electron-Nuclear Energy       -3412.562188508155
Nuclear repulsion Energy      912.8586844919183
Kinetic Energy                675.7458863739234
Coulomb Energy                1235.193701864603
Exchange-Correlation Energy   -91.08335355206667
-------------------------
Total Energy  -679.8472693297767
-------------------------



Energy difference :  3.1604940886609256e-08


Time taken for the previous iteration: 3.3396533750000117



SCF Converged after 13 iterations!

-------------------------------------
Total Energy =  -679.8472693297767
-------------------------------------



Time taken : 117.84633783299999 seconds.



-------------------------------------
Profiling
-------------------------------------
Preprocessing                           1.8988954170000056
Density Fitting                         4.6156483350000315
    DF (gamma)                          1.2784854190000203
    DF (coeff)                          0.03076566600000774
    DF (Jtri)                           3.2628286280000225
    DF (Cholesky)                       0.007887000000010858
DIIS                                    1.5645937490000108
KS matrix diagonalization               0.9002426229999685
One electron Integrals (S, T, Vnuc)     0.15948245900000302
Coulomb Integrals (2c2e + 3c2e)         72.75420820899998
Grids construction                      0
Exchange-Correlation Term               35.909555833999974
Misc.                                   0.043711207000015406
Complete SCF                            117.84633783299999
Energy diff (PySCF-CrysX) 2.5348583676532144e-07


PyFock Dipole moment
Dipole moment(X, Y, Z, A.U.): -1.2814040135612093 0.2345893266746112 0.15677565009241012
Max Diff dipole moment (PySCF-CrysX) 0.0014888045736816125
